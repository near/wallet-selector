"use strict";(self.webpackChunkangular=self.webpackChunkangular||[]).push([[4757],{64757:(Gt,W,$)=>{$.r(W),$.d(W,{MessageFormatter:()=>I,Methods:()=>d,Operation:()=>k.Operation,RPC_CALLS:()=>m,RestrictedMethods:()=>M,TokenType:()=>k.TokenType,TransactionStatus:()=>k.TransactionStatus,TransferDirection:()=>k.TransferDirection,default:()=>Vt,getSDKVersion:()=>K,isObjectEIP712TypedData:()=>O});const K=()=>"9.1.0",Ce=t=>t.toString(16).padStart(2,"0"),ke=()=>typeof window<"u"?(t=>{const e=new Uint8Array((t||40)/2);return window.crypto.getRandomValues(e),Array.from(e,Ce).join("")})(10):(new Date).getTime().toString(36);class I{}var d,t,M;I.makeRequest=(t,e)=>({id:ke(),method:t,params:e,env:{sdkVersion:K()}}),I.makeResponse=(t,e,n)=>({id:t,success:!0,version:n,data:e}),I.makeErrorResponse=(t,e,n)=>({id:t,success:!1,error:e,version:n}),(t=d||(d={})).sendTransactions="sendTransactions",t.rpcCall="rpcCall",t.getChainInfo="getChainInfo",t.getSafeInfo="getSafeInfo",t.getTxBySafeTxHash="getTxBySafeTxHash",t.getSafeBalances="getSafeBalances",t.signMessage="signMessage",t.signTypedMessage="signTypedMessage",t.getEnvironmentInfo="getEnvironmentInfo",t.getOffChainSignature="getOffChainSignature",t.requestAddressBook="requestAddressBook",t.wallet_getPermissions="wallet_getPermissions",t.wallet_requestPermissions="wallet_requestPermissions",function(t){t.requestAddressBook="requestAddressBook"}(M||(M={}));const _e=class De{constructor(e=null,n=!1){this.allowedOrigins=null,this.callbacks=new Map,this.debugMode=!1,this.isServer=typeof window>"u",this.isValidMessage=({origin:r,data:s,source:i})=>{const o=!s,a=!this.isServer&&i===window.parent,u=typeof s.version<"u"&&parseInt(s.version.split(".")[0]),f="number"==typeof u&&u>=1;let h=!0;return Array.isArray(this.allowedOrigins)&&(h=void 0!==this.allowedOrigins.find(g=>g.test(r))),!o&&a&&f&&h},this.logIncomingMessage=r=>{console.info(`Safe Apps SDK v1: A message was received from origin ${r.origin}. `,r.data)},this.onParentMessage=r=>{this.isValidMessage(r)&&(this.debugMode&&this.logIncomingMessage(r),this.handleIncomingMessage(r.data))},this.handleIncomingMessage=r=>{const{id:s}=r,i=this.callbacks.get(s);i&&(i(r),this.callbacks.delete(s))},this.send=(r,s)=>{const i=I.makeRequest(r,s);if(this.isServer)throw new Error("Window doesn't exist");return window.parent.postMessage(i,"*"),new Promise((o,a)=>{this.callbacks.set(i.id,u=>{u.success?o(u):a(new Error(u.error))})})},this.allowedOrigins=e,this.debugMode=n,this.isServer||window.addEventListener("message",this.onParentMessage)}};var l=$(49671);const O=t=>"object"==typeof t&&null!=t&&"domain"in t&&"types"in t&&"message"in t;var k=$(92797);class je{constructor(e){this.communicator=e}getBySafeTxHash(e){var n=this;return(0,l.Z)(function*(){if(!e)throw new Error("Invalid safeTxHash");return(yield n.communicator.send(d.getTxBySafeTxHash,{safeTxHash:e})).data})()}signMessage(e){var n=this;return(0,l.Z)(function*(){const r={message:e};return(yield n.communicator.send(d.signMessage,r)).data})()}signTypedMessage(e){var n=this;return(0,l.Z)(function*(){if(!O(e))throw new Error("Invalid typed data");return(yield n.communicator.send(d.signTypedMessage,{typedData:e})).data})()}send({txs:e,params:n}){var r=this;return(0,l.Z)(function*(){if(!e||!e.length)throw new Error("No transactions were passed");const s={txs:e,params:n};return(yield r.communicator.send(d.sendTransactions,s)).data})()}}const m={eth_call:"eth_call",eth_gasPrice:"eth_gasPrice",eth_getLogs:"eth_getLogs",eth_getBalance:"eth_getBalance",eth_getCode:"eth_getCode",eth_getBlockByHash:"eth_getBlockByHash",eth_getBlockByNumber:"eth_getBlockByNumber",eth_getStorageAt:"eth_getStorageAt",eth_getTransactionByHash:"eth_getTransactionByHash",eth_getTransactionReceipt:"eth_getTransactionReceipt",eth_getTransactionCount:"eth_getTransactionCount",eth_estimateGas:"eth_estimateGas",safe_setSettings:"safe_setSettings"},b={defaultBlockParam:(t="latest")=>t,returnFullTxObjectParam:(t=!1)=>t,blockNumberToHex:t=>Number.isInteger(t)?`0x${t.toString(16)}`:t};class Oe{constructor(e){this.communicator=e,this.call=this.buildRequest({call:m.eth_call,formatters:[null,b.defaultBlockParam]}),this.getBalance=this.buildRequest({call:m.eth_getBalance,formatters:[null,b.defaultBlockParam]}),this.getCode=this.buildRequest({call:m.eth_getCode,formatters:[null,b.defaultBlockParam]}),this.getStorageAt=this.buildRequest({call:m.eth_getStorageAt,formatters:[null,b.blockNumberToHex,b.defaultBlockParam]}),this.getPastLogs=this.buildRequest({call:m.eth_getLogs}),this.getBlockByHash=this.buildRequest({call:m.eth_getBlockByHash,formatters:[null,b.returnFullTxObjectParam]}),this.getBlockByNumber=this.buildRequest({call:m.eth_getBlockByNumber,formatters:[b.blockNumberToHex,b.returnFullTxObjectParam]}),this.getTransactionByHash=this.buildRequest({call:m.eth_getTransactionByHash}),this.getTransactionReceipt=this.buildRequest({call:m.eth_getTransactionReceipt}),this.getTransactionCount=this.buildRequest({call:m.eth_getTransactionCount,formatters:[null,b.defaultBlockParam]}),this.getGasPrice=this.buildRequest({call:m.eth_gasPrice}),this.getEstimateGas=n=>this.buildRequest({call:m.eth_estimateGas})([n]),this.setSafeSettings=this.buildRequest({call:m.safe_setSettings})}buildRequest(e){var n=this;const{call:r,formatters:s}=e;return function(){var i=(0,l.Z)(function*(o){s&&Array.isArray(o)&&s.forEach((f,h)=>{f&&(o[h]=f(o[h]))});const a={call:r,params:o||[]};return(yield n.communicator.send(d.rpcCall,a)).data});return function(o){return i.apply(this,arguments)}}()}}function x(t){return"string"==typeof t[0]?Y(t):function Ne(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}(t)}function Y(t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function N(t,{includeName:e=!1}={}){if("function"!==t.type&&"event"!==t.type&&"error"!==t.type)throw new Ge(t.type);return`${t.name}(${J(t.inputs,{includeName:e})})`}function J(t,{includeName:e=!1}={}){return t?t.map(n=>function He(t,{includeName:e}){return t.type.startsWith("tuple")?`(${J(t.components,{includeName:e})})${t.type.slice(5)}`:t.type+(e&&t.name?` ${t.name}`:"")}(n,{includeName:e})).join(e?", ":","):""}function B(t,{strict:e=!0}={}){return!(!t||"string"!=typeof t)&&(e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x"))}function p(t){return B(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const X="2.23.6";let D={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${X}`};class c extends Error{constructor(e,n={}){const r=n.cause instanceof c?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof c&&n.cause.docsPath||n.docsPath,i=D.getDocsUrl?.({...n,docsPath:s});super([e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...D.version?[`Version: ${D.version}`]:[]].join("\n"),n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=X}walk(e){return Q(this,e)}}function Q(t,e){return e?.(t)?t:t&&"object"==typeof t&&"cause"in t&&void 0!==t.cause?Q(t.cause,e):e?null:t}class Fe extends c{constructor({expectedLength:e,givenLength:n,type:r}){super([`ABI encoding array length mismatch for type ${r}.`,`Expected length: ${e}`,`Given length: ${n}`].join("\n"),{name:"AbiEncodingArrayLengthMismatchError"})}}class Re extends c{constructor({expectedSize:e,value:n}){super(`Size of bytes "${n}" (bytes${p(n)}) does not match expected size (bytes${e}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class Le extends c{constructor({expectedLength:e,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${e}`,`Given length (values): ${n}`].join("\n"),{name:"AbiEncodingLengthMismatchError"})}}class ee extends c{constructor(e,{docsPath:n}={}){super([`Function ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join("\n"),{docsPath:n,name:"AbiFunctionNotFoundError"})}}class qe extends c{constructor(e,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${e.type}\` in \`${N(e.abiItem)}\`, and`,`\`${n.type}\` in \`${N(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}class Ve extends c{constructor({expectedSize:e,givenSize:n}){super(`Expected bytes${e}, got bytes${n}.`,{name:"BytesSizeMismatchError"})}}class Ze extends c{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid encoding type.`,"Please provide a valid ABI type."].join("\n"),{docsPath:n,name:"InvalidAbiEncodingType"})}}class Ue extends c{constructor(e){super([`Value "${e}" is not a valid array.`].join("\n"),{name:"InvalidArrayError"})}}class Ge extends c{constructor(e){super([`"${e}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join("\n"),{name:"InvalidDefinitionTypeError"})}}class te extends c{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}class ne extends c{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${8*s}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class We extends c{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}class re extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&void 0!==n&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}class se extends c{constructor({offset:e,position:n,size:r}){super(`Slice ${"start"===n?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}}class ie extends c{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function S(t,{dir:e,size:n=32}={}){return"string"==typeof t?w(t,{dir:e,size:n}):function Ke(t,{dir:e,size:n=32}={}){if(null===n)return t;if(t.length>n)throw new ie({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i="right"===e;r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}(t,{dir:e,size:n})}function w(t,{dir:e,size:n=32}={}){if(null===n)return t;const r=t.replace("0x","");if(r.length>2*n)throw new ie({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r["right"===e?"padEnd":"padStart"](2*n,"0")}`}function A(t,{size:e}){if(p(t)>e)throw new We({givenSize:p(t),maxSize:e})}const Qe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function H(t,e={}){return"number"==typeof t||"bigint"==typeof t?v(t,e):"string"==typeof t?_(t,e):"boolean"==typeof t?ae(t,e):F(t,e)}function ae(t,e={}){const n=`0x${Number(t)}`;return"number"==typeof e.size?(A(n,{size:e.size}),S(n,{size:e.size})):n}function F(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=Qe[t[s]];const r=`0x${n}`;return"number"==typeof e.size?(A(r,{size:e.size}),S(r,{dir:"right",size:e.size})):r}function v(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?i=n?(1n<<8n*BigInt(r)-1n)-1n:2n**(8n*BigInt(r))-1n:"number"==typeof t&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o="bigint"==typeof i&&n?-i-1n:0;if(i&&s>i||s<o){const u="bigint"==typeof t?"n":"";throw new ne({max:i?`${i}${u}`:void 0,min:`${o}${u}`,signed:n,size:r,value:`${t}${u}`})}const a=`0x${(n&&s<0?(1n<<BigInt(8*r))+BigInt(s):s).toString(16)}`;return r?S(a,{size:r}):a}const et=new TextEncoder;function _(t,e={}){return F(et.encode(t),e)}const tt=new TextEncoder;function ce(t,e={}){return"number"==typeof t||"bigint"==typeof t?function rt(t,e){const n=v(t,e);return le(n)}(t,e):"boolean"==typeof t?function nt(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),"number"==typeof e.size?(A(n,{size:e.size}),S(n,{size:e.size})):n}(t,e):B(t)?le(t,e):de(t,e)}const E={zero:48,nine:57,A:65,F:70,a:97,f:102};function ue(t){return t>=E.zero&&t<=E.nine?t-E.zero:t>=E.A&&t<=E.F?t-(E.A-10):t>=E.a&&t<=E.f?t-(E.a-10):void 0}function le(t,e={}){let n=t;e.size&&(A(n,{size:e.size}),n=S(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const u=ue(r.charCodeAt(a++)),f=ue(r.charCodeAt(a++));if(void 0===u||void 0===f)throw new c(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=16*u+f}return i}function de(t,e={}){const n=tt.encode(t);return"number"==typeof e.size?(A(n,{size:e.size}),S(n,{dir:"right",size:e.size})):n}var st=$(65846);function y(t,e){const n=e||"hex",r=(0,st.fr)(B(t,{strict:!1})?ce(t):t);return"bytes"===n?r:H(r)}const R=new re(8192);function fe(t,e){if(R.has(`${t}.${e}`))return R.get(`${t}.${e}`);const n=e?`${e}${t.toLowerCase()}`:t.substring(2).toLowerCase(),r=y(de(n),"bytes"),s=(e?n.substring(`${e}0x`.length):n).split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(15&r[o>>1])>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return R.set(`${t}.${e}`,i),i}const it=/^0x[a-fA-F0-9]{40}$/,L=new re(8192);function T(t,e){const{strict:n=!0}=e??{},r=`${t}.${n}`;if(L.has(r))return L.get(r);const s=!(!it.test(t)||t.toLowerCase()!==t&&n&&fe(t)!==t);return L.set(r,s),s}function he(t,e,n,{strict:r}={}){return B(t,{strict:!1})?function at(t,e,n,{strict:r}={}){me(t,e);const s=`0x${t.replace("0x","").slice(2*(e??0),2*(n??t.length))}`;return r&&ge(s,e,n),s}(t,e,n,{strict:r}):function ot(t,e,n,{strict:r}={}){me(t,e);const s=t.slice(e,n);return r&&ge(s,e,n),s}(t,e,n,{strict:r})}function me(t,e){if("number"==typeof e&&e>0&&e>p(t)-1)throw new se({offset:e,position:"start",size:p(t)})}function ge(t,e,n){if("number"==typeof e&&"number"==typeof n&&p(t)!==n-e)throw new se({offset:n,position:"end",size:p(t)})}const ct=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,pe=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function q(t,e){if(t.length!==e.length)throw new Le({expectedLength:t.length,givenLength:e.length});const n=function ut({params:t,values:e}){const n=[];for(let r=0;r<t.length;r++)n.push(V({param:t[r],value:e[r]}));return n}({params:t,values:e}),r=Z(n);return 0===r.length?"0x":r}function V({param:t,value:e}){const n=function yt(t){const e=t.match(/^(.*)\[(\d+)?\]$/);return e?[e[2]?Number(e[2]):null,e[1]]:void 0}(t.type);if(n){const[r,s]=n;return function dt(t,{length:e,param:n}){const r=null===e;if(!Array.isArray(t))throw new Ue(t);if(!r&&t.length!==e)throw new Fe({expectedLength:e,givenLength:t.length,type:`${n.type}[${e}]`});let s=!1;const i=[];for(let o=0;o<t.length;o++){const a=V({param:n,value:t[o]});a.dynamic&&(s=!0),i.push(a)}if(r||s){const o=Z(i);if(r){const a=v(i.length,{size:32});return{dynamic:!0,encoded:i.length>0?x([a,o]):a}}if(s)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:x(i.map(({encoded:o})=>o))}}(e,{length:r,param:{...t,type:s}})}if("tuple"===t.type)return function pt(t,{param:e}){let n=!1;const r=[];for(let s=0;s<e.components.length;s++){const i=e.components[s],a=V({param:i,value:t[Array.isArray(t)?s:i.name]});r.push(a),a.dynamic&&(n=!0)}return{dynamic:n,encoded:n?Z(r):x(r.map(({encoded:s})=>s))}}(e,{param:t});if("address"===t.type)return function lt(t){if(!T(t))throw new te({address:t});return{dynamic:!1,encoded:w(t.toLowerCase())}}(e);if("bool"===t.type)return function ht(t){if("boolean"!=typeof t)throw new c(`Invalid boolean value: "${t}" (type: ${typeof t}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:w(ae(t))}}(e);if(t.type.startsWith("uint")||t.type.startsWith("int")){const r=t.type.startsWith("int"),[,,s="256"]=pe.exec(t.type)??[];return function mt(t,{signed:e,size:n=256}){if("number"==typeof n){const r=2n**(BigInt(n)-(e?1n:0n))-1n,s=e?-r-1n:0n;if(t>r||t<s)throw new ne({max:r.toString(),min:s.toString(),signed:e,size:n/8,value:t.toString()})}return{dynamic:!1,encoded:v(t,{size:32,signed:e})}}(e,{signed:r,size:Number(s)})}if(t.type.startsWith("bytes"))return function ft(t,{param:e}){const[,n]=e.type.split("bytes"),r=p(t);if(!n){let s=t;return r%32!=0&&(s=w(s,{dir:"right",size:32*Math.ceil((t.length-2)/2/32)})),{dynamic:!0,encoded:x([w(v(r,{size:32})),s])}}if(r!==Number.parseInt(n))throw new Re({expectedSize:Number.parseInt(n),value:t});return{dynamic:!1,encoded:w(t,{dir:"right"})}}(e,{param:t});if("string"===t.type)return function gt(t){const e=_(t),n=Math.ceil(p(e)/32),r=[];for(let s=0;s<n;s++)r.push(w(he(e,32*s,32*(s+1)),{dir:"right"}));return{dynamic:!0,encoded:x([w(v(p(e),{size:32})),...r])}}(e);throw new Ze(t.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function Z(t){let e=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];e+=o?32:p(a)}const n=[],r=[];let s=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?(n.push(v(e+s,{size:32})),r.push(a),s+=p(a)):n.push(a)}return x([...n,...r])}const bt=t=>y(ce(t));var xt=$(72537);const At=t=>function wt(t){let e=!0,n="",r=0,s="",i=!1;for(let o=0;o<t.length;o++){const a=t[o];if(["(",")",","].includes(a)&&(e=!0),"("===a&&r++,")"===a&&r--,e){if(0===r){if(" "===a&&["event","function",""].includes(s))s="";else if(s+=a,")"===a){i=!0;break}continue}if(" "===a){","!==t[o-1]&&","!==n&&",("!==n&&(n="",e=!1);continue}s+=a,n+=a}}if(!i)throw new c("Unable to normalize signature.");return s}("string"==typeof t?t:(0,xt.t)(t));function ye(t){return function Et(t){return bt(t)}(At(t))}const be=t=>he(ye(t),0,4),vt=ye;function U(t,e){const n=typeof t,r=e.type;switch(r){case"address":return T(t,{strict:!1});case"bool":return"boolean"===n;case"function":case"string":return"string"===n;default:return"tuple"===r&&"components"in e?Object.values(e.components).every((s,i)=>U(Object.values(t)[i],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?"number"===n||"bigint"===n:/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?"string"===n||t instanceof Uint8Array:!!/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)&&(Array.isArray(t)&&t.every(s=>U(s,{...e,type:r.replace(/(\[[0-9]{0,}\])$/,"")})))}}function Ee(t,e,n){for(const r in t){const s=t[r],i=e[r];if("tuple"===s.type&&"tuple"===i.type&&"components"in s&&"components"in i)return Ee(s.components,i.components,n[r]);const o=[s.type,i.type];if(o.includes("address")&&o.includes("bytes20")||(o.includes("address")&&o.includes("string")||o.includes("address")&&o.includes("bytes"))&&T(n[r],{strict:!1}))return o}}const xe="/docs/contract/encodeFunctionData";function St(t){const{abi:e,args:n,functionName:r}=t;let s=e[0];if(r){const i=function $t(t){const{abi:e,args:n=[],name:r}=t,s=B(r,{strict:!1}),i=e.filter(a=>s?"function"===a.type?be(a)===r:"event"===a.type&&vt(a)===r:"name"in a&&a.name===r);if(0===i.length)return;if(1===i.length)return i[0];let o;for(const a of i)if("inputs"in a)if(n&&0!==n.length){if(a.inputs&&0!==a.inputs.length&&a.inputs.length===n.length&&n.every((f,h)=>{const g="inputs"in a&&a.inputs[h];return!!g&&U(f,g)})){if(o&&"inputs"in o&&o.inputs){const f=Ee(a.inputs,o.inputs,n);if(f)throw new qe({abiItem:a,type:f[0]},{abiItem:o,type:f[1]})}o=a}}else if(!a.inputs||0===a.inputs.length)return a;return o||i[0]}({abi:e,args:n,name:r});if(!i)throw new ee(r,{docsPath:xe});s=i}if("function"!==s.type)throw new ee(void 0,{docsPath:xe});return{abi:[s],functionName:be(N(s))}}function we(t){const{args:e}=t,{abi:n,functionName:r}=1===t.abi.length&&t.functionName?.startsWith("0x")?t:St(t),s=n[0];return Y([r,("inputs"in s&&s.inputs?q(s.inputs,e??[]):void 0)??"0x"])}const It="\x19Ethereum Signed Message:\n";function Tt(t,e){return y(function Bt(t){const e="string"==typeof t?_(t):"string"==typeof t.raw?t.raw:F(t.raw);return x([_(`${It}${p(e)}`),e])}(t),e)}class zt extends c{constructor({domain:e}){super(`Invalid domain "${((t,e,n)=>JSON.stringify(t,(r,s)=>{const i="bigint"==typeof s?s.toString():s;return"function"==typeof e?e(r,i):i},n))(e)}".`,{metaMessages:["Must be a valid EIP-712 domain."]})}}class Ct extends c{constructor({primaryType:e,types:n}){super(`Invalid primary type \`${e}\` must be one of \`${JSON.stringify(Object.keys(n))}\`.`,{docsPath:"/api/glossary/Errors#typeddatainvalidprimarytypeerror",metaMessages:["Check that the primary type is a key in `types`."]})}}class Mt extends c{constructor({type:e}){super(`Struct type "${e}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."],name:"InvalidStructTypeError"})}}function Ae({domain:t}){return["string"==typeof t?.name&&{name:"name",type:"string"},t?.version&&{name:"version",type:"string"},("number"==typeof t?.chainId||"bigint"==typeof t?.chainId)&&{name:"chainId",type:"uint256"},t?.verifyingContract&&{name:"verifyingContract",type:"address"},t?.salt&&{name:"salt",type:"bytes32"}].filter(Boolean)}function Dt(t){if("address"===t||"bool"===t||"string"===t||t.startsWith("bytes")||t.startsWith("uint")||t.startsWith("int"))throw new Mt({type:t})}function _t(t){const{domain:e={},message:n,primaryType:r}=t,s={EIP712Domain:Ae({domain:e}),...t.types};!function kt(t){const{domain:e,message:n,primaryType:r,types:s}=t,i=(o,a)=>{for(const u of o){const{name:f,type:h}=u,g=a[f],z=h.match(pe);if(z&&("number"==typeof g||"bigint"==typeof g)){const[Zt,C,Ut]=z;v(g,{signed:"int"===C,size:Number.parseInt(Ut)/8})}if("address"===h&&"string"==typeof g&&!T(g))throw new te({address:g});const j=h.match(ct);if(j){const[Zt,C]=j;if(C&&p(g)!==Number.parseInt(C))throw new Ve({expectedSize:Number.parseInt(C),givenSize:p(g)})}const ze=s[h];ze&&(Dt(h),i(ze,g))}};if(s.EIP712Domain&&e){if("object"!=typeof e)throw new zt({domain:e});i(s.EIP712Domain,e)}if("EIP712Domain"!==r){if(!s[r])throw new Ct({primaryType:r,types:s});i(s[r],n)}}({domain:e,message:n,primaryType:r,types:s});const i=["0x1901"];return e&&i.push(function jt({domain:t,types:e}){return ve({data:t,primaryType:"EIP712Domain",types:e})}({domain:e,types:s})),"EIP712Domain"!==r&&i.push(ve({data:n,primaryType:r,types:s})),y(x(i))}function ve({data:t,primaryType:e,types:n}){return y($e({data:t,primaryType:e,types:n}))}function $e({data:t,primaryType:e,types:n}){const r=[{type:"bytes32"}],s=[Ot({primaryType:e,types:n})];for(const i of n[e]){const[o,a]=Ie({types:n,name:i.name,type:i.type,value:t[i.name]});r.push(o),s.push(a)}return q(r,s)}function Ot({primaryType:t,types:e}){const n=H(function Nt({primaryType:t,types:e}){let n="";const r=Se({primaryType:t,types:e});r.delete(t);const s=[t,...Array.from(r).sort()];for(const i of s)n+=`${i}(${e[i].map(({name:o,type:a})=>`${a} ${o}`).join(",")})`;return n}({primaryType:t,types:e}));return y(n)}function Se({primaryType:t,types:e},n=new Set){const s=t.match(/^\w*/u)?.[0];if(n.has(s)||void 0===e[s])return n;n.add(s);for(const i of e[s])Se({primaryType:i.type,types:e},n);return n}function Ie({types:t,name:e,type:n,value:r}){if(void 0!==t[n])return[{type:"bytes32"},y($e({data:r,primaryType:n,types:t}))];if("bytes"===n)return[{type:"bytes32"},y(r="0x"+((r.length%2?"0":"")+r.slice(2)))];if("string"===n)return[{type:"bytes32"},y(H(r))];if(n.lastIndexOf("]")===n.length-1){const s=n.slice(0,n.lastIndexOf("[")),i=r.map(o=>Ie({name:e,type:s,types:t,value:o}));return[{type:"bytes32"},y(q(i.map(([o])=>o),i.map(([,o])=>o)))]}return[{type:n},r]}const G=4001;class P extends Error{constructor(e,n,r){super(e),this.code=n,this.data=r,Object.setPrototypeOf(this,P.prototype)}}class Be{constructor(e){this.communicator=e}getPermissions(){var e=this;return(0,l.Z)(function*(){return(yield e.communicator.send(d.wallet_getPermissions,void 0)).data})()}requestPermissions(e){var n=this;return(0,l.Z)(function*(){if(!n.isPermissionRequestValid(e))throw new P("Permissions request is invalid",G);try{return(yield n.communicator.send(d.wallet_requestPermissions,e)).data}catch{throw new P("Permissions rejected",G)}})()}isPermissionRequestValid(e){return e.every(n=>"object"==typeof n&&Object.keys(n).every(r=>!!Object.values(M).includes(r)))}}const Te=(t,e)=>e.some(n=>n.parentCapability===t);class Pe{constructor(e){this.communicator=e}getChainInfo(){var e=this;return(0,l.Z)(function*(){return(yield e.communicator.send(d.getChainInfo,void 0)).data})()}getInfo(){var e=this;return(0,l.Z)(function*(){return(yield e.communicator.send(d.getSafeInfo,void 0)).data})()}experimental_getBalances({currency:e="usd"}={}){var n=this;return(0,l.Z)(function*(){return(yield n.communicator.send(d.getSafeBalances,{currency:e})).data})()}check1271Signature(e,n="0x"){var r=this;return(0,l.Z)(function*(){const s=yield r.getInfo(),i=we({abi:[{constant:!1,inputs:[{name:"_dataHash",type:"bytes32"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[e,n]}),o={call:m.eth_call,params:[{to:s.safeAddress,data:i},"latest"]};try{return"0x1626ba7e"===(yield r.communicator.send(d.rpcCall,o)).data.slice(0,10).toLowerCase()}catch{return!1}})()}check1271SignatureBytes(e,n="0x"){var r=this;return(0,l.Z)(function*(){const s=yield r.getInfo(),i=we({abi:[{constant:!1,inputs:[{name:"_data",type:"bytes"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[e,n]}),o={call:m.eth_call,params:[{to:s.safeAddress,data:i},"latest"]};try{return"0x20c13b0b"===(yield r.communicator.send(d.rpcCall,o)).data.slice(0,10).toLowerCase()}catch{return!1}})()}calculateMessageHash(e){return Tt(e)}calculateTypedMessageHash(e){const n="object"==typeof e.domain.chainId?e.domain.chainId.toNumber():Number(e.domain.chainId);let r=e.primaryType;if(!r){const s=Object.values(e.types),i=Object.keys(e.types).filter(o=>s.every(a=>a.every(({type:u})=>u.replace("[","").replace("]","")!==o)));if(0===i.length||i.length>1)throw new Error("Please specify primaryType");r=i[0]}return _t({message:e.message,domain:{...e.domain,chainId:n,verifyingContract:e.domain.verifyingContract,salt:e.domain.salt},types:e.types,primaryType:r})}getOffChainSignature(e){var n=this;return(0,l.Z)(function*(){return(yield n.communicator.send(d.getOffChainSignature,e)).data})()}isMessageSigned(e,n="0x"){var r=this;return(0,l.Z)(function*(){let s;if("string"==typeof e&&(s=function(){var i=(0,l.Z)(function*(){const o=r.calculateMessageHash(e);return yield r.isMessageHashSigned(o,n)});return function(){return i.apply(this,arguments)}}()),O(e)&&(s=function(){var i=(0,l.Z)(function*(){const o=r.calculateTypedMessageHash(e);return yield r.isMessageHashSigned(o,n)});return function(){return i.apply(this,arguments)}}()),s)return yield s();throw new Error("Invalid message type")})()}isMessageHashSigned(e,n="0x"){var r=this;return(0,l.Z)(function*(){const s=[r.check1271Signature.bind(r),r.check1271SignatureBytes.bind(r)];for(const i of s)if(yield i(e,n))return!0;return!1})()}getEnvironmentInfo(){var e=this;return(0,l.Z)(function*(){return(yield e.communicator.send(d.getEnvironmentInfo,void 0)).data})()}requestAddressBook(){var e=this;return(0,l.Z)(function*(){return(yield e.communicator.send(d.requestAddressBook,void 0)).data})()}}!function(t,e,n,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);s>3&&i&&Object.defineProperty(e,n,i)}([(t,e,n)=>{const r=n.value;return n.value=(0,l.Z)(function*(){const s=new Be(this.communicator);let i=yield s.getPermissions();if(Te(e,i)||(i=yield s.requestPermissions([{[e]:{}}])),!Te(e,i))throw new P("Permissions rejected",G);return r.apply(this)}),n}],Pe.prototype,"requestAddressBook",null);const Vt=class qt{constructor(e={}){const{allowedDomains:n=null,debug:r=!1}=e;this.communicator=new _e(n,r),this.eth=new Oe(this.communicator),this.txs=new je(this.communicator),this.safe=new Pe(this.communicator),this.wallet=new Be(this.communicator)}}}}]);