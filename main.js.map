{"version":3,"file":"main.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;CAEA;AACA;;AACA;AAEA;;;;;;;ICbEW,wDAAAA;;;;;IAEEA,yDAAAA,8BAAqB,UAArB,EAAqBC,eAArB,EAAqB,WAArB,EAAqBA,gBAArB,EAAqB,OAArB,EAAqBA,YAArB;;;;ADyBE,MAAOC,YAAP,CAAmB;EALzBC;IASE,gBAAgC,EAAhC;EAsDD;;EApDOC,QAAQ;IAAA;;IAAA;MACZ,MAAM,KAAI,CAACC,UAAL,GAAkBC,KAAlB,CAAyBC,GAAD,IAAQ;QACpCC,OAAO,CAACC,KAAR,CAAcF,GAAd;QACAG,KAAK,CAAC,sCAAD,CAAL;MACD,CAHK,CAAN;IADY;EAKb;;EAEKL,UAAU;IAAA;;IAAA;;;MACd,MAAMM,SAAS,SAAStB,+EAAmB,CAAC;QAC1CuB,OAAO,EAAE,SADiC;QAE1CC,KAAK,EAAE,IAFmC;QAG1CC,OAAO,EAAE,CACP,UAAUxB,0FAAmB,EAA7B,CADO,EAEPC,kFAAe,EAFR,EAGPC,yEAAW,EAHJ,EAIPC,kFAAe,EAJR,EAKPC,2EAAY,EALL,EAMPC,sFAAiB,EANV,EAOPE,wFAAkB,CAAC;UACjBkB,SAAS,EAAE,YADM;UAEjBC,QAAQ,EAAE;YACRC,IAAI,EAAE,sBADE;YAERC,WAAW,EAAE,2CAFL;YAGRC,GAAG,EAAE,yCAHG;YAIRC,KAAK,EAAE,CAAC,kDAAD;UAJC;QAFO,CAAD,CAPX,EAgBPxB,0FAAmB,CAAC;UAClBuB,GAAG,EAAE,6BADa;UAElBE,WAAW,EAAE;YACXC,cAAc,EAAE,EADL;YAEXC,WAAW,EAAE,sBAFF;YAGXL,WAAW,EAAE,2CAHF;YAIXM,IAAI,EAAE;UAJK;QAFK,CAAD,CAhBZ;MAHiC,CAAD,CAA3C;;MA+BA,MAAMC,MAAM,GAAG3B,8EAAU,CAACa,SAAD,EAAY;QAAEe,UAAU,EAAE3B,oDAAWA;MAAzB,CAAZ,CAAzB;;MACA,MAAM4B,KAAK,GAAGhB,SAAS,CAACiB,KAAV,CAAgBC,QAAhB,EAAd;;MAEA,MAAI,CAACC,QAAL,GAAgBH,KAAK,CAACG,QAAtB;MACA,MAAI,CAACC,SAAL,GACE,YAAK,CAACD,QAAN,CAAeE,IAAf,CAAqBC,OAAD,IAAaA,OAAO,CAACC,MAAzC,OAAgD,IAAhD,IAAgDC,aAAhD,GAAgD,MAAhD,GAAgDA,GAAEJ,SAAlD,KAA+D,IADjE;MAGAK,MAAM,CAACC,QAAP,GAAkB1B,SAAlB;MACAyB,MAAM,CAACE,KAAP,GAAeb,MAAf;MAEA,MAAI,CAACY,QAAL,GAAgB1B,SAAhB;MACA,MAAI,CAAC2B,KAAL,GAAab,MAAb;IA3Cc;EA4Cf;;AAzDsB;;;mBAAZvB;AAAY;;;QAAZA;EAAYqC;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MC7BzB3C,6DAAAA,YAAM,CAAN,EAAM,IAAN;MACMA,qDAAAA;MAAeA,2DAAAA;MACnBA,yDAAAA;MAQFA,2DAAAA;;;;MAPKA,wDAAAA;MAAAA,yDAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACFqD;AACb;AAEE;AAC0B;AACI;AACZ;AACS;;AAcnE,MAAM,SAAS;;kEAAT,SAAS;sGAAT,SAAS,cAFR,wDAAY;0GAFd,oEAAa,EAAE,uDAAW;mIAIzB,SAAS,mBAVlB,wDAAY;QACZ,kFAAe;QACf,sFAAiB;QACjB,0EAAa;QACb,mFAAgB,aAER,oEAAa,EAAE,uDAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjBtC;AAUA;AAEA;;;;;;;;;;;ICRIA,4DAAAA;IAAoCA,wDAAAA;MAAAA,2DAAAA;MAAA;MAAA,OAASA,yDAAAA,wBAAT;IAAwB,CAAxB;IAClCA,oDAAAA;IACFA,0DAAAA;;;;;;IAMFA,uDAAAA;;;;;IAEEA,wDAAAA;;;;;;;;IAfJA,qEAAAA;IACEA,4DAAAA,WAAK,CAAL,EAAK,QAAL,EAAK,CAAL;IACUA,wDAAAA;MAAAA,2DAAAA;MAAA;MAAA,OAASA,yDAAAA,kBAAT;IAAkB,CAAlB;IAAoBA,oDAAAA;IAAOA,0DAAAA;IACnCA,4DAAAA;IAAQA,wDAAAA;MAAAA,2DAAAA;MAAA;MAAA,OAASA,yDAAAA,uBAAT;IAAuB,CAAvB;IAAyBA,oDAAAA;IAAaA,0DAAAA;IAC9CA,4DAAAA;IAAQA,wDAAAA;MAAAA,2DAAAA;MAAA;MAAA,OAASA,yDAAAA,wBAAT;IAAwB,CAAxB;IAA0BA,oDAAAA;IAAYA,0DAAAA;IAC9CA,wDAAAA;IAGFA,0DAAAA;IACAA,4DAAAA;IAEEA,wDAAAA;MAAAA,2DAAAA;MAAA;MAAA,OAAcA,yDAAAA,0BAAd;IAA8B,CAA9B;IACDA,0DAAAA;IACDA,wDAAAA;IAIFA,mEAAAA;;;;;IAZaA,uDAAAA;IAAAA,wDAAAA;IAKTA,uDAAAA;IAAAA,wDAAAA;IAICA,uDAAAA;IAAAA,wDAAAA;;;;;;;;IAKLA,qEAAAA;IACEA,4DAAAA;IAAQA,wDAAAA;MAAAA,2DAAAA;MAAA;MAAA,OAASA,yDAAAA,kBAAT;IAAiB,CAAjB;IAAmBA,oDAAAA;IAAMA,0DAAAA;IACjCA,uDAAAA;IACFA,mEAAAA;;;;ADNA,MAAMgD,kBAAkB,GAAG,GAA3B,EACA;;AACA,MAAMC,eAAe,GAAGJ,qEAAA,CAA6B,eAA7B,CAAxB;AAOM,MAAOO,gBAAP,CAAuB;EAUrBhD,QAAQ;IAAA;;IAAA;MACZ,MAAM,CAACiD,QAAD,EAAWpB,OAAX,UAA4BqB,OAAO,CAACC,GAAR,CAAY,CAC5C,KAAI,CAACC,WAAL,EAD4C,EAE5C,KAAI,CAACC,UAAL,EAF4C,CAAZ,CAAlC;MAKA,KAAI,CAACxB,OAAL,GAAeA,OAAf;MACA,KAAI,CAACoB,QAAL,GAAgBA,QAAhB;;MAEA,KAAI,CAACK,iBAAL;IATY;EAUb;;EAEKD,UAAU;IAAA;;IAAA;MACd,IAAI,CAAC,MAAI,CAAC1B,SAAV,EAAqB;QACnB,OAAO,IAAP;MACD;;MAED,MAAM;QAAEnB;MAAF,IAAc,MAAI,CAACyB,QAAL,CAAcsB,OAAlC;MACA,MAAMC,QAAQ,GAAG,IAAIhB,kEAAJ,CAA8B;QAAEzB,GAAG,EAAEP,OAAO,CAACkD;MAAf,CAA9B,CAAjB;MAEA,OAAOF,QAAQ,CACZG,KADI,CACe;QAClBC,YAAY,EAAE,cADI;QAElBC,QAAQ,EAAE,OAFQ;QAGlBC,UAAU,EAAE,MAAI,CAACnC;MAHC,CADf,EAMJoC,IANI,CAMEC,IAAD,IAAUC,gCACXD,IADW,GACP;QACPF,UAAU,EAAE,MAAI,CAACnC;MADV,CADO,CANX,CAAP;IARc;EAkBf;;EAEDuC,MAAM;IACJ,KAAKhC,KAAL,CAAWiC,IAAX;EACD;;EAEKC,OAAO;IAAA;;IAAA;MACX,MAAMC,MAAM,SAAS,MAAI,CAACpC,QAAL,CAAcoC,MAAd,EAArB;MAEAA,MAAM,CAACD,OAAP,GAAiBlE,KAAjB,CAAwBC,GAAD,IAAQ;QAC7BC,OAAO,CAACkE,GAAR,CAAY,oBAAZ;QACAlE,OAAO,CAACC,KAAR,CAAcF,GAAd;MACD,CAHD;IAHW;EAOZ;;EAEDoE,YAAY;IACV,KAAKrC,KAAL,CAAWiC,IAAX;EACD;;EAEDf,WAAW;IACT,MAAM;MAAE5C;IAAF,IAAc,KAAKyB,QAAL,CAAcsB,OAAlC;IACA,MAAMC,QAAQ,GAAG,IAAIhB,kEAAJ,CAA8B;MAAEzB,GAAG,EAAEP,OAAO,CAACkD;IAAf,CAA9B,CAAjB;IAEA,OAAOF,QAAQ,CACZG,KADI,CACc;MACjBC,YAAY,EAAE,eADG;MAEjBE,UAAU,EAAEnE,mDAFK;MAGjB6E,WAAW,EAAE,aAHI;MAIjBC,WAAW,EAAE,EAJI;MAKjBZ,QAAQ,EAAE;IALO,CADd,EAQJE,IARI,CAQEW,GAAD,IAASC,IAAI,CAACC,KAAL,CAAWC,MAAM,CAACC,IAAP,CAAYJ,GAAG,CAACK,MAAhB,EAAwBC,QAAxB,EAAX,CARV,CAAP;EASD;;EAEDC,aAAa;IACX,MAAMC,YAAY,GAAG,KAAKxD,QAAL,CAAcyD,SAAd,CAClBC,CAAD,IAAOA,CAAC,CAACzD,SAAF,KAAgB,KAAKA,SADT,CAArB;IAGA,MAAM0D,SAAS,GACbH,YAAY,GAAG,KAAKxD,QAAL,CAAc4D,MAAd,GAAuB,CAAtC,GAA0CJ,YAAY,GAAG,CAAzD,GAA6D,CAD/D;IAGA,MAAMK,aAAa,GAAG,KAAK7D,QAAL,CAAc2D,SAAd,EAAyB1D,SAA/C;IAEA,KAAKM,QAAL,CAAcuD,gBAAd,CAA+BD,aAA/B;IAEAjF,KAAK,CAAC,yBAAyBiF,aAA1B,CAAL;EACD;;EAEKE,aAAa;IAAA;;IAAA;MACjB,MAAMpB,MAAM,SAAS,MAAI,CAACpC,QAAL,CAAcoC,MAAd,EAArB;;MACA,IAAI;QACF,MAAMqB,KAAK,SAASrB,MAAM,CAACsB,WAAP,CAAmB;UACrCC,OAAO,EAAE;QAD4B,CAAnB,CAApB;;QAIA,IAAIF,KAAJ,EAAW;UACTpF,KAAK,CAAC,+BAA+BqE,IAAI,CAACkB,SAAL,CAAeH,KAAf,CAAqB,EAArD,CAAL;QACD;MACF,CARD,CAQE,OAAOvF,GAAP,EAAY;QACZ,MAAMyF,OAAO,GACXzF,GAAG,YAAY2F,KAAf,GAAuB3F,GAAG,CAACyF,OAA3B,GAAqC,sBADvC;QAEAtF,KAAK,CAACsF,OAAD,CAAL;MACD;IAdgB;EAelB;;EAEDtC,iBAAiB;IACf,KAAKyC,YAAL,GAAoB,KAAK9D,QAAL,CAAcT,KAAd,CAAoBwE,UAApB,CACjBC,IADiB,CAEhBtD,yCAAG,CAAEpB,KAAD,IAAWA,KAAK,CAACG,QAAlB,CAFa,EAGhBgB,0DAAoB,EAHJ,EAKjBwD,SALiB,CAKNC,YAAD,IAAiB;;;MAC1B/F,OAAO,CAACkE,GAAR,CAAY,iBAAZ,EAA+B6B,YAA/B;MAEA,KAAKzE,QAAL,GAAgByE,YAAhB;MACA,KAAKxE,SAAL,GACE,mBAAY,CAACC,IAAb,CAAmBC,OAAD,IAAaA,OAAO,CAACC,MAAvC,OAA8C,IAA9C,IAA8CC,aAA9C,GAA8C,MAA9C,GAA8CA,GAAEJ,SAAhD,KAA6D,IAD/D;MAGA,KAAK0B,UAAL,GAAkBU,IAAlB,CAAwBlC,OAAD,IAAY;QACjC,KAAKA,OAAL,GAAeA,OAAf;MACD,CAFD;IAGD,CAfiB,CAApB;EAgBD;;EAEKuE,WAAW,CAACR,OAAD,EAAkBS,QAAlB,EAAoCC,QAApC,EAAqD;IAAA;;IAAA;MACpE,MAAM;QAAEC;MAAF,IAAe,MAAI,CAACtE,QAAL,CAAcT,KAAd,CAAoBC,QAApB,EAArB;;MACA,MAAM4C,MAAM,SAAS,MAAI,CAACpC,QAAL,CAAcoC,MAAd,EAArB;;MAEA,IAAI,CAACiC,QAAL,EAAe;QACb,OAAOjC,MAAM,CACVmC,sBADI,CACmB;UACtB;UACAC,QAAQ,EAAE,MAAI,CAAC9E,SAFO;UAGtB+E,OAAO,EAAE,CACP;YACEC,IAAI,EAAE,cADR;YAEEC,MAAM,EAAE;cACNC,UAAU,EAAE,YADN;cAENC,IAAI,EAAE;gBAAEC,IAAI,EAAEnB;cAAR,CAFA;cAGNoB,GAAG,EAAEnE,eAHC;cAIN;cACAoE,OAAO,EAAExE,qEAAA,CAA6B4D,QAA7B;YALH;UAFV,CADO;QAHa,CADnB,EAiBJnG,KAjBI,CAiBGC,GAAD,IAAQ;UACbG,KAAK,CAAC,uBAAD,CAAL;UACAF,OAAO,CAACkE,GAAR,CAAY,uBAAZ;UAEA,MAAMnE,GAAN;QACD,CAtBI,CAAP;MAuBD;;MAED,MAAM+G,YAAY,GAAuB,EAAzC;;MAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,IAAI,CAA5B,EAA+B;QAC7BD,YAAY,CAACE,IAAb,CAAkB;UAChB;UACAX,QAAQ,EAAE,MAAI,CAAC9E,SAFC;UAGhB;UACA0F,UAAU,EAAEd,QAAS,CAACjF,UAJN;UAKhBoF,OAAO,EAAE,CACP;YACEC,IAAI,EAAE,cADR;YAEEC,MAAM,EAAE;cACNC,UAAU,EAAE,YADN;cAENC,IAAI,EAAE;gBACJC,IAAI,EAAE,GAAGnB,OAAO,KAAKuB,CAAC,GAAG,CAAC;cADtB,CAFA;cAKNH,GAAG,EAAEnE,eALC;cAMN;cACAoE,OAAO,EAAExE,qEAAA,CAA6B4D,QAA7B;YAPH;UAFV,CADO;QALO,CAAlB;MAoBD;;MAED,OAAOhC,MAAM,CAACiD,uBAAP,CAA+B;QAAEJ;MAAF,CAA/B,EAAiDhH,KAAjD,CAAwDC,GAAD,IAAQ;QACpEG,KAAK,CAAC,wBAAD,CAAL;QACAF,OAAO,CAACkE,GAAR,CAAY,wBAAZ;QAEA,MAAMnE,GAAN;MACD,CALM,CAAP;IAvDoE;EA6DrE;;EAEKoH,QAAQ,CAACC,CAAD,EAAa;IAAA;;IAAA;MACzB,MAAM;QAAEC,QAAF;QAAY7B,OAAZ;QAAqBS,QAArB;QAA+BC;MAA/B,IAA4CkB,CAAC,CAACE,MAAF,CAASC,QAA3D;MAEAF,QAAQ,CAACG,QAAT,GAAoB,IAApB;;MAEA,MAAI,CAACxB,WAAL,CAAiBR,OAAO,CAACiC,KAAzB,EAAgCxB,QAAQ,CAACwB,KAAT,IAAkB,GAAlD,EAAuDvB,QAAQ,CAACwB,OAAhE,EACG/D,IADH,CACQ,MAAK;QACT,OAAO,MAAI,CAACX,WAAL,GACJW,IADI,CACEgE,YAAD,IAAiB;UACrB,MAAI,CAAC9E,QAAL,GAAgB8E,YAAhB;UACAnC,OAAO,CAACiC,KAAR,GAAgB,EAAhB;UACAxB,QAAQ,CAACwB,KAAT,GAAiBjF,kBAAjB;UACA6E,QAAQ,CAACG,QAAT,GAAoB,KAApB;UACAhC,OAAO,CAACoC,KAAR;QACD,CAPI,EAQJ9H,KARI,CAQGC,GAAD,IAAQ;UACbG,KAAK,CAAC,4BAAD,CAAL;UACAF,OAAO,CAACkE,GAAR,CAAY,4BAAZ;UACA,MAAMnE,GAAN;QACD,CAZI,CAAP;MAaD,CAfH,EAgBGD,KAhBH,CAgBUC,GAAD,IAAQ;QACbC,OAAO,CAACC,KAAR,CAAcF,GAAd;QAEAsH,QAAQ,CAACG,QAAT,GAAoB,KAApB;MACD,CApBH;IALyB;EA0B1B;;EAEDK,WAAW;;;IACT,WAAKlC,YAAL,MAAiB,IAAjB,IAAiBhE,aAAjB,GAAiB,MAAjB,GAAiBA,GAAEmG,WAAF,EAAjB;EACD;;AAzN0B;;;mBAAhBlF;AAAgB;;;QAAhBA;EAAgBb;EAAAgG;IAAAlG;IAAAC;IAAAR;IAAAC;EAAA;EAAAS;EAAAC;EAAAC;EAAAC;IAAA;MCzB7B3C,wDAAAA;MAmBAA,wDAAAA;;;;MAnBeA,wDAAAA;MAmBAA,uDAAAA;MAAAA,wDAAAA;;;;;;;;;;;;;;;;;;;;;;;ACnBgE;AACtD;;;AAYlB,MAAM,aAAa;IAL1B;QAOY,eAAU,GAA4B,IAAI,uDAAY,EAAE,CAAC;KAYpE;IATC,QAAQ;QACN,IAAI,CAAC,QAAQ,GAAG,kDAAG,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;aACrC,GAAG,CAAC,EAAE,IAAI,EAAE,CAAC;aACb,QAAQ,EAAE,CAAC;IAChB,CAAC;IAED,QAAQ,CAAC,KAAgB;QACvB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC9B,CAAC;;0EAbU,aAAa;2GAAb,aAAa;QCb1B,0EAAoC;QAA9B,+IAAY,oBAAgB,IAAC;QACjC,8EAAwB;QACnB,uDAA8C;QAAA,4DAAI;QACrD,uEAAqB;QACE,mEAAQ;QAAA,4DAAQ;QACrC,sEAA4D;QAC9D,4DAAI;QACJ,oEAAG;QACqB,gFAAoB;QAAA,4DAAQ;QAClD,uEAQE;QACF,2EAA0B;QAAA,kEAAC;QAAA,4DAAO;QAEpC,qEAAG;QACyB,kFAAsB;QAAA,4DAAQ;QACxD,uEAAuC;QACzC,4DAAI;QACJ,8EAAsB;QAAA,gEAAI;QAAA,4DAAS;;QAtBhC,0DAA8C;QAA9C,sHAA8C;QAW7C,0DAAoB;QAApB,wFAAoB;QAFpB,6EAAoB;;;;;;;;;;;;;;;;;;;;;;;IET5B,uEAAiF;IACvE,uDAAoB;IAAA,4DAAS;IAAA,4DAAC;IAAA,gEAAM;IAC5C,uDACF;IAAA,4DAAI;;;IAHiC,8JAA2C;IACtE,0DAAoB;IAApB,kFAAoB;IAC5B,0DACF;IADE,4FACF;;ADGO,MAAM,iBAAiB;;kFAAjB,iBAAiB;+GAAjB,iBAAiB;QCR9B,qEAAI;QAAA,mEAAQ;QAAA,4DAAK;QAEjB,yGAGI;;QAHmB,0DAAY;QAAZ,iFAAY;;;;;;;;;;;;;;;;;;;ACK5B,MAAM,eAAe;;8EAAf,eAAe;6GAAf,eAAe;QCP5B,oEAAG;QACD,0ZAKF;QAAA,4DAAI;QACJ,oEAAG;QACD,2KAEF;QAAA,4DAAI;QACJ,oEAAG;QAAA,8FAAmC;QAAA,4DAAI;;;;;;;;;;;;;;;;;ACXnC,MAAM,WAAW,GAAG,oBAAoB,CAAC;;;;;;;;;;;;;;;;ACAhD,gFAAgF;AAChF,mEAAmE;AACnE,gEAAgE;AAEzD,MAAM,WAAW,GAAG;IACzB,UAAU,EAAE,KAAK;CAClB,CAAC;AAEF;;;;;;GAMG;AACH,sEAAsE;;;;;;;;;;;;;;;;;;ACfvB;AAGF;AACY;AAEzD,IAAI,6EAAsB,EAAE;IAC1B,6DAAc,EAAE,CAAC;CAClB;AAED,wEAAwB;KACrB,eAAe,CAAC,sDAAS,CAAC;KAC1B,KAAK,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;ACNsB;AA4DF;;;;;;;;;;;;;;;;;;;;AClEnD,MAAM,YAAY,GAAG,sBAAsB,CAAC;AAE5C,MAAM,QAAQ,GAAG,UAAU,CAAC;AAC5B,MAAM,gBAAgB,GAAG,kBAAkB,CAAC;AAE5C,MAAM,kBAAkB,GAAG,kBAAkB,CAAC;AAC9C,MAAM,0BAA0B,GAAG,0BAA0B,CAAC;;;;;;;;;;;;;;;;ACJ9D,MAAM,gBAAgB,GAAG,CAC9B,KAA0B,EACL,EAAE;IACvB,OAAO,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC;AAClE,CAAC,CAAC;;;;;;;;;;;;;;;;;;;ACNwB;AACS;;;;;;;;;;;;;;;;;;;ACDnC,MAAMwI,IAAI,GAAIC,EAAD,IAAe;EAC1B,OAAO,IAAInF,OAAJ,CAAaoF,OAAD,IAAaC,UAAU,CAACD,OAAD,EAAUD,EAAV,CAAnC,CAAP;AACD,CAFD;;AAIA,MAAMG,IAAI;EAAA,2MAAG,WACXC,EADW,EAEXC,QAFW,EAGXC,SAHW,EAIS;IACpB,MAAM5D,MAAM,GAAG0D,EAAE,EAAjB;;IAEA,IAAI1D,MAAJ,EAAY;MACV,OAAOA,MAAP;IACD;;IAED,IAAI,CAAC4D,SAAL,EAAgB;MACd,MAAM,IAAI7C,KAAJ,CAAU,kBAAV,CAAN;IACD;;IAED,OAAOsC,IAAI,CAACM,QAAD,CAAJ,CAAe3E,IAAf,CAAoB,MAAMyE,IAAI,CAACC,EAAD,EAAKC,QAAL,EAAeC,SAAS,GAAG,CAA3B,CAA9B,CAAP;EACD,CAhBS;;EAAA,gBAAJH,IAAI;IAAA;EAAA;AAAA,GAAV;;AAkBO,MAAMI,OAAO;EAAA,4MAAG,WACrBH,EADqB,EAErBI,OAAgD,EAF3B,EAGnB;IACF,MAAM;MAAEC,OAAO,GAAG,GAAZ;MAAiBJ,QAAQ,GAAG;IAA5B,IAAmCG,IAAzC;IAEA,OAAO3F,OAAO,CAAC6F,IAAR,CAAa,CAClBX,IAAI,CAACU,OAAD,CAAJ,CAAc/E,IAAd,CAAmB,MAAK;MACtB,MAAM,IAAI+B,KAAJ,CAAU,kBAAV,CAAN;IACD,CAFD,CADkB,EAIlB0C,IAAI,CAACC,EAAD,EAAKC,QAAL,EAAeM,IAAI,CAACC,KAAL,CAAWH,OAAO,GAAGJ,QAArB,CAAf,CAJc,CAAb,CAAP;EAMD,CAZmB;;EAAA,gBAAPE,OAAO;IAAA;EAAA;AAAA,GAAb;;;;;;;;;;;;;;;;;;ACpBwC;AAExC,MAAM,gBAAgB,GAAG,CAAC,SAAoB,EAAW,EAAE;IAChE,QAAQ,SAAS,EAAE;QACjB,KAAK,SAAS;YACZ,OAAO;gBACL,SAAS;gBACT,OAAO,EAAE,8BAA8B;gBACvC,SAAS,EAAE,iCAAiC;gBAC5C,WAAW,EAAE,2BAA2B;gBACxC,UAAU,EAAE,2BAA2B;aACxC,CAAC;QACJ,KAAK,SAAS;YACZ,OAAO;gBACL,SAAS;gBACT,OAAO,EAAE,8BAA8B;gBACvC,SAAS,EAAE,iCAAiC;gBAC5C,WAAW,EAAE,mCAAmC;gBAChD,UAAU,EAAE,mCAAmC;aAChD,CAAC;QACJ;YACE,MAAM,KAAK,CAAC,+BAA+B,SAAS,GAAG,CAAC,CAAC;KAC5D;AACH,CAAC,CAAC;AAEK,MAAM,cAAc,GAAG,CAAC,OAA4B,EAAW,EAAE;IACtE,OAAO,OAAO,OAAO,KAAK,QAAQ,CAAC,CAAC,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;AAC3E,CAAC,CAAC;AAEK,MAAM,cAAc,GAAG,CAAC,MAA4B,EAAE,EAAE;IAC7D,MAAM,OAAO,GAAY;QACvB,OAAO,EAAE,cAAc,CAAC,MAAM,CAAC,OAAO,CAAC;QACvC,KAAK,EAAE,MAAM,CAAC,KAAK,IAAI,KAAK;KAC7B,CAAC;IAEF,OAAO;QACL,OAAO;QACP,OAAO,EAAE,MAAM,CAAC,OAAO,IAAI,IAAI,wDAAiB,EAAE;KACnD,CAAC;AACJ,CAAC,CAAC;;;;;;;;;;;;;;;;;;ACzCqD;AAGhD,MAAM,YAAY;IAAzB;QAGU,YAAO,GAAG,IAAI,gDAAa,EAAE,CAAC;IAuBxC,CAAC;IArBC,EAAE,CACA,SAAgB,EAChB,QAAwC;QAExC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,SAAmB,EAAE,QAAQ,CAAC,CAAC;QAE/C,OAAO;YACL,MAAM,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,SAAmB,EAAE,QAAQ,CAAC;SAC9D,CAAC;IACJ,CAAC;IAED,GAAG,CACD,SAAgB,EAChB,QAAwC;QAExC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,SAAmB,EAAE,QAAQ,CAAC,CAAC;IAClD,CAAC;IAED,IAAI,CAA6B,SAAgB,EAAE,KAAoB;QACrE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,SAAmB,EAAE,KAAK,CAAC,CAAC;IAChD,CAAC;CACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AE7B2C;AACM;AACF;AACK;AACN;AACD;AACN;AACM;AACU;AACF;AACF;;;;;;;;;;;;;;;;;ACN7C,MAAM,MAAM;IAKjB,YAAY,SAAkB;QAC5B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;IAC7B,CAAC;IAEO,IAAI,CAAC,MAAuB,EAAE,GAAG,MAAsB;QAC7D,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;YACjB,OAAO;SACR;QAED,IAAI,IAAI,CAAC,SAAS,IAAI,MAAM,KAAK,OAAO,EAAE;YACxC,sCAAsC;YACtC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,MAAM,CAAC,CAAC;YAE3C,OAAO;SACR;QAED,sCAAsC;QACtC,OAAO,CAAC,MAAM,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC;IAC7B,CAAC;IAED,GAAG,CAAC,GAAG,MAAsB;QAC3B,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,MAAM,CAAC,CAAC;IAC9B,CAAC;IAED,IAAI,CAAC,GAAG,MAAsB;QAC5B,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,MAAM,CAAC,CAAC;IAC/B,CAAC;IAED,IAAI,CAAC,GAAG,MAAsB;QAC5B,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,MAAM,CAAC,CAAC;IAC/B,CAAC;IAED,KAAK,CAAC,GAAG,MAAsB;QAC7B,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,GAAG,MAAM,CAAC,CAAC;IAChC,CAAC;;AAtCM,YAAK,GAAG,KAAK,CAAC;AAyChB,MAAM,MAAM,GAAG,IAAI,MAAM,EAAE,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AE9CK;AAajC,MAAM,QAAQ;IAGnB,YAAY,GAAW;QACrB,IAAI,CAAC,QAAQ,GAAG,IAAI,kEAAyB,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC;IACzD,CAAC;IAED,KAAK,CAAqC,MAAmB;QAC3D,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAW,MAAM,CAAC,CAAC;IAC/C,CAAC;IAED,aAAa,CAAC,EAAE,SAAS,EAAE,SAAS,EAAuB;QACzD,OAAO,IAAI,CAAC,KAAK,CAAgB;YAC/B,YAAY,EAAE,iBAAiB;YAC/B,QAAQ,EAAE,OAAO;YACjB,UAAU,EAAE,SAAS;YACrB,UAAU,EAAE,SAAS;SACtB,CAAC,CAAC;IACL,CAAC;IAED,KAAK,CAAC,SAAyB;QAC7B,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;IACxC,CAAC;IAED,eAAe,CAAC,iBAAoC;QAClD,OAAO,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,iBAAiB,CAAC,CAAC;IAC1D,CAAC;CACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AErCD,MAAM,aAAa,GAAG,GAAG,CAAC;AAEnB,MAAM,WAAW;IAItB,YAAY,OAAuB,EAAE,SAAiC;QACpE,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC;YACvC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,aAAa,CAAC;YAC/B,CAAC,CAAC,SAAS,CAAC;IAChB,CAAC;IAEO,UAAU,CAAC,GAAW;QAC5B,OAAO,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IACnD,CAAC;IAED,OAAO,CAAQ,GAAW;QACxB,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE;YAC9D,OAAO,OAAO,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAW,CAAC,CAAC,CAAC,IAAI,CAAC;QACvE,CAAC,CAAC,CAAC;IACL,CAAC;IAED,OAAO,CAAQ,GAAW,EAAE,KAAY;QACtC,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;IAC3E,CAAC;IAED,UAAU,CAAC,GAAW;QACpB,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;IACvD,CAAC;CACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AG/BM,MAAM,iBAAiB;IAC5B,OAAO,CAAC,GAAW;QACjB,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE;YAC7B,MAAM,KAAK,GAAG,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAExC,OAAO,CAAC,KAAK,CAAC,CAAC;QACjB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,OAAO,CAAC,GAAW,EAAE,KAAa;QAChC,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE;YAC7B,YAAY,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;YAEjC,OAAO,EAAE,CAAC;QACZ,CAAC,CAAC,CAAC;IACL,CAAC;IAED,UAAU,CAAC,GAAW;QACpB,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE;YAC7B,YAAY,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;YAE7B,OAAO,EAAE,CAAC;QACZ,CAAC,CAAC,CAAC;IACL,CAAC;CACF;;;;;;;;;;;;;;;;;;;;;;ACdD;AAEA;AACA;AAKA;AAGM,MAAOa,aAAP,CAAoB;EAWxB1J,YAAY;IACV2J,SADU;IAEVC,OAFU;IAGVpG,OAHU;IAIV/B,KAJU;IAKVoI,OALU;IAMVpG;EANU,CAAZ,EAOsB;IACpB,KAAKkG,SAAL,GAAiBA,SAAjB;IACA,KAAKC,OAAL,GAAeA,OAAf;IACA,KAAKpG,OAAL,GAAeA,OAAf;IACA,KAAK/B,KAAL,GAAaA,KAAb;IACA,KAAKoI,OAAL,GAAeA,OAAf;IACA,KAAKpG,QAAL,GAAgBA,QAAhB;IAEA,KAAK9C,OAAL,GAAe,EAAf;IACA,KAAKmJ,SAAL,GAAiB,EAAjB;EACD;;EAEaC,cAAc,CAACC,EAAD,EAAkB;IAAA;;IAAA;MAC5C,IAAIrI,QAAQ,GAAmB,EAA/B;MACA,MAAM2C,MAAM,SAAS,KAAI,CAAC2F,SAAL,CAAeD,EAAf,CAArB;;MAEA,IAAI1F,MAAJ,EAAY;QACV;QACA;QACA3C,QAAQ,SAAS2C,MAAM,CAAC4F,WAAP,GAAqB/J,KAArB,CAA4BC,GAAD,IAAQ;UAClDiJ,8DAAA,CAAW,sBAAsB/E,MAAM,CAAC0F,EAAE,eAA1C;UACAX,gEAAA,CAAajJ,GAAb;UAEA,OAAO,EAAP;QACD,CALgB,CAAjB;MAMD;;MAED,OAAOuB,QAAP;IAf4C;EAgB7C;;EAEawI,mBAAmB;IAAA;;IAAA;MAC/B,MAAMC,WAAW,GAAG,IAAIX,sEAAJ,CAAgB,MAAI,CAACG,OAArB,EAA8BN,oDAA9B,CAApB;MACA,MAAMe,uBAAuB,SAASD,WAAW,CAACE,OAAZ,CACpCd,kEADoC,CAAtC;MAGA,MAAMe,eAAe,SAASH,WAAW,CAACE,OAAZ,CAC5Bf,wDAD4B,CAA9B;;MAIA,IAAIc,uBAAuB,IAAIE,eAA/B,EAAgD;QAC9C,MAAM5I,QAAQ,SAAS,MAAI,CAACoI,cAAL,CAAoBM,uBAApB,CAAvB;QAEA,MAAMD,WAAW,CAACI,UAAZ,CAAuBhB,kEAAvB,CAAN;QACA,MAAMY,WAAW,CAACI,UAAZ,CAAuBjB,wDAAvB,CAAN;;QAEA,IAAI5H,QAAQ,CAAC4D,MAAb,EAAqB;UACnB,MAAM;YAAEkF;UAAF,IAAuB,MAAI,CAAChJ,KAAL,CAAWC,QAAX,EAA7B;;UACA,MAAMgJ,cAAc,SAAS,MAAI,CAACT,SAAL,CAAeQ,gBAAf,CAA7B;;UAEA,IAAIC,cAAc,IAAIL,uBAAuB,KAAKI,gBAAlD,EAAoE;YAClE,MAAMC,cAAc,CAACrG,OAAf,GAAyBlE,KAAzB,CAAgCC,GAAD,IAAQ;cAC3CiJ,8DAAA,CAAW,oCAAX;cACAA,gEAAA,CAAajJ,GAAb;YACD,CAHK,CAAN;UAID;;UAED,OAAO;YACLuB,QADK;YAEL6E,QAAQ,EAAE+D,eAFL;YAGLE,gBAAgB,EAAEJ;UAHb,CAAP;QAKD;MACF;;MAED,MAAM;QAAE7D,QAAF;QAAYiE;MAAZ,IAAiC,MAAI,CAAChJ,KAAL,CAAWC,QAAX,EAAvC;;MACA,MAAMC,QAAQ,SAAS,MAAI,CAACoI,cAAL,CAAoBU,gBAApB,CAAvB;;MAEA,IAAI,CAAC9I,QAAQ,CAAC4D,MAAd,EAAsB;QACpB,OAAO;UACL5D,QAAQ,EAAE,EADL;UAEL6E,QAAQ,EAAE,IAFL;UAGLiE,gBAAgB,EAAE;QAHb,CAAP;MAKD;;MAED,OAAO;QACL9I,QADK;QAEL6E,QAFK;QAGLiE;MAHK,CAAP;IA7C+B;EAkDhC;;EAEaE,aAAa,CAACC,QAAD,EAAiB;IAAA;;IAAA;MAC1C,MAAMtG,MAAM,SAAU,MAAI,CAAC2F,SAAL,CAAeW,QAAf,CAAtB;MAEA,MAAMtG,MAAM,CAACD,OAAP,GAAiBlE,KAAjB,CAAwBC,GAAD,IAAQ;QACnCiJ,8DAAA,CAAW,sBAAsB/E,MAAM,CAAC0F,EAAE,EAA1C;QACAX,gEAAA,CAAajJ,GAAb,EAFmC,CAInC;;QACA,MAAI,CAACyK,iBAAL,CAAuBvG,MAAM,CAAC0F,EAA9B;MACD,CANK,CAAN;IAH0C;EAU3C;;EAEac,gBAAgB,CAC5BF,QAD4B,EAE5B;IAAEjJ,QAAF;IAAYJ,UAAZ;IAAwBwJ;EAAxB,CAF4B,EAEmC;IAAA;;IAAA;MAE/D,MAAM;QAAEN;MAAF,IAAuB,MAAI,CAAChJ,KAAL,CAAWC,QAAX,EAA7B;;MACA,MAAM0I,WAAW,GAAG,IAAIX,sEAAJ,CAAgB,MAAI,CAACG,OAArB,EAA8BN,oDAA9B,CAApB;MACA,MAAM9C,QAAQ,GAAG;QAAEjF,UAAF;QAAcwJ;MAAd,CAAjB;;MAEA,IAAI,CAACpJ,QAAQ,CAAC4D,MAAd,EAAsB;QACpB,MAAMyF,MAAM,GAAG,MAAI,CAACC,SAAL,CAAeL,QAAf,CAAf,CADoB,CAEpB;QACA;;;QACA,IAAII,MAAM,CAACpE,IAAP,KAAgB,SAApB,EAA+B;UAC7B,MAAMwD,WAAW,CAACc,OAAZ,CAAoB1B,kEAApB,EAAgDoB,QAAhD,CAAN;UACA,MAAMR,WAAW,CAACc,OAAZ,CAAmC3B,wDAAnC,EAAqD/C,QAArD,CAAN;QACD;;QAED;MACD;;MAED,IAAIiE,gBAAgB,IAAIA,gBAAgB,KAAKG,QAA7C,EAAuD;QACrD,MAAM,MAAI,CAACD,aAAL,CAAmBF,gBAAnB,CAAN;MACD;;MAED,MAAI,CAAChJ,KAAL,CAAW0J,QAAX,CAAoB;QAClBvE,IAAI,EAAE,kBADY;QAElBwE,OAAO,EAAE;UAAER,QAAF;UAAYpE,QAAZ;UAAsB7E;QAAtB;MAFS,CAApB;IAtB+D;EA0BhE;;EAEOkJ,iBAAiB,CAACD,QAAD,EAAiB;IACxC,KAAKnJ,KAAL,CAAW0J,QAAX,CAAoB;MAClBvE,IAAI,EAAE,qBADY;MAElBwE,OAAO,EAAE;QAAER;MAAF;IAFS,CAApB;EAID;;EAEOS,kBAAkB,CAACL,MAAD,EAAqB;IAAA;;IAC7C,MAAMnB,OAAO,GAAG,IAAIV,8EAAJ,EAAhB;IAEAU,OAAO,CAACyB,EAAR,CAAW,WAAX,EAAwB,MAAK;MAC3B,KAAKT,iBAAL,CAAuBG,MAAM,CAAChB,EAA9B;IACD,CAFD;IAIAH,OAAO,CAACyB,EAAR,CAAW,UAAX,EAAwBC,KAAD,IAAU;MAC/B,KAAKT,gBAAL,CAAsBE,MAAM,CAAChB,EAA7B,EAAiCuB,KAAjC;IACD,CAFD;IAIA1B,OAAO,CAACyB,EAAR,CAAW,iBAAX;MAAA,2MAA8B,WAAO;QAAE3J;MAAF,CAAP,EAAuB;QACnD,IAAI,CAACA,QAAQ,CAAC4D,MAAd,EAAsB;UACpB,OAAO,MAAI,CAACoF,aAAL,CAAmBK,MAAM,CAAChB,EAA1B,CAAP;QACD;;QAED,MAAI,CAACvI,KAAL,CAAW0J,QAAX,CAAoB;UAClBvE,IAAI,EAAE,kBADY;UAElBwE,OAAO,EAAE;YAAER,QAAQ,EAAEI,MAAM,CAAChB,EAAnB;YAAuBrI;UAAvB;QAFS,CAApB;MAID,CATD;;MAAA;QAAA;MAAA;IAAA;IAWAkI,OAAO,CAACyB,EAAR,CAAW,gBAAX,EAA6B,CAAC;MAAEE;IAAF,CAAD,KAAkB;MAC7C,KAAK3B,OAAL,CAAa4B,IAAb,CAAkB,gBAAlB,EAAoC;QAAEb,QAAQ,EAAEI,MAAM,CAAChB,EAAnB;QAAuBwB;MAAvB,CAApC;IACD,CAFD;IAIA,OAAO3B,OAAP;EACD;;EAEO6B,cAAc,CAACpH,MAAD,EAAe;IAAA;;IACnC,MAAMqH,OAAO,GAAGrH,MAAM,CAACH,MAAvB;IACA,MAAMyH,QAAQ,GAAGtH,MAAM,CAACD,OAAxB;;IAEAC,MAAM,CAACH,MAAP;MAAA,4MAAgB,WAAO0C,MAAP,EAAwB;QACtC,MAAMlF,QAAQ,SAASgK,OAAO,CAAC9E,MAAD,CAA9B;QAEA,MAAM;UAAEtF,UAAF;UAAcwJ,WAAW,GAAG;QAA5B,IAAmClE,MAAzC;QACA,MAAM,MAAI,CAACiE,gBAAL,CAAsBxG,MAAM,CAAC0F,EAA7B,EAAiC;UACrCrI,QADqC;UAErCJ,UAFqC;UAGrCwJ;QAHqC,CAAjC,CAAN;QAMA,OAAOpJ,QAAP;MACD,CAXD;;MAAA;QAAA;MAAA;IAAA;;IAaA2C,MAAM,CAACD,OAAP,gNAAiB,aAAW;MAC1B,MAAMuH,QAAQ,EAAd;;MACA,MAAI,CAACf,iBAAL,CAAuBvG,MAAM,CAAC0F,EAA9B;IACD,CAHD;IAKA,OAAO1F,MAAP;EACD;;EAEauH,aAAa,CAACb,MAAD,EAAqB;IAAA;;IAAA;MAC9C,IAAI,CAACA,MAAM,CAACnK,QAAP,CAAgBiL,SAArB,EAAgC;QAC9B,MAAMjG,OAAO,GACXmF,MAAM,CAACpE,IAAP,KAAgB,UAAhB,GAA6B,eAA7B,GAA+C,eADjD;QAEA,MAAMb,KAAK,CAAC,GAAGiF,MAAM,CAACnK,QAAP,CAAgBC,IAAI,OAAO+E,OAAO,EAAtC,CAAX;MACD;;MAED,MAAMvB,MAAM,GAAGJ;QACb8F,EAAE,EAAEgB,MAAM,CAAChB,EADE;QAEbpD,IAAI,EAAEoE,MAAM,CAACpE,IAFA;QAGb/F,QAAQ,EAAEmK,MAAM,CAACnK;MAHJ,SAIHmK,MAAM,CAACe,IAAP,CAAY;QACpB/B,EAAE,EAAEgB,MAAM,CAAChB,EADS;QAEpBpD,IAAI,EAAEoE,MAAM,CAACpE,IAFO;QAGpB/F,QAAQ,EAAEmK,MAAM,CAACnK,QAHG;QAIpB2C,OAAO,EAAE,MAAI,CAACA,OAJM;QAKpB/B,KAAK,EAAE,MAAI,CAACA,KAAL,CAAWuK,UAAX,EALa;QAMpBvI,QAAQ,EAAE,MAAI,CAACA,QANK;QAOpBoG,OAAO,EAAE,MAAI,CAACwB,kBAAL,CAAwBL,MAAxB,CAPW;QAQpB3B,MAAM,EAAE,IAAID,0DAAJ,CAAW4B,MAAM,CAAChB,EAAlB,CARY;QASpBJ,OAAO,EAAE,IAAIH,sEAAJ,CAAgB,MAAI,CAACG,OAArB,EAA8B,CAACN,oDAAD,EAAe0B,MAAM,CAAChB,EAAtB,CAA9B;MATW,CAAZ,CAJG,CAAf;MAiBA,OAAO,MAAI,CAAC0B,cAAL,CAAoBpH,MAApB,CAAP;IAxB8C;EAyB/C;;EAEO2G,SAAS,CAACjB,EAAD,EAAkB;IACjC,OAAO,KAAKrJ,OAAL,CAAakB,IAAb,CAAmBwD,CAAD,IAAOA,CAAC,CAAC2E,EAAF,KAASA,EAAlC,CAAP;EACD;;EAEKC,SAAS,CAAoCD,EAApC,EAAqD;IAAA;;IAAA;MAClE,MAAMgB,MAAM,GAAG,MAAI,CAACC,SAAL,CAAejB,EAAf,CAAf;;MAEA,IAAI,CAACgB,MAAL,EAAa;QACX,OAAO,IAAP;MACD;;MAED,MAAM;QAAEP;MAAF,IAAuB,MAAI,CAAChJ,KAAL,CAAWC,QAAX,EAA7B,CAPkE,CASlE;MACA;;;MACA,IAAI,CAACsJ,MAAM,CAACnK,QAAP,CAAgBiL,SAAjB,IAA8BrB,gBAAlC,EAAoD;QAClD,MAAI,CAACI,iBAAL,CAAuBJ,gBAAvB;;QAEA,OAAO,IAAP;MACD;;MAED,aAAcO,MAAM,CAAC1G,MAAP,EAAd;IAjBkE;EAkBnE;;EAEK2H,KAAK;IAAA;;IAAA;MACT,MAAMtL,OAAO,GAAuB,EAApC;;MAEA,KAAK,IAAIyG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,MAAI,CAACuC,SAAL,CAAepE,MAAnC,EAA2C6B,CAAC,IAAI,CAAhD,EAAmD;QACjD,MAAM4D,MAAM,SAAS,MAAI,CAACrB,SAAL,CAAevC,CAAf,EAAkB;UAAE5D,OAAO,EAAE,MAAI,CAACA;QAAhB,CAAlB,EAA6CrD,KAA7C,CAClBC,GAAD,IAAQ;UACNiJ,8DAAA,CAAW,wBAAX;UACAA,gEAAA,CAAajJ,GAAb;UAEA,OAAO,IAAP;QACD,CANkB,CAArB,CADiD,CAUjD;;QACA,IAAI,CAAC4K,MAAL,EAAa;UACX;QACD,CAbgD,CAejD;;;QACA,IAAIrK,OAAO,CAACuL,IAAR,CAAc7G,CAAD,IAAOA,CAAC,CAAC2E,EAAF,KAASgB,MAAM,CAAChB,EAApC,CAAJ,EAA6C;UAC3C;QACD;;QAEDrJ,OAAO,CAAC0G,IAAR,CAAa;UACX2C,EAAE,EAAEgB,MAAM,CAAChB,EADA;UAEXpD,IAAI,EAAEoE,MAAM,CAACpE,IAFF;UAGX/F,QAAQ,EAAEmK,MAAM,CAACnK,QAHN;UAIXyD,MAAM;YAAA,4MAAE,aAAW;cACjB,IAAI6H,QAAQ,GAAG,MAAI,CAACrC,SAAL,CAAekB,MAAM,CAAChB,EAAtB,CAAf;;cAEA,IAAImC,QAAJ,EAAc;gBACZ,OAAOA,QAAP;cACD;;cAEDA,QAAQ,SAAS,MAAI,CAACN,aAAL,CAAmBb,MAAnB,CAAjB;cAEA,MAAI,CAAClB,SAAL,CAAekB,MAAM,CAAChB,EAAtB,IAA4BmC,QAA5B;cAEA,OAAOA,QAAP;YACD,CAZK;;YAAA;cAAA;YAAA;UAAA;QAJK,CAAb;MAkBD;;MAED,MAAI,CAACxL,OAAL,GAAeA,OAAf;MAEA,MAAM;QAAEgB,QAAF;QAAY6E,QAAZ;QAAsBiE;MAAtB,UACE,MAAI,CAACN,mBAAL,EADR;;MAGA,MAAI,CAAC1I,KAAL,CAAW0J,QAAX,CAAoB;QAClBvE,IAAI,EAAE,sBADY;QAElBwE,OAAO,EAAE;UACPzK,OADO;UAEPgB,QAFO;UAGP6E,QAHO;UAIPiE;QAJO;MAFS,CAApB;IAhDS;EAyDV;;AAvTuB;;;;;;;;;;;;;;;;;;;;;;ACvB1B;AAEA;AAOA;;AAEA,MAAMgC,OAAO,GAAG,CACdjL,KADc,EAEdkL,MAFc,KAGS;EACvBrD,iDAAA,CAAW,cAAX,EAA2BqD,MAA3B;;EAEA,QAAQA,MAAM,CAAC9F,IAAf;IACE,KAAK,sBAAL;MAA6B;QAC3B,MAAM;UAAEjG,OAAF;UAAWgB,QAAX;UAAqB6E,QAArB;UAA+BiE;QAA/B,IAAoDiC,MAAM,CAACtB,OAAjE;QAEA,MAAMuB,aAAa,GAAGhL,QAAQ,CAACiB,GAAT,CAAa,CAACd,OAAD,EAAUsF,CAAV,KAAe;UAChD,uCACKtF,OADL,GACY;YACVC,MAAM,EAAEqF,CAAC,KAAK;UADJ,CADZ;QAID,CALqB,CAAtB;QAOA,uCACK5F,KADL,GACU;UACRb,OADQ;UAERgB,QAAQ,EAAEgL,aAFF;UAGRnG,QAHQ;UAIRiE;QAJQ,CADV;MAOD;;IACD,KAAK,kBAAL;MAAyB;QACvB,MAAM;UAAEG,QAAF;UAAYpE,QAAZ;UAAsB7E;QAAtB,IAAmC+K,MAAM,CAACtB,OAAhD;;QAEA,IAAI,CAACzJ,QAAQ,CAAC4D,MAAd,EAAsB;UACpB,OAAO/D,KAAP;QACD;;QAED,MAAMoL,kBAAkB,GAAGpL,KAAK,CAACG,QAAN,CAAeyD,SAAf,CACxBtD,OAAD,IAAaA,OAAO,CAACC,MADI,CAA3B;QAIA,MAAM4K,aAAa,GAAGhL,QAAQ,CAACiB,GAAT,CAAa,CAACd,OAAD,EAAUsF,CAAV,KAAe;UAChD,uCACKtF,OADL,GACY;YACVC,MAAM,EAAEqF,CAAC,MAAMwF,kBAAkB,GAAG,CAAC,CAAtB,GAA0BA,kBAA1B,GAA+C,CAArD;UADC,CADZ;QAID,CALqB,CAAtB;QAOA,uCACKpL,KADL,GACU;UACRgF,QADQ;UAER7E,QAAQ,EAAEgL,aAFF;UAGRlC,gBAAgB,EAAEG;QAHV,CADV;MAMD;;IACD,KAAK,qBAAL;MAA4B;QAC1B,MAAM;UAAEA;QAAF,IAAe8B,MAAM,CAACtB,OAA5B;;QAEA,IAAIR,QAAQ,KAAKpJ,KAAK,CAACiJ,gBAAvB,EAAyC;UACvC,OAAOjJ,KAAP;QACD;;QAED,uCACKA,KADL,GACU;UACRgF,QAAQ,EAAE,IADF;UAER7E,QAAQ,EAAE,EAFF;UAGR8I,gBAAgB,EAAE;QAHV,CADV;MAMD;;IACD,KAAK,kBAAL;MAAyB;QACvB,MAAM;UAAEG,QAAF;UAAYjJ;QAAZ,IAAyB+K,MAAM,CAACtB,OAAtC;;QAEA,IAAIR,QAAQ,KAAKpJ,KAAK,CAACiJ,gBAAvB,EAAyC;UACvC,OAAOjJ,KAAP;QACD;;QAED,MAAMqL,aAAa,GAAGrL,KAAK,CAACG,QAAN,CAAeE,IAAf,CAAqBC,OAAD,IAAaA,OAAO,CAACC,MAAzC,CAAtB;QAEA,MAAM+K,sBAAsB,GAAG,CAACnL,QAAQ,CAACuK,IAAT,CAC7BpK,OAAD,IAAaA,OAAO,CAACF,SAAR,MAAsBiL,aAAa,SAAb,iBAAa,WAAb,GAAa,MAAb,gBAAa,CAAEjL,SAArC,CADiB,CAAhC;QAIA,MAAM+K,aAAa,GAAGhL,QAAQ,CAACiB,GAAT,CAAa,CAACd,OAAD,EAAUsF,CAAV,KAAe;UAChD,uCACKtF,OADL,GACY;YACVC,MAAM,EAAE+K,sBAAsB,GAC1B1F,CAAC,KAAK,CADoB,GAE1BtF,OAAO,CAACF,SAAR,MAAsBiL,aAAa,SAAb,iBAAa,WAAb,GAAa,MAAb,gBAAa,CAAEjL,SAArC;UAHM,CADZ;QAMD,CAPqB,CAAtB;QASA,uCACKJ,KADL,GACU;UACRG,QAAQ,EAAEgL;QADF,CADV;MAID;;IACD,KAAK,oBAAL;MAA2B;QACzB,MAAM;UAAE/K;QAAF,IAAgB8K,MAAM,CAACtB,OAA7B;QAEA,MAAMuB,aAAa,GAAGnL,KAAK,CAACG,QAAN,CAAeiB,GAAf,CAAoBd,OAAD,IAAY;UACnD,uCACKA,OADL,GACY;YACVC,MAAM,EAAED,OAAO,CAACF,SAAR,KAAsBA;UADpB,CADZ;QAID,CALqB,CAAtB;QAOA,uCACKJ,KADL,GACU;UACRG,QAAQ,EAAEgL;QADF,CADV;MAID;;IACD;MACE,OAAOnL,KAAP;EArGJ;AAuGD,CA7GD;;AA+GO,MAAMuL,WAAW;EAAA,2MAAG,WAAOnD,OAAP,EAAkD;IAC3E,MAAMQ,WAAW,GAAG,IAAIX,kDAAJ,CAAgBG,OAAhB,EAAyBN,oDAAzB,CAApB;IACA,MAAM0D,YAAY,GAAwB;MACxCrM,OAAO,EAAE,EAD+B;MAExCgB,QAAQ,EAAE,EAF8B;MAGxC6E,QAAQ,QAAQ4D,WAAW,CAACE,OAAZ,CAAoBiC,gDAApB,CAHwB;MAIxC9B,gBAAgB,QAAQL,WAAW,CAACE,OAAZ,CAAoBkC,0DAApB;IAJgB,CAA1C;IAOA,MAAMS,MAAM,GAAG,IAAIZ,iDAAJ,CAAoBW,YAApB,CAAf;IACA,MAAME,QAAQ,GAAG,IAAId,yCAAJ,EAAjB;IAEAc,QAAQ,CAAChH,IAAT,CAAcoG,0CAAI,CAACG,OAAD,EAAUO,YAAV,CAAlB,EAA2C7G,SAA3C,CAAqD8G,MAArD;;IAEA,MAAME,WAAW;MAAA,4MAAG,WAClBC,SADkB,EAElB5L,KAFkB,EAGlB6L,UAHkB,EAIlBC,QAJkB,EAKhB;QACF,IAAI9L,KAAK,CAAC8L,QAAD,CAAL,KAAoBF,SAAS,CAACE,QAAD,CAAjC,EAA6C;UAC3C;QACD;;QAED,IAAI9L,KAAK,CAAC8L,QAAD,CAAT,EAAqB;UACnB,MAAMlD,WAAW,CAACc,OAAZ,CAAoBmC,UAApB,EAAgC7L,KAAK,CAAC8L,QAAD,CAArC,CAAN;UACA;QACD;;QAED,MAAMlD,WAAW,CAACI,UAAZ,CAAuB6C,UAAvB,CAAN;MACD,CAhBgB;;MAAA,gBAAXF,WAAW;QAAA;MAAA;IAAA,GAAjB;;IAkBA,IAAIC,SAAS,GAAGH,MAAM,CAACM,QAAP,EAAhB;IACAN,MAAM,CAAC9G,SAAP,CAAkB3E,KAAD,IAAU;MACzB2L,WAAW,CAACC,SAAD,EAAY5L,KAAZ,EAAmBgL,0DAAnB,EAAuC,kBAAvC,CAAX;MACAW,WAAW,CAACC,SAAD,EAAY5L,KAAZ,EAAmB+K,gDAAnB,EAA6B,UAA7B,CAAX;MACAa,SAAS,GAAG5L,KAAZ;IACD,CAJD;IAMA,OAAO;MACLyE,UAAU,EAAEgH,MADP;MAELvL,QAAQ,EAAE,MAAMuL,MAAM,CAACM,QAAP,EAFX;MAGLpC,QAAQ,EAAGuB,MAAD,IAAYQ,QAAQ,CAACM,IAAT,CAAcd,MAAd,CAHjB;MAILV,UAAU,EAAE,OAAO;QACjBtK,QAAQ,EAAE,MAAMuL,MAAM,CAACM,QAAP,EADC;QAEjBtH,UAAU,EAAEgH,MAAM,CAACQ,YAAP;MAFK,CAAP;IAJP,CAAP;EASD,CAhDuB;;EAAA,gBAAXV,WAAW;IAAA;EAAA;AAAA,GAAjB;;;;;;;;;;;;;;;;;;;;AC1HP;AACA;AAMA;AAGA,IAAIa,sBAAsB,GAA0B,IAApD;AAEO,MAAM1O,mBAAmB;EAAA,2MAAG,WACjC2H,MADiC,EAEN;IAC3B,MAAM;MAAErD,OAAF;MAAWoG;IAAX,IAAuB8D,wDAAc,CAAC7G,MAAD,CAA3C;IACAuC,mDAAA,GAAe5F,OAAO,CAAC9C,KAAvB;IAEA,MAAMmJ,OAAO,GAAG,IAAIV,mDAAJ,EAAhB;IACA,MAAM1H,KAAK,SAASsL,mDAAW,CAACnD,OAAD,CAA/B;IACA,MAAMiE,aAAa,GAAG,IAAInE,oDAAJ,CAAkB;MACtCC,SAAS,EAAE9C,MAAM,CAAClG,OADoB;MAEtCiJ,OAFsC;MAGtCpG,OAHsC;MAItC/B,KAJsC;MAKtCoI,OALsC;MAMtCpG,QAAQ,EAAE,IAAIkK,+CAAJ,CAAanK,OAAO,CAAC/C,OAAR,CAAgBkD,OAA7B;IAN4B,CAAlB,CAAtB;IASA,MAAMkK,aAAa,CAAC5B,KAAd,EAAN;;IAEA,IAAI,CAAC2B,sBAAL,EAA6B;MAC3BA,sBAAsB,GAAG;QACvBpK,OADuB;QAEvB/B,KAAK,EAAEA,KAAK,CAACuK,UAAN,EAFgB;QAGvB1H,MAAM;UAAA,4MAAE,WAA0C0F,EAA1C,EAAyD;YAC/D,MAAM;cAAES;YAAF,IAAuBhJ,KAAK,CAACC,QAAN,EAA7B;YACA,MAAM4C,MAAM,SAASuJ,aAAa,CAAC5D,SAAd,CACnBD,EAAE,IAAIS,gBADa,CAArB;;YAIA,IAAI,CAACnG,MAAL,EAAa;cACX,IAAI0F,EAAJ,EAAQ;gBACN,MAAM,IAAIjE,KAAJ,CAAU,mBAAV,CAAN;cACD;;cAED,MAAM,IAAIA,KAAJ,CAAU,oBAAV,CAAN;YACD;;YAED,OAAOzB,MAAP;UACD,CAfK;;UAAA;YAAA;UAAA;QAAA,GAHiB;QAmBvBmB,gBAAgB,EAAG7D,SAAD,IAAsB;UACtC,MAAM;YAAED;UAAF,IAAeF,KAAK,CAACC,QAAN,EAArB;;UAEA,IAAI,CAACC,QAAQ,CAACuK,IAAT,CAAepK,OAAD,IAAaA,OAAO,CAACF,SAAR,KAAsBA,SAAjD,CAAL,EAAkE;YAChE,MAAM,IAAImE,KAAJ,CAAU,oBAAV,CAAN;UACD;;UAEDtE,KAAK,CAAC0J,QAAN,CAAe;YACbvE,IAAI,EAAE,oBADO;YAEbwE,OAAO,EAAE;cAAExJ;YAAF;UAFI,CAAf;QAID,CA9BsB;;QA+BvBkM,UAAU;UACR,MAAM;YAAEnM;UAAF,IAAeF,KAAK,CAACC,QAAN,EAArB;UAEA,OAAOqM,OAAO,CAACpM,QAAQ,CAAC4D,MAAV,CAAd;QACD,CAnCsB;;QAoCvB+F,EAAE,EAAE,CAAC0C,SAAD,EAAYC,QAAZ,KAAwB;UAC1B,OAAOpE,OAAO,CAACyB,EAAR,CAAW0C,SAAX,EAAsBC,QAAtB,CAAP;QACD,CAtCsB;QAuCvBC,GAAG,EAAE,CAACF,SAAD,EAAYC,QAAZ,KAAwB;UAC3BpE,OAAO,CAACqE,GAAR,CAAYF,SAAZ,EAAuBC,QAAvB;QACD;MAzCsB,CAAzB;IA2CD;;IAED,OAAOL,sBAAP;EACD,CAlE+B;;EAAA,gBAAnB1O,mBAAmB;IAAA;EAAA;AAAA,GAAzB;;;;;;;;;;;;;;;;ACZqD;;;;;;;;;;;;;;;;;;;;ACA5D;AACA;AAGO,MAAMC,mBAAmB;EAAA,2MAAG,aAE/B;IACF,OAAO,CAACgP,uFAAiB,EAAlB,EAAsBC,yEAAW,EAAjC,CAAP;EACD,CAJ+B;;EAAA,gBAAnBjP,mBAAmB;IAAA;EAAA;AAAA,GAAzB;;;;;;;;;;;;;;;;ACJoC;;;;;;;;;;;;;;;;ACA3C,iEAAe,4gEAA4gE,EAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACA5hE;CAIA;AACA;AACA;;AAEO,MAAMmP,GAAG,GAAG,IAAZ,EAAkB;;AAClB,MAAMC,QAAQ,GAAG,IAAjB,EAAuB;;AACvB,MAAMC,kBAAkB,GAAG,IAA3B,EAAiC;;AACjC,MAAMC,mBAAmB,GAAG,IAA5B,EAAkC;;AAClC,MAAMC,OAAO,GAAG,IAAhB,EAAsB;;AACtB,MAAMC,OAAO,GAAG,IAAhB,EAAsB;;AACtB,MAAMC,SAAS,GAAG,IAAlB;AACA,MAAMC,SAAS,GAAG,IAAlB,EAEP;AACA;;AACM,SAAUC,mBAAV,CAA8BC,cAA9B,EAAoD;EACxD,MAAMC,KAAK,GAAGD,cAAc,CAACE,KAAf,CAAqB,GAArB,CAAd;EAEA,OAAOnK,MAAM,CAACoK,MAAP,CACLF,KAAK,CACFpM,GADH,CACQuM,IAAD,IAAS;IACZ,OAAOA,IAAI,CAACC,QAAL,CAAc,GAAd,IACHnG,IAAI,CAACoG,GAAL,CAASC,QAAQ,CAACH,IAAI,CAACI,KAAL,CAAW,CAAX,EAAc,CAAC,CAAf,CAAD,CAAjB,IAAwC,UADrC,GAEHtG,IAAI,CAACoG,GAAL,CAASC,QAAQ,CAACH,IAAD,CAAjB,CAFJ;EAGD,CALH,EAMGvM,GANH,CAMQ4M,GAAD,IAAQ;IACX,OAAO1K,MAAM,CAACC,IAAP,CAAY,CAChByK,GAAG,IAAI,EAAR,GAAc,IADG,EAEhBA,GAAG,IAAI,EAAR,GAAc,IAFG,EAGhBA,GAAG,IAAI,CAAR,GAAa,IAHI,EAIjBA,GAAG,GAAG,IAJW,CAAZ,CAAP;EAMD,CAbH,CADK,CAAP;AAgBD,EAED;;AACO,MAAMhE,SAAS,GAAG,IAAIiE,UAAJ,CAAe,CAAf,CAAlB,EAmBP;;AACO,MAAMC,iBAAiB,GAAG,MAAK;;;EACpC,OAAO,CAAC,EAAC,YAAM,CAACC,SAAP,MAAgB,IAAhB,IAAgB3N,aAAhB,GAAgB,MAAhB,GAAgBA,GAAE4N,GAAnB,CAAR;AACD,CAFM;AAID,MAAOC,YAAP,CAAmB;EAAzB7P;IAAA;;IACU,iBAA8B,IAA9B;;IAER,mBAAc,MAAK;MACjB,OAAO+N,OAAO,CAAC,KAAK+B,SAAN,CAAd;IACD,CAFD;;IAIA,4NAAU,aAAW;MACnB,KAAI,CAACA,SAAL,SAAuBzB,4EAAA,EAAvB;;MAEA,MAAM2B,gBAAgB,GAAG,MAAK;;;QAC5B,WAAI,CAACF,SAAL,MAAc,IAAd,IAAc9N,aAAd,GAAc,MAAd,GAAcA,GAAEkM,GAAF,CAAM,YAAN,EAAoB8B,gBAApB,CAAd;QACA,KAAI,CAACF,SAAL,GAAiB,IAAjB;MACD,CAHD;;MAKA,KAAI,CAACA,SAAL,CAAexE,EAAf,CAAkB,YAAlB,EAAgC0E,gBAAhC;IACD,CATD;IAWA,+NAAa,aAAW;MACtB,IAAI,CAAC,KAAI,CAACF,SAAV,EAAqB;QACnB,MAAM,IAAI/J,KAAJ,CAAU,sBAAV,CAAN;MACD;;MAED,MAAM,KAAI,CAAC+J,SAAL,CAAeG,KAAf,EAAN;MACA,KAAI,CAACH,SAAL,GAAiB,IAAjB;IACD,CAPD;;IASA,sBAAkBI,GAAD,IAAgB;MAC/B,IAAI,CAAC,KAAKJ,SAAV,EAAqB;QACnB,MAAM,IAAI/J,KAAJ,CAAU,sBAAV,CAAN;MACD;;MAED,KAAK+J,SAAL,CAAeK,cAAf,CAA8BD,GAA9B;IACD,CAND;;IAQA,UAAK,CACH3E,KADG,EAEH0C,QAFG,KAGa;MAChB,IAAI,CAAC,KAAK6B,SAAV,EAAqB;QACnB,MAAM,IAAI/J,KAAJ,CAAU,sBAAV,CAAN;MACD;;MAED,KAAK+J,SAAL,CAAexE,EAAf,CAAkBC,KAAlB,EAAyB0C,QAAzB;MAEA,OAAO;QACLmC,MAAM,EAAE,MAAK;UAAA;;UAAC,kBAAKN,SAAL,MAAc,IAAd,IAAc9N,aAAd,GAAc,MAAd,GAAcA,GAAEkM,GAAF,CAAM3C,KAAN,EAAa0C,QAAb,CAAd;QAAoC;MAD7C,CAAP;IAGD,CAbD;;IAeA,WAAM,CAAC1C,KAAD,EAAwB0C,QAAxB,KAAgD;MACpD,IAAI,CAAC,KAAK6B,SAAV,EAAqB;QACnB,MAAM,IAAI/J,KAAJ,CAAU,sBAAV,CAAN;MACD;;MAED,KAAK+J,SAAL,CAAe5B,GAAf,CAAmB3C,KAAnB,EAA0B0C,QAA1B;IACD,CAND;;IAQA,+NAAa,aAAW;MACtB,IAAI,CAAC,KAAI,CAAC6B,SAAV,EAAqB;QACnB,MAAM,IAAI/J,KAAJ,CAAU,sBAAV,CAAN;MACD;;MAED,MAAMpB,GAAG,SAAS,KAAI,CAACmL,SAAL,CAAeO,IAAf,CAChB/B,GADgB,EAEhBG,mBAFgB,EAGhBG,SAHgB,EAIhBC,SAJgB,CAAlB;MAOA,MAAM,CAACyB,KAAD,EAAQC,KAAR,EAAeC,KAAf,IAAwBC,KAAK,CAAC1L,IAAN,CAAWJ,GAAX,CAA9B;MAEA,OAAO,GAAG2L,KAAK,IAAIC,KAAK,IAAIC,KAAK,EAAjC;IACD,CAfD;;IAiBA;MAAA,4MAAe,WAAO;QAAEzB;MAAF,CAAP,EAAiD;QAC9D,IAAI,CAAC,KAAI,CAACe,SAAV,EAAqB;UACnB,MAAM,IAAI/J,KAAJ,CAAU,sBAAV,CAAN;QACD;;QAED,MAAMpB,GAAG,SAAS,KAAI,CAACmL,SAAL,CAAeO,IAAf,CAChB/B,GADgB,EAEhBE,kBAFgB,EAGhBK,SAHgB,EAIhBrD,SAJgB,EAKhBsD,mBAAmB,CAACC,cAAD,CALH,CAAlB;QAQA,OAAOrM,oEAAA,CAA4BiC,GAAG,CAACiM,QAAJ,CAAa,CAAb,EAAgB,CAAC,CAAjB,CAA5B,CAAP;MACD,CAdD;;MAAA;QAAA;MAAA;IAAA;;IAgBA;MAAA,4MAAO,WAAO;QAAE3M,IAAF;QAAQ8K;MAAR,CAAP,EAA+C;QACpD,IAAI,CAAC,KAAI,CAACe,SAAV,EAAqB;UACnB,MAAM,IAAI/J,KAAJ,CAAU,sBAAV,CAAN;QACD,CAHmD,CAKpD;;;QACA,MAAM,KAAI,CAAC8K,UAAL,EAAN,CANoD,CAQpD;;QACA,MAAMC,UAAU,GAAG,GAAnB;QACA,MAAMC,OAAO,GAAGjM,MAAM,CAACoK,MAAP,CAAc,CAC5BJ,mBAAmB,CAACC,cAAD,CADS,EAE5BjK,MAAM,CAACC,IAAP,CAAYd,IAAZ,CAF4B,CAAd,CAAhB;;QAKA,KAAK,IAAI+M,MAAM,GAAG,CAAlB,EAAqBA,MAAM,GAAGD,OAAO,CAACxL,MAAtC,EAA8CyL,MAAM,IAAIF,UAAxD,EAAoE;UAClE,MAAMG,WAAW,GAAGD,MAAM,GAAGF,UAAT,IAAuBC,OAAO,CAACxL,MAAnD;UAEA,MAAM2L,QAAQ,SAAS,KAAI,CAACpB,SAAL,CAAeO,IAAf,CACrB/B,GADqB,EAErBC,QAFqB,EAGrB0C,WAAW,GAAGvC,OAAH,GAAaC,OAHH,EAIrBE,SAJqB,EAKrB/J,MAAM,CAACC,IAAP,CAAYgM,OAAO,CAACH,QAAR,CAAiBI,MAAjB,EAAyBA,MAAM,GAAGF,UAAlC,CAAZ,CALqB,CAAvB;;UAQA,IAAIG,WAAJ,EAAiB;YACf,OAAOnM,MAAM,CAACC,IAAP,CAAYmM,QAAQ,CAACN,QAAT,CAAkB,CAAlB,EAAqB,CAAC,CAAtB,CAAZ,CAAP;UACD;QACF;;QAED,MAAM,IAAI7K,KAAJ,CAAU,iCAAV,CAAN;MACD,CAhCD;;MAAA;QAAA;MAAA;IAAA;EAiCD;;AA5HwB;;;;;;;;;;;;;;;;;;;;;;;;;;ACjEzB;AACA;AAUA;AAEA;AAEA;AAEA;AAuBO,MAAMuL,gBAAgB,GAAG,UAAzB;;AAEP,MAAMC,gBAAgB;EAAA,2MAAG,WACvB3H,OADuB,EAEC;IACxB,MAAMjI,QAAQ,SAASiI,OAAO,CAACU,OAAR,CACrBgH,gBADqB,CAAvB;IAIA,OAAO;MACLE,MAAM,EAAE,IAAI3B,wDAAJ,EADH;MAEL4B,aAAa,EAAE,EAFV;MAGL9P,QAAQ,EAAEA,QAAQ,IAAI;IAHjB,CAAP;EAKD,CAZqB;;EAAA,gBAAhB4P,gBAAgB;IAAA;EAAA;AAAA,GAAtB;;AAcA,MAAMG,MAAM;EAAA,4MAA2C,WAAO;IAC5DlO,OAD4D;IAE5D/B,KAF4D;IAG5DgC,QAH4D;IAI5D4F,MAJ4D;IAK5DO,OAL4D;IAM5D/I;EAN4D,CAAP,EAOlD;IACH,MAAM8Q,MAAM,SAASJ,gBAAgB,CAAC3H,OAAD,CAArC;;IAEA,MAAMgI,MAAM,GAAW;MACrBC,SAAS,EAAE,MAAK;QACd,MAAM,IAAI9L,KAAJ,CAAU,iBAAV,CAAN;MACD,CAHoB;MAIrB+L,YAAY;QAAA,4MAAE,WAAOlQ,SAAP,EAAoB;UAChC,MAAME,OAAO,GAAG6P,MAAM,CAAChQ,QAAP,CAAgBE,IAAhB,CAAsBkQ,CAAD,IAAOA,CAAC,CAACnQ,SAAF,KAAgBA,SAA5C,CAAhB;;UAEA,IAAI,CAACE,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,uCAAV,CAAN;UACD;;UAED,OAAOrD,6DAAA,CAAqBZ,OAAO,CAACmQ,SAA7B,CAAP;QACD,CARW;;QAAA;UAAA;QAAA;MAAA,GAJS;MAarBC,WAAW;QAAA,4MAAE,WAAOrM,OAAP,EAAgBjE,SAAhB,EAA6B;UACxC,MAAME,OAAO,GAAG6P,MAAM,CAAChQ,QAAP,CAAgBE,IAAhB,CAAsBkQ,CAAD,IAAOA,CAAC,CAACnQ,SAAF,KAAgBA,SAA5C,CAAhB;;UAEA,IAAI,CAACE,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,oCAAV,CAAN;UACD;;UAED,MAAMoM,SAAS,SAASR,MAAM,CAACH,MAAP,CAAcY,IAAd,CAAmB;YACzCnO,IAAI,EAAE4B,OADmC;YAEzCkJ,cAAc,EAAEjN,OAAO,CAACiN;UAFiB,CAAnB,CAAxB;UAKA,OAAO;YACLoD,SADK;YAELF,SAAS,EAAEvP,6DAAA,CAAqBZ,OAAO,CAACmQ,SAA7B;UAFN,CAAP;QAID,CAhBU;;QAAA;UAAA;QAAA;MAAA;IAbU,CAAvB;;IAgCA,MAAM/H,WAAW,GAAG,MAAqB;MACvC,OAAOyH,MAAM,CAAChQ,QAAP,CAAgBiB,GAAhB,CAAqByC,CAAD,KAAQ;QACjCzD,SAAS,EAAEyD,CAAC,CAACzD;MADoB,CAAR,CAApB,CAAP;IAGD,CAJD;;IAMA,MAAMyQ,OAAO,GAAG,MAAK;MACnBV,MAAM,CAACF,aAAP,CAAqBa,OAArB,CAA8BtM,YAAD,IAAkBA,YAAY,CAACoK,MAAb,EAA/C;;MAEAuB,MAAM,CAACF,aAAP,GAAuB,EAAvB;MACAE,MAAM,CAAChQ,QAAP,GAAkB,EAAlB;MAEAiI,OAAO,CAACY,UAAR,CAAmB8G,gBAAnB;IACD,CAPD;;IASA,MAAMjN,OAAO;MAAA,4MAAG,aAAW;QACzB,IAAIsN,MAAM,CAACH,MAAP,CAAce,WAAd,EAAJ,EAAiC;UAC/B,MAAMZ,MAAM,CAACH,MAAP,CAAcgB,UAAd,GAA2BrS,KAA3B,CAAkCC,GAAD,IAAQ;YAC7CiJ,MAAM,CAAC9E,GAAP,CAAW,6BAAX;YACA8E,MAAM,CAAC/I,KAAP,CAAaF,GAAb;UACD,CAHK,CAAN;QAID;;QAEDiS,OAAO;MACR,CATY;;MAAA,gBAAPhO,OAAO;QAAA;MAAA;IAAA,GAAb;;IAWA,MAAMoO,mBAAmB;MAAA,4MAAG,aAAW;QACrC,IAAId,MAAM,CAACH,MAAP,CAAce,WAAd,EAAJ,EAAiC;UAC/B;QACD;;QAED,MAAMZ,MAAM,CAACH,MAAP,CAAckB,OAAd,EAAN;MACD,CANwB;;MAAA,gBAAnBD,mBAAmB;QAAA;MAAA;IAAA,GAAzB;;IAQA,MAAME,iBAAiB,GAAG,CAAC;MACzB/Q,SADyB;MAEzBqQ;IAFyB,CAAD,KAGI;MAC5B5I,MAAM,CAAC9E,GAAP,CAAW,mBAAX,EAAgC;QAAE3C,SAAF;QAAaqQ;MAAb,CAAhC;MAEA,OAAOxO,QAAQ,CAACmP,aAAT,CAAuB;QAAEhR,SAAF;QAAaqQ;MAAb,CAAvB,EAAiDjO,IAAjD,CACJ6O,SAAD,IAAc;QACZxJ,MAAM,CAAC9E,GAAP,CAAW,6BAAX,EAA0C;UAAEsO;QAAF,CAA1C;;QAEA,IAAIA,SAAS,CAACC,UAAV,KAAyB,YAA7B,EAA2C;UACzC,MAAM,IAAI/M,KAAJ,CAAU,6CAAV,CAAN;QACD;;QAED,OAAO8M,SAAP;MACD,CATI,EAUJzS,GAAD,IAAQ;QACN,IAAIA,GAAG,CAACwG,IAAJ,KAAa,uBAAjB,EAA0C;UACxC,OAAO,IAAP;QACD;;QAED,MAAMxG,GAAN;MACD,CAhBI,CAAP;IAkBD,CAxBD;;IA0BA,MAAM2S,qBAAqB,GACzB5L,YAD4B,IAEN;MACtB,MAAM;QAAEX;MAAF,IAAe/E,KAAK,CAACC,QAAN,EAArB;;MAEA,IAAI,CAAC8E,QAAL,EAAe;QACb,MAAM,IAAIT,KAAJ,CAAU,sBAAV,CAAN;MACD;;MAED,MAAMjE,OAAO,GAAGuP,4EAAgB,CAAC5P,KAAK,CAACC,QAAN,EAAD,CAAhC;;MAEA,IAAI,CAACI,OAAL,EAAc;QACZ,MAAM,IAAIiE,KAAJ,CAAU,mBAAV,CAAN;MACD;;MAED,OAAOoB,YAAY,CAACvE,GAAb,CAAkBoQ,WAAD,IAAgB;QACtC,OAAO;UACLtM,QAAQ,EAAEsM,WAAW,CAACtM,QAAZ,IAAwB5E,OAAO,CAACF,SADrC;UAEL0F,UAAU,EAAE0L,WAAW,CAAC1L,UAAZ,IAA0Bd,QAAQ,CAACjF,UAF1C;UAGLoF,OAAO,EAAEqM,WAAW,CAACrM;QAHhB,CAAP;MAKD,CANM,CAAP;IAOD,CAtBD;;IAwBA,OAAO;MACCxC,MAAN,CAAa;QAAExC;MAAF,CAAb,EAAyB;QAAA;UACvB,MAAMsR,gBAAgB,GAAG/I,WAAW,EAApC;;UAEA,IAAI+I,gBAAgB,CAAC1N,MAArB,EAA6B;YAC3B,OAAO0N,gBAAP;UACD;;UAED,MAAMC,cAAc,GAAyB,EAA7C;;UAEA,KAAK,IAAI9L,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGzF,QAAQ,CAAC4D,MAA7B,EAAqC6B,CAAC,EAAtC,EAA0C;YACxC,MAAM;cAAE2H,cAAF;cAAkBnN,SAAlB;cAA6BqQ;YAA7B,IAA2CtQ,QAAQ,CAACyF,CAAD,CAAzD;YAEA,MAAMyL,SAAS,SAASF,iBAAiB,CAAC;cAAE/Q,SAAF;cAAaqQ;YAAb,CAAD,CAAzC;;YAEA,IAAI,CAACY,SAAL,EAAgB;cACd,MAAM,IAAI9M,KAAJ,CACJ,kDAAkDnE,SAAS,IADvD,CAAN;YAGD;;YAEDsR,cAAc,CAAC7L,IAAf,CAAoB;cAClBzF,SADkB;cAElBmN,cAFkB;cAGlBkD;YAHkB,CAApB;UAKD;;UAED,MAAMrI,OAAO,CAACsB,OAAR,CAAgBoG,gBAAhB,EAAkC4B,cAAlC,CAAN;UACAvB,MAAM,CAAChQ,QAAP,GAAkBuR,cAAlB;UAEA,OAAOhJ,WAAW,EAAlB;QA9BuB;MA+BxB,CAhCI;;MAkCL7F,OAlCK;;MAoCC6F,WAAN,GAAiB;QAAA;UACf,OAAOA,WAAW,EAAlB;QADe;MAEhB,CAtCI;;MAwCCtE,WAAN,CAAkB;QAAEC;MAAF,CAAlB,EAA6B;QAAA;UAC3BwD,MAAM,CAAC9E,GAAP,CAAW,oBAAX,EAAiC;YAAEsB;UAAF,CAAjC;UAEA,MAAM,IAAIE,KAAJ,CAAU,2BAA2BlF,QAAQ,CAACC,IAAI,EAAlD,CAAN;QAH2B;MAI5B,CA5CI;;MA8CC2F,sBAAN,CAA6B;QAAEC,QAAF;QAAYY,UAAZ;QAAwBX;MAAxB,CAA7B,EAA8D;QAAA;UAC5D0C,MAAM,CAAC9E,GAAP,CAAW,wBAAX,EAAqC;YAAEmC,QAAF;YAAYY,UAAZ;YAAwBX;UAAxB,CAArC;;UAEA,IAAI,CAACgL,MAAM,CAAChQ,QAAP,CAAgB4D,MAArB,EAA6B;YAC3B,MAAM,IAAIQ,KAAJ,CAAU,sBAAV,CAAN;UACD,CAL2D,CAO5D;;;UACA,MAAM0M,mBAAmB,EAAzB;UAEA,MAAMU,kBAAkB,SAAS/B,oFAAgB,CAC/C2B,qBAAqB,CAAC,CAAC;YAAErM,QAAF;YAAYY,UAAZ;YAAwBX;UAAxB,CAAD,CAAD,CAD0B,EAE/CiL,MAF+C,EAG/CpO,OAAO,CAAC/C,OAHuC,CAAjD;UAMA,OAAOgD,QAAQ,CAAC2P,eAAT,CAAyBD,kBAAkB,CAAC,CAAD,CAA3C,CAAP;QAhB4D;MAiB7D,CA/DI;;MAiEC5L,uBAAN,CAA8B;QAAEJ;MAAF,CAA9B,EAA8C;QAAA;UAC5CkC,MAAM,CAAC9E,GAAP,CAAW,yBAAX,EAAsC;YAAE4C;UAAF,CAAtC;;UAEA,IAAI,CAACwK,MAAM,CAAChQ,QAAP,CAAgB4D,MAArB,EAA6B;YAC3B,MAAM,IAAIQ,KAAJ,CAAU,sBAAV,CAAN;UACD,CAL2C,CAO5C;;;UACA,MAAM0M,mBAAmB,EAAzB;UAEA,MAAMU,kBAAkB,SAAS/B,oFAAgB,CAC/C2B,qBAAqB,CAAC5L,YAAD,CAD0B,EAE/CyK,MAF+C,EAG/CpO,OAAO,CAAC/C,OAHuC,CAAjD;UAMA,MAAM4S,OAAO,GAAiC,EAA9C;;UAEA,KAAK,IAAIjM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+L,kBAAkB,CAAC5N,MAAvC,EAA+C6B,CAAC,EAAhD,EAAoD;YAClDiM,OAAO,CAAChM,IAAR,OAAmB5D,QAAQ,CAAC2P,eAAT,CAAyBD,kBAAkB,CAAC/L,CAAD,CAA3C,CAAnB;UACD;;UAED,OAAOiM,OAAP;QAtB4C;MAuB7C,CAxFI;;MAyFCvB,YAAN,CAAmB/C,cAAnB,EAAyC;QAAA;UACvC,MAAM0D,mBAAmB,EAAzB;UAEA,aAAad,MAAM,CAACH,MAAP,CAAcM,YAAd,CAA2B;YAAE/C;UAAF,CAA3B,CAAb;QAHuC;MAIxC;;IA7FI,CAAP;EA+FD,CA7NW;;EAAA,gBAAN2C,MAAM;IAAA;EAAA;AAAA,GAAZ;;AA+NM,SAAUtD,WAAV,CAAsB;EAC1BkF,OAAO,GAAGjS,6CADgB;EAE1BkS,UAAU,GAAG;AAFa,IAGV,EAHZ,EAGc;EAClB,oNAAO,aAAW;IAChB,MAAMC,MAAM,GAAGrC,mDAAQ,EAAvB;IACA,MAAMsC,SAAS,GAAG/D,iEAAiB,EAAnC;;IAEA,IAAI8D,MAAJ,EAAY;MACV,OAAO,IAAP;IACD;;IAED,OAAO;MACLxJ,EAAE,EAAE,QADC;MAELpD,IAAI,EAAE,UAFD;MAGL/F,QAAQ,EAAE;QACRC,IAAI,EAAE,QADE;QAERC,WAAW,EACT,8DAHM;QAIRuS,OAJQ;QAKRC,UALQ;QAMRzH,SAAS,EAAE2H;MANH,CAHL;MAWL1H,IAAI,EAAE2F;IAXD,CAAP;EAaD,CArBD;AAsBD;;;;;;;;;;;;;;;;ACjTmD;;;;;;;;;;;;;;;;ACApD,iEAAe,4tQAA4tQ,EAAC;;;;;;;;;;;;;;;;;;;;;;;ACA5uQ;AASA;AACA;AAEA;AAEA;;AAiBA,MAAMgC,WAAW,GAAG,MAAK;EACvB,OAAO7K,mEAAO,CAAC,MAAM,CAAC,CAAC5G,MAAM,CAAC0R,aAAhB,CAAP,CAAsCxT,KAAtC,CAA4C,MAAM,KAAlD,CAAP;AACD,CAFD;;AAIA,MAAMyT,oBAAoB,GAAG,MAAsB;EACjD,MAAMtP,MAAM,GAAGrC,MAAM,CAAC0R,aAAtB;EAEA,OAAO;IACLrP;EADK,CAAP;AAGD,CAND;;AAQA,MAAMuP,UAAU;EAAA,2MAA2C,WAAO;IAChEhT,QADgE;IAEhE2C,OAFgE;IAGhE/B,KAHgE;IAIhEgC,QAJgE;IAKhE4F;EALgE,CAAP,EAMtD;IACH,MAAMsI,MAAM,GAAGiC,oBAAoB,EAAnC;;IAEA,MAAM1J,WAAW,GAAG,MAAqB;MACvC,MAAMpI,OAAO,GAAG6P,MAAM,CAACrN,MAAP,CAAcsN,MAAd,CAAqB9P,OAArC;;MAEA,IAAI,CAACA,OAAL,EAAc;QACZ,OAAO,EAAP;MACD;;MAED,OAAO,CAAC;QAAEF,SAAS,EAAEE,OAAO,CAACF;MAArB,CAAD,CAAP;IACD,CARD;;IAUA,MAAMmR,qBAAqB,GACzB5L,YAD4B,IAEN;MACtB,MAAM;QAAEX;MAAF,IAAe/E,KAAK,CAACC,QAAN,EAArB;;MAEA,IAAI,CAAC8E,QAAL,EAAe;QACb,MAAM,IAAIT,KAAJ,CAAU,sBAAV,CAAN;MACD;;MAED,MAAMjE,OAAO,GAAGuP,4EAAgB,CAAC5P,KAAK,CAACC,QAAN,EAAD,CAAhC;;MAEA,IAAI,CAACI,OAAL,EAAc;QACZ,MAAM,IAAIiE,KAAJ,CAAU,mBAAV,CAAN;MACD;;MAED,OAAOoB,YAAY,CAACvE,GAAb,CAAkBoQ,WAAD,IAAgB;QACtC,OAAO;UACLtM,QAAQ,EAAEsM,WAAW,CAACtM,QAAZ,IAAwB5E,OAAO,CAACF,SADrC;UAEL0F,UAAU,EAAE0L,WAAW,CAAC1L,UAAZ,IAA0Bd,QAAQ,CAACjF,UAF1C;UAGLoF,OAAO,EAAEqM,WAAW,CAACrM;QAHhB,CAAP;MAKD,CANM,CAAP;IAOD,CAtBD;;IAwBA,OAAO;MACCxC,MAAN,CAAa;QAAE5C;MAAF,CAAb,EAA2B;QAAA;UACzB,MAAM0R,gBAAgB,GAAG/I,WAAW,EAApC;;UAEA,IAAI+I,gBAAgB,CAAC1N,MAArB,EAA6B;YAC3B,OAAO0N,gBAAP;UACD;;UAED,MAAMtB,MAAM,CAACrN,MAAP,CAAcwP,KAAd,CAAoB;YAAEvS;UAAF,CAApB,CAAN;UAEA,OAAO2I,WAAW,EAAlB;QATyB;MAU1B,CAXI;;MAaC7F,OAAN,GAAa;QAAA;UACX;UACA,MAAMsN,MAAM,CAACrN,MAAP,CAAcyP,MAAd,EAAN;QAFW;MAGZ,CAhBI;;MAkBC7J,WAAN,GAAiB;QAAA;UACf,OAAOA,WAAW,EAAlB;QADe;MAEhB,CApBI;;MAsBCtE,WAAN,CAAkB;QAAEC;MAAF,CAAlB,EAA6B;QAAA;UAC3BwD,MAAM,CAAC9E,GAAP,CAAW,wBAAX,EAAqC;YAAEsB;UAAF,CAArC;UAEA,MAAM/D,OAAO,GAAGuP,4EAAgB,CAAC5P,KAAK,CAACC,QAAN,EAAD,CAAhC;;UAEA,IAAI,CAACI,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,mBAAV,CAAN;UACD;;UAED,MAAMnE,SAAS,GAAGE,OAAO,CAACF,SAA1B;UACA,MAAMoS,MAAM,SAASrC,MAAM,CAACrN,MAAP,CAAcsN,MAAd,CAAqBE,YAArB,CAAkClQ,SAAlC,CAArB;UACA,MAAMqS,KAAK,SAASxQ,QAAQ,CAACwQ,KAAT,CAAe;YAAEnQ,QAAQ,EAAE;UAAZ,CAAf,CAApB;UAEA,MAAMG,IAAI,GAAG;YACXrC,SADW;YAEXiE,OAFW;YAGXqO,OAAO,EAAED,KAAK,CAACE,MAAN,CAAaC,IAHX;YAIXnC,SAAS,EAAEnN,MAAM,CAACC,IAAP,CAAYiP,MAAM,CAAC/P,IAAnB,EAAyBgB,QAAzB,CAAkC,QAAlC,CAJA;YAKXoP,OAAO,EAAEL,MAAM,CAACK;UALL,CAAb;UAOA,MAAMC,OAAO,GAAG1P,IAAI,CAACkB,SAAL,CAAe7B,IAAf,CAAhB,CApB2B,CAsB3B;;UACA,MAAM,IAAI8B,KAAJ,CAAU,2BAA2BlF,QAAQ,CAACC,IAAI,EAAlD,CAAN;UAEA,MAAMyT,MAAM,SAAS5C,MAAM,CAACrN,MAAP,CAAcsN,MAAd,CAAqBM,WAArB,CACnB,IAAIsC,UAAJ,CAAe1P,MAAM,CAACC,IAAP,CAAYuP,OAAZ,CAAf,CADmB,EAEnB1S,SAFmB,EAGnB4B,OAAO,CAAC/C,OAAR,CAAgB+K,SAHG,CAArB;UAMA,uCACKvH,IADL,GACS;YACPkO,SAAS,EAAErN,MAAM,CAACC,IAAP,CAAYwP,MAAM,CAACpC,SAAnB,EAA8BlN,QAA9B,CAAuC,QAAvC,CADJ;YAEPoP,OAAO,EAAEE,MAAM,CAACtC,SAAP,CAAiBoC;UAFnB,CADT;QA/B2B;MAoC5B,CA1DI;;MA4DC5N,sBAAN,CAA6B;QAAEC,QAAF;QAAYY,UAAZ;QAAwBX;MAAxB,CAA7B,EAA8D;QAAA;UAC5D0C,MAAM,CAAC9E,GAAP,CAAW,wBAAX,EAAqC;YAAEmC,QAAF;YAAYY,UAAZ;YAAwBX;UAAxB,CAArC;UACA,MAAMwM,kBAAkB,SAAS/B,oFAAgB,CAC/C2B,qBAAqB,CAAC,CAAC;YAAErM,QAAF;YAAYY,UAAZ;YAAwBX;UAAxB,CAAD,CAAD,CAD0B,EAE/CgL,MAAM,CAACrN,MAAP,CAAcsN,MAFiC,EAG/CpO,OAAO,CAAC/C,OAHuC,CAAjD;UAMA,OAAOgD,QAAQ,CAAC2P,eAAT,CAAyBD,kBAAkB,CAAC,CAAD,CAA3C,CAAP;QAR4D;MAS7D,CArEI;;MAuEC5L,uBAAN,CAA8B;QAAEJ;MAAF,CAA9B,EAA8C;QAAA;UAC5CkC,MAAM,CAAC9E,GAAP,CAAW,yBAAX,EAAsC;YAAE4C;UAAF,CAAtC;UAEA,MAAMgM,kBAAkB,SAAS/B,oFAAgB,CAC/C2B,qBAAqB,CAAC5L,YAAD,CAD0B,EAE/CwK,MAAM,CAACrN,MAAP,CAAcsN,MAFiC,EAG/CpO,OAAO,CAAC/C,OAHuC,CAAjD;UAMA4I,MAAM,CAAC9E,GAAP,CACE,4CADF,EAEE4O,kBAFF;UAKA,MAAME,OAAO,GAAiC,EAA9C;;UAEA,KAAK,IAAIjM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+L,kBAAkB,CAAC5N,MAAvC,EAA+C6B,CAAC,EAAhD,EAAoD;YAClDiM,OAAO,CAAChM,IAAR,OAAmB5D,QAAQ,CAAC2P,eAAT,CAAyBD,kBAAkB,CAAC/L,CAAD,CAA3C,CAAnB;UACD;;UAED,OAAOiM,OAAP;QApB4C;MAqB7C;;IA5FI,CAAP;EA8FD,CAzIe;;EAAA,gBAAVQ,UAAU;IAAA;EAAA;AAAA,GAAhB;;AA2IO,MAAMvU,eAAe,GAAG,CAAC;EAC9BgU,OAAO,GAAGjS,6CADoB;EAE9BkS,UAAU,GAAG;AAFiB,IAGV,EAHS,KAGkC;EAC/D,oNAAO,aAAW;IAChB,MAAMC,MAAM,GAAGrC,mDAAQ,EAAvB;IACA,MAAMsD,SAAS,SAASf,WAAW,EAAnC;;IAEA,IAAIF,MAAJ,EAAY;MACV,OAAO,IAAP;IACD;;IAED,OAAO;MACLxJ,EAAE,EAAE,aADC;MAELpD,IAAI,EAAE,UAFD;MAGL/F,QAAQ,EAAE;QACRC,IAAI,EAAE,aADE;QAERC,WAAW,EAAE,sCAFL;QAGRuS,OAHQ;QAIRoB,WAAW,EACT,wFALM;QAMRnB,UANQ;QAORzH,SAAS,EAAE2I;MAPH,CAHL;MAYL1I,IAAI,EAAE8H;IAZD,CAAP;EAcD,CAtBD;AAuBD,CA3BM;;;;;;;;;;;;;;;;ACtLiD;;;;;;;;;;;;;;;;ACAxD,iEAAe,o+dAAo+d,EAAC;;;;;;;;;;;;;;;;;;;;;;;;ACAp/d;AAcA;AAQA;AACA;;AAEA,MAAMoB,gBAAgB;EAAA,2MAAG,WACvBpO,MADuB,EAEvBpG,OAFuB,EAGO;IAC9B,MAAMyU,QAAQ,GAAG,IAAIP,8EAAJ,CACf1S,MAAM,CAACmT,YADQ,EAEf,gBAFe,CAAjB;IAKA,MAAMC,IAAI,SAAS3C,oDAAO;MACxBwC;IADwB,GAErBzU,OAFqB,GAEd;MACV6U,OAAO,EAAE;IADC,CAFc,EAA1B;IAMA,MAAMhR,MAAM,GAAG,IAAIyQ,2DAAJ,CAAoB;MAAEM,IAAF;MAAQE,YAAY,EAAE;IAAtB,CAApB,CAAf;IAEA,OAAO;MACLjR,MADK;MAEL4Q;IAFK,CAAP;EAID,CArBqB;;EAAA,gBAAhBD,gBAAgB;IAAA;EAAA;AAAA,GAAtB;;AAuBA,MAAMO,0BAA0B;EAAA,4MAG5B,WAAO;IAAEhS,OAAF;IAAW6F,MAAX;IAAmB5H,KAAnB;IAA0BoF;EAA1B,CAAP,EAA6C;IAC/C,MAAM8K,MAAM,SAASsD,gBAAgB,CAACpO,MAAD,EAASrD,OAAO,CAAC/C,OAAjB,CAArC;;IAEA,MAAM4R,OAAO,GAAG,MAAK;MACnBV,MAAM,CAACuD,QAAP,CAAgBO,KAAhB;IACD,CAFD;;IAIA,MAAMvL,WAAW,GAAG,MAAK;MACvB,MAAMtI,SAAS,GAAG+P,MAAM,CAACrN,MAAP,CAAcoR,YAAd,EAAlB;;MAEA,IAAI,CAAC9T,SAAL,EAAgB;QACd,OAAO,EAAP;MACD;;MAED,OAAO,CAAC;QAAEA;MAAF,CAAD,CAAP;IACD,CARD;;IAUA,MAAMmR,qBAAqB;MAAA,4MAAG,WAC5B5L,YAD4B,EAE1B;QACF,MAAMrF,OAAO,GAAG6P,MAAM,CAACrN,MAAP,CAAcxC,OAAd,EAAhB;;QACA,MAAM;UAAE0J,SAAF;UAAaoG,MAAb;UAAqBnO;QAArB,IAAkC3B,OAAO,CAAC6T,UAAhD;QAEA,MAAMC,QAAQ,SAAShE,MAAM,CAACE,YAAP,CAAoBhQ,OAAO,CAACF,SAA5B,EAAuC4J,SAAvC,CAAvB;;QAEA,KAAK,MAAMqK,GAAX,IAAkB1O,YAAlB,EAAgC;UAC9B,IAAI0O,GAAG,CAACnP,QAAJ,KAAiB5E,OAAO,CAACF,SAA7B,EAAwC;YACtC,MAAM,IAAImE,KAAJ,CACJ,+EADI,CAAN;UAGD;QACF;;QAED,OAAO5C,OAAO,CAACC,GAAR,CACL+D,YAAY,CAACvE,GAAb;UAAA,4MAAiB,WAAOoQ,WAAP,EAAoB8C,KAApB,EAA6B;YAC5C,MAAMnP,OAAO,GAAGqM,WAAW,CAACrM,OAAZ,CAAoB/D,GAApB,CAAyB8J,MAAD,IACtCsI,gFAAY,CAACtI,MAAD,CADE,CAAhB;YAGA,MAAMmG,SAAS,SAAS/Q,OAAO,CAACiU,uBAAR,CACtB/C,WAAW,CAAC1L,UADU,EAEtBX,OAFsB,EAGtBiP,QAHsB,CAAxB;;YAMA,IAAI,CAAC/C,SAAL,EAAgB;cACd,MAAM,IAAI9M,KAAJ,CACJ,uDAAuDiN,WAAW,CAAC1L,UAAU,EADzE,CAAN;YAGD;;YAED,MAAM2M,KAAK,SAASxQ,QAAQ,CAACwQ,KAAT,CAAe;cAAEnQ,QAAQ,EAAE;YAAZ,CAAf,CAApB;YAEA,OAAO8Q,uEAAA,CACL9S,OAAO,CAACF,SADH,EAELc,6DAAA,CAAqBmQ,SAAS,CAACoD,UAA/B,CAFK,EAGLjD,WAAW,CAAC1L,UAHP,EAILuL,SAAS,CAACqD,UAAV,CAAqBC,KAArB,GAA6BL,KAA7B,GAAqC,CAJhC,EAKLnP,OALK,EAMLjE,oEAAA,CAA4BuR,KAAK,CAACE,MAAN,CAAaC,IAAzC,CANK,CAAP;UAQD,CA1BD;;UAAA;YAAA;UAAA;QAAA,IADK,CAAP;MA6BD,CA7C0B;;MAAA,gBAArBrB,qBAAqB;QAAA;MAAA;IAAA,GAA3B;;IA+CA,OAAO;MACC5O,MAAN,CAAa;QAAE5C,UAAF;QAAcwJ,WAAW,GAAG;MAA5B,CAAb,EAA6C;QAAA;UAC3C1B,MAAM,CAAC9E,GAAP,CAAW,qBAAX,EAAkC;YAChChD,UADgC;YAEhCwJ;UAFgC,CAAlC;;UAKA,IAAIA,WAAW,CAACxF,MAAhB,EAAwB;YACtB,MAAMoM,MAAM,CAACrN,MAAP,CAAc+R,aAAd,CAA4B;cAChCC,OAAO,EAAEvL,WADuB;cAEhCnE,IAAI,EAAEiO,uFAF0B;cAGhC2B,WAAW,EAAEjV;YAHmB,CAA5B,CAAN;UAKD,CAND,MAMO;YACL,MAAMoQ,MAAM,CAACrN,MAAP,CAAc+R,aAAd,CAA4B;cAChCzP,IAAI,EAAEiO,kFAD0B;cAEhC2B,WAAW,EAAEjV;YAFmB,CAA5B,CAAN;UAID;;UAED,OAAO2I,WAAW,EAAlB;QAnB2C;MAoB5C,CArBI;;MAuBC7F,OAAN,GAAa;QAAA;UACX,IAAIsN,MAAM,CAACrN,MAAP,CAAcwJ,UAAd,EAAJ,EAAgC;YAC9B,MAAM6D,MAAM,CAACrN,MAAP,CAAcD,OAAd,EAAN;UACD;;UAEDgO,OAAO;QALI;MAMZ,CA7BI;;MA+BCvE,UAAN,GAAgB;QAAA;UACd,IAAI,CAAC6D,MAAM,CAACrN,MAAZ,EAAoB;YAClB,OAAO,KAAP;UACD;;UAED,OAAOqN,MAAM,CAACrN,MAAP,CAAcwJ,UAAd,EAAP;QALc;MAMf,CArCI;;MAuCC5D,WAAN,GAAiB;QAAA;UACf,OAAOA,WAAW,EAAlB;QADe;MAEhB,CAzCI;;MA2CCtE,WAAN,CAAkB;QAAEC;MAAF,CAAlB,EAA6B;QAAA;UAC3BwD,MAAM,CAAC9E,GAAP,CAAW,0BAAX,EAAuC;YAAEsB;UAAF,CAAvC;UAEA,MAAMqL,QAAQ,SAASS,MAAM,CAACrN,MAAP,CAAcsB,WAAd,CAA0B;YAC/CC;UAD+C,CAA1B,CAAvB;;UAIA,IAAIqL,QAAQ,CAACwF,OAAb,EAAsB;YACpB,OAAOxF,QAAQ,CAAC9F,OAAhB;UACD,CAFD,MAEO;YACL,MAAM,IAAIrF,KAAJ,CAAU,0BAA0BmL,QAAQ,CAACrL,OAAO,EAApD,CAAN;UACD;QAX0B;MAY5B,CAvDI;;MAyDCY,sBAAN,CAA6B;QAAEC,QAAF;QAAYY,UAAZ;QAAwBX;MAAxB,CAA7B,EAA8D;QAAA;UAC5D0C,MAAM,CAAC9E,GAAP,CAAW,qCAAX,EAAkD;YAChDmC,QADgD;YAEhDY,UAFgD;YAGhDX;UAHgD,CAAlD;UAMA,MAAM;YAAEH;UAAF,IAAe/E,KAAK,CAACC,QAAN,EAArB;;UAEA,IAAI,CAACiQ,MAAM,CAACrN,MAAP,CAAcwJ,UAAd,EAAL,EAAiC;YAC/B,MAAM,IAAI/H,KAAJ,CAAU,sBAAV,CAAN;UACD;;UAED,IAAI,CAACuB,UAAD,IAAe,CAACd,QAApB,EAA8B;YAC5B,MAAM,IAAIT,KAAJ,CAAU,8CAAV,CAAN;UACD;;UAED,MAAMjE,OAAO,GAAG6P,MAAM,CAACrN,MAAP,CAAcxC,OAAd,EAAhB;;UAEA,OAAOA,OAAO,CAAC,+BAAD,CAAP,CAAyC;YAC9CwF,UAAU,EAAEA,UAAU,SAAV,cAAU,WAAV,gBAAcd,QAAS,CAACjF,UADU;YAE9CoF,OAAO,EAAEA,OAAO,CAAC/D,GAAR,CAAa8J,MAAD,IAAYsI,gFAAY,CAACtI,MAAD,CAApC;UAFqC,CAAzC,CAAP;QAnB4D;MAuB7D,CAhFI;;MAkFCnF,uBAAN,CAA8B;QAAEJ;MAAF,CAA9B,EAA8C;QAAA;UAC5CkC,MAAM,CAAC9E,GAAP,CAAW,sCAAX,EAAmD;YACjD4C;UADiD,CAAnD;;UAIA,IAAI,CAACwK,MAAM,CAACrN,MAAP,CAAcwJ,UAAd,EAAL,EAAiC;YAC/B,MAAM,IAAI/H,KAAJ,CAAU,sBAAV,CAAN;UACD;;UAED,OAAO4L,MAAM,CAACrN,MAAP,CAAcqS,uBAAd,CAAsC;YAC3CxP,YAAY,QAAQ4L,qBAAqB,CAAC5L,YAAD;UADE,CAAtC,CAAP;QAT4C;MAY7C;;IA9FI,CAAP;EAgGD,CAnK+B;;EAAA,gBAA1BqO,0BAA0B;IAAA;EAAA;AAAA,GAAhC;;AAqKM,SAAUhW,iBAAV,CAA4B;EAChC8T,OAAO,GAAGjS,6CADsB;EAEhCkS,UAAU,GAAG;AAFmB,IAGD,EAH3B,EAG6B;EACjC,oNAAO,aAAW;IAChB,OAAO;MACLvJ,EAAE,EAAE,eADC;MAELpD,IAAI,EAAE,UAFD;MAGL/F,QAAQ,EAAE;QACRiL,SAAS,EAAE,IADH;QAERhL,IAAI,EAAE,eAFE;QAGRC,WAAW,EACT,8EAJM;QAKRuS,OALQ;QAMRC,UANQ;QAORmB,WAAW,EAAE;MAPL,CAHL;MAYL3I,IAAI,EAAGvI,OAAD,IAAY;QAChB,OAAOgS,0BAA0B,iCAC5BhS,OAD4B,GACrB;UACVqD,MAAM,EAAE;YACNyM;UADM;QADE,CADqB,EAAjC;MAMD;IAnBI,CAAP;EAqBD,CAtBD;AAuBD;;;;;;;;;;;;;;;;AChPwC;;;;;;;;;;;;;;;;;;;ACCsB;AACb;AACoB;AAE/D,SAAS,2BAA2B,CAAC,MAA2B;;IACrE,IAAI,CAAC,8CAAU,EAAE;QACf,OAAO;KACR;IAED,6DAAyB,GAAG,2DAAuB,CAAC;IAEpD,QAAQ,CAAC,aAAa,CAAC,cAAc,CAAE,CAAC,SAAS,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAyGnD,CAAC;IAEF,cAAQ,CAAC,cAAc,CAAC,iBAAiB,CAAC,0CAAE,gBAAgB,CAAC,OAAO,EAAE,GAAG,EAAE;QACzE,8DAAe,CAAC,MAAM,CAAC,CAAC;IAC1B,CAAC,CAAC,CAAC;IAEH,cAAQ;SACL,cAAc,CAAC,gCAAgC,CAAC,0CAC/C,gBAAgB,CAAC,OAAO,EAAE,GAAG,EAAE;QAC/B,mFAA2B,CAAC,MAAM,CAAC,CAAC;IACtC,CAAC,CAAC,CAAC;AACP,CAAC;;;;;;;;;;;;;;;;;;;;AC/HD;AACA;;AAEA,SAASwD,UAAT,CAAoB9L,MAApB,EAAuC;EACrC,IAAI,CAAC4L,8CAAL,EAAiB;IACf;EACD;;EAED,MAAM;IAAEpL;EAAF,IAAgBoL,uEAAtB;EACA,IAAI5V,GAAG,GAAG,EAAV;;EAEA,IAAIgK,MAAM,CAACpE,IAAP,KAAgB,UAApB,EAAgC;IAC9B5F,GAAG,GAAIgK,MAAsC,CAACnK,QAAvC,CAAgD6T,WAAvD;EACD,CAVoC,CAYrC;;;EACA,IAAI1J,MAAM,CAAChB,EAAP,KAAc,gBAAlB,EAAoC;IAClC,MAAM+M,SAAS,GAAGvL,SAAS,KAAK,SAAd,GAA0B,SAA1B,GAAsC,KAAxD;IACAxK,GAAG,GAAG,WAAW+V,SAAS,mBAA1B;EACD;;EAED,IAAI/L,MAAM,CAAChB,EAAP,KAAc,aAAlB,EAAiC;IAC/B,MAAM+M,SAAS,GAAGvL,SAAS,KAAK,SAAd,GAA0B,UAA1B,GAAuC,EAAzD;IACAxK,GAAG,GAAG,kBAAkB+V,SAAS,UAAjC;EACD;;EAED,IAAK/V,GAAG,KAAK,EAAR,IAAcgK,MAAM,CAACpE,IAAP,KAAgB,QAA/B,IAA4CoE,MAAM,CAACpE,IAAP,KAAgB,UAAhE,EAA4E;IAC1E;EACD;;EAED3E,MAAM,CAAC+U,IAAP,CAAYhW,GAAZ,EAAiB,QAAjB;AACD;;AAEM,SAAeiW,gBAAtB;EAAA;AAAA;;;sNAAO,aAA+B;;;IACpC,IAAI,CAACL,8CAAL,EAAiB;MACf;IACD;;IAEDM,QAAQ,CAACC,aAAT,CAAuB,cAAvB,EAAwCC,SAAxC,GAAoD;;;;;;;;;;;;;;;;;;;;;;;;;GAApD;;IA2BA,MAAMC,YAAY,GAAIC,IAAD,IAA2B;MAC9C,OAAOA,IAAI,CAAC1Q,IAAL,KAAc,QAAd,IAA0B0Q,IAAI,CAAC1Q,IAAL,KAAc,UAA/C;IACD,CAFD;;IAIA,MAAM2Q,eAAe,GAAGX,6DAAA,CAA0BS,YAA1B,EAAwC9H,KAAxC,CAA8C,CAA9C,EAAiD,CAAjD,CAAxB;;IAEA,KAAK,IAAInI,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmQ,eAAe,CAAChS,MAApC,EAA4C6B,CAAC,EAA7C,EAAiD;MAC/C,cAAQ,CAACqQ,cAAT,CAAwB,SAAxB,OAAkC,IAAlC,IAAkCzV,aAAlC,GAAkC,MAAlC,GAAkCA,GAAE0V,kBAAF,CAChC,WADgC,EAEhC;;;;iBAIWH,eAAe,CAACnQ,CAAD,CAAf,CAAmBvG,QAAnB,CAA4ByS,OAAO;iBACnCiE,eAAe,CAACnQ,CAAD,CAAf,CAAmBvG,QAAnB,CAA4BC,IAAI;;6BAEpByW,eAAe,CAACnQ,CAAD,CAAf,CAAmBvG,QAAnB,CAA4BC,IAAI;mCAEnDyW,eAAe,CAACnQ,CAAD,CAAf,CAAmBvG,QAAnB,CAA4BE,WAA5B,GACIwW,eAAe,CAACnQ,CAAD,CAAf,CAAmBvG,QAAnB,CAA4BE,WADhC,GAEI,EACN;;;yCAGiCwW,eAAe,CAACnQ,CAAD,CAAf,CAAmB4C,EAAE;;;CAjBxB,CAAlC;IAsBD;;IAEDyG,KAAK,CAAC1L,IAAN,CAAWmS,QAAQ,CAACS,gBAAT,CAA0B,aAA1B,CAAX,EAAqDrF,OAArD,CAA8DsF,MAAD,IAAW;MACtEA,MAAM,CAACC,gBAAP,CAAwB,OAAxB,EAAiC,MAAK;QACpC,IAAI,CAACjB,8CAAL,EAAiB;UACf;QACD;;QAED,MAAM5L,MAAM,GAAG4L,2DAAA,CAAyBkB,CAAD,IAAOA,CAAC,CAAC9N,EAAF,KAAS4N,MAAM,CAAC5N,EAA/C,CAAf;;QAEA,IAAI,CAACgB,MAAL,EAAa;UACX;QACD;;QAED8L,UAAU,CAAC9L,MAAD,CAAV;MACD,CAZD;IAaD,CAdD;IAgBA,cAAQ,CAACyM,cAAT,CAAwB,aAAxB,OAAsC,IAAtC,IAAsCM,aAAtC,GAAsC,MAAtC,GAAsCA,GAAEF,gBAAF,CAAmB,OAAnB,EAA4B,MAAK;MACrEhB,mEAAmB;IACpB,CAFqC,CAAtC;EAGD;;;;;;;;;;;;;;;;;;;;;;ACnHD;AAEA;AACA;AAEO,SAAeqB,gCAAtB;EAAA;AAAA;;;sOAAO,WACLlN,MADK,EAELrJ,QAFK,EAGLwW,gBAHK,EAG8C;;;IAEnDjB,QAAQ,CAACC,aAAT,CAAuB,cAAvB,EAAwCC,SAAxC,GAAoD;;;;;;;;;;+CAUPe,gBAAgB,CAAC5S,MAAM;;;;;;;;;;;;;;;;;GAVpE;;IA6BA,KAAK,IAAI6B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+Q,gBAAgB,CAAC5S,MAArC,EAA6C6B,CAAC,EAA9C,EAAkD;MAChD,cAAQ,CAACqQ,cAAT,CAAwB,UAAxB,OAAmC,IAAnC,IAAmCzV,aAAnC,GAAmC,MAAnC,GAAmCA,GAAE0V,kBAAF,CACjC,WADiC,EAEjC;;;oBAGcS,gBAAgB,CAAC/Q,CAAD,CAAhB,CAAoBxF,SAAS;;;OALV,CAAnC;IAUD;;IAED,cAAQ,CAAC6V,cAAT,CAAwB,aAAxB,OAAsC,IAAtC,IAAsCM,aAAtC,GAAsC,MAAtC,GAAsCA,GAAEF,gBAAF,CAAmB,OAAnB,EAA4B,MAAK;MACrEG,+EAAyB,CAAChN,MAAD,EAASrJ,QAAT,CAAzB;IACD,CAFqC,CAAtC;IAIA,cAAQ,CACL8V,cADH,CACkB,eADlB,OACkC,IADlC,IACkCW,aADlC,GACkC,MADlC,GACkCA,GAC9BP,gBAD8B,CACb,OADa,+MACJ,aAAW;MACrC,IAAI;QACF,IAAI,CAACjB,8CAAL,EAAiB;UACf;QACD;;QAED,MAAMtS,MAAM,SAAS0G,MAAM,CAAC1G,MAAP,EAArB;QACAA,MAAM,CAACH,MAAP,CAAc;UACZ5C,UAAU,EAAEqV,iEADA;UAEZ7L,WAAW,EAAE6L,kEAFD;UAGZjV,QAAQ,EAAEwW;QAHE,CAAd;QAMAvB,qFAAA,CAAkD,MAAlD;MACD,CAbD,CAaE,OAAOxW,GAAP,EAAY;QACZ,MAAM6X,qFAA4B,CAACjN,MAAD,EAAS5K,GAAT,CAAlC;MACD;IACF,CAlB+B,EADlC;EAoBD;;;;;;;;;;;;;;;;;;;;;;AC5ED;AAEA;AACA;AAEO,SAAe4X,yBAAtB;EAAA;AAAA;;;+NAAO,WACLhN,MADK,EAELrJ,QAFK,EAEsC;;;IAE3C,IAAI,CAACiV,8CAAL,EAAiB;MACf;IACD;;IAEDM,QAAQ,CAACC,aAAT,CAAuB,cAAvB,EAAwCC,SAAxC,GAAoD;;;;;;;;;;;;;;;;;;;wBAoB1CzV,QAAQ,CAAC4D,MACX;yFAC+EqR,mEAAA,CAC7E,CAAC,CAD4E,EAE7E,CAAC,CAF4E,CAG9E;;;;;;;;;;;GAzBT;;IAsCA,KAAK,IAAIxP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGzF,QAAQ,CAAC4D,MAA7B,EAAqC6B,CAAC,EAAtC,EAA0C;MACxC,cAAQ,CAACqQ,cAAT,CAAwB,UAAxB,OAAmC,IAAnC,IAAmCzV,aAAnC,GAAmC,MAAnC,GAAmCA,GAAE0V,kBAAF,CACjC,WADiC,EAEjC;;qCAGI/V,QAAQ,CAACyF,CAAD,CAAR,CAAYxF,SACd,2BAA2BD,QAAQ,CAACyF,CAAD,CAAR,CAAYxF,SAAS,KAChDwF,CAAC,KAAK,CAAN,GAAU,SAAV,GAAsB,EACxB;sBACgBzF,QAAQ,CAACyF,CAAD,CAAR,CAAYxF,SAAS,MAAMD,QAAQ,CAACyF,CAAD,CAAR,CAAYxF,SAAS;;;OAT/B,CAAnC;IAcD;;IAED,cAAQ,CACL6V,cADH,CACkB,+BADlB,OACkD,IADlD,IACkDM,aADlD,GACkD,MADlD,GACkDA,GAC9CF,gBAD8C,CAC7B,OAD6B,EACpB,MAAK;MAC/BW,mFAA2B,CAACxN,MAAD,CAA3B;IACD,CAH+C,CADlD;IAMA,cAAQ,CAACyM,cAAT,CAAwB,gBAAxB,OAAyC,IAAzC,IAAyCW,aAAzC,GAAyC,MAAzC,GAAyCA,GAAEP,gBAAF,CAAmB,OAAnB,EAA6BpQ,CAAD,IAAM;MACzEA,CAAC,CAACgR,cAAF;MAEA,MAAMC,oBAAoB,GAAGjI,KAAK,CAAC1L,IAAN,CAC3BmS,QAAQ,CAACS,gBAAT,CAA0B,uBAA1B,CAD2B,EAE3B/U,GAF2B,CAEtB+V,EAAD,IAASA,EAAuB,CAAC5Q,OAFV,CAA7B;MAIA,MAAM6Q,eAAe,GAAGjX,QAAQ,CAAC6V,MAAT,CACtB,CAACqB,QAAD,EAAWzR,CAAX,KAAiBsR,oBAAoB,CAACtR,CAAD,CADf,CAAxB;;MAIA,IAAIwR,eAAe,CAACrT,MAAhB,GAAyB,CAA7B,EAAgC;QAC9B;MACD;;MAED2S,6FAAgC,CAAClN,MAAD,EAASrJ,QAAT,EAAmBiX,eAAnB,CAAhC;IACD,CAhBwC,CAAzC;EAiBD;;;;;;;;;;;;;;;;;;;;AC3FD;AAEO,SAAeG,2BAAtB;EAAA;AAAA;;;iOAAO,WAA2C/N,MAA3C,EAAsE;;;IAC3EkM,QAAQ,CAACC,aAAT,CAAuB,cAAvB,EAAwCC,SAAxC,GAAoD;;;;;;;;;;;;;;;;;;;;;;;;;GAApD;IA2BA,cAAQ,CAACK,cAAT,CAAwB,aAAxB,OAAsC,IAAtC,IAAsCzV,aAAtC,GAAsC,MAAtC,GAAsCA,GAAE6V,gBAAF,CAAmB,OAAnB,EAA4B,MAAK;MACrEiB,mFAA2B,CAAC9N,MAAD,CAA3B;IACD,CAFqC,CAAtC;EAGD;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjCD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEM,SAAUwN,2BAAV,CAAsCxN,MAAtC,EAAiE;;;EACrE,IAAI,CAAC4L,8CAAL,EAAiB;IACf;EACD;;EAEDM,QAAQ,CAACC,aAAT,CAAuB,cAAvB,EAAwCC,SAAxC,GAAoD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAApD;EAgDA,MAAM8B,0BAA0B,GAAGhC,QAAQ,CAACO,cAAT,CACjC,uBADiC,CAAnC;EAIAyB,0BAA0B,CAACC,SAA3B,GAAuCvC,mEAAA,CACrC,CAAC,CADoC,EAErC,CAAC,CAFoC,CAAvC;EAKA,cAAQ,CACLa,cADH,CACkB,uBADlB,OAC0C,IAD1C,IAC0CzV,aAD1C,GAC0C,MAD1C,GAC0CA,GACtC6V,gBADsC,CACrB,OADqB,EACZ,MAAK;IAC/B,IAAI,CAACjB,8CAAL,EAAiB;MACf;IACD;;IAED,MAAMtR,SAAS,GAAGgK,QAAQ,CAAC4J,0BAA2B,CAACC,SAA7B,CAAR,GAAkD,CAApE;IACAvC,6DAAA,GACEA,mEAAA,CAAgC,CAAhC,EAAmC,CAAC,CAApC,IAAyCtR,SAAS,CAACL,QAAV,EAAzC,GAAgE,GADlE;IAEAiU,0BAA0B,CAACC,SAA3B,GAAuC7T,SAAS,CAACL,QAAV,EAAvC;EACD,CAVuC,CAD1C;EAaA,cAAQ,CACLwS,cADH,CACkB,uBADlB,OAC0C,IAD1C,IAC0CM,aAD1C,GAC0C,MAD1C,GAC0CA,GACtCF,gBADsC,CACrB,OADqB,EACZ,MAAK;IAC/B,IAAI,CAACjB,8CAAL,EAAiB;MACf;IACD;;IAED,MAAMtR,SAAS,GAAGgK,QAAQ,CAAC4J,0BAA2B,CAACC,SAA7B,CAAR,GAAkD,CAApE;IACAvC,6DAAA,GACEA,mEAAA,CAAgC,CAAhC,EAAmC,CAAC,CAApC,IAAyCtR,SAAS,CAACL,QAAV,EAAzC,GAAgE,GADlE;;IAEA,IAAIK,SAAS,IAAI,CAAjB,EAAoB;MAClB4T,0BAA0B,CAACC,SAA3B,GAAuC7T,SAAS,CAACL,QAAV,EAAvC;IACD;EACF,CAZuC,CAD1C;EAeA,cAAQ,CAACwS,cAAT,CAAwB,aAAxB,OAAsC,IAAtC,IAAsCW,aAAtC,GAAsC,MAAtC,GAAsCA,GAAEP,gBAAF,CAAmB,OAAnB,EAA4B,MAAK;IACrEiB,mFAA2B,CAAC9N,MAAD,CAA3B;EACD,CAFqC,CAAtC;EAIA,cAAQ,CACLyM,cADH,CACkB,aADlB,OACgC,IADhC,IACgC2B,aADhC,GACgC,MADhC,GACgCA,GAC5BvB,gBAD4B,CACX,OADW,+MACF,aAAW;IACrC,IAAI;MACF,MAAMvT,MAAM,SAAS0G,MAAM,CAAC1G,MAAP,EAArB;MACA2U,yEAAsB,CAACjO,MAAD,CAAtB;MACA,MAAMrJ,QAAQ,SAASqX,8DAAe,CAAC1U,MAAD,CAAtC;;MAEA,IAAI,CAAC3C,QAAD,IAAaA,QAAQ,CAAC4D,MAAT,GAAkB,CAAnC,EAAsC;QACpC,OAAOwT,mFAA2B,CAAC/N,MAAD,CAAlC;MACD;;MAED,IAAIrJ,QAAQ,CAAC4D,MAAT,KAAoB,CAAxB,EAA2B;QACzB2S,6FAAgC,CAAClN,MAAD,EAASrJ,QAAT,EAAmBA,QAAnB,CAAhC;MACD;;MAEDqW,+EAAyB,CAAChN,MAAD,EAASrJ,QAAT,CAAzB;IACD,CAdD,CAcE,OAAOvB,GAAP,EAAY;MACZ,MAAM6X,qFAA4B,CAACjN,MAAD,EAAS5K,GAAT,CAAlC;IACD;EACF,CAnB6B,EADhC;AAqBD;;;;;;;;;;;;;;;;;AC3HM,SAAeiZ,mBAAtB;EAAA;AAAA;;;yNAAO,WACLrO,SAAqC,IADhC,EACoC;IAEzCkM,QAAQ,CAACC,aAAT,CAAuB,cAAvB,EAAwCC,SAAxC,GAAoD;;;;;;;;;;;;;;;;wCAgBdpM,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEnK,QAAR,CAAiByS,OAAO,UAAUtI,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEnK,QAAR,CAAiBC,IAAI;wCACvDkK,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEnK,QAAR,CAAiBC,IAAI;;;;;GAjB3D;EAuBD;;;;;;;;;;;;;;;;;;;AC1BM,SAAemY,sBAAtB;EAAA;AAAA;;;4NAAO,WACLjO,SAAqC,IADhC,EACoC;IAEzCkM,QAAQ,CAACC,aAAT,CAAuB,cAAvB,EAAwCC,SAAxC,GAAoD;;;;;;;;;;;;;;;;wCAgBdpM,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEnK,QAAR,CAAiByS,OAAO,UAAUtI,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEnK,QAAR,CAAiBC,IAAI;wCACvDkK,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEnK,QAAR,CAAiBC,IAAI;;;;+DAIEkK,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEnK,QAAR,CAAiBC,IAAI;;;;;GArBlF;EA2BD;;;;;;;;;;;;;;;;;;;;AC/BD;AAEO,SAAemX,4BAAtB;EAAA;AAAA;;;kOAAO,WACLjN,MADK,EAEL5K,GAFK,EAEK;;;IAEV8W,QAAQ,CAACC,aAAT,CAAuB,cAAvB,EAAwCC,SAAxC,GAAoD;;;;;;;;;;;;;;;;wCAgBdpM,MAAM,CAACnK,QAAP,CAAgByS,OAAO,UAC3DtI,MAAM,CAACnK,QAAP,CAAgBC,IAClB;wCACsCkK,MAAM,CAACnK,QAAP,CAAgBC,IAAI;;;;;;;;;;;uBAWrCV,GAAG,IAAIA,GAAG,CAACyF,OAAX,GAAqBzF,GAAG,CAACyF,OAAzB,GAAmC,EAAE,OACxD,EAACmF,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEnK,QAAR,CAAiB0S,UAAlB,MAAgCvI,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEnK,QAAR,CAAiBiL,SAAjD,IACI,0CADJ,GAEI,EACN;;;;;;;GAlCA;IA2CA,cAAQ,CAAC2L,cAAT,CAAwB,cAAxB,OAAuC,IAAvC,IAAuCzV,aAAvC,GAAuC,MAAvC,GAAuCA,GAAE6V,gBAAF,CAAmB,OAAnB,EAA4B,MAAK;MACtEyB,8DAAe,CAACtO,MAAD,CAAf;IACD,CAFsC,CAAvC;EAGD;;;;;;;;;;;;;;;;;;ACpDqC;AAE/B,SAAS,wBAAwB,CACtC,MAIC;;IAED,IAAI,CAAC,8CAAU,EAAE;QACf,OAAO;KACR;IAED,QAAQ,CAAC,aAAa,CAAC,cAAc,CAAE,CAAC,SAAS,GAAG;;;;;;;;;;;;;;;;;;;;qBAoBjC,MAAM,CAAC,QAAQ,CAAC,OAAO,UAAU,MAAM,CAAC,QAAQ,CAAC,IAAI;eAC3D,MAAM,CAAC,QAAQ,CAAC,IAAI;;oCAEC,MAAM,CAAC,QAAQ,CAAC,IAAI;;6FAEqC,MAAM,CAAC,QAAQ,CAAC,IAAI;;;GAG9G,CAAC;IAEF,cAAQ;SACL,cAAc,CAAC,mBAAmB,CAAC,0CAClC,gBAAgB,CAAC,OAAO,EAAE,GAAG,EAAE;QAC/B,MAAM,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;IAC3B,CAAC,CAAC,CAAC;IAEL,cAAQ,CAAC,cAAc,CAAC,iBAAiB,CAAC,0CAAE,gBAAgB,CAAC,OAAO,EAAE,GAAG,EAAE;QACzE,IAAI,MAAM,CAAC,IAAI,KAAK,UAAU,EAAE;YAC9B,OAAO;SACR;QAED,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;IACrD,CAAC,CAAC,CAAC;AACL,CAAC;;;;;;;;;;;;;;;;;;;ACzDD;AAEO,SAAe6L,mBAAtB;EAAA;AAAA;;;yNAAO,aAAkC;;;IACvCK,QAAQ,CAACC,aAAT,CAAuB,cAAvB,EAAwCC,SAAxC,GAAoD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAApD;IAiDA,cAAQ,CACLK,cADH,CACkB,qBADlB,OACwC,IADxC,IACwCzV,aADxC,GACwC,MADxC,GACwCA,GACpC6V,gBADoC,CACnB,OADmB,EACV,MAAK;MAC/BZ,6DAAgB;IACjB,CAHqC,CADxC;IAMA,cAAQ,CACLQ,cADH,CACkB,4BADlB,OAC+C,IAD/C,IAC+CM,aAD/C,GAC+C,MAD/C,GAC+CA,GAC3CF,gBAD2C,CAC1B,OAD0B,EACjB,MAAK;MAC/BZ,6DAAgB;IACjB,CAH4C,CAD/C;EAKD;;;;;;;;;;;;;;;;;;;;;;;AC1D4C;AAMoB;AACA;AAEjE,MAAM,gBAAgB,GAAG,4BAA4B,CAAC;AAC/C,MAAM,uBAAuB,GAAG,mBAAmB,CAAC;AAE3D,IAAI,aAAa,GAA+B,IAAI,CAAC;AAW9C,IAAI,UAAU,GAAsB,IAAI,CAAC;AAEzC,SAAS,gBAAgB,CAAC,aAAyB;IACxD,UAAU,GAAG,aAAa,CAAC;AAC7B,CAAC;AAED,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;IACjC,MAAM,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IACzC,EAAE,CAAC,EAAE,GAAG,gBAAgB,CAAC;IACzB,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;CAC/B;AAEM,MAAM,UAAU,GAAG,CACxB,QAAwB,EACxB,OAAqB,EACA,EAAE;IACvB,UAAU,GAAG;QACX,SAAS,EAAE,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAE;QACrD,QAAQ;QACR,OAAO;QACP,KAAK,EAAE;YACL,IAAI,EAAE,eAAe;SACtB;QACD,OAAO,EAAE,EAAE;QACX,cAAc,EAAE,uBAAuB;KACxC,CAAC;IAEF,UAAU,CAAC,QAAQ,CAAC,KAAK,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,KAAK,EAAE,EAAE;QACvD,IAAI,CAAC,UAAU,EAAE;YACf,OAAO;SACR;QAED,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,IAAI,EAAE,EAAE;YACnC,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,KAAK,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE;gBAC5D,OAAO,CAAC,CAAC;aACV;YAED,OAAO,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;QAEH,UAAU,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;IACrC,CAAC,CAAC,CAAC;IAEH,MAAM,KAAK,GAAG,CAAC,CAAgB,EAAE,EAAE;QACjC,IAAI,CAAC,CAAC,GAAG,KAAK,QAAQ,EAAE;YACtB,IAAI,CAAC,UAAU,EAAE;gBACf,OAAO;aACR;YAED,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SAC3D;IACH,CAAC,CAAC;IACF,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;IAE1C,0DAAW,EAAE,CAAC;IAEd,IAAI,CAAC,aAAa,EAAE;QAClB,aAAa,GAAG;YACd,IAAI,EAAE,GAAG,EAAE;gBACT,IAAI,CAAC,UAAU,EAAE;oBACf,OAAO;iBACR;gBACD,0DAAW,EAAE,CAAC;gBACd,MAAM,gBAAgB,GACpB,UAAU,CAAC,QAAQ,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,gBAAgB,CAAC;gBACxD,IAAI,gBAAgB,EAAE;oBACpB,MAAM,MAAM,GAAG,UAAU,CAAC,OAAO,CAAC,IAAI,CACpC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,gBAAgB,CACjC,CAAC;oBACF,8EAAmB,CAAC,MAAM,CAAC,CAAC;iBAC7B;qBAAM;oBACL,8EAAmB,EAAE,CAAC;iBACvB;gBACD,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YACzD,CAAC;YACD,IAAI,EAAE,GAAG,EAAE;gBACT,IAAI,CAAC,UAAU,EAAE;oBACf,OAAO;iBACR;gBACD,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;YAC5D,CAAC;SACF,CAAC;KACH;IAED,OAAO,aAAa,CAAC;AACvB,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3GF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAMA,MAAMuC,aAAa;EAAA,2MAAG,WAAOvH,SAAP,EAAoD;IACxE,IAAI,CAAC2E,8CAAL,EAAiB;MACf,OAAO,EAAP;IACD;;IAED,MAAM1F,QAAQ,SAASuI,KAAK,CAC1B,GAAG7C,kFAA8C,sBAAsB3E,SAAS,WADtD,CAA5B;;IAIA,IAAI,CAACf,QAAQ,CAACyI,EAAd,EAAkB;MAChB,MAAM,IAAI5T,KAAJ,CAAU,0CAAV,CAAN;IACD;;IAED,MAAM6T,UAAU,SAAS1I,QAAQ,CAAC2I,IAAT,EAAzB;;IAEA,IAAI,CAACpJ,KAAK,CAACqJ,OAAN,CAAcF,UAAd,CAAD,IAA8B,CAACA,UAAU,CAACrU,MAA9C,EAAsD;MACpD,OAAO,EAAP;IACD;;IAED,OAAOqU,UAAP;EACD,CApBkB;;EAAA,gBAAbJ,aAAa;IAAA;EAAA;AAAA,GAAnB;;AAsBO,MAAMR,eAAe;EAAA,4MAAG,WAC7B1U,MAD6B,EAEwB;IACrD,IAAI,CAACsS,8CAAL,EAAiB;MACf,OAAO,EAAP;IACD;;IAED,MAAM3E,SAAS,SAAU3N,MAAyB,CAACwN,YAA1B,CACvB8E,6DADuB,CAAzB;;IAGA,IAAI;MACF,MAAMgD,UAAU,SAASJ,aAAa,CAACvH,SAAD,CAAtC;MAEA,OAAO2H,UAAU,CAAChX,GAAX,CAAe,CAAChB,SAAD,EAAYkU,KAAZ,KAAqB;QACzC,OAAO;UACL/G,cAAc,EAAE6H,6DADX;UAEL3E,SAFK;UAGLrQ,SAHK;UAILmY,QAAQ,EAAEjE,KAAK,KAAK;QAJf,CAAP;MAMD,CAPM,CAAP;IAQD,CAXD,CAWE,OAAOrO,CAAP,EAAU;MACV,OAAO,IAAP;IACD;EACF,CAxB2B;;EAAA,gBAAfuR,eAAe;IAAA;EAAA;AAAA,GAArB;AA0BA,SAAeM,eAAtB;EAAA;AAAA;;;qNAAO,WAA+BtO,MAA/B,EAA0D;IAC/D,IAAI,CAAC4L,8CAAL,EAAiB;MACf;IACD;;IAED,MAAM;MAAEnM;IAAF,IAAuBmM,sEAAA,EAA7B;;IAEA,IAAInM,gBAAgB,KAAKO,MAAM,CAAChB,EAAhC,EAAoC;MAClCqP,8EAAmB,CAACrO,MAAD,CAAnB;MACA;IACD;;IAED,IAAI;MACF,IAAIA,MAAM,CAACpE,IAAP,KAAgB,UAAhB,IAA8B,CAACoE,MAAM,CAACnK,QAAP,CAAgBiL,SAAnD,EAA8D;QAC5D,OAAOyN,wFAAwB,CAACvO,MAAD,CAA/B;MACD;;MAED,IAAIA,MAAM,CAACnK,QAAP,CAAgB0S,UAApB,EAAgC;QAC9B,OAAO0E,gGAA4B,CACjCjN,MADiC,EAEjC,IAAIjF,KAAJ,CAAU,sBAAV,CAFiC,CAAnC;MAID;;MAED,MAAMzB,MAAM,SAAS0G,MAAM,CAAC1G,MAAP,EAArB;MAEA,MAAM2U,oFAAsB,CAACjO,MAAD,CAA5B;;MAEA,IAAI1G,MAAM,CAACsC,IAAP,KAAgB,UAApB,EAAgC;QAC9B,MAAMjF,QAAQ,SAASqX,eAAe,CAAC1U,MAAD,CAAtC;;QAEA,IAAI,CAAC3C,QAAD,IAAaA,QAAQ,CAAC4D,MAAT,GAAkB,CAAnC,EAAsC;UACpC,OAAOwT,8FAA2B,CAAC/N,MAAD,CAAlC;QACD;;QAED,IAAIrJ,QAAQ,CAAC4D,MAAT,KAAoB,CAAxB,EAA2B;UACzB,OAAO2S,wGAAgC,CAAClN,MAAD,EAASrJ,QAAT,EAAmBA,QAAnB,CAAvC;QACD,CAFD,MAEO;UACL,OAAOqW,0FAAyB,CAAChN,MAAD,EAASrJ,QAAT,CAAhC;QACD;MACF;;MAED,MAAM2C,MAAM,CAACH,MAAP,CAAc;QAClB5C,UAAU,EAAEqV,iEADM;QAElB7L,WAAW,EAAE6L,kEAA8B7L;MAFzB,CAAd,CAAN;MAKA6L,qFAAA,CAAkD,MAAlD;IACD,CApCD,CAoCE,OAAOxW,GAAP,EAAY;MACZ,MAAM;QAAEU;MAAF,IAAWkK,MAAM,CAACnK,QAAxB;MACA,MAAMgF,OAAO,GAAGzF,GAAG,YAAY2F,KAAf,GAAuB3F,GAAG,CAACyF,OAA3B,GAAqC,sBAArD;MAEA,MAAMoS,gGAA4B,CAChCjN,MADgC,EAEhC,IAAIjF,KAAJ,CAAU,0BAA0BjF,IAAI,KAAK+E,OAAO,EAApD,CAFgC,CAAlC;IAID;EACF;;;;AAEK,SAAUmU,WAAV,GAAqB;;;EACzB,IAAI,CAACpD,8CAAL,EAAiB;IACf;EACD;;EAEDA,kEAAA,GAAiC;oCAE7BA,4DAAA,KAA6B,MAA7B,GAAsC,YAAtC,GAAqD,EACvD;;;;;;;;;;;;;;;;GAHF;;EAqBA,KAAK,IAAIxP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwP,6DAApB,EAA+CxP,CAAC,EAAhD,EAAoD;IAClD,MAAM4D,MAAM,GAAG4L,sDAAA,CAAmBxP,CAAnB,CAAf;IACA,MAAM;MAAEtG,IAAF;MAAQC,WAAR;MAAqBuS;IAArB,IAAiCtI,MAAM,CAACnK,QAA9C;IACA,cAAQ,CAACsW,aAAT,CAAuB,eAAvB,OAAuC,IAAvC,IAAuCnV,aAAvC,GAAuC,MAAvC,GAAuCA,GAAE0V,kBAAF,CACrC,WADqC,EAErC;oCAEI1M,MAAM,CAAChB,EAAP,KAAc4M,sEAAA,GAAqCnM,gBAAnD,GACI,kCADJ,GAEI,EACN,YACAO,MAAM,CAACnK,QAAP,CAAgB0S,UAAhB,GAA6B,mBAA7B,GAAmD,EACrD,gBAAgBvI,MAAM,CAAChB,EAAE;wCACSsJ,OAAO,UAAUxS,IAAI;;iCAE5BA,IAAI;uCACEC,WAAW;;YAGtCiK,MAAM,CAACnK,QAAP,CAAgB0S,UAAhB,GACI;;;;iBADJ,GAMI,EACN;;OAvBiC,CAAvC;IA4BA,cAAQ,CACLkE,cADH,CACkB,YAAYzM,MAAM,CAAChB,EADrC,OACwC,IADxC,IACwC+N,aADxC,GACwC,MADxC,GACwCA,GACpCF,gBADoC,CACnB,OADmB,EACV,MAAK;;;MAC/BX,QAAQ,CAACS,gBAAT,CAA0B,kBAA1B,EAA8CrF,OAA9C,CAAuD4H,OAAD,IAAY;QAChEA,OAAO,CAAC3B,SAAR,CAAkBnI,MAAlB,CAAyB,iBAAzB;MACD,CAFD;MAIA,cAAQ,CACLqH,cADH,CACkB,YAAYzM,MAAM,CAAChB,EADrC,OACwC,IADxC,IACwChI,aADxC,GACwC,MADxC,GACwCA,GACpCuW,SADoC,CAC1B4B,GAD0B,CACtB,iBADsB,CADxC;;MAIA,IAAInP,MAAM,CAACpE,IAAP,KAAgB,UAApB,EAAgC;QAC9B,OAAOkS,8FAA2B,CAAC9N,MAAD,CAAlC;MACD;;MACDsO,eAAe,CAACtO,MAAD,CAAf;IACD,CAdqC,CADxC;EAgBD;;EAED,cAAQ,CACLmM,aADH,CACiB,oBADjB,OACsC,IADtC,IACsCiB,aADtC,GACsC,MADtC,GACsCA,GAClCP,gBADkC,CACjB,OADiB,EACR,MAAK;IAC/B,IAAI,CAACjB,8CAAL,EAAiB;MACf;IACD;;IACDA,qFAAA,CAAkD,MAAlD;EACD,CANmC,CADtC;EASAM,QAAQ,CAACW,gBAAT,CAA0B,OAA1B,EAAoCpQ,CAAD,IAAM;IACvC,IAAI,CAACmP,8CAAL,EAAiB;MACf;IACD;;IAED,MAAMjP,MAAM,GAAGF,CAAC,CAACE,MAAjB;;IAEA,IAAIA,MAAM,IAAIA,MAAM,CAACyS,SAAP,KAAqB,cAAnC,EAAmD;MACjDxD,qFAAA,CAAkD,MAAlD;IACD;EACF,CAVD;AAWD;;;;;;;;;;;;;;;;AC9NwD;;;;;;;;;;;;;;;;ACAzD,iEAAe,4viBAA4viB,EAAC;;;;;;;;;;;;;;;;;;;;;;ACA5wiB;AAeA;AACA;;AAiBA,MAAM0D,gBAAgB,GAAG,CAAC7Z,OAAD,EAAmB8Z,SAAnB,KAAyC;EAChE,IAAIA,SAAJ,EAAe;IACb,OAAOA,SAAP;EACD;;EAED,QAAQ9Z,OAAO,CAAC+K,SAAhB;IACE,KAAK,SAAL;MACE,OAAO,8BAAP;;IACF,KAAK,SAAL;MACE,OAAO,kCAAP;;IACF;MACE,MAAM,IAAIzF,KAAJ,CAAU,oBAAV,CAAN;EANJ;AAQD,CAbD;;AAeA,MAAMkP,gBAAgB;EAAA,2MAAG,WACvBpO,MADuB,EAEvBpG,OAFuB,EAGO;IAC9B,MAAMyU,QAAQ,GAAG,IAAIP,8EAAJ,EAAjB;IAEA,MAAMU,IAAI,SAAS3C,oDAAO;MACxBwC,QADwB;MAExBqF,SAAS,EAAE1T,MAAM,CAAC0T;IAFM,GAGrB9Z,OAHqB,GAGd;MACV6U,OAAO,EAAE;IADC,CAHc,EAA1B;IAOA,MAAMhR,MAAM,GAAG,IAAI+V,yDAAJ,CAAqBhF,IAArB,EAA2B,UAA3B,CAAf,CAV8B,CAY9B;;IACA,IAAI,CAAC/Q,MAAM,CAACwJ,UAAP,EAAL,EAA0B;MACxB,MAAMoH,QAAQ,CAACO,KAAT,EAAN;IACD;;IAED,OAAO;MACLnR,MADK;MAEL4Q;IAFK,CAAP;EAID,CAxBqB;;EAAA,gBAAhBD,gBAAgB;IAAA;EAAA;AAAA,GAAtB;;AA0BA,MAAMuF,YAAY;EAAA,4MAGd,WAAO;IAAE3Z,QAAF;IAAY2C,OAAZ;IAAqB/B,KAArB;IAA4BoF,MAA5B;IAAoCwC;EAApC,CAAP,EAAuD;IACzD,MAAMsI,MAAM,SAASsD,gBAAgB,CAACpO,MAAD,EAASrD,OAAO,CAAC/C,OAAjB,CAArC;;IAEA,MAAM4R,OAAO,GAAG,MAAK;MACnBV,MAAM,CAACuD,QAAP,CAAgBO,KAAhB;IACD,CAFD;;IAIA,MAAMvL,WAAW,GAAG,MAAK;MACvB,MAAMtI,SAAS,GAAkB+P,MAAM,CAACrN,MAAP,CAAcoR,YAAd,EAAjC;;MAEA,IAAI,CAAC9T,SAAL,EAAgB;QACd,OAAO,EAAP;MACD;;MAED,OAAO,CAAC;QAAEA;MAAF,CAAD,CAAP;IACD,CARD;;IAUA,MAAMmR,qBAAqB;MAAA,4MAAG,WAC5B5L,YAD4B,EAE1B;QACF,MAAMrF,OAAO,GAAG6P,MAAM,CAACrN,MAAP,CAAcxC,OAAd,EAAhB;;QACA,MAAM;UAAE0J,SAAF;UAAaoG,MAAb;UAAqBnO;QAArB,IAAkC3B,OAAO,CAAC6T,UAAhD;QAEA,MAAMC,QAAQ,SAAShE,MAAM,CAACE,YAAP,CAAoBhQ,OAAO,CAACF,SAA5B,EAAuC4J,SAAvC,CAAvB;QAEA,OAAOrI,OAAO,CAACC,GAAR,CACL+D,YAAY,CAACvE,GAAb;UAAA,4MAAiB,WAAOoQ,WAAP,EAAoB8C,KAApB,EAA6B;YAC5C,MAAMnP,OAAO,GAAGqM,WAAW,CAACrM,OAAZ,CAAoB/D,GAApB,CAAyB8J,MAAD,IACtCsI,gFAAY,CAACtI,MAAD,CADE,CAAhB;YAGA,MAAMmG,SAAS,SAAS/Q,OAAO,CAACiU,uBAAR,CACtB/C,WAAW,CAAC1L,UADU,EAEtBX,OAFsB,EAGtBiP,QAHsB,CAAxB;;YAMA,IAAI,CAAC/C,SAAL,EAAgB;cACd,MAAM,IAAI9M,KAAJ,CACJ,uDAAuDiN,WAAW,CAAC1L,UAAU,EADzE,CAAN;YAGD;;YAED,MAAM2M,KAAK,SAASxQ,QAAQ,CAACwQ,KAAT,CAAe;cAAEnQ,QAAQ,EAAE;YAAZ,CAAf,CAApB;YAEA,OAAO8Q,uEAAA,CACL9S,OAAO,CAACF,SADH,EAELc,6DAAA,CAAqBmQ,SAAS,CAACoD,UAA/B,CAFK,EAGLjD,WAAW,CAAC1L,UAHP,EAILuL,SAAS,CAACqD,UAAV,CAAqBC,KAArB,GAA6BL,KAA7B,GAAqC,CAJhC,EAKLnP,OALK,EAMLjE,oEAAA,CAA4BuR,KAAK,CAACE,MAAN,CAAaC,IAAzC,CANK,CAAP;UAQD,CA1BD;;UAAA;YAAA;UAAA;QAAA,IADK,CAAP;MA6BD,CArC0B;;MAAA,gBAArBrB,qBAAqB;QAAA;MAAA;IAAA,GAA3B;;IAuCA,OAAO;MACC5O,MAAN,CAAa;QAAE5C,UAAF;QAAcwJ;MAAd,CAAb,EAAwC;QAAA;UACtC,MAAMkI,gBAAgB,GAAG/I,WAAW,EAApC;;UAEA,IAAI+I,gBAAgB,CAAC1N,MAArB,EAA6B;YAC3B,OAAO0N,gBAAP;UACD;;UAED,MAAMtB,MAAM,CAACrN,MAAP,CAAc+R,aAAd,CAA4B;YAAE9U,UAAF;YAAcwJ;UAAd,CAA5B,CAAN;UAEA,OAAOb,WAAW,EAAlB;QATsC;MAUvC,CAXI;;MAaC7F,OAAN,GAAa;QAAA;UACX,IAAIsN,MAAM,CAACrN,MAAP,CAAcwJ,UAAd,EAAJ,EAAgC;YAC9B6D,MAAM,CAACrN,MAAP,CAAcD,OAAd;UACD;;UAEDgO,OAAO;QALI;MAMZ,CAnBI;;MAqBCnI,WAAN,GAAiB;QAAA;UACf,OAAOA,WAAW,EAAlB;QADe;MAEhB,CAvBI;;MAyBCtE,WAAN,CAAkB;QAAEC,OAAF;QAAW4U,WAAX;QAAwBC;MAAxB,CAAlB,EAAgD;QAAA;UAC9CrR,MAAM,CAAC9E,GAAP,CAAW,aAAX,EAA0B;YAAEsB;UAAF,CAA1B;;UAEA,MAAM/D,OAAO,GAAG6P,MAAM,CAACrN,MAAP,CAAcxC,OAAd,EAAhB;;UAEA,IAAI,CAACA,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,sBAAV,CAAN;UACD;;UACD,MAAM4U,WAAW,GACf,OAAO1Y,MAAP,KAAkB,WAAlB,GAAgCA,MAAM,CAAC2Y,QAAP,CAAgBC,IAAhD,GAAuD,EADzD;UAGA,MAAM7Z,GAAG,GAAGyZ,WAAW,IAAIE,WAA3B;;UAEA,IAAI,CAAC3Z,GAAL,EAAU;YACR,MAAM,IAAI+E,KAAJ,CAAU,kCAAkClF,QAAQ,CAACC,IAAI,EAAzD,CAAN;UACD;;UAED,MAAMga,UAAU,GAAGC,kBAAkB,CAAC/Z,GAAD,CAArC;UACA,MAAMga,SAAS,GAAGN,IAAI,GAAG,SAASA,IAAI,EAAhB,GAAqB,EAA3C;UAEAzY,MAAM,CAAC2Y,QAAP,CAAgBK,OAAhB,CACE,GAAGpU,MAAM,CAAC0T,SAAS,yBAAyB1U,OAAO,gBAAgBiV,UAAU,GAAGE,SAAS,EAD3F;UAIA;QAxB8C;MAyB/C,CAlDI;;MAoDCvU,sBAAN,CAA6B;QAC3BC,QAD2B;QAE3BY,UAF2B;QAG3BX,OAH2B;QAI3B8T;MAJ2B,CAA7B,EAKC;QAAA;UACCpR,MAAM,CAAC9E,GAAP,CAAW,wBAAX,EAAqC;YACnCmC,QADmC;YAEnCY,UAFmC;YAGnCX,OAHmC;YAInC8T;UAJmC,CAArC;UAOA,MAAM;YAAEjU;UAAF,IAAe/E,KAAK,CAACC,QAAN,EAArB;;UAEA,IAAI,CAACiQ,MAAM,CAACrN,MAAP,CAAcwJ,UAAd,EAAD,IAA+B,CAACtH,QAApC,EAA8C;YAC5C,MAAM,IAAIT,KAAJ,CAAU,sBAAV,CAAN;UACD;;UAED,MAAMjE,OAAO,GAAG6P,MAAM,CAACrN,MAAP,CAAcxC,OAAd,EAAhB;;UAEA,OAAOA,OAAO,CAAC,wBAAD,CAAP,CAAkC;YACvCwF,UAAU,EAAEA,UAAU,IAAId,QAAQ,CAACjF,UADI;YAEvCoF,OAAO,EAAEA,OAAO,CAAC/D,GAAR,CAAa8J,MAAD,IAAYsI,gFAAY,CAACtI,MAAD,CAApC,CAF8B;YAGvCwO,iBAAiB,EAAET;UAHoB,CAAlC,CAAP;QAhBD;MAqBA,CA9EI;;MAgFClT,uBAAN,CAA8B;QAAEJ,YAAF;QAAgBsT;MAAhB,CAA9B,EAA2D;QAAA;UACzDpR,MAAM,CAAC9E,GAAP,CAAW,yBAAX,EAAsC;YAAE4C,YAAF;YAAgBsT;UAAhB,CAAtC;;UAEA,IAAI,CAAC9I,MAAM,CAACrN,MAAP,CAAcwJ,UAAd,EAAL,EAAiC;YAC/B,MAAM,IAAI/H,KAAJ,CAAU,sBAAV,CAAN;UACD;;UAED,OAAO4L,MAAM,CAACrN,MAAP,CAAcqS,uBAAd,CAAsC;YAC3CxP,YAAY,QAAQ4L,qBAAqB,CAAC5L,YAAD,CADE;YAE3CsT;UAF2C,CAAtC,CAAP;QAPyD;MAW1D;;IA3FI,CAAP;EA6FD,CAxJiB;;EAAA,gBAAZD,YAAY;IAAA;EAAA;AAAA,GAAlB;;AA0JM,SAAUrM,iBAAV,CAA4B;EAChCoM,SADgC;EAEhCjH,OAAO,GAAGjS,6CAFsB;EAGhCkS,UAAU,GAAG;AAHmB,IAIV,EAJlB,EAIoB;EACxB,oNAAO,aAAW;IAChB,OAAO;MACLvJ,EAAE,EAAE,gBADC;MAELpD,IAAI,EAAE,SAFD;MAGL/F,QAAQ,EAAE;QACRC,IAAI,EAAE,cADE;QAERC,WAAW,EACT,4DAHM;QAIRuS,OAJQ;QAKRC,UALQ;QAMRzH,SAAS,EAAE;MANH,CAHL;MAWLC,IAAI,EAAGvI,OAAD,IAAY;QAChB,OAAOgX,YAAY,iCACdhX,OADc,GACP;UACVqD,MAAM,EAAE;YACN0T,SAAS,EAAED,gBAAgB,CAAC9W,OAAO,CAACA,OAAR,CAAgB/C,OAAjB,EAA0B8Z,SAA1B;UADrB;QADE,CADO,EAAnB;MAMD;IAlBI,CAAP;EAoBD,CArBD;AAsBD;;;;;;;;;;;;;;;;AC/PmD;;;;;;;;;;;;;;;;ACApD,iEAAe,4rSAA4rS,EAAC;;;;;;;;;;;;;;;;;;;;ACK5sS;AAIA;;AAIA,MAAMD,gBAAgB,GAAG,CAAC7Z,OAAD,EAAmB8Z,SAAnB,KAAyC;EAChE,IAAIA,SAAJ,EAAe;IACb,OAAOA,SAAP;EACD;;EAED,QAAQ9Z,OAAO,CAAC+K,SAAhB;IACE,KAAK,SAAL;MACE,OAAO,yBAAP;;IACF,KAAK,SAAL;MACE,OAAO,iCAAP;;IACF;MACE,MAAM,IAAIzF,KAAJ,CAAU,oBAAV,CAAN;EANJ;AAQD,CAbD;;AAeM,SAAU3G,eAAV,CAA0B;EAC9Bmb,SAD8B;EAE9BjH,OAAO,GAAGjS,6CAFoB;EAG9BkS,UAAU,GAAG;AAHiB,IAIV,EAJhB,EAIkB;EACtB;IAAA,2MAAO,WAAO/P,OAAP,EAAkB;MACvB,MAAMc,MAAM,SAAS6J,uFAAiB,CAAC;QACrCoM,SAAS,EAAED,gBAAgB,CAAC9W,OAAO,CAACA,OAAR,CAAgB/C,OAAjB,EAA0B8Z,SAA1B,CADU;QAErCjH;MAFqC,CAAD,CAAjB,CAGlB9P,OAHkB,CAArB;;MAKA,IAAI,CAACc,MAAL,EAAa;QACX,OAAO,IAAP;MACD;;MAED,uCACKA,MADL,GACW;QACT0F,EAAE,EAAE,aADK;QAETnJ,QAAQ,kCACHyD,MAAM,CAACzD,QADJ,GACY;UAClBC,IAAI,EAAE,aADY;UAElBC,WAAW,EAAE,8BAFK;UAGlBuS,OAHkB;UAIlBC,UAJkB;UAKlBzH,SAAS,EAAE;QALO,CADZ;MAFC,CADX;IAYD,CAtBD;;IAAA;MAAA;IAAA;EAAA;AAuBD;;;;;;;;;;;;;;;;ACxD2D;;;;;;;;;;;;;;;;ACA5D,iEAAe,44RAA44R,EAAC;;;;;;;;;;;;;;;;;;;;;;;;;ACA55R;AACA;AAcA;AAQA;AAEA;;AAmBA,MAAMgQ,wBAAwB,GAAG,MAA0B;EACzD,OAAO;IACLtK,MAAM,EAAE,IADH;IAELrP,KAAK,EAAE,IAAIwZ,0EAAJ,EAFF;IAGLha,QAAQ,EAAE;EAHL,CAAP;AAKD,CAND;;AAQA,MAAMoa,cAAc;EAAA,2MAGhB,WAAO;IAAElb,QAAF;IAAYY,KAAZ;IAAmBoF,MAAnB;IAA2BwC,MAA3B;IAAmC7F,OAAnC;IAA4CC,QAA5C;IAAsDoG;EAAtD,CAAP,EAA0E;IAC5E,MAAM8H,MAAM,GAAGmK,wBAAwB,EAAvC;;IAEA,MAAM5R,WAAW,GAAG,MAAK;MACvB,OAAOyH,MAAM,CAAChQ,QAAd;IACD,CAFD;;IAIA,MAAMiQ,MAAM,GAAW;MACrBC,SAAS,EAAE,MAAK;QACd,MAAM,IAAI9L,KAAJ,CAAU,iBAAV,CAAN;MACD,CAHoB;MAIrB+L,YAAY;QAAA,4MAAE,WAAOlQ,SAAP,EAAoB;UAChC,MAAMD,QAAQ,GAAGuI,WAAW,EAA5B;UACA,MAAMpI,OAAO,GAAGH,QAAQ,CAACE,IAAT,CAAekQ,CAAD,IAAOA,CAAC,CAACnQ,SAAF,KAAgBA,SAArC,CAAhB;;UAEA,IAAI,CAACE,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,uCAAV,CAAN;UACD;;UAED,OAAOrD,6DAAA,CAAqBZ,OAAO,CAACmQ,SAA7B,CAAP;QACD,CATW;;QAAA;UAAA;QAAA;MAAA,GAJS;MAcrBC,WAAW;QAAA,4MAAE,WAAOrM,OAAP,EAAgBjE,SAAhB,EAA6B;UACxC,MAAMD,QAAQ,GAAGuI,WAAW,EAA5B;UACA,MAAMpI,OAAO,GAAGH,QAAQ,CAACE,IAAT,CAAekQ,CAAD,IAAOA,CAAC,CAACnQ,SAAF,KAAgBA,SAArC,CAAhB;;UAEA,IAAI,CAACE,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,oCAAV,CAAN;UACD;;UAED,IAAI;YACF,MAAMiW,EAAE,GAAGpH,wEAAA,CAAoC9P,MAAM,CAACC,IAAP,CAAYc,OAAZ,CAApC,CAAX;YACA,MAAMsW,QAAQ,SAASxK,MAAM,CAACH,MAAP,CAAe4K,eAAf,CAA+BJ,EAA/B,CAAvB;YAEA,OAAO;cACL7J,SAAS,EAAEgK,QAAQ,CAAChK,SAAT,CAAmBlO,IADzB;cAELgO,SAAS,EAAE+J,EAAE,CAAC/J;YAFT,CAAP;UAID,CARD,CAQE,OAAO7R,GAAP,EAAY;YACZiJ,MAAM,CAAC9E,GAAP,CAAW,wBAAX;YACA8E,MAAM,CAAC/I,KAAP,CAAaF,GAAb;YAEA,MAAM2F,KAAK,CAAC,kDAAD,CAAX;UACD;QACF,CAtBU;;QAAA;UAAA;QAAA;MAAA;IAdU,CAAvB;;IAuCA,MAAM1B,OAAO;MAAA,4MAAG,aAAW;;;QACzBgX,kFAAuB;QACvBC,yFAA8B;QAC9BF,yFAA8B;QAC9B,YAAM,CAAC5J,MAAP,MAAa,IAAb,IAAaxP,aAAb,GAAa,MAAb,GAAaA,GAAEqa,EAAF,CAAKpM,KAAL,EAAb;MACD,CALY;;MAAA,gBAAP5L,OAAO;QAAA;MAAA;IAAA,GAAb;;IAOA,MAAM0O,qBAAqB,GACzB5L,YAD4B,IAEN;MACtB,MAAMrF,OAAO,GAAGuP,4EAAgB,CAAC5P,KAAK,CAACC,QAAN,EAAD,CAAhC;MACA,MAAM;QAAE8E;MAAF,IAAe/E,KAAK,CAACC,QAAN,EAArB;;MAEA,IAAI,CAACI,OAAD,IAAY,CAAC0E,QAAjB,EAA2B;QACzB,MAAM,IAAIT,KAAJ,CAAU,sBAAV,CAAN;MACD;;MAED,OAAOoB,YAAY,CAACvE,GAAb,CAAkBoQ,WAAD,IAAgB;QACtC,OAAO;UACLtM,QAAQ,EAAEsM,WAAW,CAACtM,QAAZ,IAAwB5E,OAAO,CAACF,SADrC;UAEL0F,UAAU,EAAE0L,WAAW,CAAC1L,UAAZ,IAA0Bd,QAAQ,CAACjF,UAF1C;UAGLoF,OAAO,EAAEqM,WAAW,CAACrM;QAHhB,CAAP;MAKD,CANM,CAAP;IAOD,CAjBD;;IAmBA,OAAO;MACCxC,MAAN,GAAY;QAAA;UACV,OAAO,IAAIhB,OAAJ,CAAY,CAACoF,OAAD,EAAU+T,MAAV,KAAoB;YACrC,MAAMrJ,gBAAgB,GAAG/I,WAAW,EAApC;;YAEA,IAAI+I,gBAAgB,CAAC1N,MAArB,EAA6B;cAC3B,OAAOgD,OAAO,CAAC0K,gBAAD,CAAd;YACD;;YAED,IAAIsJ,WAAW,GAAGf,gFAAqB,EAAvC;YACA,MAAMgB,eAAe,GAAGf,uFAA4B,EAApD;YACA,MAAMgB,kBAAkB,GAAGlB,uFAA4B,EAAvD;;YAEA,IACE1U,MAAM,CAAC3F,WAAP,CAAmBwb,UAAnB,KAAkC,KAAlC,IACAH,WAAW,KAAK,IADhB,KAECC,eAAe,KAAK,IAApB,IAA4BC,kBAAkB,KAAK,IAFpD,CADF,EAIE;cACApB,kFAAuB;cACvBkB,WAAW,GAAG,IAAd;YACD;;YAED,IAAI;cACFpB,oEAAA,CAAajX,gCACR2C,MADQ,GACF;gBACT+V,aAAa,EAAG9a,OAAD,IAAY;kBACzB+Z,uFAA4B,CAAC/Z,OAAO,CAACmQ,SAAR,CAAkBhN,QAAlB,EAAD,CAA5B;kBACA2W,uFAA4B,CAAC9Z,OAAO,CAACF,SAAR,CAAkBqD,QAAlB,EAAD,CAA5B;;kBACA0M,MAAM,CAAChQ,QAAP,CAAgB0F,IAAhB,CAAqBvF,OAArB;;kBACA6P,MAAM,CAACxP,KAAP,CAAa0a,OAAb,GAAuBC,SAAvB;;kBACAnL,MAAM,CAACxP,KAAP,CAAa4a,UAAb;;kBACAxU,OAAO,CAAC2B,WAAW,EAAZ,CAAP;gBACD;cARQ,CADE,CAAb,EAUGlG,IAVH,CAUSwN,MAAD,IAAW;gBACjBA,MAAM,CAAC6K,EAAP,CAAUW,OAAV,GAAoB,MAAK;kBACvBrL,MAAM,CAACH,MAAP,GAAgB,IAAhB;kBACAG,MAAM,CAAChQ,QAAP,GAAkB,EAAlB;kBACAkI,OAAO,CAAC4B,IAAR,CAAa,WAAb,EAA0B,IAA1B;gBACD,CAJD;;gBAKAkG,MAAM,CAACH,MAAP,GAAgBA,MAAhB;;gBAEA,IACE3K,MAAM,CAAC3F,WAAP,CAAmBwb,UAAnB,KAAkC,KAAlC,IACAH,WAAW,KAAK/K,MAAM,CAACyL,SADvB,IAEAT,eAAe,KAAK,IAFpB,IAGAC,kBAAkB,KAAK,IAJzB,EAKE;kBACA9K,MAAM,CAAChQ,QAAP,CAAgB0F,IAAhB,CAAqB;oBACnBzF,SAAS,EAAE6a,kBADQ;oBAEnBxK,SAAS,EAAEvP,6DAAA,CAAqB8Z,eAArB;kBAFQ,CAArB;;kBAIA7K,MAAM,CAACxP,KAAP,CAAa0a,OAAb,GAAuBC,SAAvB;kBACAvU,OAAO,CAAC2B,WAAW,EAAZ,CAAP;gBACD,CAZD,MAYO;kBACLyH,MAAM,CAACxP,KAAP,CAAa+a,SAAb,CAAuB1L,MAAM,CAACyL,SAA9B,EAAyCvB,mEAAzC;;kBACA/J,MAAM,CAACxP,KAAP,CAAa0a,OAAb,GAAuB,MAAK;oBAC1BP,MAAM,CAAC,IAAIvW,KAAJ,CAAU,wBAAV,CAAD,CAAN;kBACD,CAFD;gBAGD;cACF,CApCD;YAqCD,CAtCD,CAsCE,OAAO3F,GAAP,EAAY;cACZiE,OAAO;cACPiY,MAAM,CAAClc,GAAD,CAAN;YACD;UACF,CA9DM,CAAP;QADU;MAgEX,CAjEI;;MAmELiE,OAnEK;;MAqEC6F,WAAN,GAAiB;QAAA;UACf,OAAOA,WAAW,GAAGtH,GAAd,CAAkB,CAAC;YAAEhB;UAAF,CAAD,MAAoB;YAAEA;UAAF,CAApB,CAAlB,CAAP;QADe;MAEhB,CAvEI;;MAyECgE,WAAN,CAAkB;QAAEC;MAAF,CAAlB,EAA6B;QAAA;UAC3BwD,MAAM,CAAC9E,GAAP,CAAW,4BAAX,EAAyC;YAAEsB;UAAF,CAAzC;UAEA,MAAM,IAAIE,KAAJ,CAAU,2BAA2BlF,QAAQ,CAACC,IAAI,EAAlD,CAAN;QAH2B;MAI5B,CA7EI;;MA+EC2F,sBAAN,CAA6B;QAAEC,QAAF;QAAYY,UAAZ;QAAwBX;MAAxB,CAA7B,EAA8D;QAAA;;;UAC5D0C,MAAM,CAAC9E,GAAP,CAAW,wBAAX,EAAqC;YAAEmC,QAAF;YAAYY,UAAZ;YAAwBX;UAAxB,CAArC;UAEA,MAAMhF,QAAQ,GAAGuI,WAAW,EAA5B;;UAEA,IAAI,EAAC,YAAM,CAACsH,MAAP,MAAa,IAAb,IAAaxP,aAAb,GAAa,MAAb,GAAaA,GAAEib,SAAhB,KAA6B,CAACtb,QAAQ,CAAC4D,MAA3C,EAAmD;YACjD,MAAM,IAAIQ,KAAJ,CAAU,sBAAV,CAAN;UACD;;UAED,MAAM,CAACoW,QAAD,UAAmB/K,oFAAgB,CACvC2B,qBAAqB,CAAC,CAAC;YAAErM,QAAF;YAAYY,UAAZ;YAAwBX;UAAxB,CAAD,CAAD,CADkB,EAEvCiL,MAFuC,EAGvCpO,OAAO,CAAC/C,OAH+B,CAAzC;UAMA,OAAOgD,QAAQ,CAAC2P,eAAT,CAAyB+I,QAAzB,CAAP;QAf4D;MAgB7D,CA/FI;;MAiGC5U,uBAAN,CAA8B;QAAEJ;MAAF,CAA9B,EAA8C;QAAA;;;UAC5CkC,MAAM,CAAC9E,GAAP,CAAW,yBAAX,EAAsC;YAAE4C;UAAF,CAAtC;UAEA,MAAMxF,QAAQ,GAAGuI,WAAW,EAA5B;;UAEA,IAAI,EAAC,YAAM,CAACsH,MAAP,MAAa,IAAb,IAAaxP,aAAb,GAAa,MAAb,GAAaA,GAAEib,SAAhB,KAA6B,CAACtb,QAAQ,CAAC4D,MAA3C,EAAmD;YACjD,MAAM,IAAIQ,KAAJ,CAAU,sBAAV,CAAN;UACD;;UAED,MAAMqX,SAAS,SAAShM,oFAAgB,CACtC2B,qBAAqB,CAAC5L,YAAD,CADiB,EAEtCyK,MAFsC,EAGtCpO,OAAO,CAAC/C,OAH8B,CAAxC;UAMA,MAAM4S,OAAO,GAAiC,EAA9C;;UAEA,KAAK,IAAIjM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgW,SAAS,CAAC7X,MAA9B,EAAsC6B,CAAC,EAAvC,EAA2C;YACzCiM,OAAO,CAAChM,IAAR,OAAmB5D,QAAQ,CAAC2P,eAAT,CAAyBgK,SAAS,CAAChW,CAAD,CAAlC,CAAnB;UACD;;UAED,OAAOiM,OAAP;QArB4C;MAsB7C;;IAvHI,CAAP;EAyHD,CApMmB;;EAAA,gBAAd0I,cAAc;IAAA;EAAA;AAAA,GAApB;;AA2MM,SAAUtc,mBAAV,CAA8B;EAClCyB,WADkC;EAElC6H,OAFkC;EAGlC/H,GAHkC;EAIlCsS,OAAO,GAAGjS,6CAJwB;EAKlCkS,UAAU,GAAG;AALqB,CAA9B,EAMsB;EAC1B,oNAAO,aAAW;IAChB,OAAO;MACLvJ,EAAE,EAAE,iBADC;MAELpD,IAAI,EAAE,QAFD;MAGL/F,QAAQ,EAAE;QACRC,IAAI,EAAE,iBADE;QAERC,WAAW,EAAE,6CAFL;QAGRuS,OAAO,EAAEA,OAHD;QAIRC,UAJQ;QAKRzH,SAAS,EAAE;MALH,CAHL;MAULC,IAAI,EAAGvI,OAAD,IAAY;QAChB,OAAOuY,cAAc,iCAChBvY,OADgB,GACT;UACVqD,MAAM,EAAE;YACN3F,WADM;YAEN6H,OAFM;YAGN/H;UAHM;QADE,CADS,EAArB;MAQD;IAnBI,CAAP;EAqBD,CAtBD;AAuBD;;;;;;;;;;;;;;;;AC7R4C;;;;;;;;;;;;;;;;ACA7C,iEAAe,w3ZAAw3Z,EAAC;;;;;;;;;;;;;;;;;;;;;;;;;ACMx4Z;AACA;AACA;AACA;AAGA;;AAYA,MAAMqc,iBAAiB;EAAA,2MAAG,WACxB5b,KADwB,EAEC;IACzB,MAAM;MAAEgJ;IAAF,IAAuBhJ,KAAK,CAACC,QAAN,EAA7B;IACA,MAAM4C,MAAM,GAAGrC,MAAM,CAACqb,OAAP,CAAgBjI,IAA/B,CAFyB,CAIzB;;IACA,IAAI5K,gBAAgB,KAAK,SAAzB,EAAoC;MAClC,MAAMnG,MAAM,CAACoO,OAAP,CAAeoK,SAAf,EAA0B,IAA1B,EAAgC3c,KAAhC,CAAsC,MAAM,IAA5C,CAAN;IACD;;IAED,OAAO;MACLmE;IADK,CAAP;EAGD,CAdsB;;EAAA,gBAAjB+Y,iBAAiB;IAAA;EAAA;AAAA,GAAvB;;AAeA,MAAM3J,WAAW,GAAG,MAAK;EACvB,OAAO7K,mEAAO,CAAC,MAAM,CAAC,CAAC5G,MAAM,CAACqb,OAAP,CAAgBjI,IAAzB,CAAP,CAAuClV,KAAvC,CAA6C,MAAM,KAAnD,CAAP;AACD,CAFD;;AAGA,MAAMod,OAAO;EAAA,4MAA2C,WAAO;IAC7D1c,QAD6D;IAE7D2C,OAF6D;IAG7D/B,KAH6D;IAI7D4H,MAJ6D;IAK7D5F;EAL6D,CAAP,EAMnD;IACH,MAAMkO,MAAM,SAAS0L,iBAAiB,CAAC5b,KAAD,CAAtC;;IAEA,MAAMyI,WAAW,GAAG,MAAK;MACvB,MAAM;QAAEtI,SAAF;QAAaqQ;MAAb,IAA2BN,MAAM,CAACrN,MAAP,CAAcxC,OAA/C;;MAEA,IAAI,CAACF,SAAL,EAAgB;QACd,OAAO,EAAP;MACD;;MAED,OAAO,CACL;QACEA,SADF;QAEEqQ,SAAS,EAAEA,SAAS,CAAChN,QAAV;MAFb,CADK,CAAP;IAMD,CAbD;;IAeA,MAAM8N,qBAAqB,GACzB5L,YAD4B,IAEN;MACtB,MAAMxF,QAAQ,GAAGuI,WAAW,EAA5B;MACA,MAAM;QAAE1D;MAAF,IAAe/E,KAAK,CAACC,QAAN,EAArB;;MAEA,IAAI,CAACC,QAAQ,CAAC4D,MAAV,IAAoB,CAACiB,QAAzB,EAAmC;QACjC,MAAM,IAAIT,KAAJ,CAAU,sBAAV,CAAN;MACD;;MAED,OAAOoB,YAAY,CAACvE,GAAb,CAAkBoQ,WAAD,IAAgB;QACtC,OAAO;UACLtM,QAAQ,EAAEsM,WAAW,CAACtM,QAAZ,IAAwB/E,QAAQ,CAAC,CAAD,CAAR,CAAYC,SADzC;UAEL0F,UAAU,EAAE0L,WAAW,CAAC1L,UAAZ,IAA0Bd,QAAQ,CAACjF,UAF1C;UAGLoF,OAAO,EAAEqM,WAAW,CAACrM;QAHhB,CAAP;MAKD,CANM,CAAP;IAOD,CAjBD;;IAmBA,MAAMiL,MAAM,GAAW;MACrBC,SAAS,EAAE,MAAK;QACd,MAAM,IAAI9L,KAAJ,CAAU,iBAAV,CAAN;MACD,CAHoB;MAIrB+L,YAAY;QAAA,4MAAE,WAAOlQ,SAAP,EAAoB;UAChC,MAAMD,QAAQ,GAAGuI,WAAW,EAA5B;UACA,MAAMpI,OAAO,GAAGH,QAAQ,CAACE,IAAT,CAAekQ,CAAD,IAAOA,CAAC,CAACnQ,SAAF,KAAgBA,SAArC,CAAhB;;UAEA,IAAI,CAACE,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,uCAAV,CAAN;UACD;;UAED,OAAOrD,6DAAA,CAAqBZ,OAAO,CAACmQ,SAA7B,CAAP;QACD,CATW;;QAAA;UAAA;QAAA;MAAA,GAJS;MAcrBC,WAAW;QAAA,4MAAE,WAAOrM,OAAP,EAAgBjE,SAAhB,EAA6B;UACxC,MAAMD,QAAQ,GAAGuI,WAAW,EAA5B;UACA,MAAMpI,OAAO,GAAGH,QAAQ,CAACE,IAAT,CAAekQ,CAAD,IAAOA,CAAC,CAACnQ,SAAF,KAAgBA,SAArC,CAAhB;;UAEA,IAAI,CAACE,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,oCAAV,CAAN;UACD;;UAED,IAAI;YACF,MAAMiW,EAAE,GAAGpH,wEAAA,CAAoC9P,MAAM,CAACC,IAAP,CAAYc,OAAZ,CAApC,CAAX;YACA,MAAMsW,QAAQ,SAASxK,MAAM,CAACrN,MAAP,CAAc8X,eAAd,CAA8BJ,EAA9B,CAAvB;YAEA,OAAO;cACL7J,SAAS,EAAEgK,QAAQ,CAAChK,SAAT,CAAmBlO,IADzB;cAELgO,SAAS,EAAE+J,EAAE,CAAC/J;YAFT,CAAP;UAID,CARD,CAQE,OAAO7R,GAAP,EAAY;YACZiJ,MAAM,CAAC9E,GAAP,CAAW,wBAAX;YACA8E,MAAM,CAAC/I,KAAP,CAAaF,GAAb;YAEA,MAAM2F,KAAK,CAAC,kDAAD,CAAX;UACD;QACF,CAtBU;;QAAA;UAAA;QAAA;MAAA;IAdU,CAAvB;IAuCA,OAAO;MACC5B,MAAN,GAAY;QAAA;UACV,MAAM8O,gBAAgB,GAAG/I,WAAW,EAApC;;UAEA,IAAI+I,gBAAgB,CAAC1N,MAArB,EAA6B;YAC3B,OAAO0N,gBAAP;UACD;;UAED,MAAMtB,MAAM,CAACrN,MAAP,CAAcoO,OAAd,EAAN;UAEA,OAAOxI,WAAW,EAAlB;QATU;MAUX,CAXI;;MAaC7F,OAAN,GAAa;QAAA;UACX,MAAMsN,MAAM,CAACrN,MAAP,CAAckO,UAAd,EAAN;QADW;MAEZ,CAfI;;MAiBCtI,WAAN,GAAiB;QAAA;UACf,OAAOA,WAAW,GAAGtH,GAAd,CAAkB,CAAC;YAAEhB;UAAF,CAAD,MAAoB;YAAEA;UAAF,CAApB,CAAlB,CAAP;QADe;MAEhB,CAnBI;;MAqBCgE,WAAN,CAAkB;QAAEC;MAAF,CAAlB,EAA6B;QAAA;UAC3BwD,MAAM,CAAC9E,GAAP,CAAW,qBAAX,EAAkC;YAAEsB;UAAF,CAAlC;UAEA,MAAM,IAAIE,KAAJ,CAAU,2BAA2BlF,QAAQ,CAACC,IAAI,EAAlD,CAAN;QAH2B;MAI5B,CAzBI;;MA2BC2F,sBAAN,CAA6B;QAAEC,QAAF;QAAYY,UAAZ;QAAwBX;MAAxB,CAA7B,EAA8D;QAAA;UAC5D0C,MAAM,CAAC9E,GAAP,CAAW,wBAAX,EAAqC;YAAEmC,QAAF;YAAYY,UAAZ;YAAwBX;UAAxB,CAArC;UAEA,MAAM;YAAEH;UAAF,IAAe/E,KAAK,CAACC,QAAN,EAArB;UACA,MAAMC,QAAQ,GAAGuI,WAAW,EAA5B;;UAEA,IAAI,CAACvI,QAAQ,CAAC4D,MAAV,IAAoB,CAACiB,QAAzB,EAAmC;YACjC,MAAM,IAAIT,KAAJ,CAAU,sBAAV,CAAN;UACD;;UAED,MAAM,CAACoW,QAAD,UAAmB/K,oFAAgB,CACvC2B,qBAAqB,CAAC,CAAC;YAAErM,QAAF;YAAYY,UAAZ;YAAwBX;UAAxB,CAAD,CAAD,CADkB,EAEvCiL,MAFuC,EAGvCpO,OAAO,CAAC/C,OAH+B,CAAzC;UAMA,OAAOgD,QAAQ,CAAC2P,eAAT,CAAyB+I,QAAzB,CAAP;QAhB4D;MAiB7D,CA5CI;;MA8CC5U,uBAAN,CAA8B;QAAEJ;MAAF,CAA9B,EAA8C;QAAA;UAC5CkC,MAAM,CAAC9E,GAAP,CAAW,yBAAX,EAAsC;YAAE4C;UAAF,CAAtC;UAEA,MAAMiW,SAAS,SAAShM,oFAAgB,CACtC2B,qBAAqB,CAAC5L,YAAD,CADiB,EAEtCyK,MAFsC,EAGtCpO,OAAO,CAAC/C,OAH8B,CAAxC;UAMA,MAAM4S,OAAO,GAAiC,EAA9C;;UAEA,KAAK,IAAIjM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgW,SAAS,CAAC7X,MAA9B,EAAsC6B,CAAC,EAAvC,EAA2C;YACzCiM,OAAO,CAAChM,IAAR,OAAmB5D,QAAQ,CAAC2P,eAAT,CAAyBgK,SAAS,CAAChW,CAAD,CAAlC,CAAnB;UACD;;UAED,OAAOiM,OAAP;QAf4C;MAgB7C;;IA9DI,CAAP;EAgED,CAlJY;;EAAA,gBAAPkK,OAAO;IAAA;EAAA;AAAA,GAAb;;AAwJM,SAAUhe,YAAV,CAAuB;EAC3B+T,OAAO,GAAGjS,6CADiB;EAE3BkS,UAAU,GAAG;AAFc,IAGJ,EAHnB,EAGqB;EACzB,oNAAO,aAAW;IAChB,MAAMC,MAAM,GAAGrC,mDAAQ,EAAvB;IACA,MAAMsD,SAAS,SAASf,WAAW,EAAnC;;IAEA,IAAIF,MAAJ,EAAY;MACV,OAAO,IAAP;IACD;;IAED,MAAM3K,mEAAO,CAAC,MAAK;MAAA;;MAAC,QAAC,EAAC,YAAM,CAACyU,OAAP,MAAc,IAAd,IAActb,aAAd,GAAc,MAAd,GAAcA,GAAEqT,IAAjB,CAAD;IAAsB,CAA7B,EAA+B;MAC1CtM,OAAO,EAAE;IADiC,CAA/B,CAAP,CAEH5I,KAFG,CAEG,MAAM,KAFT,CAAN;IAIA,OAAO;MACL6J,EAAE,EAAE,SADC;MAELpD,IAAI,EAAE,UAFD;MAGL/F,QAAQ,EAAE;QACRC,IAAI,EAAE,SADE;QAERC,WAAW,EAAE,sCAFL;QAGRuS,OAHQ;QAIR;QACAoB,WAAW,EAAE,yBALL;QAMRnB,UANQ;QAORzH,SAAS,EAAE2I;MAPH,CAHL;MAYL1I,IAAI,EAAEwR;IAZD,CAAP;EAcD,CA1BD;AA2BD;;;;;;;;;;;;;;;;ACjO0C;;;;;;;;;;;;;;;;ACA3C,iEAAe,giXAAgiX,EAAC;;;;;;;;;;;;;;;;;;;;;;ACAhjX;AAUA;AAEA;;AAiBA,MAAM7J,WAAW,GAAG,MAAK;EACvB,OAAO7K,mEAAO,CAAC,MAAK;IAAA;;IAAC,QAAC,EAAC,YAAM,CAACwM,IAAP,MAAW,IAAX,IAAWrT,aAAX,GAAW,MAAX,GAAWA,GAAEwb,QAAd,CAAD;EAAuB,CAA9B,CAAP,CAAuCrd,KAAvC,CAA6C,MAAM,KAAnD,CAAP;AACD,CAFD;;AAIA,MAAMsd,gBAAgB,GAAG,MAAkB;EACzC,MAAMnZ,MAAM,GAAGrC,MAAM,CAACoT,IAAtB;EAEA,OAAO;IACL/Q;EADK,CAAP;AAGD,CAND;;AAQA,MAAMoZ,MAAM;EAAA,2MAA2C,WAAO;IAC5Dla,OAD4D;IAE5D3C,QAF4D;IAG5DY,KAH4D;IAI5DgC,QAJ4D;IAK5DoG,OAL4D;IAM5DR;EAN4D,CAAP,EAOlD;IACH,MAAMsI,MAAM,GAAG8L,gBAAgB,EAA/B;;IAEA,MAAMpL,OAAO,GAAG,MAAK;MACnB,KAAK,MAAMnC,GAAX,IAAkByB,MAAM,CAACrN,MAAP,CAAcqZ,SAAhC,EAA2C;QACzChM,MAAM,CAACrN,MAAP,CAAc8L,MAAd,CAAqBF,GAArB;MACD;IACF,CAJD;;IAMA,MAAM7L,OAAO;MAAA,4MAAG,aAAW;QACzB,IAAI,CAACsN,MAAM,CAACrN,MAAP,CAAcwJ,UAAd,EAAL,EAAiC;UAC/B;QACD;;QAEDuE,OAAO;QAEP,MAAM1N,GAAG,SAASgN,MAAM,CAACrN,MAAP,CAAcD,OAAd,EAAlB;;QAEA,IAAIM,GAAG,KAAK,IAAZ,EAAkB;UAChB;QACD;;QAED,MAAMrE,KAAK,GAAG,IAAIyF,KAAJ,CACZ,OAAOpB,GAAG,CAACrE,KAAX,KAAqB,QAArB,GAAgCqE,GAAG,CAACrE,KAApC,GAA4CqE,GAAG,CAACrE,KAAJ,CAAUsG,IAD1C,CAAd,CAbyB,CAiBzB;;QACA,IAAItG,KAAK,CAACuF,OAAN,KAAkB,aAAtB,EAAqC;UACnC,MAAMvF,KAAN;QACD,CApBwB,CAsBzB;;;QACA+I,MAAM,CAAC9E,GAAP,CAAW,oBAAX;QACA8E,MAAM,CAAC/I,KAAP,CAAaA,KAAb;MACD,CAzBY;;MAAA,gBAAP+D,OAAO;QAAA;MAAA;IAAA,GAAb;;IA2BA,MAAMuZ,WAAW,GAAG,MAAK;MACvBjM,MAAM,CAACrN,MAAP,CAAcgH,EAAd,CAAiB,gBAAjB;QAAA,4MAAmC,WAAOuS,YAAP,EAAuB;UACxDxU,MAAM,CAAC9E,GAAP,CAAW,iBAAX,EAA8BsZ,YAA9B;UACAhU,OAAO,CAAC4B,IAAR,CAAa,WAAb,EAA0B,IAA1B;QACD,CAHD;;QAAA;UAAA;QAAA;MAAA;;MAKAkG,MAAM,CAACrN,MAAP,CAAcgH,EAAd,CAAiB,YAAjB;QAAA,4MAA+B,WAAOwS,GAAP,EAAc;UAC3CzU,MAAM,CAAC9E,GAAP,CAAW,iBAAX,EAA8BuZ,GAA9B;;UAEA,IAAIta,OAAO,CAAC/C,OAAR,CAAgB+K,SAAhB,KAA8BsS,GAAG,CAACtS,SAAtC,EAAiD;YAC/C,MAAMnH,OAAO,EAAb;YAEAwF,OAAO,CAAC4B,IAAR,CAAa,WAAb,EAA0B,IAA1B;YACA5B,OAAO,CAAC4B,IAAR,CAAa,gBAAb,EAA+B;cAAED,SAAS,EAAEsS,GAAG,CAACtS;YAAjB,CAA/B;UACD;QACF,CATD;;QAAA;UAAA;QAAA;MAAA;IAUD,CAhBD;;IAkBA,MAAMtB,WAAW,GAAG,MAAK;MACvB,MAAMtI,SAAS,GAAG+P,MAAM,CAACrN,MAAP,CAAcoR,YAAd,EAAlB;;MAEA,IAAI,CAAC9T,SAAL,EAAgB;QACd,OAAO,EAAP;MACD;;MAED,OAAO,CAAC;QAAEA;MAAF,CAAD,CAAP;IACD,CARD;;IAUA,MAAMmc,cAAc,GAClBpX,OADqB,IAEmB;MACxC,OAAOA,OAAO,CAACqX,KAAR,CAAe3Y,CAAD,IAAOA,CAAC,CAACuB,IAAF,KAAW,cAAhC,CAAP;IACD,CAJD;;IAMA,MAAMqX,gBAAgB,GAAItX,OAAD,IAA2B;MAClD,MAAMuX,YAAY,GAAGH,cAAc,CAACpX,OAAD,CAAnC;;MAEA,IAAI,CAACuX,YAAL,EAAmB;QACjB,MAAM,IAAInY,KAAJ,CACJ,sDAAsDlF,QAAQ,CAACC,IAAI,EAD/D,CAAN;MAGD;;MAED,OAAO6F,OAAO,CAAC/D,GAAR,CAAayC,CAAD,IAAOA,CAAC,CAACwB,MAArB,CAAP;IACD,CAVD;;IAYA,MAAMkM,qBAAqB,GACzB5L,YAD4B,IAE1B;MACF,OAAOA,YAAY,CAACvE,GAAb,CAAkBoQ,WAAD,IAAgB;QACtC,OAAO;UACL1L,UAAU,EAAE0L,WAAW,CAAC1L,UADnB;UAELX,OAAO,EAAEsX,gBAAgB,CAACjL,WAAW,CAACrM,OAAb;QAFpB,CAAP;MAID,CALM,CAAP;IAMD,CATD;;IAWA,IAAIgL,MAAM,CAACrN,MAAP,IAAiBqN,MAAM,CAACrN,MAAP,CAAcwJ,UAAd,EAArB,EAAiD;MAC/C8P,WAAW;IACZ;;IAED,OAAO;MACCzZ,MAAN,CAAa;QAAE5C,UAAF;QAAcwJ;MAAd,CAAb,EAAwC;QAAA;UACtC,MAAMkI,gBAAgB,GAAG/I,WAAW,EAApC;;UAEA,IAAI+I,gBAAgB,CAAC1N,MAArB,EAA6B;YAC3B,OAAO0N,gBAAP;UACD;;UAED,MAAM;YAAEJ,SAAF;YAAavS;UAAb,UAA6BqR,MAAM,CAACrN,MAAP,CAAc+R,aAAd,CAA4B;YAC7D9U,UAD6D;YAE7DwJ;UAF6D,CAA5B,CAAnC;;UAKA,IAAI,CAAC8H,SAAD,IAAcvS,KAAlB,EAAyB;YACvB,MAAM+D,OAAO,EAAb;YAEA,MAAM,IAAI0B,KAAJ,CACJ,CAAC,OAAOzF,KAAP,KAAiB,QAAjB,GAA4BA,KAA5B,GAAoCA,KAAK,CAACsG,IAA3C,KACE,mBAFE,CAAN;UAID;;UAEDgX,WAAW;UAEX,OAAO1T,WAAW,EAAlB;QAvBsC;MAwBvC,CAzBI;;MA2BL7F,OA3BK;;MA6BC6F,WAAN,GAAiB;QAAA;UACf,OAAOA,WAAW,EAAlB;QADe;MAEhB,CA/BI;;MAiCCtE,WAAN,CAAkB;QAAEC;MAAF,CAAlB,EAA6B;QAAA;UAC3BwD,MAAM,CAAC9E,GAAP,CAAW,oBAAX,EAAiC;YAAEsB;UAAF,CAAjC;;UAEA,MAAM/D,OAAO,GAAG6P,MAAM,CAACrN,MAAP,CAAcxC,OAAd,EAAhB;;UAEA,IAAI,CAACA,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,sBAAV,CAAN;UACD,CAP0B,CAS3B;UACA;UACA;;;UACA,IAAI,CAACjE,OAAO,CAAC6T,UAAR,CAAmB/D,MAAnB,CAA0BM,WAA/B,EAA4C;YAC1C,MAAM,IAAInM,KAAJ,CAAU,kBAAV,CAAN;UACD;;UAED,MAAMyF,SAAS,GAAGhI,OAAO,CAAC/C,OAAR,CAAgB+K,SAAlC;UACA,MAAM5J,SAAS,GAAGE,OAAO,CAACF,SAA1B;UACA,MAAMoS,MAAM,SAASlS,OAAO,CAAC6T,UAAR,CAAmB/D,MAAnB,CAA0BE,YAA1B,CACnBlQ,SADmB,EAEnB4J,SAFmB,CAArB;UAIA,MAAMyI,KAAK,SAASxQ,QAAQ,CAACwQ,KAAT,CAAe;YAAEnQ,QAAQ,EAAE;UAAZ,CAAf,CAApB;UAEA,MAAMG,IAAI,GAAG;YACXrC,SADW;YAEXiE,OAFW;YAGXqO,OAAO,EAAED,KAAK,CAACE,MAAN,CAAaC,IAHX;YAIXnC,SAAS,EAAEnN,MAAM,CAACC,IAAP,CAAYiP,MAAM,CAAC/P,IAAnB,EAAyBgB,QAAzB,CAAkC,QAAlC,CAJA;YAKXoP,OAAO,EAAEL,MAAM,CAACK;UALL,CAAb;UAOA,MAAMC,OAAO,GAAG1P,IAAI,CAACkB,SAAL,CAAe7B,IAAf,CAAhB;UAEA,MAAMsQ,MAAM,SAASzS,OAAO,CAAC6T,UAAR,CAAmB/D,MAAnB,CAA0BM,WAA1B,CACnB,IAAIsC,UAAJ,CAAe1P,MAAM,CAACC,IAAP,CAAYuP,OAAZ,CAAf,CADmB,EAEnB1S,SAFmB,EAGnB4J,SAHmB,CAArB;UAMA,uCACKvH,IADL,GACS;YACPkO,SAAS,EAAErN,MAAM,CAACC,IAAP,CAAYwP,MAAM,CAACpC,SAAnB,EAA8BlN,QAA9B,CAAuC,QAAvC,CADJ;YAEPoP,OAAO,EAAEE,MAAM,CAACtC,SAAP,CAAiBoC;UAFnB,CADT;QAvC2B;MA4C5B,CA7EI;;MA+EC5N,sBAAN,CAA6B;QAAEC,QAAF;QAAYY,UAAZ;QAAwBX;MAAxB,CAA7B,EAA8D;QAAA;UAC5D0C,MAAM,CAAC9E,GAAP,CAAW,wBAAX,EAAqC;YAAEmC,QAAF;YAAYY,UAAZ;YAAwBX;UAAxB,CAArC;UAEA,MAAM;YAAEH;UAAF,IAAe/E,KAAK,CAACC,QAAN,EAArB;;UAEA,IAAI,CAACiQ,MAAM,CAACrN,MAAP,CAAcwJ,UAAd,EAAD,IAA+B,CAACtH,QAApC,EAA8C;YAC5C,MAAM,IAAIT,KAAJ,CAAU,sBAAV,CAAN;UACD;;UAED,OAAO4L,MAAM,CAACrN,MAAP,CACJmC,sBADI,CACmB;YACtBa,UAAU,EAAEA,UAAU,IAAId,QAAQ,CAACjF,UADb;YAEtBoF,OAAO,EAAEsX,gBAAgB,CAACtX,OAAD;UAFH,CADnB,EAKJ3C,IALI,CAKEW,GAAD,IAAQ;;;YACZ,IAAIA,GAAG,CAACrE,KAAR,EAAe;cACb,MAAM,IAAIyF,KAAJ,CAAUpB,GAAG,CAACrE,KAAd,CAAN;YACD,CAFD,MAEO,IAAIqE,GAAG,CAACuM,QAAJ,IAAgB,WAAWvM,GAAG,CAACuM,QAAnC,EAA6C;cAClD,MAAM,IAAInL,KAAJ,CAAUpB,GAAG,CAACuM,QAAJ,CAAa5Q,KAAb,CAAmBuF,OAA7B,CAAN;YACD,CALW,CAOZ;;;YACA,IAAI,EAAC,SAAG,CAACqL,QAAJ,MAAY,IAAZ,IAAYlP,aAAZ,GAAY,MAAZ,GAAYA,GAAEuD,MAAf,CAAJ,EAA2B;cACzB,MAAM,IAAIQ,KAAJ,CAAU,kBAAV,CAAN;YACD;;YAED,OAAOpB,GAAG,CAACuM,QAAJ,CAAa,CAAb,CAAP;UACD,CAlBI,CAAP;QAT4D;MA4B7D,CA3GI;;MA6GC3J,uBAAN,CAA8B;QAAEJ;MAAF,CAA9B,EAA8C;QAAA;UAC5CkC,MAAM,CAAC9E,GAAP,CAAW,yBAAX,EAAsC;YAAE4C;UAAF,CAAtC;;UAEA,IAAI,CAACwK,MAAM,CAACrN,MAAP,CAAcwJ,UAAd,EAAL,EAAiC;YAC/B,MAAM,IAAI/H,KAAJ,CAAU,sBAAV,CAAN;UACD;;UAED,OAAO4L,MAAM,CAACrN,MAAP,CACJqS,uBADI,CACoB;YACvBxP,YAAY,EAAE4L,qBAAqB,CAAC5L,YAAD;UADZ,CADpB,EAIJnD,IAJI,CAIEW,GAAD,IAAQ;;;YACZ,IAAIA,GAAG,CAACrE,KAAR,EAAe;cACb,MAAM,IAAIyF,KAAJ,CAAUpB,GAAG,CAACrE,KAAd,CAAN;YACD,CAFD,MAEO,IAAIqE,GAAG,CAACuM,QAAJ,IAAgB,WAAWvM,GAAG,CAACuM,QAAnC,EAA6C;cAClD,MAAM,IAAInL,KAAJ,CAAUpB,GAAG,CAACuM,QAAJ,CAAa5Q,KAAb,CAAmBuF,OAA7B,CAAN;YACD,CALW,CAOZ;;;YACA,IAAI,EAAC,SAAG,CAACqL,QAAJ,MAAY,IAAZ,IAAYlP,aAAZ,GAAY,MAAZ,GAAYA,GAAEuD,MAAf,CAAJ,EAA2B;cACzB,MAAM,IAAIQ,KAAJ,CAAU,kBAAV,CAAN;YACD;;YAED,OAAOpB,GAAG,CAACuM,QAAX;UACD,CAjBI,CAAP;QAP4C;MAyB7C;;IAtII,CAAP;EAwID,CAhPW;;EAAA,gBAANwM,MAAM;IAAA;EAAA;AAAA,GAAZ;;AAkPM,SAAUre,WAAV,CAAsB;EAC1BiU,OAAO,GAAGjS,6CADgB;EAE1BkS,UAAU,GAAG;AAFa,IAGV,EAHZ,EAGc;EAClB,oNAAO,aAAW;IAChB,MAAMC,MAAM,GAAGrC,mDAAQ,EAAvB;IACA,MAAMsD,SAAS,SAASf,WAAW,EAAnC;;IAEA,IAAIF,MAAJ,EAAY;MACV,OAAO,IAAP;IACD,CANe,CAQhB;IACA;;;IACA,MAAM3K,mEAAO,CAAC,MAAK;MAAA;;MAAC,QAAC,EAAC,YAAM,CAACwM,IAAP,MAAW,IAAX,IAAWrT,aAAX,GAAW,MAAX,GAAWA,GAAE8L,UAAF,EAAZ,CAAD;IAA2B,CAAlC,EAAoC;MAAE/E,OAAO,EAAE;IAAX,CAApC,CAAP,CAA6D5I,KAA7D,CACJ,MAAM,KADF,CAAN;IAIA,OAAO;MACL6J,EAAE,EAAE,QADC;MAELpD,IAAI,EAAE,UAFD;MAGL/F,QAAQ,EAAE;QACRC,IAAI,EAAE,QADE;QAERC,WAAW,EAAE,yCAFL;QAGRuS,OAHQ;QAIRoB,WAAW,EACT,0FALM;QAMRnB,UANQ;QAORzH,SAAS,EAAE2I;MAPH,CAHL;MAYL1I,IAAI,EAAE2R;IAZD,CAAP;EAcD,CA5BD;AA6BD;;;;;;;;;;;;;;;;AC5TyD;;;;;;;;;;;;;;;;ACA1D,iEAAe,g5XAAg5X,EAAC;;;;;;;;;;;;;;;;;;;;;ACAh6X;AAEA;;AAGA,MAAMW,mBAAN,CAAyB;EAGjBtS,IAAI,CAACjD,IAAD,EAA8B;IAAA;;IAAA;MACtC,KAAI,CAAC0I,MAAL,SAAoB2M,uEAAA,CAAYrV,IAAZ,CAApB;IADsC;EAEvC;;EAEU,IAAPwV,OAAO;IACT,OAAO,KAAK9M,MAAL,CAAY8M,OAAnB;EACD;;EAEDhT,EAAE,CACAC,KADA,EAEA0C,QAFA,EAE+D;IAE/D,KAAKuD,MAAL,CAAYlG,EAAZ,CAAeC,KAAf,EAAsB0C,QAAtB;IAEA,OAAO;MACLmC,MAAM,EAAE,MAAM,KAAKoB,MAAL,CAAY+M,cAAZ,CAA2BhT,KAA3B,EAAkC0C,QAAlC;IADT,CAAP;EAGD;;EAEDuQ,IAAI,CACFjT,KADE,EAEF0C,QAFE,EAE6D;IAE/D,KAAKuD,MAAL,CAAYgN,IAAZ,CAAiBjT,KAAjB,EAAwB0C,QAAxB;EACD;;EAEKyE,OAAO,CAAC7L,MAAD,EAAkC;IAAA;;IAAA;MAC7C,OAAO,IAAI1D,OAAJ,CAAiC,CAACoF,OAAD,EAAU+T,MAAV,KAAoB;QAC1D,MAAI,CAAC9K,MAAL,CACGkB,OADH,CACW7L,MADX,EAEG7C,IAFH,CAEQ,CAAC;UAAEya,GAAF;UAAOC;QAAP,CAAD,KAAsB;UAC1B,IAAID,GAAJ,EAAS;YACPL,uEAAA,CAAiBK,GAAjB,EAAsB,MAAK;cACzBnC,MAAM,CAAC,IAAIvW,KAAJ,CAAU,wBAAV,CAAD,CAAN;YACD,CAFD;UAGD;;UAED2Y,QAAQ,GACL1a,IADH,CACQuE,OADR,EAEGpI,KAFH,CAESmc,MAFT,EAGGqC,OAHH,CAGW,MAAMP,wEAAA,EAHjB;QAID,CAbH,EAcGje,KAdH,CAcSmc,MAdT;MAeD,CAhBM,CAAP;IAD6C;EAkB9C;;EAEKsC,OAAO,CACX/X,MADW,EACsB;IAAA;;IAAA;MAEjC,OAAO,MAAI,CAAC2K,MAAL,CAAYoN,OAAZ,CAAoB/X,MAApB,CAAP;IAFiC;EAGlC;;EAEK2L,UAAU,CAAC3L,MAAD,EAAqC;IAAA;;IAAA;MACnD,OAAO,MAAI,CAAC2K,MAAL,CAAYgB,UAAZ,CAAuB3L,MAAvB,CAAP;IADmD;EAEpD;;AAzDsB;;AA4DzB,iEAAewX,mBAAf;;;;;;;;;;;;;;;;;;;;;;;ACjEA;AAiBA;AACA;AAEA;AACA;AAwCA,MAAMS,UAAU,GAAG,CACjB,aADiB,EAEjB,cAFiB,EAGjB,kBAHiB,EAIjB,sBAJiB,EAKjB,uBALiB,CAAnB;AAQA,MAAMC,SAAS,GAAG,CAAC,cAAD,EAAiB,iBAAjB,CAAlB;;AAEA,MAAMC,uBAAuB;EAAA,2MAAG,WAC9BhV,EAD8B,EAE9BnD,MAF8B,EAGC;IAC/B,MAAM2K,MAAM,GAAG,IAAI6M,8DAAJ,EAAf;IACA,IAAIC,OAAO,GAA+B,IAA1C;IACA,MAAMW,QAAQ,GAAG,IAAItK,8EAAJ,CACf1S,MAAM,CAACmT,YADQ,EAEf,wBAAwBpL,EAAE,YAFX,CAAjB;IAKA,MAAMwH,MAAM,CAACzF,IAAP,CAAY;MAChBnL,SAAS,EAAEiG,MAAM,CAACjG,SADF;MAEhBC,QAAQ,EAAEgG,MAAM,CAAChG,QAFD;MAGhBqe,QAAQ,EAAErY,MAAM,CAACqY;IAHD,CAAZ,CAAN;;IAMA,IAAI1N,MAAM,CAAC8M,OAAP,CAAe/Y,MAAnB,EAA2B;MACzB,MAAM4Z,YAAY,GAAG3N,MAAM,CAAC8M,OAAP,CAAec,IAAf,CAAoB7Z,MAApB,GAA6B,CAAlD;MACA+Y,OAAO,GAAG9M,MAAM,CAAC8M,OAAP,CAAee,GAAf,CAAmB7N,MAAM,CAAC8M,OAAP,CAAec,IAAf,CAAoBD,YAApB,CAAnB,CAAV;IACD;;IAED,OAAO;MACL3N,MADK;MAEL8M,OAFK;MAGLW,QAHK;MAILxN,aAAa,EAAE;IAJV,CAAP;EAMD,CA5B4B;;EAAA,gBAAvBuN,uBAAuB;IAAA;EAAA;AAAA,GAA7B;;AA8BA,MAAMM,aAAa;EAAA,4MAGf,WAAO;IACTtV,EADS;IAETxG,OAFS;IAGT/B,KAHS;IAIToF,MAJS;IAKTpD,QALS;IAMToG,OANS;IAOTR,MAPS;IAQTxI;EARS,CAAP,EASC;IACH,MAAM8Q,MAAM,SAASqN,uBAAuB,CAAChV,EAAD,EAAKnD,MAAL,CAA5C;;IAEA,MAAM0Y,UAAU,GAAG,MAAK;MACtB,IAAI1Y,MAAM,CAAC2Y,OAAX,EAAoB;QAClB,OAAO3Y,MAAM,CAAC2Y,OAAd;MACD;;MAED,MAAM;QAAEhU;MAAF,IAAgBhI,OAAO,CAAC/C,OAA9B;;MAEA,IAAI,CAAC,SAAD,EAAY,SAAZ,EAAuBgf,QAAvB,CAAgCjU,SAAhC,CAAJ,EAAgD;QAC9C,OAAO,QAAQA,SAAS,EAAxB;MACD;;MAED,MAAM,IAAIzF,KAAJ,CAAU,kBAAV,CAAN;IACD,CAZD;;IAcA,MAAMmE,WAAW,GAAG,MAAK;;;MACvB,OAAO,CAAC,aAAM,CAACoU,OAAP,MAAc,IAAd,IAActc,aAAd,GAAc,MAAd,GAAcA,GAAE0d,UAAF,CAAa,MAAb,EAAqB/d,QAAnC,KAA+C,EAAhD,EAAoDiB,GAApD,CAAyDyC,CAAD,KAAQ;QACrEzD,SAAS,EAAEyD,CAAC,CAAC4J,KAAF,CAAQ,GAAR,EAAa,CAAb;MAD0D,CAAR,CAAxD,CAAP;IAGD,CAJD;;IAMA,MAAMoD,OAAO;MAAA,4MAAG,aAAW;QACzBV,MAAM,CAACF,aAAP,CAAqBa,OAArB,CAA8BtM,YAAD,IAAkBA,YAAY,CAACoK,MAAb,EAA/C;;QAEAuB,MAAM,CAACF,aAAP,GAAuB,EAAvB;QACAE,MAAM,CAAC2M,OAAP,GAAiB,IAAjB;QAEA,MAAM3M,MAAM,CAACsN,QAAP,CAAgBxJ,KAAhB,EAAN;MACD,CAPY;;MAAA,gBAAPpD,OAAO;QAAA;MAAA;IAAA,GAAb;;IASA,MAAMM,iBAAiB,GAAG,CACxBK,WADwB,EAExBH,SAFwB,KAGtB;MACF,IAAIA,SAAS,CAACC,UAAV,KAAyB,YAA7B,EAA2C;QACzC,OAAOD,SAAP;MACD,CAHC,CAKF;;;MACA,MAAM;QAAE8M,WAAF;QAAeC;MAAf,IAAgC/M,SAAS,CAACC,UAAV,CAAqB+M,YAA3D;;MAEA,IAAI7M,WAAW,CAAC1L,UAAZ,KAA2BqY,WAA/B,EAA4C;QAC1C,OAAO,IAAP;MACD;;MAED,OAAO3M,WAAW,CAACrM,OAAZ,CAAoBqX,KAApB,CAA2BtR,MAAD,IAAW;QAC1C,IAAIA,MAAM,CAAC9F,IAAP,KAAgB,cAApB,EAAoC;UAClC,OAAO,KAAP;QACD;;QAED,MAAM;UAAEE,UAAF;UAAcI;QAAd,IAA0BwF,MAAM,CAAC7F,MAAvC;;QAEA,IAAI+Y,YAAY,CAACra,MAAb,IAAuBqa,YAAY,CAACH,QAAb,CAAsB3Y,UAAtB,CAA3B,EAA8D;UAC5D,OAAO,KAAP;QACD;;QAED,OAAOgZ,UAAU,CAAC5Y,OAAD,CAAV,IAAuB,CAA9B;MACD,CAZM,CAAP;IAaD,CA5BD;;IA8BA,MAAMkK,gBAAgB;MAAA,4MAAG,WAAOjK,YAAP,EAA2C;QAClE,MAAMyK,MAAM,GAAG,IAAIiN,uDAAJ,CAAmBlN,MAAM,CAACsN,QAA1B,CAAf;QACA,MAAM9L,kBAAkB,GAA8C,EAAtE;QAEA,MAAMc,KAAK,SAASxQ,QAAQ,CAACwQ,KAAT,CAAe;UAAEnQ,QAAQ,EAAE;QAAZ,CAAf,CAApB;;QAEA,KAAK,IAAIsD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,YAAY,CAAC5B,MAAjC,EAAyC6B,CAAC,IAAI,CAA9C,EAAiD;UAC/C,MAAM4L,WAAW,GAAG7L,YAAY,CAACC,CAAD,CAAhC;UACA,MAAM6K,SAAS,SAASL,MAAM,CAACE,YAAP,CACtBkB,WAAW,CAACtM,QADU,EAEtBlD,OAAO,CAAC/C,OAAR,CAAgB+K,SAFM,CAAxB;;UAKA,IAAI,CAACyG,SAAL,EAAgB;YACd,MAAM,IAAIlM,KAAJ,CAAU,qBAAV,CAAN;UACD;;UAED,MAAM8M,SAAS,SAASpP,QAAQ,CAACG,KAAT,CAA8B;YACpDC,YAAY,EAAE,iBADsC;YAEpDC,QAAQ,EAAE,OAF0C;YAGpDC,UAAU,EAAEiP,WAAW,CAACtM,QAH4B;YAIpDuP,UAAU,EAAEhE,SAAS,CAAChN,QAAV;UAJwC,CAA9B,CAAxB;;UAOA,IAAI,CAAC0N,iBAAiB,CAACK,WAAD,EAAcH,SAAd,CAAtB,EAAgD;YAC9C,MAAM,IAAI9M,KAAJ,CAAU,oBAAV,CAAN;UACD;;UAED,MAAMiW,EAAE,GAAGpH,uEAAA,CACTzN,YAAY,CAACC,CAAD,CAAZ,CAAgBV,QADP,EAEThE,6DAAA,CAAqBuP,SAAS,CAAChN,QAAV,EAArB,CAFS,EAGTkC,YAAY,CAACC,CAAD,CAAZ,CAAgBE,UAHP,EAITuL,SAAS,CAACsD,KAAV,GAAkB/O,CAAlB,GAAsB,CAJb,EAKT4L,WAAW,CAACrM,OAAZ,CAAoB/D,GAApB,CAAyB8J,MAAD,IAAYsI,gFAAY,CAACtI,MAAD,CAAhD,CALS,EAMThK,oEAAA,CAA4BuR,KAAK,CAACE,MAAN,CAAaC,IAAzC,CANS,CAAX;UASA,MAAM,GAAG+H,QAAH,UAAqBvH,qEAAA,CACzBoH,EADyB,EAEzBpK,MAFyB,EAGzBzK,YAAY,CAACC,CAAD,CAAZ,CAAgBV,QAHS,EAIzBlD,OAAO,CAAC/C,OAAR,CAAgB+K,SAJS,CAA3B;UAOA2H,kBAAkB,CAAC9L,IAAnB,CAAwB8U,QAAxB;QACD;;QAED,OAAOhJ,kBAAP;MACD,CAhDqB;;MAAA,gBAAhB/B,gBAAgB;QAAA;MAAA;IAAA,GAAtB;;IAkDA,MAAM2O,eAAe;MAAA,4MAAG,aAAW;QACjC,OAAOpO,MAAM,CAACH,MAAP,CAAcoN,OAAd,CAAmD;UACxDoB,KAAK,EAAErO,MAAM,CAAC2M,OAAP,CAAgB0B,KADiC;UAExDR,OAAO,EAAED,UAAU,EAFqC;UAGxDX,OAAO,EAAE;YACPqB,MAAM,EAAE,kBADD;YAEPpZ,MAAM,EAAE;UAFD;QAH+C,CAAnD,CAAP;MAQD,CAToB;;MAAA,gBAAfkZ,eAAe;QAAA;MAAA;IAAA,GAArB;;IAWA,MAAMG,sBAAsB;MAAA,4MAAG,WAAOlN,WAAP,EAAmC;QAChE,MAAMrR,QAAQ,SAASoe,eAAe,EAAtC;QACA,MAAMje,OAAO,GAAGH,QAAQ,CAACE,IAAT,CAAewD,CAAD,IAAOA,CAAC,CAACzD,SAAF,KAAgBoR,WAAW,CAACtM,QAAjD,CAAhB;;QAEA,IAAI,CAAC5E,OAAL,EAAc;UACZ,MAAM,IAAIiE,KAAJ,CAAU,mBAAV,CAAN;QACD;;QAED,MAAM,CAACkO,KAAD,EAAQpB,SAAR,UAA2B1P,OAAO,CAACC,GAAR,CAAY,CAC3CK,QAAQ,CAACwQ,KAAT,CAAe;UAAEnQ,QAAQ,EAAE;QAAZ,CAAf,CAD2C,EAE3CL,QAAQ,CAACG,KAAT,CAA8B;UAC5BC,YAAY,EAAE,iBADc;UAE5BC,QAAQ,EAAE,OAFkB;UAG5BC,UAAU,EAAEiP,WAAW,CAACtM,QAHI;UAI5BuP,UAAU,EAAEnU,OAAO,CAACmQ;QAJQ,CAA9B,CAF2C,CAAZ,CAAjC;QAUA,MAAM+J,EAAE,GAAGpH,uEAAA,CACT5B,WAAW,CAACtM,QADH,EAEThE,6DAAA,CAAqBZ,OAAO,CAACmQ,SAA7B,CAFS,EAGTe,WAAW,CAAC1L,UAHH,EAITuL,SAAS,CAACsD,KAAV,GAAkB,CAJT,EAKTnD,WAAW,CAACrM,OAAZ,CAAoB/D,GAApB,CAAyB8J,MAAD,IAAYsI,gFAAY,CAACtI,MAAD,CAAhD,CALS,EAMThK,oEAAA,CAA4BuR,KAAK,CAACE,MAAN,CAAaC,IAAzC,CANS,CAAX;QASA,MAAMpP,MAAM,SAAS2M,MAAM,CAACH,MAAP,CAAcoN,OAAd,CAAkC;UACrDoB,KAAK,EAAErO,MAAM,CAAC2M,OAAP,CAAgB0B,KAD8B;UAErDR,OAAO,EAAED,UAAU,EAFkC;UAGrDX,OAAO,EAAE;YACPqB,MAAM,EAAE,sBADD;YAEPpZ,MAAM,EAAE;cAAEmM,WAAW,EAAEgJ,EAAE,CAACmE,MAAH;YAAf;UAFD;QAH4C,CAAlC,CAArB;QASA,OAAOvL,8EAAA,CAA0C9P,MAAM,CAACC,IAAP,CAAYC,MAAZ,CAA1C,CAAP;MACD,CArC2B;;MAAA,gBAAtBkb,sBAAsB;QAAA;MAAA;IAAA,GAA5B;;IAuCA,MAAMvJ,uBAAuB;MAAA,4MAAG,WAAOxP,YAAP,EAA2C;QACzE,IAAI,CAACA,YAAY,CAAC5B,MAAlB,EAA0B;UACxB,OAAO,EAAP;QACD;;QAED,MAAM8a,GAAG,GAAwC,EAAjD;QAEA,MAAM,CAACpM,KAAD,EAAQtS,QAAR,UAA0BwB,OAAO,CAACC,GAAR,CAAY,CAC1CK,QAAQ,CAACwQ,KAAT,CAAe;UAAEnQ,QAAQ,EAAE;QAAZ,CAAf,CAD0C,EAE1Cic,eAAe,EAF2B,CAAZ,CAAhC;;QAKA,KAAK,IAAI3Y,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,YAAY,CAAC5B,MAAjC,EAAyC6B,CAAC,IAAI,CAA9C,EAAiD;UAC/C,MAAM4L,WAAW,GAAG7L,YAAY,CAACC,CAAD,CAAhC;UACA,MAAMtF,OAAO,GAAGH,QAAQ,CAACE,IAAT,CACbwD,CAAD,IAAOA,CAAC,CAACzD,SAAF,KAAgBoR,WAAW,CAACtM,QADrB,CAAhB;;UAIA,IAAI,CAAC5E,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,mBAAV,CAAN;UACD;;UAED,MAAM8M,SAAS,SAASpP,QAAQ,CAACG,KAAT,CAA8B;YACpDC,YAAY,EAAE,iBADsC;YAEpDC,QAAQ,EAAE,OAF0C;YAGpDC,UAAU,EAAEiP,WAAW,CAACtM,QAH4B;YAIpDuP,UAAU,EAAEnU,OAAO,CAACmQ;UAJgC,CAA9B,CAAxB;UAOAoO,GAAG,CAAChZ,IAAJ,CACEuN,uEAAA,CACE5B,WAAW,CAACtM,QADd,EAEEhE,6DAAA,CAAqBZ,OAAO,CAACmQ,SAA7B,CAFF,EAGEe,WAAW,CAAC1L,UAHd,EAIEuL,SAAS,CAACsD,KAAV,GAAkB/O,CAAlB,GAAsB,CAJxB,EAKE4L,WAAW,CAACrM,OAAZ,CAAoB/D,GAApB,CAAyB8J,MAAD,IAAYsI,gFAAY,CAACtI,MAAD,CAAhD,CALF,EAMEhK,oEAAA,CAA4BuR,KAAK,CAACE,MAAN,CAAaC,IAAzC,CANF,CADF;QAUD;;QAED,MAAMf,OAAO,SAAS1B,MAAM,CAACH,MAAP,CAAcoN,OAAd,CAAyC;UAC7DoB,KAAK,EAAErO,MAAM,CAAC2M,OAAP,CAAgB0B,KADsC;UAE7DR,OAAO,EAAED,UAAU,EAF0C;UAG7DX,OAAO,EAAE;YACPqB,MAAM,EAAE,8BADD;YAEPpZ,MAAM,EAAE;cAAEM,YAAY,EAAEkZ,GAAG,CAACzd,GAAJ,CAASyC,CAAD,IAAOA,CAAC,CAAC8a,MAAF,EAAf;YAAhB;UAFD;QAHoD,CAAzC,CAAtB;QASA,OAAO9M,OAAO,CAACzQ,GAAR,CAAaoC,MAAD,IAAW;UAC5B,OAAO4P,8EAAA,CAA0C9P,MAAM,CAACC,IAAP,CAAYC,MAAZ,CAA1C,CAAP;QACD,CAFM,CAAP;MAGD,CArD4B;;MAAA,gBAAvB2R,uBAAuB;QAAA;MAAA;IAAA,GAA7B;;IAuDA,MAAM2J,2BAA2B,GAAG,MAAkC;MACpE,MAAM3e,QAAQ,GAAGuI,WAAW,EAA5B;MAEA,OAAOvI,QAAQ,CAACiB,GAAT,CAAa,CAAC;QAAEhB;MAAF,CAAD,MAAoB;QACtCA,SADsC;QAEtC2e,OAAO,EAAE7d,iEAAA,CAAyB,SAAzB;MAF6B,CAApB,CAAb,CAAP;IAID,CAPD;;IASA,MAAM2T,aAAa;MAAA,4MAAG,WACpBvD,UADoB,EAElB;QACF,MAAM4N,QAAQ,GAAGJ,2BAA2B,EAA5C;QACA,MAAMK,qBAAqB,GAAgCD,QAAQ,CAAC9d,GAAT,CACzD,CAAC;UAAEhB,SAAF;UAAa2e;QAAb,CAAD,MAA6B;UAC3B3e,SAD2B;UAE3BqQ,SAAS,EAAEsO,OAAO,CAACzO,YAAR,GAAuB7M,QAAvB;QAFgB,CAA7B,CADyD,CAA3D;QAOA,MAAM0M,MAAM,CAACH,MAAP,CAAcoN,OAAd,CAAsB;UAC1BoB,KAAK,EAAErO,MAAM,CAAC2M,OAAP,CAAgB0B,KADG;UAE1BR,OAAO,EAAED,UAAU,EAFO;UAG1BX,OAAO,EAAE;YACPqB,MAAM,EAAE,aADD;YAEPpZ,MAAM,EAAE;cACNiM,UAAU,EAAEA,UADN;cAENnR,QAAQ,EAAEgf;YAFJ;UAFD;QAHiB,CAAtB,CAAN;;QAYA,KAAK,IAAIvZ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsZ,QAAQ,CAACnb,MAA7B,EAAqC6B,CAAC,IAAI,CAA1C,EAA6C;UAC3C,MAAM;YAAExF,SAAF;YAAa2e;UAAb,IAAyBG,QAAQ,CAACtZ,CAAD,CAAvC;UAEA,MAAMuK,MAAM,CAACsN,QAAP,CAAgB2B,MAAhB,CACJpd,OAAO,CAAC/C,OAAR,CAAgB+K,SADZ,EAEJ5J,SAFI,EAGJ2e,OAHI,CAAN;QAKD;MACF,CAhCkB;;MAAA,gBAAblK,aAAa;QAAA;MAAA;IAAA,GAAnB;;IAkCA,MAAMwK,cAAc;MAAA,4MAAG,aAAW;QAChC,MAAMlf,QAAQ,GAAGuI,WAAW,EAA5B;QACA,MAAMyW,qBAAqB,GAAgC,EAA3D;;QAEA,KAAK,IAAIvZ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGzF,QAAQ,CAAC4D,MAA7B,EAAqC6B,CAAC,IAAI,CAA1C,EAA6C;UAC3C,MAAMtF,OAAO,GAAGH,QAAQ,CAACyF,CAAD,CAAxB;UACA,MAAMmZ,OAAO,SAAS5O,MAAM,CAACsN,QAAP,CAAgB6B,MAAhB,CACpBtd,OAAO,CAAC/C,OAAR,CAAgB+K,SADI,EAEpB1J,OAAO,CAACF,SAFY,CAAtB;;UAKA,IAAI,CAAC2e,OAAL,EAAc;YACZ;UACD;;UAEDI,qBAAqB,CAACtZ,IAAtB,CAA2B;YACzBzF,SAAS,EAAEE,OAAO,CAACF,SADM;YAEzBqQ,SAAS,EAAEsO,OAAO,CAACzO,YAAR,GAAuB7M,QAAvB;UAFc,CAA3B;QAID;;QAED,IAAI,CAAC0b,qBAAqB,CAACpb,MAA3B,EAAmC;UACjC;QACD;;QAED,MAAMoM,MAAM,CAACH,MAAP,CAAcoN,OAAd,CAAsB;UAC1BoB,KAAK,EAAErO,MAAM,CAAC2M,OAAP,CAAgB0B,KADG;UAE1BR,OAAO,EAAED,UAAU,EAFO;UAG1BX,OAAO,EAAE;YACPqB,MAAM,EAAE,cADD;YAEPpZ,MAAM,EAAE;cACNlF,QAAQ,EAAEgf;YADJ;UAFD;QAHiB,CAAtB,CAAN;;QAWA,KAAK,IAAIvZ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuZ,qBAAqB,CAACpb,MAA1C,EAAkD6B,CAAC,IAAI,CAAvD,EAA0D;UACxD,MAAM;YAAExF;UAAF,IAAgB+e,qBAAqB,CAACvZ,CAAD,CAA3C;UAEA,MAAMuK,MAAM,CAACsN,QAAP,CAAgB8B,SAAhB,CAA0Bvd,OAAO,CAAC/C,OAAR,CAAgB+K,SAA1C,EAAqD5J,SAArD,CAAN;QACD;MACF,CAzCmB;;MAAA,gBAAdif,cAAc;QAAA;MAAA;IAAA,GAApB;;IA2CA,MAAMxc,OAAO;MAAA,6MAAG,aAAW;QACzB,IAAIsN,MAAM,CAAC2M,OAAX,EAAoB;UAClB,MAAMuC,cAAc,EAApB;UAEA,MAAMlP,MAAM,CAACH,MAAP,CAAcgB,UAAd,CAAyB;YAC7BwN,KAAK,EAAErO,MAAM,CAAC2M,OAAP,CAAe0B,KADO;YAE7BgB,MAAM,EAAE;cACNC,IAAI,EAAE,IADA;cAENpb,OAAO,EAAE;YAFH;UAFqB,CAAzB,CAAN;QAOD;;QAED,MAAMwM,OAAO,EAAb;MACD,CAdY;;MAAA,gBAAPhO,OAAO;QAAA;MAAA;IAAA,GAAb;;IAgBA,MAAMuZ,WAAW,GAAG,MAAK;MACvBjM,MAAM,CAACF,aAAP,CAAqBpK,IAArB,CACEsK,MAAM,CAACH,MAAP,CAAclG,EAAd,CAAiB,gBAAjB,EAAoCC,KAAD,IAAU;;;QAC3ClC,MAAM,CAAC9E,GAAP,CAAW,gBAAX,EAA6BgH,KAA7B;;QAEA,IAAIA,KAAK,CAACyU,KAAN,MAAgB,YAAM,CAAC1B,OAAP,MAAc,IAAd,IAActc,aAAd,GAAc,MAAd,GAAcA,GAAEge,KAAhC,CAAJ,EAA2C;UACzCrO,MAAM,CAAC2M,OAAP,GAAcpa,gCACTyN,MAAM,CAACH,MAAP,CAAc8M,OAAd,CAAsBe,GAAtB,CAA0B9T,KAAK,CAACyU,KAAhC,CADS,GAC6B;YACzCN,UAAU,EAAEnU,KAAK,CAAC1E,MAAN,CAAa6Y;UADgB,CAD7B,CAAd;UAKA7V,OAAO,CAAC4B,IAAR,CAAa,iBAAb,EAAgC;YAAE9J,QAAQ,EAAEuI,WAAW;UAAvB,CAAhC;QACD;MACF,CAXD,CADF;;MAeAyH,MAAM,CAACF,aAAP,CAAqBpK,IAArB,CACEsK,MAAM,CAACH,MAAP,CAAclG,EAAd,CAAiB,gBAAjB;QAAA,6MAAmC,WAAOC,KAAP,EAAgB;;;UACjDlC,MAAM,CAAC9E,GAAP,CAAW,iBAAX,EAA8BgH,KAA9B;;UAEA,IAAIA,KAAK,CAACyU,KAAN,MAAgB,YAAM,CAAC1B,OAAP,MAAc,IAAd,IAActc,aAAd,GAAc,MAAd,GAAcA,GAAEge,KAAhC,CAAJ,EAA2C;YACzC,MAAM3N,OAAO,EAAb;YACAxI,OAAO,CAAC4B,IAAR,CAAa,WAAb,EAA0B,IAA1B;UACD;QACF,CAPD;;QAAA;UAAA;QAAA;MAAA,IADF;IAUD,CA1BD;;IA4BA,IAAIkG,MAAM,CAAC2M,OAAX,EAAoB;MAClBV,WAAW;IACZ;;IAED,OAAO;MACCzZ,MAAN,CAAa;QAAE5C,UAAF;QAAcwJ,WAAW,GAAG;MAA5B,CAAb,EAA6C;QAAA;UAC3C,MAAMkI,gBAAgB,GAAG/I,WAAW,EAApC;;UAEA,IAAI+I,gBAAgB,CAAC1N,MAArB,EAA6B;YAC3B,OAAO0N,gBAAP;UACD;;UAED,IAAI;YACFtB,MAAM,CAAC2M,OAAP,SAAuB3M,MAAM,CAACH,MAAP,CAAckB,OAAd,CAAsB;cAC3CwO,kBAAkB,EAAE;gBAClB7L,IAAI,EAAE;kBACJ8L,MAAM,EAAE,CAAC5B,UAAU,EAAX,CADJ;kBAEJjJ,OAAO,EAAEwI,UAFL;kBAGJsC,MAAM,EAAErC;gBAHJ;cADY;YADuB,CAAtB,CAAvB;YAUA,MAAM1I,aAAa,CAAC;cAAE/O,UAAU,EAAE/F,UAAd;cAA0BwJ;YAA1B,CAAD,CAAnB;YAEA6S,WAAW;YAEX,OAAO1T,WAAW,EAAlB;UACD,CAhBD,CAgBE,OAAO9J,GAAP,EAAY;YACZ,MAAMiE,OAAO,EAAb;YAEA,MAAMjE,GAAN;UACD;QA3B0C;MA4B5C,CA7BI;;MA+BLiE,OA/BK;;MAiCC6F,WAAN,GAAiB;QAAA;UACf,OAAOA,WAAW,EAAlB;QADe;MAEhB,CAnCI;;MAqCCtE,WAAN,CAAkB;QAAEC;MAAF,CAAlB,EAA6B;QAAA;UAC3BwD,MAAM,CAAC9E,GAAP,CAAW,2BAAX,EAAwC;YAAEsB;UAAF,CAAxC;UAEA,MAAM,IAAIE,KAAJ,CAAU,2BAA2BlF,QAAQ,CAACC,IAAI,EAAlD,CAAN;QAH2B;MAI5B,CAzCI;;MA2CC2F,sBAAN,CAA6B;QAAEC,QAAF;QAAYY,UAAZ;QAAwBX;MAAxB,CAA7B,EAA8D;QAAA;UAC5D0C,MAAM,CAAC9E,GAAP,CAAW,wBAAX,EAAqC;YAAEmC,QAAF;YAAYY,UAAZ;YAAwBX;UAAxB,CAArC;UAEA,MAAM;YAAEH;UAAF,IAAe/E,KAAK,CAACC,QAAN,EAArB;;UAEA,IAAI,CAACiQ,MAAM,CAAC2M,OAAR,IAAmB,CAAC9X,QAAxB,EAAkC;YAChC,MAAM,IAAIT,KAAJ,CAAU,sBAAV,CAAN;UACD;;UAED,MAAMjE,OAAO,GAAGuP,4EAAgB,CAAC5P,KAAK,CAACC,QAAN,EAAD,CAAhC;;UAEA,IAAI,CAACI,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,mBAAV,CAAN;UACD;;UAED,MAAMsb,mBAAmB,GAAgB;YACvC3a,QAAQ,EAAEA,QAAQ,IAAI5E,OAAO,CAACF,SADS;YAEvC0F,UAAU,EAAEA,UAAU,IAAId,QAAQ,CAACjF,UAFI;YAGvCoF;UAHuC,CAAzC;;UAMA,IAAI;YACF,MAAM,CAACwV,QAAD,UAAmB/K,gBAAgB,CAAC,CAACiQ,mBAAD,CAAD,CAAzC;YACA,OAAO5d,QAAQ,CAAC2P,eAAT,CAAyB+I,QAAzB,CAAP;UACD,CAHD,CAGE,OAAO/b,GAAP,EAAY;YACZiJ,MAAM,CAAC9E,GAAP,CAAW,mDAAX,EAAgEnE,GAAhE;YAEA,MAAM+b,QAAQ,SAAS+D,sBAAsB,CAACmB,mBAAD,CAA7C;YACA,OAAO5d,QAAQ,CAAC2P,eAAT,CAAyB+I,QAAzB,CAAP;UACD;QA7B2D;MA8B7D,CAzEI;;MA2EC5U,uBAAN,CAA8B;QAAEJ;MAAF,CAA9B,EAA8C;QAAA;UAC5CkC,MAAM,CAAC9E,GAAP,CAAW,yBAAX,EAAsC;YAAE4C;UAAF,CAAtC;UAEA,MAAM;YAAEX;UAAF,IAAe/E,KAAK,CAACC,QAAN,EAArB;;UAEA,IAAI,CAACiQ,MAAM,CAAC2M,OAAR,IAAmB,CAAC9X,QAAxB,EAAkC;YAChC,MAAM,IAAIT,KAAJ,CAAU,sBAAV,CAAN;UACD;;UAED,MAAMjE,OAAO,GAAGuP,4EAAgB,CAAC5P,KAAK,CAACC,QAAN,EAAD,CAAhC;;UAEA,IAAI,CAACI,OAAL,EAAc;YACZ,MAAM,IAAIiE,KAAJ,CAAU,mBAAV,CAAN;UACD;;UAED,MAAMub,oBAAoB,GAAGna,YAAY,CAACvE,GAAb,CAAkByC,CAAD,KAAQ;YACpDqB,QAAQ,EAAErB,CAAC,CAACqB,QAAF,IAAc5E,OAAO,CAACF,SADoB;YAEpD0F,UAAU,EAAEjC,CAAC,CAACiC,UAFsC;YAGpDX,OAAO,EAAEtB,CAAC,CAACsB;UAHyC,CAAR,CAAjB,CAA7B;;UAMA,IAAI;YACF,MAAMyW,SAAS,SAAShM,gBAAgB,CAACkQ,oBAAD,CAAxC;YACA,MAAMjO,OAAO,GAA2C,EAAxD;;YAEA,KAAK,IAAIjM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgW,SAAS,CAAC7X,MAA9B,EAAsC6B,CAAC,IAAI,CAA3C,EAA8C;cAC5CiM,OAAO,CAAChM,IAAR,OAAmB5D,QAAQ,CAAC2P,eAAT,CAAyBgK,SAAS,CAAChW,CAAD,CAAlC,CAAnB;YACD;;YAED,OAAOiM,OAAP;UACD,CATD,CASE,OAAOjT,GAAP,EAAY;YACZ,MAAMgd,SAAS,SAASzG,uBAAuB,CAAC2K,oBAAD,CAA/C;YACA,MAAMjO,OAAO,GAA2C,EAAxD;;YAEA,KAAK,IAAIjM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgW,SAAS,CAAC7X,MAA9B,EAAsC6B,CAAC,IAAI,CAA3C,EAA8C;cAC5CiM,OAAO,CAAChM,IAAR,OAAmB5D,QAAQ,CAAC2P,eAAT,CAAyBgK,SAAS,CAAChW,CAAD,CAAlC,CAAnB;YACD;;YAED,OAAOiM,OAAP;UACD;QAvC2C;MAwC7C;;IAnHI,CAAP;EAqHD,CAhekB;;EAAA,gBAAbiM,aAAa;IAAA;EAAA;AAAA,GAAnB;;AAkeM,SAAU5f,kBAAV,CAA6B;EACjCkB,SADiC;EAEjCC,QAFiC;EAGjC2e,OAHiC;EAIjCN,QAAQ,GAAG,+BAJsB;EAKjC5L,OAAO,GAAGjS,6CALuB;EAMjCkS,UAAU,GAAG;AANoB,CAA7B,EAOgB;EACpB,oNAAO,aAAW;IAChB,OAAO;MACLvJ,EAAE,EAAE,gBADC;MAELpD,IAAI,EAAE,QAFD;MAGL/F,QAAQ,EAAE;QACRC,IAAI,EAAE,eADE;QAERC,WAAW,EAAE,yBAFL;QAGRuS,OAHQ;QAIRC,UAJQ;QAKRzH,SAAS,EAAE;MALH,CAHL;MAULC,IAAI,EAAGvI,OAAD,IAAY;QAChB,OAAO8b,aAAa,iCACf9b,OADe,GACR;UACVqD,MAAM,EAAE;YACNjG,SADM;YAENC,QAFM;YAGNqe,QAHM;YAINM;UAJM;QADE,CADQ,EAApB;MASD;IApBI,CAAP;EAsBD,CAvBD;AAwBD;;;;;;;;;;;;;;;;;ACvmBmE;;;;;;;;;;;;;;;;;;;;ACAzC;AACuB;AAGlD,MAAM,YAAY,GAAG,CAAC,UAA4B,EAAE,EAAE;IACpD,IAAI,UAAU,KAAK,YAAY,EAAE;QAC/B,OAAO,mEAA0B,EAAE,CAAC;KACrC;IAED,MAAM,EAAE,UAAU,EAAE,WAAW,GAAG,EAAE,EAAE,GAAG,UAAU,CAAC;IACpD,MAAM,SAAS,GAAG,UAAU,CAAC,SAAS;QACpC,CAAC,CAAC,IAAI,qCAAE,CAAC,UAAU,CAAC,SAAS,CAAC;QAC9B,CAAC,CAAC,SAAS,CAAC;IAEd,OAAO,2EAAkC,CAAC,UAAU,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;AAChF,CAAC,CAAC;AAEK,MAAM,YAAY,GAAG,CAAC,MAAc,EAAE,EAAE;IAC7C,QAAQ,MAAM,CAAC,IAAI,EAAE;QACnB,KAAK,eAAe;YAClB,OAAO,mEAA0B,EAAE,CAAC;QACtC,KAAK,gBAAgB,CAAC,CAAC;YACrB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC;YAE/B,OAAO,oEAA2B,CAAC,IAAI,CAAC,CAAC;SAC1C;QACD,KAAK,cAAc,CAAC,CAAC;YACnB,MAAM,EAAE,UAAU,EAAE,IAAI,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC;YAEzD,OAAO,kEAAyB,CAC9B,UAAU,EACV,IAAI,EACJ,IAAI,qCAAE,CAAC,GAAG,CAAC,EACX,IAAI,qCAAE,CAAC,OAAO,CAAC,CAChB,CAAC;SACH;QACD,KAAK,UAAU,CAAC,CAAC;YACf,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC;YAElC,OAAO,8DAAqB,CAAC,IAAI,qCAAE,CAAC,OAAO,CAAC,CAAC,CAAC;SAC/C;QACD,KAAK,OAAO,CAAC,CAAC;YACZ,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC;YAE3C,OAAO,2DAAkB,CAAC,IAAI,qCAAE,CAAC,KAAK,CAAC,EAAE,6DAAoB,CAAC,SAAS,CAAC,CAAC,CAAC;SAC3E;QACD,KAAK,QAAQ,CAAC,CAAC;YACb,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC;YAE/C,OAAO,4DAAmB,CACxB,6DAAoB,CAAC,SAAS,CAAC;YAC/B,mEAAmE;YACnE,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,CACnC,CAAC;SACH;QACD,KAAK,WAAW,CAAC,CAAC;YAChB,MAAM,EAAE,SAAS,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC;YAEpC,OAAO,+DAAsB,CAAC,6DAAoB,CAAC,SAAS,CAAC,CAAC,CAAC;SAChE;QACD,KAAK,eAAe,CAAC,CAAC;YACpB,MAAM,EAAE,aAAa,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC;YAExC,OAAO,mEAA0B,CAAC,aAAa,CAAC,CAAC;SAClD;QACD;YACE,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;KAC1C;AACH,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;ACpEF;AAQA;AAEO,MAAMpO,gBAAgB;EAAA,2MAAG,WAC9BjK,YAD8B,EAE9ByK,MAF8B,EAG9BnR,OAH8B,EAI5B;IACF,MAAMgD,QAAQ,GAAG,IAAIhB,kEAAJ,CAA8B;MAC7CzB,GAAG,EAAEP,OAAO,CAACkD;IADgC,CAA9B,CAAjB;IAIA,MAAMwP,kBAAkB,GAA8C,EAAtE;;IAEA,KAAK,IAAI/L,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,YAAY,CAAC5B,MAAjC,EAAyC6B,CAAC,EAA1C,EAA8C;MAC5C,MAAM6K,SAAS,SAASL,MAAM,CAACE,YAAP,CACtB3K,YAAY,CAACC,CAAD,CAAZ,CAAgBV,QADM,EAEtBjG,OAAO,CAAC+K,SAFc,CAAxB;MAKA,MAAM,CAACyI,KAAD,EAAQpB,SAAR,UAA2B1P,OAAO,CAACC,GAAR,CAAY,CAC3CK,QAAQ,CAACwQ,KAAT,CAAe;QAAEnQ,QAAQ,EAAE;MAAZ,CAAf,CAD2C,EAE3CL,QAAQ,CAACG,KAAT,CAA8B;QAC5BC,YAAY,EAAE,iBADc;QAE5BC,QAAQ,EAAE,OAFkB;QAG5BC,UAAU,EAAEoD,YAAY,CAACC,CAAD,CAAZ,CAAgBV,QAHA;QAI5BuP,UAAU,EAAEhE,SAAS,CAAChN,QAAV;MAJgB,CAA9B,CAF2C,CAAZ,CAAjC;MAUA,MAAM0B,OAAO,GAAGQ,YAAY,CAACC,CAAD,CAAZ,CAAgBT,OAAhB,CAAwB/D,GAAxB,CAA6B8J,MAAD,IAC1CsI,4DAAY,CAACtI,MAAD,CADE,CAAhB;MAIA,MAAMsG,WAAW,GAAG4B,uEAAA,CAClBzN,YAAY,CAACC,CAAD,CAAZ,CAAgBV,QADE,EAElBhE,6DAAA,CAAqBuP,SAAS,CAAChN,QAAV,EAArB,CAFkB,EAGlBkC,YAAY,CAACC,CAAD,CAAZ,CAAgBE,UAHE,EAIlBuL,SAAS,CAACsD,KAAV,GAAkB/O,CAAlB,GAAsB,CAJJ,EAKlBT,OALkB,EAMlBjE,oEAAA,CAA4BuR,KAAK,CAACE,MAAN,CAAaC,IAAzC,CANkB,CAApB;MASA,MAAMlD,QAAQ,SAAS0D,qEAAA,CACrB5B,WADqB,EAErBpB,MAFqB,EAGrBzK,YAAY,CAACC,CAAD,CAAZ,CAAgBV,QAHK,EAIrBjG,OAAO,CAAC+K,SAJa,CAAvB;MAOA2H,kBAAkB,CAAC9L,IAAnB,CAAwB6J,QAAQ,CAAC,CAAD,CAAhC;IACD;;IAED,OAAOiC,kBAAP;EACD,CAnD4B;;EAAA,gBAAhB/B,gBAAgB;IAAA;EAAA;AAAA,GAAtB;;;;;;;;;;;;;;;;;;ACVwC;AACQ;AAEb;;;;;;;;;;;ACH1C;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA","sources":["./examples/angular/src/app/app.component.ts","./examples/angular/src/app/app.component.html","./examples/angular/src/app/app.module.ts","./examples/angular/src/app/components/content/content.component.ts","./examples/angular/src/app/components/content/content.component.html","./examples/angular/src/app/components/form/form.component.ts","./examples/angular/src/app/components/form/form.component.html","./examples/angular/src/app/components/messages/messages.component.ts","./examples/angular/src/app/components/messages/messages.component.html","./examples/angular/src/app/components/sign-in/sign-in.component.ts","./examples/angular/src/app/components/sign-in/sign-in.component.html","./examples/angular/src/constants.ts","./examples/angular/src/environments/environment.ts","./examples/angular/src/main.ts","./packages/core/src/index.ts","./packages/core/src/lib/constants.ts","./packages/core/src/lib/helpers/getActiveAccount.ts","./packages/core/src/lib/helpers/index.ts","./packages/core/src/lib/helpers/waitFor.ts","./packages/core/src/lib/options.ts","./packages/core/src/lib/services/event-emitter/event-emitter.service.ts","./packages/core/src/lib/services/event-emitter/event-emitter.types.ts","./packages/core/src/lib/services/index.ts","./packages/core/src/lib/services/logger/logger.service.ts","./packages/core/src/lib/services/logger/logger.service.types.ts","./packages/core/src/lib/services/provider/provider.service.ts","./packages/core/src/lib/services/provider/provider.service.types.ts","./packages/core/src/lib/services/storage/json-storage.service.ts","./packages/core/src/lib/services/storage/json-storage.service.types.ts","./packages/core/src/lib/services/storage/storage.service.types.ts","./packages/core/src/lib/services/storage/web-storage.service.ts","./packages/core/src/lib/services/wallet-modules/wallet-modules.service.ts","./packages/core/src/lib/store.ts","./packages/core/src/lib/wallet-selector.ts","./packages/default-wallets/src/index.ts","./packages/default-wallets/src/lib/default-wallets.ts","./packages/ledger/src/index.ts","./packages/ledger/src/lib/icon.ts","./packages/ledger/src/lib/ledger-client.ts","./packages/ledger/src/lib/ledger.ts","./packages/math-wallet/src/index.ts","./packages/math-wallet/src/lib/icon.ts","./packages/math-wallet/src/lib/math-wallet.ts","./packages/meteor-wallet/src/index.ts","./packages/meteor-wallet/src/lib/icon.ts","./packages/meteor-wallet/src/lib/meteor-wallet.ts","./packages/modal-ui-js/src/index.ts","./packages/modal-ui-js/src/lib/components/ConnectHardwareWallet.ts","./packages/modal-ui-js/src/lib/components/GetAWallet.ts","./packages/modal-ui-js/src/lib/components/LedgerAccountsOverviewList.ts","./packages/modal-ui-js/src/lib/components/LedgerSelectAccount.ts","./packages/modal-ui-js/src/lib/components/NoLedgerAccountsFound.ts","./packages/modal-ui-js/src/lib/components/SpecifyDerivationPath.ts","./packages/modal-ui-js/src/lib/components/WalletAccount.ts","./packages/modal-ui-js/src/lib/components/WalletConnecting.ts","./packages/modal-ui-js/src/lib/components/WalletConnectionFailed.ts","./packages/modal-ui-js/src/lib/components/WalletNotInstalled.ts","./packages/modal-ui-js/src/lib/components/WhatIsAWallet.ts","./packages/modal-ui-js/src/lib/modal.ts","./packages/modal-ui-js/src/lib/render-modal.ts","./packages/my-near-wallet/src/index.ts","./packages/my-near-wallet/src/lib/icon.ts","./packages/my-near-wallet/src/lib/my-near-wallet.ts","./packages/near-wallet/src/index.ts","./packages/near-wallet/src/lib/icon.ts","./packages/near-wallet/src/lib/near-wallet.ts","./packages/nightly-connect/src/index.ts","./packages/nightly-connect/src/lib/icon.ts","./packages/nightly-connect/src/lib/nightly-connect.ts","./packages/nightly/src/index.ts","./packages/nightly/src/lib/icon.ts","./packages/nightly/src/lib/nightly.ts","./packages/sender/src/index.ts","./packages/sender/src/lib/icon.ts","./packages/sender/src/lib/sender.ts","./packages/wallet-connect/src/index.ts","./packages/wallet-connect/src/lib/icon.ts","./packages/wallet-connect/src/lib/wallet-connect-client.ts","./packages/wallet-connect/src/lib/wallet-connect.ts","./packages/wallet-utils/src/index.ts","./packages/wallet-utils/src/lib/create-action.ts","./packages/wallet-utils/src/lib/sign-transactions.ts","./packages/wallet-utils/src/lib/wallet-utils.ts","ignored|C:\\Users\\haris\\WebstormProjects\\wallet-selector\\node_modules\\@nightlylabs\\connect-near\\node_modules\\bn.js\\lib|buffer","ignored|C:\\Users\\haris\\WebstormProjects\\wallet-selector\\node_modules\\@stablelib\\ed25519\\node_modules\\@stablelib\\random\\lib\\source|crypto","ignored|C:\\Users\\haris\\WebstormProjects\\wallet-selector\\node_modules\\@stablelib\\random\\lib\\source|crypto","ignored|C:\\Users\\haris\\WebstormProjects\\wallet-selector\\node_modules\\bn.js\\lib|buffer","ignored|C:\\Users\\haris\\WebstormProjects\\wallet-selector\\node_modules\\near-api-js\\node_modules\\bn.js\\lib|buffer","ignored|C:\\Users\\haris\\WebstormProjects\\wallet-selector\\node_modules\\near-api-js\\node_modules\\borsh\\node_modules\\bn.js\\lib|buffer","ignored|C:\\Users\\haris\\WebstormProjects\\wallet-selector\\node_modules\\tweetnacl|crypto"],"sourcesContent":["import { Component, OnInit } from \"@angular/core\";\r\nimport { setupWalletSelector } from \"@near-wallet-selector/core\";\r\nimport type { WalletSelector, AccountState } from \"@near-wallet-selector/core\";\r\nimport { setupDefaultWallets } from \"@near-wallet-selector/default-wallets\";\r\nimport { setupNearWallet } from \"@near-wallet-selector/near-wallet\";\r\nimport { setupSender } from \"@near-wallet-selector/sender\";\r\nimport { setupMathWallet } from \"@near-wallet-selector/math-wallet\";\r\nimport { setupNightly } from \"@near-wallet-selector/nightly\";\r\nimport { setupMeteorWallet } from \"@near-wallet-selector/meteor-wallet\";\r\nimport { setupNightlyConnect } from \"@near-wallet-selector/nightly-connect\";\r\nimport { setupWalletConnect } from \"@near-wallet-selector/wallet-connect\";\r\n// import { setupModal } from \"@near-wallet-selector/modal-ui\";\r\n// import type { WalletSelectorModal } from \"@near-wallet-selector/modal-ui\";\r\nimport { setupModal } from \"@near-wallet-selector/modal-ui-js\";\r\nimport type { WalletSelectorModal } from \"@near-wallet-selector/modal-ui-js\";\r\nimport { CONTRACT_ID } from \"../constants\";\r\n\r\ndeclare global {\r\n  interface Window {\r\n    selector: WalletSelector;\r\n    modal: WalletSelectorModal;\r\n  }\r\n}\r\n\r\n@Component({\r\n  selector: \"near-wallet-selector-root\",\r\n  templateUrl: \"./app.component.html\",\r\n  styleUrls: [\"./app.component.scss\"],\r\n})\r\nexport class AppComponent implements OnInit {\r\n  selector: WalletSelector;\r\n  modal: WalletSelectorModal;\r\n  accountId: string | null;\r\n  accounts: Array<AccountState> = [];\r\n\r\n  async ngOnInit() {\r\n    await this.initialize().catch((err) => {\r\n      console.error(err);\r\n      alert(\"Failed to initialise wallet selector\");\r\n    });\r\n  }\r\n\r\n  async initialize() {\r\n    const _selector = await setupWalletSelector({\r\n      network: \"testnet\",\r\n      debug: true,\r\n      modules: [\r\n        ...(await setupDefaultWallets()),\r\n        setupNearWallet(),\r\n        setupSender(),\r\n        setupMathWallet(),\r\n        setupNightly(),\r\n        setupMeteorWallet(),\r\n        setupWalletConnect({\r\n          projectId: \"c4f79cc...\",\r\n          metadata: {\r\n            name: \"NEAR Wallet Selector\",\r\n            description: \"Example dApp used by NEAR Wallet Selector\",\r\n            url: \"https://github.com/near/wallet-selector\",\r\n            icons: [\"https://avatars.githubusercontent.com/u/37784886\"],\r\n          },\r\n        }),\r\n        setupNightlyConnect({\r\n          url: \"wss://relay.nightly.app/app\",\r\n          appMetadata: {\r\n            additionalInfo: \"\",\r\n            application: \"NEAR Wallet Selector\",\r\n            description: \"Example dApp used by NEAR Wallet Selector\",\r\n            icon: \"https://near.org/wp-content/uploads/2020/09/cropped-favicon-192x192.png\",\r\n          },\r\n        }),\r\n      ],\r\n    });\r\n\r\n    const _modal = setupModal(_selector, { contractId: CONTRACT_ID });\r\n    const state = _selector.store.getState();\r\n\r\n    this.accounts = state.accounts;\r\n    this.accountId =\r\n      state.accounts.find((account) => account.active)?.accountId || null;\r\n\r\n    window.selector = _selector;\r\n    window.modal = _modal;\r\n\r\n    this.selector = _selector;\r\n    this.modal = _modal;\r\n  }\r\n}\r\n","<main>\r\n  <h1>NEAR Guest Book</h1>\r\n  <near-wallet-selector-content\r\n    *ngIf=\"!!selector\"\r\n    [selector]=\"selector\"\r\n    [accounts]=\"accounts\"\r\n    [accountId]=\"accountId\"\r\n    [modal]=\"modal\"\r\n  >\r\n  </near-wallet-selector-content>\r\n</main>\r\n\r\n","import { NgModule } from \"@angular/core\";\r\nimport { BrowserModule } from \"@angular/platform-browser\";\r\nimport { FormsModule } from \"@angular/forms\";\r\n\r\nimport { AppComponent } from \"./app.component\";\r\nimport { SignInComponent } from \"./components/sign-in/sign-in.component\";\r\nimport { MessagesComponent } from \"./components/messages/messages.component\";\r\nimport { FormComponent } from \"./components/form/form.component\";\r\nimport { ContentComponent } from \"./components/content/content.component\";\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent,\r\n    SignInComponent,\r\n    MessagesComponent,\r\n    FormComponent,\r\n    ContentComponent,\r\n  ],\r\n  imports: [BrowserModule, FormsModule],\r\n  providers: [],\r\n  bootstrap: [AppComponent],\r\n})\r\nexport class AppModule {}\r\n","import { Component, Input, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { providers, utils } from \"near-api-js\";\r\nimport type {\r\n  AccountView,\r\n  CodeResult,\r\n} from \"near-api-js/lib/providers/provider\";\r\nimport type { WalletSelector, AccountState } from \"@near-wallet-selector/core\";\r\n\r\nimport type { Message } from \"../../interfaces/message\";\r\nimport type { Submitted } from \"../form/form.component\";\r\nimport type { Account } from \"../../interfaces/account\";\r\nimport { distinctUntilChanged, map, Subscription } from \"rxjs\";\r\nimport type { WalletSelectorModal } from \"@near-wallet-selector/modal-ui\";\r\nimport { CONTRACT_ID } from \"../../../constants\";\r\nimport { Transaction } from \"@near-wallet-selector/core\";\r\n\r\nconst SUGGESTED_DONATION = \"0\";\r\n// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\nconst BOATLOAD_OF_GAS = utils.format.parseNearAmount(\"0.00000000003\")!;\r\n\r\n@Component({\r\n  selector: \"near-wallet-selector-content\",\r\n  templateUrl: \"./content.component.html\",\r\n  styleUrls: [\"./content.component.scss\"],\r\n})\r\nexport class ContentComponent implements OnInit, OnDestroy {\r\n  @Input() selector: WalletSelector;\r\n  @Input() modal: WalletSelectorModal;\r\n  @Input() accounts: Array<AccountState>;\r\n  @Input() accountId: string | null;\r\n\r\n  account: Account | null;\r\n  messages: Array<Message>;\r\n  subscription?: Subscription;\r\n\r\n  async ngOnInit() {\r\n    const [messages, account] = await Promise.all([\r\n      this.getMessages(),\r\n      this.getAccount(),\r\n    ]);\r\n\r\n    this.account = account;\r\n    this.messages = messages;\r\n\r\n    this.subscribeToEvents();\r\n  }\r\n\r\n  async getAccount() {\r\n    if (!this.accountId) {\r\n      return null;\r\n    }\r\n\r\n    const { network } = this.selector.options;\r\n    const provider = new providers.JsonRpcProvider({ url: network.nodeUrl });\r\n\r\n    return provider\r\n      .query<AccountView>({\r\n        request_type: \"view_account\",\r\n        finality: \"final\",\r\n        account_id: this.accountId,\r\n      })\r\n      .then((data) => ({\r\n        ...data,\r\n        account_id: this.accountId,\r\n      }));\r\n  }\r\n\r\n  signIn() {\r\n    this.modal.show();\r\n  }\r\n\r\n  async signOut() {\r\n    const wallet = await this.selector.wallet();\r\n\r\n    wallet.signOut().catch((err) => {\r\n      console.log(\"Failed to sign out\");\r\n      console.error(err);\r\n    });\r\n  }\r\n\r\n  switchWallet() {\r\n    this.modal.show();\r\n  }\r\n\r\n  getMessages() {\r\n    const { network } = this.selector.options;\r\n    const provider = new providers.JsonRpcProvider({ url: network.nodeUrl });\r\n\r\n    return provider\r\n      .query<CodeResult>({\r\n        request_type: \"call_function\",\r\n        account_id: CONTRACT_ID,\r\n        method_name: \"getMessages\",\r\n        args_base64: \"\",\r\n        finality: \"optimistic\",\r\n      })\r\n      .then((res) => JSON.parse(Buffer.from(res.result).toString()));\r\n  }\r\n\r\n  switchAccount() {\r\n    const currentIndex = this.accounts.findIndex(\r\n      (x) => x.accountId === this.accountId\r\n    );\r\n    const nextIndex =\r\n      currentIndex < this.accounts.length - 1 ? currentIndex + 1 : 0;\r\n\r\n    const nextAccountId = this.accounts[nextIndex].accountId;\r\n\r\n    this.selector.setActiveAccount(nextAccountId);\r\n\r\n    alert(\"Switched account to \" + nextAccountId);\r\n  }\r\n\r\n  async onVerifyOwner() {\r\n    const wallet = await this.selector.wallet();\r\n    try {\r\n      const owner = await wallet.verifyOwner({\r\n        message: \"test message for verification\",\r\n      });\r\n\r\n      if (owner) {\r\n        alert(`Signature for verification: ${JSON.stringify(owner)}`);\r\n      }\r\n    } catch (err) {\r\n      const message =\r\n        err instanceof Error ? err.message : \"Something went wrong\";\r\n      alert(message);\r\n    }\r\n  }\r\n\r\n  subscribeToEvents() {\r\n    this.subscription = this.selector.store.observable\r\n      .pipe(\r\n        map((state) => state.accounts),\r\n        distinctUntilChanged()\r\n      )\r\n      .subscribe((nextAccounts) => {\r\n        console.log(\"Accounts Update\", nextAccounts);\r\n\r\n        this.accounts = nextAccounts;\r\n        this.accountId =\r\n          nextAccounts.find((account) => account.active)?.accountId || null;\r\n\r\n        this.getAccount().then((account) => {\r\n          this.account = account;\r\n        });\r\n      });\r\n  }\r\n\r\n  async addMessages(message: string, donation: string, multiple: boolean) {\r\n    const { contract } = this.selector.store.getState();\r\n    const wallet = await this.selector.wallet();\r\n\r\n    if (!multiple) {\r\n      return wallet\r\n        .signAndSendTransaction({\r\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n          signerId: this.accountId!,\r\n          actions: [\r\n            {\r\n              type: \"FunctionCall\",\r\n              params: {\r\n                methodName: \"addMessage\",\r\n                args: { text: message },\r\n                gas: BOATLOAD_OF_GAS,\r\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n                deposit: utils.format.parseNearAmount(donation)!,\r\n              },\r\n            },\r\n          ],\r\n        })\r\n        .catch((err) => {\r\n          alert(\"Failed to add message\");\r\n          console.log(\"Failed to add message\");\r\n\r\n          throw err;\r\n        });\r\n    }\r\n\r\n    const transactions: Array<Transaction> = [];\r\n\r\n    for (let i = 0; i < 2; i += 1) {\r\n      transactions.push({\r\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n        signerId: this.accountId!,\r\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n        receiverId: contract!.contractId,\r\n        actions: [\r\n          {\r\n            type: \"FunctionCall\",\r\n            params: {\r\n              methodName: \"addMessage\",\r\n              args: {\r\n                text: `${message} (${i + 1}/2)`,\r\n              },\r\n              gas: BOATLOAD_OF_GAS,\r\n              // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n              deposit: utils.format.parseNearAmount(donation)!,\r\n            },\r\n          },\r\n        ],\r\n      });\r\n    }\r\n\r\n    return wallet.signAndSendTransactions({ transactions }).catch((err) => {\r\n      alert(\"Failed to add messages\");\r\n      console.log(\"Failed to add messages\");\r\n\r\n      throw err;\r\n    });\r\n  }\r\n\r\n  async onSubmit(e: Submitted) {\r\n    const { fieldset, message, donation, multiple } = e.target.elements;\r\n\r\n    fieldset.disabled = true;\r\n\r\n    this.addMessages(message.value, donation.value || \"0\", multiple.checked)\r\n      .then(() => {\r\n        return this.getMessages()\r\n          .then((nextMessages) => {\r\n            this.messages = nextMessages;\r\n            message.value = \"\";\r\n            donation.value = SUGGESTED_DONATION;\r\n            fieldset.disabled = false;\r\n            message.focus();\r\n          })\r\n          .catch((err) => {\r\n            alert(\"Failed to refresh messages\");\r\n            console.log(\"Failed to refresh messages\");\r\n            throw err;\r\n          });\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n\r\n        fieldset.disabled = false;\r\n      });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.subscription?.unsubscribe();\r\n  }\r\n}\r\n","<ng-container *ngIf=\"account\">\r\n  <div>\r\n    <button (click)=\"signOut()\">Log out</button>\r\n    <button (click)=\"switchWallet()\">Switch Wallet</button>\r\n    <button (click)=\"onVerifyOwner()\">Verify Owner</button>\r\n    <button *ngIf=\"accounts.length > 1\" (click)=\"switchAccount()\">\r\n      Switch Account\r\n    </button>\r\n  </div>\r\n  <near-wallet-selector-form\r\n    [account]=\"account\"\r\n    (addMessage)=\"onSubmit($event)\"\r\n  ></near-wallet-selector-form>\r\n  <near-wallet-selector-messages\r\n    *ngIf=\"!!messages.length\"\r\n    [messages]=\"messages\"\r\n  ></near-wallet-selector-messages>\r\n</ng-container>\r\n\r\n<ng-container *ngIf=\"!accountId\">\r\n  <button (click)=\"signIn()\">Log In</button>\r\n  <near-wallet-selector-sign-in></near-wallet-selector-sign-in>\r\n</ng-container>\r\n","import { Component, EventEmitter, Input, OnInit, Output } from \"@angular/core\";\r\nimport Big from \"big.js\";\r\nimport type { Account } from \"../../interfaces/account\";\r\n\r\nexport type Submitted = SubmitEvent & {\r\n  target: { elements: { [key: string]: HTMLInputElement } };\r\n};\r\n\r\n@Component({\r\n  selector: \"near-wallet-selector-form\",\r\n  templateUrl: \"./form.component.html\",\r\n  styleUrls: [\"./form.component.scss\"],\r\n})\r\nexport class FormComponent implements OnInit {\r\n  @Input() account: Account;\r\n  @Output() addMessage: EventEmitter<Submitted> = new EventEmitter();\r\n  maxValue: string;\r\n\r\n  ngOnInit(): void {\r\n    this.maxValue = Big(this.account.amount)\r\n      .div(10 ** 24)\r\n      .toString();\r\n  }\r\n\r\n  onSubmit(event: Submitted) {\r\n    this.addMessage.emit(event);\r\n  }\r\n}\r\n","<form (ngSubmit)=\"onSubmit($event)\">\r\n  <fieldset id=\"fieldset\">\r\n    <p>Sign the guest book, {{ account.account_id }}!</p>\r\n    <p class=\"highlight\">\r\n      <label for=\"message\">Message:</label>\r\n      <input autoComplete=\"off\" autoFocus id=\"message\" required />\r\n    </p>\r\n    <p>\r\n      <label for=\"donation\">Donation (optional):</label>\r\n      <input\r\n        autocomplete=\"off\"\r\n        [defaultValue]=\"'0'\"\r\n        id=\"donation\"\r\n        max=\"{{ maxValue }}\"\r\n        min=\"0\"\r\n        step=\"0.01\"\r\n        type=\"number\"\r\n      />\r\n      <span title=\"NEAR Tokens\"></span>\r\n    </p>\r\n    <p>\r\n      <label htmlFor=\"multiple\">Multiple Transactions:</label>\r\n      <input id=\"multiple\" type=\"checkbox\" />\r\n    </p>\r\n    <button type=\"submit\">Sign</button>\r\n  </fieldset>\r\n</form>\r\n","import { Component, Input } from \"@angular/core\";\r\nimport type { Message } from \"../../interfaces/message\";\r\n\r\n@Component({\r\n  selector: \"near-wallet-selector-messages\",\r\n  templateUrl: \"./messages.component.html\",\r\n  styleUrls: [\"./messages.component.scss\"],\r\n})\r\nexport class MessagesComponent {\r\n  @Input() messages: Array<Message>;\r\n}\r\n","<h2>Messages</h2>\r\n\r\n<p *ngFor=\"let message of messages;\" [ngClass]=\"{'is-premium': message.premium}\">\r\n  <strong>{{ message.sender }}</strong>:<br />\r\n  {{ message.text }}\r\n</p>\r\n","import { Component } from \"@angular/core\";\r\n\r\n@Component({\r\n  selector: \"near-wallet-selector-sign-in\",\r\n  templateUrl: \"./sign-in.component.html\",\r\n  styleUrls: [\"./sign-in.component.scss\"],\r\n})\r\nexport class SignInComponent {}\r\n","<p>\r\n  This app demonstrates a key element of NEARs UX: once an app has\r\n  permission to make calls on behalf of a user (that is, once a user signs\r\n  in), the app can make calls to the blockchain for them without prompting\r\n  extra confirmation. So youll see that if you dont include a donation,\r\n  your message gets posted right to the guest book.\r\n</p>\r\n<p>\r\n  But if you do add a donation, then NEAR will double-check that youre ok\r\n  with sending money to this app.\r\n</p>\r\n<p>Go ahead and sign in to try it out!</p>\r\n","export const CONTRACT_ID = \"guest-book.testnet\";\r\n","// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  production: false,\r\n};\r\n\r\n/*\r\n * For easier debugging in development mode, you can import the following file\r\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\r\n *\r\n * This import should be commented out in production mode because it will have a negative impact\r\n * on performance if an error is thrown.\r\n */\r\n// import 'zone.js/plugins/zone-error';  // Included with Angular CLI.\r\n","import { enableProdMode } from \"@angular/core\";\r\nimport { platformBrowserDynamic } from \"@angular/platform-browser-dynamic\";\r\n\r\nimport { AppModule } from \"./app/app.module\";\r\nimport { environment } from \"./environments/environment\";\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic()\r\n  .bootstrapModule(AppModule)\r\n  .catch((err) => console.error(err));\r\n","export type {\r\n  WalletSelector,\r\n  WalletSelectorParams,\r\n  WalletSelectorEvents,\r\n  WalletSelectorStore,\r\n} from \"./lib/wallet-selector.types\";\r\nexport { setupWalletSelector } from \"./lib/wallet-selector\";\r\n\r\nexport type { Network, NetworkId } from \"./lib/options.types\";\r\nexport type {\r\n  Subscription,\r\n  StorageService,\r\n  JsonStorageService,\r\n} from \"./lib/services\";\r\nexport type { Optional } from \"./lib/utils.types\";\r\n\r\nexport type {\r\n  WalletSelectorState,\r\n  ContractState,\r\n  ModuleState,\r\n  AccountState,\r\n} from \"./lib/store.types\";\r\n\r\nexport type {\r\n  WalletModuleFactory,\r\n  WalletModule,\r\n  WalletBehaviourFactory,\r\n  WalletBehaviourOptions,\r\n  Wallet,\r\n  WalletType,\r\n  WalletMetadata,\r\n  WalletEvents,\r\n  SignInParams,\r\n  BrowserWalletMetadata,\r\n  BrowserWalletBehaviour,\r\n  BrowserWallet,\r\n  InjectedWalletMetadata,\r\n  InjectedWalletBehaviour,\r\n  InjectedWallet,\r\n  HardwareWalletMetadata,\r\n  HardwareWalletSignInParams,\r\n  HardwareWalletBehaviour,\r\n  HardwareWallet,\r\n  HardwareWalletAccount,\r\n  BridgeWalletMetadata,\r\n  BridgeWalletBehaviour,\r\n  BridgeWallet,\r\n  VerifiedOwner,\r\n  VerifyOwnerParams,\r\n  Account,\r\n  Transaction,\r\n  Action,\r\n  ActionType,\r\n  CreateAccountAction,\r\n  DeployContractAction,\r\n  FunctionCallAction,\r\n  TransferAction,\r\n  StakeAction,\r\n  AddKeyAction,\r\n  DeleteKeyAction,\r\n  DeleteAccountAction,\r\n  AddKeyPermission,\r\n} from \"./lib/wallet\";\r\n\r\nexport type { FinalExecutionOutcome } from \"near-api-js/lib/providers\";\r\n\r\nexport { waitFor, getActiveAccount } from \"./lib/helpers\";\r\n","export const PACKAGE_NAME = \"near-wallet-selector\";\r\n\r\nexport const CONTRACT = \"contract\";\r\nexport const PENDING_CONTRACT = \"contract:pending\";\r\n\r\nexport const SELECTED_WALLET_ID = `selectedWalletId`;\r\nexport const PENDING_SELECTED_WALLET_ID = `selectedWalletId:pending`;\r\n","import type { AccountState, WalletSelectorState } from \"../store.types\";\r\n\r\nexport const getActiveAccount = (\r\n  state: WalletSelectorState\r\n): AccountState | null => {\r\n  return state.accounts.find((account) => account.active) || null;\r\n};\r\n","export * from \"./waitFor\";\r\nexport * from \"./getActiveAccount\";\r\n","const wait = (ms: number) => {\r\n  return new Promise((resolve) => setTimeout(resolve, ms));\r\n};\r\n\r\nconst poll = async (\r\n  cb: () => boolean,\r\n  interval: number,\r\n  remaining: number\r\n): Promise<boolean> => {\r\n  const result = cb();\r\n\r\n  if (result) {\r\n    return result;\r\n  }\r\n\r\n  if (!remaining) {\r\n    throw new Error(\"Exceeded timeout\");\r\n  }\r\n\r\n  return wait(interval).then(() => poll(cb, interval, remaining - 1));\r\n};\r\n\r\nexport const waitFor = async (\r\n  cb: () => boolean,\r\n  opts: { timeout?: number; interval?: number } = {}\r\n) => {\r\n  const { timeout = 200, interval = 50 } = opts;\r\n\r\n  return Promise.race([\r\n    wait(timeout).then(() => {\r\n      throw new Error(\"Exceeded timeout\");\r\n    }),\r\n    poll(cb, interval, Math.floor(timeout / interval)),\r\n  ]);\r\n};\r\n","import type { WalletSelectorParams } from \"./wallet-selector.types\";\r\nimport type { Options, Network, NetworkId } from \"./options.types\";\r\nimport { WebStorageService } from \"./services\";\r\n\r\nexport const getNetworkPreset = (networkId: NetworkId): Network => {\r\n  switch (networkId) {\r\n    case \"mainnet\":\r\n      return {\r\n        networkId,\r\n        nodeUrl: \"https://rpc.mainnet.near.org\",\r\n        helperUrl: \"https://helper.mainnet.near.org\",\r\n        explorerUrl: \"https://explorer.near.org\",\r\n        indexerUrl: \"https://api.kitwallet.app\",\r\n      };\r\n    case \"testnet\":\r\n      return {\r\n        networkId,\r\n        nodeUrl: \"https://rpc.testnet.near.org\",\r\n        helperUrl: \"https://helper.testnet.near.org\",\r\n        explorerUrl: \"https://explorer.testnet.near.org\",\r\n        indexerUrl: \"https://testnet-api.kitwallet.app\",\r\n      };\r\n    default:\r\n      throw Error(`Failed to find config for: '${networkId}'`);\r\n  }\r\n};\r\n\r\nexport const resolveNetwork = (network: NetworkId | Network): Network => {\r\n  return typeof network === \"string\" ? getNetworkPreset(network) : network;\r\n};\r\n\r\nexport const resolveOptions = (params: WalletSelectorParams) => {\r\n  const options: Options = {\r\n    network: resolveNetwork(params.network),\r\n    debug: params.debug || false,\r\n  };\r\n\r\n  return {\r\n    options,\r\n    storage: params.storage || new WebStorageService(),\r\n  };\r\n};\r\n","import { EventEmitter as NEventEmitter } from \"events\";\r\nimport type { EventEmitterService, Subscription } from \"./event-emitter.types\";\r\n\r\nexport class EventEmitter<Events extends Record<string, unknown>>\r\n  implements EventEmitterService<Events>\r\n{\r\n  private emitter = new NEventEmitter();\r\n\r\n  on<Event extends keyof Events>(\r\n    eventName: Event,\r\n    callback: (event: Events[Event]) => void\r\n  ): Subscription {\r\n    this.emitter.on(eventName as string, callback);\r\n\r\n    return {\r\n      remove: () => this.emitter.off(eventName as string, callback),\r\n    };\r\n  }\r\n\r\n  off<Event extends keyof Events>(\r\n    eventName: Event,\r\n    callback: (event: Events[Event]) => void\r\n  ) {\r\n    this.emitter.off(eventName as string, callback);\r\n  }\r\n\r\n  emit<Event extends keyof Events>(eventName: Event, event: Events[Event]) {\r\n    this.emitter.emit(eventName as string, event);\r\n  }\r\n}\r\n","export interface Subscription {\r\n  remove: () => void;\r\n}\r\n\r\nexport interface EventEmitterService<Events extends Record<string, unknown>> {\r\n  on<EventName extends keyof Events>(\r\n    eventName: EventName,\r\n    callback: (event: Events[EventName]) => void\r\n  ): Subscription;\r\n\r\n  off<EventName extends keyof Events>(\r\n    eventName: EventName,\r\n    callback: (event: Events[EventName]) => void\r\n  ): void;\r\n\r\n  emit<EventName extends keyof Events>(\r\n    eventName: EventName,\r\n    event: Events[EventName]\r\n  ): void;\r\n}\r\n","export * from \"./provider/provider.service\";\r\nexport * from \"./provider/provider.service.types\";\r\nexport * from \"./storage/storage.service.types\";\r\nexport * from \"./storage/json-storage.service.types\";\r\nexport * from \"./storage/json-storage.service\";\r\nexport * from \"./storage/web-storage.service\";\r\nexport * from \"./logger/logger.service\";\r\nexport * from \"./logger/logger.service.types\";\r\nexport * from \"./wallet-modules/wallet-modules.service\";\r\nexport * from \"./event-emitter/event-emitter.service\";\r\nexport * from \"./event-emitter/event-emitter.types\";\r\n","import type { LoggerService } from \"./logger.service.types\";\r\n\r\ntype SupportedMethod = \"log\" | \"info\" | \"warn\" | \"error\";\r\n\r\nexport class Logger implements LoggerService {\r\n  static debug = false;\r\n\r\n  namespace?: string;\r\n\r\n  constructor(namespace?: string) {\r\n    this.namespace = namespace;\r\n  }\r\n\r\n  private emit(method: SupportedMethod, ...params: Array<unknown>) {\r\n    if (!Logger.debug) {\r\n      return;\r\n    }\r\n\r\n    if (this.namespace && method !== \"error\") {\r\n      // eslint-disable-next-line no-console\r\n      console[method](this.namespace, ...params);\r\n\r\n      return;\r\n    }\r\n\r\n    // eslint-disable-next-line no-console\r\n    console[method](...params);\r\n  }\r\n\r\n  log(...params: Array<unknown>) {\r\n    this.emit(\"log\", ...params);\r\n  }\r\n\r\n  info(...params: Array<unknown>) {\r\n    this.emit(\"info\", ...params);\r\n  }\r\n\r\n  warn(...params: Array<unknown>) {\r\n    this.emit(\"warn\", ...params);\r\n  }\r\n\r\n  error(...params: Array<unknown>) {\r\n    this.emit(\"error\", ...params);\r\n  }\r\n}\r\n\r\nexport const logger = new Logger();\r\n","export interface LoggerService {\r\n  log(...params: Array<unknown>): void;\r\n  info(...params: Array<unknown>): void;\r\n  warn(...params: Array<unknown>): void;\r\n  error(...params: Array<unknown>): void;\r\n}\r\n","import { providers } from \"near-api-js\";\r\nimport type {\r\n  AccessKeyView,\r\n  BlockReference,\r\n  QueryResponseKind,\r\n} from \"near-api-js/lib/providers/provider\";\r\nimport { SignedTransaction } from \"near-api-js/lib/transaction\";\r\nimport type {\r\n  ProviderService,\r\n  QueryParams,\r\n  ViewAccessKeyParams,\r\n} from \"./provider.service.types\";\r\n\r\nexport class Provider implements ProviderService {\r\n  private provider: providers.JsonRpcProvider;\r\n\r\n  constructor(url: string) {\r\n    this.provider = new providers.JsonRpcProvider({ url });\r\n  }\r\n\r\n  query<Response extends QueryResponseKind>(params: QueryParams) {\r\n    return this.provider.query<Response>(params);\r\n  }\r\n\r\n  viewAccessKey({ accountId, publicKey }: ViewAccessKeyParams) {\r\n    return this.query<AccessKeyView>({\r\n      request_type: \"view_access_key\",\r\n      finality: \"final\",\r\n      account_id: accountId,\r\n      public_key: publicKey,\r\n    });\r\n  }\r\n\r\n  block(reference: BlockReference) {\r\n    return this.provider.block(reference);\r\n  }\r\n\r\n  sendTransaction(signedTransaction: SignedTransaction) {\r\n    return this.provider.sendTransaction(signedTransaction);\r\n  }\r\n}\r\n","import type {\r\n  AccessKeyView,\r\n  BlockReference,\r\n  BlockResult,\r\n  QueryResponseKind,\r\n  FinalExecutionOutcome,\r\n} from \"near-api-js/lib/providers/provider\";\r\nimport { SignedTransaction } from \"near-api-js/lib/transaction\";\r\n\r\nexport type QueryParams = { [key in string]: unknown };\r\n\r\nexport interface ViewAccessKeyParams {\r\n  accountId: string;\r\n  publicKey: string;\r\n}\r\n\r\nexport interface ProviderService {\r\n  query<Response extends QueryResponseKind>(\r\n    params: QueryParams\r\n  ): Promise<Response>;\r\n  viewAccessKey(params: ViewAccessKeyParams): Promise<AccessKeyView>;\r\n  block(reference: BlockReference): Promise<BlockResult>;\r\n  sendTransaction(\r\n    signedTransaction: SignedTransaction\r\n  ): Promise<FinalExecutionOutcome>;\r\n}\r\n","import type { StorageService } from \"./storage.service.types\";\r\nimport type { JsonStorageService } from \"./json-storage.service.types\";\r\n\r\nconst KEY_DELIMITER = \":\";\r\n\r\nexport class JsonStorage implements JsonStorageService {\r\n  storage: StorageService;\r\n  namespace: string;\r\n\r\n  constructor(storage: StorageService, namespace: string | Array<string>) {\r\n    this.storage = storage;\r\n    this.namespace = Array.isArray(namespace)\r\n      ? namespace.join(KEY_DELIMITER)\r\n      : namespace;\r\n  }\r\n\r\n  private resolveKey(key: string) {\r\n    return [this.namespace, key].join(KEY_DELIMITER);\r\n  }\r\n\r\n  getItem<Value>(key: string): Promise<Value | null> {\r\n    return this.storage.getItem(this.resolveKey(key)).then((item) => {\r\n      return typeof item === \"string\" ? (JSON.parse(item) as Value) : null;\r\n    });\r\n  }\r\n\r\n  setItem<Value>(key: string, value: Value): Promise<void> {\r\n    return this.storage.setItem(this.resolveKey(key), JSON.stringify(value));\r\n  }\r\n\r\n  removeItem(key: string): Promise<void> {\r\n    return this.storage.removeItem(this.resolveKey(key));\r\n  }\r\n}\r\n","export interface JsonStorageService {\r\n  getItem<Value>(key: string): Promise<Value | null>;\r\n  setItem<Value>(key: string, value: Value): Promise<void>;\r\n  removeItem(key: string): Promise<void>;\r\n}\r\n","export interface StorageService {\r\n  getItem(key: string): Promise<string | null>;\r\n  setItem(key: string, value: string): Promise<void>;\r\n  removeItem(key: string): Promise<void>;\r\n}\r\n","import type { StorageService } from \"./storage.service.types\";\r\n\r\nexport class WebStorageService implements StorageService {\r\n  getItem(key: string): Promise<string | null> {\r\n    return new Promise((resolve) => {\r\n      const value = localStorage.getItem(key);\r\n\r\n      resolve(value);\r\n    });\r\n  }\r\n\r\n  setItem(key: string, value: string): Promise<void> {\r\n    return new Promise((resolve) => {\r\n      localStorage.setItem(key, value);\r\n\r\n      resolve();\r\n    });\r\n  }\r\n\r\n  removeItem(key: string): Promise<void> {\r\n    return new Promise((resolve) => {\r\n      localStorage.removeItem(key);\r\n\r\n      resolve();\r\n    });\r\n  }\r\n}\r\n","import type { WalletModulesParams } from \"./wallet-modules.service.types\";\r\nimport type {\r\n  SignInParams,\r\n  Wallet,\r\n  WalletEvents,\r\n  WalletModule,\r\n  WalletModuleFactory,\r\n  Account,\r\n} from \"../../wallet\";\r\nimport type { StorageService } from \"../storage/storage.service.types\";\r\nimport type { Options } from \"../../options.types\";\r\nimport type { ContractState, ModuleState, Store } from \"../../store.types\";\r\nimport { EventEmitter } from \"../event-emitter/event-emitter.service\";\r\nimport type { WalletSelectorEvents } from \"../../wallet-selector.types\";\r\nimport { Logger, logger } from \"../logger/logger.service\";\r\nimport {\r\n  PACKAGE_NAME,\r\n  PENDING_CONTRACT,\r\n  PENDING_SELECTED_WALLET_ID,\r\n} from \"../../constants\";\r\nimport { JsonStorage } from \"../storage/json-storage.service\";\r\nimport { ProviderService } from \"../provider/provider.service.types\";\r\n\r\nexport class WalletModules {\r\n  private factories: Array<WalletModuleFactory>;\r\n  private storage: StorageService;\r\n  private options: Options;\r\n  private store: Store;\r\n  private emitter: EventEmitter<WalletSelectorEvents>;\r\n  private provider: ProviderService;\r\n\r\n  private modules: Array<ModuleState>;\r\n  private instances: Record<string, Wallet>;\r\n\r\n  constructor({\r\n    factories,\r\n    storage,\r\n    options,\r\n    store,\r\n    emitter,\r\n    provider,\r\n  }: WalletModulesParams) {\r\n    this.factories = factories;\r\n    this.storage = storage;\r\n    this.options = options;\r\n    this.store = store;\r\n    this.emitter = emitter;\r\n    this.provider = provider;\r\n\r\n    this.modules = [];\r\n    this.instances = {};\r\n  }\r\n\r\n  private async validateWallet(id: string | null) {\r\n    let accounts: Array<Account> = [];\r\n    const wallet = await this.getWallet(id);\r\n\r\n    if (wallet) {\r\n      // Ensure our persistent state aligns with the selected wallet.\r\n      // For example a wallet is selected, but it returns no accounts (not signed in).\r\n      accounts = await wallet.getAccounts().catch((err) => {\r\n        logger.log(`Failed to validate ${wallet.id} during setup`);\r\n        logger.error(err);\r\n\r\n        return [];\r\n      });\r\n    }\r\n\r\n    return accounts;\r\n  }\r\n\r\n  private async resolveStorageState() {\r\n    const jsonStorage = new JsonStorage(this.storage, PACKAGE_NAME);\r\n    const pendingSelectedWalletId = await jsonStorage.getItem<string>(\r\n      PENDING_SELECTED_WALLET_ID\r\n    );\r\n    const pendingContract = await jsonStorage.getItem<ContractState>(\r\n      PENDING_CONTRACT\r\n    );\r\n\r\n    if (pendingSelectedWalletId && pendingContract) {\r\n      const accounts = await this.validateWallet(pendingSelectedWalletId);\r\n\r\n      await jsonStorage.removeItem(PENDING_SELECTED_WALLET_ID);\r\n      await jsonStorage.removeItem(PENDING_CONTRACT);\r\n\r\n      if (accounts.length) {\r\n        const { selectedWalletId } = this.store.getState();\r\n        const selectedWallet = await this.getWallet(selectedWalletId);\r\n\r\n        if (selectedWallet && pendingSelectedWalletId !== selectedWalletId) {\r\n          await selectedWallet.signOut().catch((err) => {\r\n            logger.log(\"Failed to sign out existing wallet\");\r\n            logger.error(err);\r\n          });\r\n        }\r\n\r\n        return {\r\n          accounts,\r\n          contract: pendingContract,\r\n          selectedWalletId: pendingSelectedWalletId,\r\n        };\r\n      }\r\n    }\r\n\r\n    const { contract, selectedWalletId } = this.store.getState();\r\n    const accounts = await this.validateWallet(selectedWalletId);\r\n\r\n    if (!accounts.length) {\r\n      return {\r\n        accounts: [],\r\n        contract: null,\r\n        selectedWalletId: null,\r\n      };\r\n    }\r\n\r\n    return {\r\n      accounts,\r\n      contract,\r\n      selectedWalletId,\r\n    };\r\n  }\r\n\r\n  private async signOutWallet(walletId: string) {\r\n    const wallet = (await this.getWallet(walletId))!;\r\n\r\n    await wallet.signOut().catch((err) => {\r\n      logger.log(`Failed to sign out ${wallet.id}`);\r\n      logger.error(err);\r\n\r\n      // At least clean up state on our side.\r\n      this.onWalletSignedOut(wallet.id);\r\n    });\r\n  }\r\n\r\n  private async onWalletSignedIn(\r\n    walletId: string,\r\n    { accounts, contractId, methodNames }: WalletEvents[\"signedIn\"]\r\n  ) {\r\n    const { selectedWalletId } = this.store.getState();\r\n    const jsonStorage = new JsonStorage(this.storage, PACKAGE_NAME);\r\n    const contract = { contractId, methodNames };\r\n\r\n    if (!accounts.length) {\r\n      const module = this.getModule(walletId)!;\r\n      // We can't guarantee the user will actually sign in with browser wallets.\r\n      // Best we can do is set in storage and validate on init.\r\n      if (module.type === \"browser\") {\r\n        await jsonStorage.setItem(PENDING_SELECTED_WALLET_ID, walletId);\r\n        await jsonStorage.setItem<ContractState>(PENDING_CONTRACT, contract);\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    if (selectedWalletId && selectedWalletId !== walletId) {\r\n      await this.signOutWallet(selectedWalletId);\r\n    }\r\n\r\n    this.store.dispatch({\r\n      type: \"WALLET_CONNECTED\",\r\n      payload: { walletId, contract, accounts },\r\n    });\r\n  }\r\n\r\n  private onWalletSignedOut(walletId: string) {\r\n    this.store.dispatch({\r\n      type: \"WALLET_DISCONNECTED\",\r\n      payload: { walletId },\r\n    });\r\n  }\r\n\r\n  private setupWalletEmitter(module: WalletModule) {\r\n    const emitter = new EventEmitter<WalletEvents>();\r\n\r\n    emitter.on(\"signedOut\", () => {\r\n      this.onWalletSignedOut(module.id);\r\n    });\r\n\r\n    emitter.on(\"signedIn\", (event) => {\r\n      this.onWalletSignedIn(module.id, event);\r\n    });\r\n\r\n    emitter.on(\"accountsChanged\", async ({ accounts }) => {\r\n      if (!accounts.length) {\r\n        return this.signOutWallet(module.id);\r\n      }\r\n\r\n      this.store.dispatch({\r\n        type: \"ACCOUNTS_CHANGED\",\r\n        payload: { walletId: module.id, accounts },\r\n      });\r\n    });\r\n\r\n    emitter.on(\"networkChanged\", ({ networkId }) => {\r\n      this.emitter.emit(\"networkChanged\", { walletId: module.id, networkId });\r\n    });\r\n\r\n    return emitter;\r\n  }\r\n\r\n  private decorateWallet(wallet: Wallet): Wallet {\r\n    const _signIn = wallet.signIn;\r\n    const _signOut = wallet.signOut;\r\n\r\n    wallet.signIn = async (params: never) => {\r\n      const accounts = await _signIn(params);\r\n\r\n      const { contractId, methodNames = [] } = params as SignInParams;\r\n      await this.onWalletSignedIn(wallet.id, {\r\n        accounts,\r\n        contractId,\r\n        methodNames,\r\n      });\r\n\r\n      return accounts;\r\n    };\r\n\r\n    wallet.signOut = async () => {\r\n      await _signOut();\r\n      this.onWalletSignedOut(wallet.id);\r\n    };\r\n\r\n    return wallet;\r\n  }\r\n\r\n  private async setupInstance(module: WalletModule): Promise<Wallet> {\r\n    if (!module.metadata.available) {\r\n      const message =\r\n        module.type === \"injected\" ? \"not installed\" : \"not available\";\r\n      throw Error(`${module.metadata.name} is ${message}`);\r\n    }\r\n\r\n    const wallet = {\r\n      id: module.id,\r\n      type: module.type,\r\n      metadata: module.metadata,\r\n      ...(await module.init({\r\n        id: module.id,\r\n        type: module.type,\r\n        metadata: module.metadata,\r\n        options: this.options,\r\n        store: this.store.toReadOnly(),\r\n        provider: this.provider,\r\n        emitter: this.setupWalletEmitter(module),\r\n        logger: new Logger(module.id),\r\n        storage: new JsonStorage(this.storage, [PACKAGE_NAME, module.id]),\r\n      })),\r\n    } as Wallet;\r\n\r\n    return this.decorateWallet(wallet);\r\n  }\r\n\r\n  private getModule(id: string | null) {\r\n    return this.modules.find((x) => x.id === id);\r\n  }\r\n\r\n  async getWallet<Variation extends Wallet = Wallet>(id: string | null) {\r\n    const module = this.getModule(id);\r\n\r\n    if (!module) {\r\n      return null;\r\n    }\r\n\r\n    const { selectedWalletId } = this.store.getState();\r\n\r\n    // If user uninstalled/removed a wallet which was previously signed in with\r\n    // best we can do is clean up state on our side.\r\n    if (!module.metadata.available && selectedWalletId) {\r\n      this.onWalletSignedOut(selectedWalletId);\r\n\r\n      return null;\r\n    }\r\n\r\n    return (await module.wallet()) as Variation;\r\n  }\r\n\r\n  async setup() {\r\n    const modules: Array<ModuleState> = [];\r\n\r\n    for (let i = 0; i < this.factories.length; i += 1) {\r\n      const module = await this.factories[i]({ options: this.options }).catch(\r\n        (err) => {\r\n          logger.log(\"Failed to setup module\");\r\n          logger.error(err);\r\n\r\n          return null;\r\n        }\r\n      );\r\n\r\n      // Filter out wallets that aren't available.\r\n      if (!module) {\r\n        continue;\r\n      }\r\n\r\n      // Skip duplicated module.\r\n      if (modules.some((x) => x.id === module.id)) {\r\n        continue;\r\n      }\r\n\r\n      modules.push({\r\n        id: module.id,\r\n        type: module.type,\r\n        metadata: module.metadata,\r\n        wallet: async () => {\r\n          let instance = this.instances[module.id];\r\n\r\n          if (instance) {\r\n            return instance;\r\n          }\r\n\r\n          instance = await this.setupInstance(module);\r\n\r\n          this.instances[module.id] = instance;\r\n\r\n          return instance;\r\n        },\r\n      });\r\n    }\r\n\r\n    this.modules = modules;\r\n\r\n    const { accounts, contract, selectedWalletId } =\r\n      await this.resolveStorageState();\r\n\r\n    this.store.dispatch({\r\n      type: \"SETUP_WALLET_MODULES\",\r\n      payload: {\r\n        modules,\r\n        accounts,\r\n        contract,\r\n        selectedWalletId,\r\n      },\r\n    });\r\n  }\r\n}\r\n","import { Subject, BehaviorSubject, scan } from \"rxjs\";\r\n\r\nimport { logger, JsonStorage } from \"./services\";\r\nimport { StorageService } from \"./services\";\r\nimport type {\r\n  Store,\r\n  WalletSelectorState,\r\n  WalletSelectorAction,\r\n} from \"./store.types\";\r\nimport { PACKAGE_NAME, CONTRACT, SELECTED_WALLET_ID } from \"./constants\";\r\n\r\nconst reducer = (\r\n  state: WalletSelectorState,\r\n  action: WalletSelectorAction\r\n): WalletSelectorState => {\r\n  logger.log(\"Store Action\", action);\r\n\r\n  switch (action.type) {\r\n    case \"SETUP_WALLET_MODULES\": {\r\n      const { modules, accounts, contract, selectedWalletId } = action.payload;\r\n\r\n      const accountStates = accounts.map((account, i) => {\r\n        return {\r\n          ...account,\r\n          active: i === 0,\r\n        };\r\n      });\r\n\r\n      return {\r\n        ...state,\r\n        modules,\r\n        accounts: accountStates,\r\n        contract,\r\n        selectedWalletId,\r\n      };\r\n    }\r\n    case \"WALLET_CONNECTED\": {\r\n      const { walletId, contract, accounts } = action.payload;\r\n\r\n      if (!accounts.length) {\r\n        return state;\r\n      }\r\n\r\n      const activeAccountIndex = state.accounts.findIndex(\r\n        (account) => account.active\r\n      );\r\n\r\n      const accountStates = accounts.map((account, i) => {\r\n        return {\r\n          ...account,\r\n          active: i === (activeAccountIndex > -1 ? activeAccountIndex : 0),\r\n        };\r\n      });\r\n\r\n      return {\r\n        ...state,\r\n        contract,\r\n        accounts: accountStates,\r\n        selectedWalletId: walletId,\r\n      };\r\n    }\r\n    case \"WALLET_DISCONNECTED\": {\r\n      const { walletId } = action.payload;\r\n\r\n      if (walletId !== state.selectedWalletId) {\r\n        return state;\r\n      }\r\n\r\n      return {\r\n        ...state,\r\n        contract: null,\r\n        accounts: [],\r\n        selectedWalletId: null,\r\n      };\r\n    }\r\n    case \"ACCOUNTS_CHANGED\": {\r\n      const { walletId, accounts } = action.payload;\r\n\r\n      if (walletId !== state.selectedWalletId) {\r\n        return state;\r\n      }\r\n\r\n      const activeAccount = state.accounts.find((account) => account.active);\r\n\r\n      const isActiveAccountRemoved = !accounts.some(\r\n        (account) => account.accountId === activeAccount?.accountId\r\n      );\r\n\r\n      const accountStates = accounts.map((account, i) => {\r\n        return {\r\n          ...account,\r\n          active: isActiveAccountRemoved\r\n            ? i === 0\r\n            : account.accountId === activeAccount?.accountId,\r\n        };\r\n      });\r\n\r\n      return {\r\n        ...state,\r\n        accounts: accountStates,\r\n      };\r\n    }\r\n    case \"SET_ACTIVE_ACCOUNT\": {\r\n      const { accountId } = action.payload;\r\n\r\n      const accountStates = state.accounts.map((account) => {\r\n        return {\r\n          ...account,\r\n          active: account.accountId === accountId,\r\n        };\r\n      });\r\n\r\n      return {\r\n        ...state,\r\n        accounts: accountStates,\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport const createStore = async (storage: StorageService): Promise<Store> => {\r\n  const jsonStorage = new JsonStorage(storage, PACKAGE_NAME);\r\n  const initialState: WalletSelectorState = {\r\n    modules: [],\r\n    accounts: [],\r\n    contract: await jsonStorage.getItem(CONTRACT),\r\n    selectedWalletId: await jsonStorage.getItem(SELECTED_WALLET_ID),\r\n  };\r\n\r\n  const state$ = new BehaviorSubject(initialState);\r\n  const actions$ = new Subject<WalletSelectorAction>();\r\n\r\n  actions$.pipe(scan(reducer, initialState)).subscribe(state$);\r\n\r\n  const syncStorage = async (\r\n    prevState: WalletSelectorState,\r\n    state: WalletSelectorState,\r\n    storageKey: string,\r\n    property: keyof WalletSelectorState\r\n  ) => {\r\n    if (state[property] === prevState[property]) {\r\n      return;\r\n    }\r\n\r\n    if (state[property]) {\r\n      await jsonStorage.setItem(storageKey, state[property]);\r\n      return;\r\n    }\r\n\r\n    await jsonStorage.removeItem(storageKey);\r\n  };\r\n\r\n  let prevState = state$.getValue();\r\n  state$.subscribe((state) => {\r\n    syncStorage(prevState, state, SELECTED_WALLET_ID, \"selectedWalletId\");\r\n    syncStorage(prevState, state, CONTRACT, \"contract\");\r\n    prevState = state;\r\n  });\r\n\r\n  return {\r\n    observable: state$,\r\n    getState: () => state$.getValue(),\r\n    dispatch: (action) => actions$.next(action),\r\n    toReadOnly: () => ({\r\n      getState: () => state$.getValue(),\r\n      observable: state$.asObservable(),\r\n    }),\r\n  };\r\n};\r\n","import { resolveOptions } from \"./options\";\r\nimport { createStore } from \"./store\";\r\nimport type {\r\n  WalletSelector,\r\n  WalletSelectorEvents,\r\n  WalletSelectorParams,\r\n} from \"./wallet-selector.types\";\r\nimport { EventEmitter, Logger, Provider, WalletModules } from \"./services\";\r\nimport type { Wallet } from \"./wallet\";\r\n\r\nlet walletSelectorInstance: WalletSelector | null = null;\r\n\r\nexport const setupWalletSelector = async (\r\n  params: WalletSelectorParams\r\n): Promise<WalletSelector> => {\r\n  const { options, storage } = resolveOptions(params);\r\n  Logger.debug = options.debug;\r\n\r\n  const emitter = new EventEmitter<WalletSelectorEvents>();\r\n  const store = await createStore(storage);\r\n  const walletModules = new WalletModules({\r\n    factories: params.modules,\r\n    storage,\r\n    options,\r\n    store,\r\n    emitter,\r\n    provider: new Provider(options.network.nodeUrl),\r\n  });\r\n\r\n  await walletModules.setup();\r\n\r\n  if (!walletSelectorInstance) {\r\n    walletSelectorInstance = {\r\n      options,\r\n      store: store.toReadOnly(),\r\n      wallet: async <Variation extends Wallet = Wallet>(id?: string) => {\r\n        const { selectedWalletId } = store.getState();\r\n        const wallet = await walletModules.getWallet<Variation>(\r\n          id || selectedWalletId\r\n        );\r\n\r\n        if (!wallet) {\r\n          if (id) {\r\n            throw new Error(\"Invalid wallet id\");\r\n          }\r\n\r\n          throw new Error(\"No wallet selected\");\r\n        }\r\n\r\n        return wallet;\r\n      },\r\n      setActiveAccount: (accountId: string) => {\r\n        const { accounts } = store.getState();\r\n\r\n        if (!accounts.some((account) => account.accountId === accountId)) {\r\n          throw new Error(\"Invalid account id\");\r\n        }\r\n\r\n        store.dispatch({\r\n          type: \"SET_ACTIVE_ACCOUNT\",\r\n          payload: { accountId },\r\n        });\r\n      },\r\n      isSignedIn() {\r\n        const { accounts } = store.getState();\r\n\r\n        return Boolean(accounts.length);\r\n      },\r\n      on: (eventName, callback) => {\r\n        return emitter.on(eventName, callback);\r\n      },\r\n      off: (eventName, callback) => {\r\n        emitter.off(eventName, callback);\r\n      },\r\n    };\r\n  }\r\n\r\n  return walletSelectorInstance;\r\n};\r\n","export { setupDefaultWallets } from \"./lib/default-wallets\";\r\n","import { setupMyNearWallet } from \"@near-wallet-selector/my-near-wallet\";\r\nimport { setupLedger } from \"@near-wallet-selector/ledger\";\r\nimport type { WalletModuleFactory } from \"@near-wallet-selector/core\";\r\n\r\nexport const setupDefaultWallets = async (): Promise<\r\n  Array<WalletModuleFactory>\r\n> => {\r\n  return [setupMyNearWallet(), setupLedger()];\r\n};\r\n","export { setupLedger } from \"./lib/ledger\";\r\nexport type { LedgerParams } from \"./lib/ledger\";\r\n","export default `data:image/png;base64,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`;\r\n","import TransportWebHID from \"@ledgerhq/hw-transport-webhid\";\r\nimport Transport from \"@ledgerhq/hw-transport\";\r\nimport { utils } from \"near-api-js\";\r\n\r\n// Further reading regarding APDU Ledger API:\r\n// - https://gist.github.com/Wollac/49f0c4e318e42f463b8306298dfb4f4a\r\n// - https://github.com/LedgerHQ/app-near/blob/master/workdir/app-near/src/constants.h\r\n\r\nexport const CLA = 0x80; // Always the same for Ledger.\r\nexport const INS_SIGN = 0x02; // Sign\r\nexport const INS_GET_PUBLIC_KEY = 0x04; // Get Public Key\r\nexport const INS_GET_APP_VERSION = 0x06; // Get App Version\r\nexport const P1_LAST = 0x80; // End of Bytes to Sign (finalize)\r\nexport const P1_MORE = 0x00; // More bytes coming\r\nexport const P1_IGNORE = 0x00;\r\nexport const P2_IGNORE = 0x00;\r\n\r\n// Converts BIP32-compliant derivation path to a Buffer.\r\n// More info here: https://github.com/LedgerHQ/ledger-live-common/blob/master/docs/derivation.md\r\nexport function parseDerivationPath(derivationPath: string) {\r\n  const parts = derivationPath.split(\"/\");\r\n\r\n  return Buffer.concat(\r\n    parts\r\n      .map((part) => {\r\n        return part.endsWith(`'`)\r\n          ? Math.abs(parseInt(part.slice(0, -1))) | 0x80000000\r\n          : Math.abs(parseInt(part));\r\n      })\r\n      .map((i32) => {\r\n        return Buffer.from([\r\n          (i32 >> 24) & 0xff,\r\n          (i32 >> 16) & 0xff,\r\n          (i32 >> 8) & 0xff,\r\n          i32 & 0xff,\r\n        ]);\r\n      })\r\n  );\r\n}\r\n\r\n// TODO: Understand what this is exactly. What's so special about 87?\r\nexport const networkId = \"W\".charCodeAt(0);\r\n\r\ninterface GetPublicKeyParams {\r\n  derivationPath: string;\r\n}\r\n\r\ninterface SignParams {\r\n  data: Uint8Array;\r\n  derivationPath: string;\r\n}\r\n\r\ninterface EventMap {\r\n  disconnect: Error;\r\n}\r\n\r\nexport interface Subscription {\r\n  remove: () => void;\r\n}\r\n\r\n// Not using TransportWebHID.isSupported as it's chosen to use a Promise...\r\nexport const isLedgerSupported = () => {\r\n  return !!window.navigator?.hid;\r\n};\r\n\r\nexport class LedgerClient {\r\n  private transport: Transport | null = null;\r\n\r\n  isConnected = () => {\r\n    return Boolean(this.transport);\r\n  };\r\n\r\n  connect = async () => {\r\n    this.transport = await TransportWebHID.create();\r\n\r\n    const handleDisconnect = () => {\r\n      this.transport?.off(\"disconnect\", handleDisconnect);\r\n      this.transport = null;\r\n    };\r\n\r\n    this.transport.on(\"disconnect\", handleDisconnect);\r\n  };\r\n\r\n  disconnect = async () => {\r\n    if (!this.transport) {\r\n      throw new Error(\"Device not connected\");\r\n    }\r\n\r\n    await this.transport.close();\r\n    this.transport = null;\r\n  };\r\n\r\n  setScrambleKey = (key: string) => {\r\n    if (!this.transport) {\r\n      throw new Error(\"Device not connected\");\r\n    }\r\n\r\n    this.transport.setScrambleKey(key);\r\n  };\r\n\r\n  on = <Event extends keyof EventMap>(\r\n    event: Event,\r\n    callback: (data: EventMap[Event]) => void\r\n  ): Subscription => {\r\n    if (!this.transport) {\r\n      throw new Error(\"Device not connected\");\r\n    }\r\n\r\n    this.transport.on(event, callback);\r\n\r\n    return {\r\n      remove: () => this.transport?.off(event, callback),\r\n    };\r\n  };\r\n\r\n  off = (event: keyof EventMap, callback: () => void) => {\r\n    if (!this.transport) {\r\n      throw new Error(\"Device not connected\");\r\n    }\r\n\r\n    this.transport.off(event, callback);\r\n  };\r\n\r\n  getVersion = async () => {\r\n    if (!this.transport) {\r\n      throw new Error(\"Device not connected\");\r\n    }\r\n\r\n    const res = await this.transport.send(\r\n      CLA,\r\n      INS_GET_APP_VERSION,\r\n      P1_IGNORE,\r\n      P2_IGNORE\r\n    );\r\n\r\n    const [major, minor, patch] = Array.from(res);\r\n\r\n    return `${major}.${minor}.${patch}`;\r\n  };\r\n\r\n  getPublicKey = async ({ derivationPath }: GetPublicKeyParams) => {\r\n    if (!this.transport) {\r\n      throw new Error(\"Device not connected\");\r\n    }\r\n\r\n    const res = await this.transport.send(\r\n      CLA,\r\n      INS_GET_PUBLIC_KEY,\r\n      P2_IGNORE,\r\n      networkId,\r\n      parseDerivationPath(derivationPath)\r\n    );\r\n\r\n    return utils.serialize.base_encode(res.subarray(0, -2));\r\n  };\r\n\r\n  sign = async ({ data, derivationPath }: SignParams) => {\r\n    if (!this.transport) {\r\n      throw new Error(\"Device not connected\");\r\n    }\r\n\r\n    // NOTE: getVersion call resets state to avoid starting from partially filled buffer\r\n    await this.getVersion();\r\n\r\n    // 128 - 5 service bytes\r\n    const CHUNK_SIZE = 123;\r\n    const allData = Buffer.concat([\r\n      parseDerivationPath(derivationPath),\r\n      Buffer.from(data),\r\n    ]);\r\n\r\n    for (let offset = 0; offset < allData.length; offset += CHUNK_SIZE) {\r\n      const isLastChunk = offset + CHUNK_SIZE >= allData.length;\r\n\r\n      const response = await this.transport.send(\r\n        CLA,\r\n        INS_SIGN,\r\n        isLastChunk ? P1_LAST : P1_MORE,\r\n        P2_IGNORE,\r\n        Buffer.from(allData.subarray(offset, offset + CHUNK_SIZE))\r\n      );\r\n\r\n      if (isLastChunk) {\r\n        return Buffer.from(response.subarray(0, -2));\r\n      }\r\n    }\r\n\r\n    throw new Error(\"Invalid data or derivation path\");\r\n  };\r\n}\r\n","import { isMobile } from \"is-mobile\";\r\nimport { signTransactions } from \"@near-wallet-selector/wallet-utils\";\r\nimport type {\r\n  WalletModuleFactory,\r\n  WalletBehaviourFactory,\r\n  JsonStorageService,\r\n  Account,\r\n  HardwareWallet,\r\n  Transaction,\r\n  Optional,\r\n} from \"@near-wallet-selector/core\";\r\nimport { getActiveAccount } from \"@near-wallet-selector/core\";\r\n\r\nimport { isLedgerSupported, LedgerClient } from \"./ledger-client\";\r\nimport type { Subscription } from \"./ledger-client\";\r\nimport { Signer, utils } from \"near-api-js\";\r\nimport type { FinalExecutionOutcome } from \"near-api-js/lib/providers\";\r\nimport icon from \"./icon\";\r\n\r\ninterface LedgerAccount extends Account {\r\n  derivationPath: string;\r\n  publicKey: string;\r\n}\r\n\r\ninterface ValidateAccessKeyParams {\r\n  accountId: string;\r\n  publicKey: string;\r\n}\r\n\r\ninterface LedgerState {\r\n  client: LedgerClient;\r\n  accounts: Array<LedgerAccount>;\r\n  subscriptions: Array<Subscription>;\r\n}\r\n\r\nexport interface LedgerParams {\r\n  iconUrl?: string;\r\n  deprecated?: boolean;\r\n}\r\n\r\nexport const STORAGE_ACCOUNTS = \"accounts\";\r\n\r\nconst setupLedgerState = async (\r\n  storage: JsonStorageService\r\n): Promise<LedgerState> => {\r\n  const accounts = await storage.getItem<Array<LedgerAccount>>(\r\n    STORAGE_ACCOUNTS\r\n  );\r\n\r\n  return {\r\n    client: new LedgerClient(),\r\n    subscriptions: [],\r\n    accounts: accounts || [],\r\n  };\r\n};\r\n\r\nconst Ledger: WalletBehaviourFactory<HardwareWallet> = async ({\r\n  options,\r\n  store,\r\n  provider,\r\n  logger,\r\n  storage,\r\n  metadata,\r\n}) => {\r\n  const _state = await setupLedgerState(storage);\r\n\r\n  const signer: Signer = {\r\n    createKey: () => {\r\n      throw new Error(\"Not implemented\");\r\n    },\r\n    getPublicKey: async (accountId) => {\r\n      const account = _state.accounts.find((a) => a.accountId === accountId);\r\n\r\n      if (!account) {\r\n        throw new Error(\"Failed to find public key for account\");\r\n      }\r\n\r\n      return utils.PublicKey.from(account.publicKey);\r\n    },\r\n    signMessage: async (message, accountId) => {\r\n      const account = _state.accounts.find((a) => a.accountId === accountId);\r\n\r\n      if (!account) {\r\n        throw new Error(\"Failed to find account for signing\");\r\n      }\r\n\r\n      const signature = await _state.client.sign({\r\n        data: message,\r\n        derivationPath: account.derivationPath,\r\n      });\r\n\r\n      return {\r\n        signature,\r\n        publicKey: utils.PublicKey.from(account.publicKey),\r\n      };\r\n    },\r\n  };\r\n\r\n  const getAccounts = (): Array<Account> => {\r\n    return _state.accounts.map((x) => ({\r\n      accountId: x.accountId,\r\n    }));\r\n  };\r\n\r\n  const cleanup = () => {\r\n    _state.subscriptions.forEach((subscription) => subscription.remove());\r\n\r\n    _state.subscriptions = [];\r\n    _state.accounts = [];\r\n\r\n    storage.removeItem(STORAGE_ACCOUNTS);\r\n  };\r\n\r\n  const signOut = async () => {\r\n    if (_state.client.isConnected()) {\r\n      await _state.client.disconnect().catch((err) => {\r\n        logger.log(\"Failed to disconnect device\");\r\n        logger.error(err);\r\n      });\r\n    }\r\n\r\n    cleanup();\r\n  };\r\n\r\n  const connectLedgerDevice = async () => {\r\n    if (_state.client.isConnected()) {\r\n      return;\r\n    }\r\n\r\n    await _state.client.connect();\r\n  };\r\n\r\n  const validateAccessKey = ({\r\n    accountId,\r\n    publicKey,\r\n  }: ValidateAccessKeyParams) => {\r\n    logger.log(\"validateAccessKey\", { accountId, publicKey });\r\n\r\n    return provider.viewAccessKey({ accountId, publicKey }).then(\r\n      (accessKey) => {\r\n        logger.log(\"validateAccessKey:accessKey\", { accessKey });\r\n\r\n        if (accessKey.permission !== \"FullAccess\") {\r\n          throw new Error(\"Public key requires 'FullAccess' permission\");\r\n        }\r\n\r\n        return accessKey;\r\n      },\r\n      (err) => {\r\n        if (err.type === \"AccessKeyDoesNotExist\") {\r\n          return null;\r\n        }\r\n\r\n        throw err;\r\n      }\r\n    );\r\n  };\r\n\r\n  const transformTransactions = (\r\n    transactions: Array<Optional<Transaction, \"signerId\" | \"receiverId\">>\r\n  ): Array<Transaction> => {\r\n    const { contract } = store.getState();\r\n\r\n    if (!contract) {\r\n      throw new Error(\"Wallet not signed in\");\r\n    }\r\n\r\n    const account = getActiveAccount(store.getState());\r\n\r\n    if (!account) {\r\n      throw new Error(\"No active account\");\r\n    }\r\n\r\n    return transactions.map((transaction) => {\r\n      return {\r\n        signerId: transaction.signerId || account.accountId,\r\n        receiverId: transaction.receiverId || contract.contractId,\r\n        actions: transaction.actions,\r\n      };\r\n    });\r\n  };\r\n\r\n  return {\r\n    async signIn({ accounts }) {\r\n      const existingAccounts = getAccounts();\r\n\r\n      if (existingAccounts.length) {\r\n        return existingAccounts;\r\n      }\r\n\r\n      const ledgerAccounts: Array<LedgerAccount> = [];\r\n\r\n      for (let i = 0; i < accounts.length; i++) {\r\n        const { derivationPath, accountId, publicKey } = accounts[i];\r\n\r\n        const accessKey = await validateAccessKey({ accountId, publicKey });\r\n\r\n        if (!accessKey) {\r\n          throw new Error(\r\n            `Public key is not registered with the account '${accountId}'.`\r\n          );\r\n        }\r\n\r\n        ledgerAccounts.push({\r\n          accountId,\r\n          derivationPath,\r\n          publicKey,\r\n        });\r\n      }\r\n\r\n      await storage.setItem(STORAGE_ACCOUNTS, ledgerAccounts);\r\n      _state.accounts = ledgerAccounts;\r\n\r\n      return getAccounts();\r\n    },\r\n\r\n    signOut,\r\n\r\n    async getAccounts() {\r\n      return getAccounts();\r\n    },\r\n\r\n    async verifyOwner({ message }) {\r\n      logger.log(\"Ledger:verifyOwner\", { message });\r\n\r\n      throw new Error(`Method not supported by ${metadata.name}`);\r\n    },\r\n\r\n    async signAndSendTransaction({ signerId, receiverId, actions }) {\r\n      logger.log(\"signAndSendTransaction\", { signerId, receiverId, actions });\r\n\r\n      if (!_state.accounts.length) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      // Note: Connection must be triggered by user interaction.\r\n      await connectLedgerDevice();\r\n\r\n      const signedTransactions = await signTransactions(\r\n        transformTransactions([{ signerId, receiverId, actions }]),\r\n        signer,\r\n        options.network\r\n      );\r\n\r\n      return provider.sendTransaction(signedTransactions[0]);\r\n    },\r\n\r\n    async signAndSendTransactions({ transactions }) {\r\n      logger.log(\"signAndSendTransactions\", { transactions });\r\n\r\n      if (!_state.accounts.length) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      // Note: Connection must be triggered by user interaction.\r\n      await connectLedgerDevice();\r\n\r\n      const signedTransactions = await signTransactions(\r\n        transformTransactions(transactions),\r\n        signer,\r\n        options.network\r\n      );\r\n\r\n      const results: Array<FinalExecutionOutcome> = [];\r\n\r\n      for (let i = 0; i < signedTransactions.length; i++) {\r\n        results.push(await provider.sendTransaction(signedTransactions[i]));\r\n      }\r\n\r\n      return results;\r\n    },\r\n    async getPublicKey(derivationPath: string) {\r\n      await connectLedgerDevice();\r\n\r\n      return await _state.client.getPublicKey({ derivationPath });\r\n    },\r\n  };\r\n};\r\n\r\nexport function setupLedger({\r\n  iconUrl = icon,\r\n  deprecated = false,\r\n}: LedgerParams = {}): WalletModuleFactory<HardwareWallet> {\r\n  return async () => {\r\n    const mobile = isMobile();\r\n    const supported = isLedgerSupported();\r\n\r\n    if (mobile) {\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      id: \"ledger\",\r\n      type: \"hardware\",\r\n      metadata: {\r\n        name: \"Ledger\",\r\n        description:\r\n          \"Protect crypto assets with the most popular hardware wallet.\",\r\n        iconUrl,\r\n        deprecated,\r\n        available: supported,\r\n      },\r\n      init: Ledger,\r\n    };\r\n  };\r\n}\r\n","export { setupMathWallet } from \"./lib/math-wallet\";\r\nexport type { MathWalletParams } from \"./lib/math-wallet\";\r\n","export default `data:image/png;base64,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`;\r\n","import { isMobile } from \"is-mobile\";\r\nimport type {\r\n  WalletModuleFactory,\r\n  WalletBehaviourFactory,\r\n  InjectedWallet,\r\n  Account,\r\n  Optional,\r\n  Transaction,\r\n} from \"@near-wallet-selector/core\";\r\nimport { getActiveAccount } from \"@near-wallet-selector/core\";\r\nimport { waitFor } from \"@near-wallet-selector/core\";\r\nimport type { InjectedMathWallet } from \"./injected-math-wallet\";\r\nimport { signTransactions } from \"@near-wallet-selector/wallet-utils\";\r\nimport type { FinalExecutionOutcome } from \"near-api-js/lib/providers\";\r\nimport icon from \"./icon\";\r\n\r\ndeclare global {\r\n  interface Window {\r\n    nearWalletApi: InjectedMathWallet | undefined;\r\n  }\r\n}\r\n\r\nexport interface MathWalletParams {\r\n  iconUrl?: string;\r\n  deprecated?: boolean;\r\n}\r\n\r\ninterface MathWalletState {\r\n  wallet: InjectedMathWallet;\r\n}\r\n\r\nconst isInstalled = () => {\r\n  return waitFor(() => !!window.nearWalletApi).catch(() => false);\r\n};\r\n\r\nconst setupMathWalletState = (): MathWalletState => {\r\n  const wallet = window.nearWalletApi!;\r\n\r\n  return {\r\n    wallet,\r\n  };\r\n};\r\n\r\nconst MathWallet: WalletBehaviourFactory<InjectedWallet> = async ({\r\n  metadata,\r\n  options,\r\n  store,\r\n  provider,\r\n  logger,\r\n}) => {\r\n  const _state = setupMathWalletState();\r\n\r\n  const getAccounts = (): Array<Account> => {\r\n    const account = _state.wallet.signer.account;\r\n\r\n    if (!account) {\r\n      return [];\r\n    }\r\n\r\n    return [{ accountId: account.accountId }];\r\n  };\r\n\r\n  const transformTransactions = (\r\n    transactions: Array<Optional<Transaction, \"signerId\" | \"receiverId\">>\r\n  ): Array<Transaction> => {\r\n    const { contract } = store.getState();\r\n\r\n    if (!contract) {\r\n      throw new Error(\"Wallet not signed in\");\r\n    }\r\n\r\n    const account = getActiveAccount(store.getState());\r\n\r\n    if (!account) {\r\n      throw new Error(\"No active account\");\r\n    }\r\n\r\n    return transactions.map((transaction) => {\r\n      return {\r\n        signerId: transaction.signerId || account.accountId,\r\n        receiverId: transaction.receiverId || contract.contractId,\r\n        actions: transaction.actions,\r\n      };\r\n    });\r\n  };\r\n\r\n  return {\r\n    async signIn({ contractId }) {\r\n      const existingAccounts = getAccounts();\r\n\r\n      if (existingAccounts.length) {\r\n        return existingAccounts;\r\n      }\r\n\r\n      await _state.wallet.login({ contractId });\r\n\r\n      return getAccounts();\r\n    },\r\n\r\n    async signOut() {\r\n      // Ignore if unsuccessful (returns false).\r\n      await _state.wallet.logout();\r\n    },\r\n\r\n    async getAccounts() {\r\n      return getAccounts();\r\n    },\r\n\r\n    async verifyOwner({ message }) {\r\n      logger.log(\"MathWallet:verifyOwner\", { message });\r\n\r\n      const account = getActiveAccount(store.getState());\r\n\r\n      if (!account) {\r\n        throw new Error(\"No active account\");\r\n      }\r\n\r\n      const accountId = account.accountId;\r\n      const pubKey = await _state.wallet.signer.getPublicKey(accountId);\r\n      const block = await provider.block({ finality: \"final\" });\r\n\r\n      const data = {\r\n        accountId,\r\n        message,\r\n        blockId: block.header.hash,\r\n        publicKey: Buffer.from(pubKey.data).toString(\"base64\"),\r\n        keyType: pubKey.keyType,\r\n      };\r\n      const encoded = JSON.stringify(data);\r\n\r\n      // Note: Math Wallet currently hangs when calling signMessage.\r\n      throw new Error(`Method not supported by ${metadata.name}`);\r\n\r\n      const signed = await _state.wallet.signer.signMessage(\r\n        new Uint8Array(Buffer.from(encoded)),\r\n        accountId,\r\n        options.network.networkId\r\n      );\r\n\r\n      return {\r\n        ...data,\r\n        signature: Buffer.from(signed.signature).toString(\"base64\"),\r\n        keyType: signed.publicKey.keyType,\r\n      };\r\n    },\r\n\r\n    async signAndSendTransaction({ signerId, receiverId, actions }) {\r\n      logger.log(\"signAndSendTransaction\", { signerId, receiverId, actions });\r\n      const signedTransactions = await signTransactions(\r\n        transformTransactions([{ signerId, receiverId, actions }]),\r\n        _state.wallet.signer,\r\n        options.network\r\n      );\r\n\r\n      return provider.sendTransaction(signedTransactions[0]);\r\n    },\r\n\r\n    async signAndSendTransactions({ transactions }) {\r\n      logger.log(\"signAndSendTransactions\", { transactions });\r\n\r\n      const signedTransactions = await signTransactions(\r\n        transformTransactions(transactions),\r\n        _state.wallet.signer,\r\n        options.network\r\n      );\r\n\r\n      logger.log(\r\n        \"signAndSendTransactions:signedTransactions\",\r\n        signedTransactions\r\n      );\r\n\r\n      const results: Array<FinalExecutionOutcome> = [];\r\n\r\n      for (let i = 0; i < signedTransactions.length; i++) {\r\n        results.push(await provider.sendTransaction(signedTransactions[i]));\r\n      }\r\n\r\n      return results;\r\n    },\r\n  };\r\n};\r\n\r\nexport const setupMathWallet = ({\r\n  iconUrl = icon,\r\n  deprecated = false,\r\n}: MathWalletParams = {}): WalletModuleFactory<InjectedWallet> => {\r\n  return async () => {\r\n    const mobile = isMobile();\r\n    const installed = await isInstalled();\r\n\r\n    if (mobile) {\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      id: \"math-wallet\",\r\n      type: \"injected\",\r\n      metadata: {\r\n        name: \"Math Wallet\",\r\n        description: \"World's First Insured Crypto Wallet.\",\r\n        iconUrl,\r\n        downloadUrl:\r\n          \"https://chrome.google.com/webstore/detail/math-wallet/afbcbjpbpfadlkmhmclhkeeodmamcflc\",\r\n        deprecated,\r\n        available: installed,\r\n      },\r\n      init: MathWallet,\r\n    };\r\n  };\r\n};\r\n","export { setupMeteorWallet } from \"./lib/meteor-wallet\";\r\n","export default `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZsAAAGbCAMAAAAlRs3KAAAC/VBMVEUAAAB1gdddWs6cq+JsadRdXalLTJhFRXtTU415iNhOTo5+pe41NXxjYM8qKmscHGuRn+MSGZl0ovJ3eL6EqPEXF19QUcFdnfNlctZZmvNvc9prbdaMsPA1NoYkJHFdXdFSg+08ReFMO9VVTdg3k/Vdk/BHSL1bXac+mPVDlvQcIqFKcupJlfQvL3lRculLS404ivJLRNw9P7dHkPIoKHQ/lPQpLapPm/RGRohmlvF0oPCBg7pFPt4UFFBOQ9AkKag0OK9Ie+04PLJYT9ZeYLtJRsc4OH9LXOE/TuIrL64kJG9dZ+EVHJxDZudFgu5AXuZHk/NHjfE9PMA2OLVQfOtLd+tQjfBrbLZ7fbFGdOs8d+1Dj/JCK9hPT49Jk/JqnvJaVc4jI3EXHptRTclVUcxOS8dUQdhNQ91SO9pZUdBLRt5WR9UgIGlLScVYU80YGFJXTNJGRcMbG1tDfO1BXOVDeexSPttJR8RVRNZDV+MUFEVTUMohIW5BaOhCcuqkoe9Eh+9DgO5CQcBCdetAX+VHT+FCbelBZedPQdxBaulITeBJS99GUeFFU+JAYeZYTtEdHWBKSd8XF04WFkseHmNCWeQTE0JEVeISEj94a+49Pr1WStRQP9xAQL5FivBCb+lFj/IfH2YZGVVBY+YaGlhGlvNEhO4VFUk5O7tGkvNFjPEPDzoRET0tMLDCv/02OLgwM7IqLa00NrZaVM8cIqAcHF4kKagyNbQhJqVCWuQODjVGmvQnK6tEQsIKCi0dHW1MR8tQSsuAcfUYGGmrqPNiXd97bfFKSN9hXNFNS9CvrPQGBiMFDJMTE2ZIRMhfWtsVG6NFRc0/QMfIxf9AlvQICFxQTtUoJ3lpZNU5OcCbmOw0NJrRzv8ZHopoYONcV9UwL4ampPAPFpgSElRRTcJEQacwMbo6Oq1WU9g8PLM+jvIVFV0dIamBfeAoKpM3cOsnKrOOi+ZJSNE7g+9GM9s4VuU7OqJ0cNo1e+83aOlyZ+q7uPkyX+gzT+RLR7VJUHVbAAAAYHRSTlMACZEcgRAaYFcjjy+3ib/zE9xhVFP2lmouhmk/Q3XcXEv+/bL+qGNK9d7Vq8yjfzb+2a2k7em8saKagj/++dCljvvGnHfp0r7s6s2b7u3z3b7u6NrO8+HPcNr59ujU+LDlSLXNAAApKklEQVR42uzYPU7EMBAF4IlQftZEASkNTdxSRdtssdK2aIvcYu4xd5vCtUvEdRACaSRgvSlINsLvu8LzjJ9NAAAAAAAAAAAAAAAAAJCzsjoNbhzd0FcVwXZUjTt7/uInVz8RbMLe+fAqLMIfhDnGw1gXBLfWtxqUv9Gg55eS4Jb2owb+VQhdQ3A79SEIX6I8YLHdjAvKCRLaHa2prO77pq6b/qnK/FSUY+Ar4rSntVS18wdVEVHVw3loMo6naCNfpX6dcIrno5coLHbdvU1uT3myaJKC39HiiuEcflx8IoG7njJUWjRpsStoYc2kKvwLERl3lJuyDTxTGGlR1VGVLxH1uTX5wqK5Lja0oJNX4QRVRzmxhTaH+pIW8/ygnCaxzej31aKZJwy0lMaiuUynbAqbNbSZ1N+RWW1qjHSZTM7n1GxicCyaK7TL4iFqDW0+nQoy6y00E3MoBIloEuKJzB9Gs5WyuAmJhZYSj2RWXGhG/SP9b+/s2rFrE1EcB/BLbFqjRcWaUBTtIOgkhVKkIARRU1G3OOgiRK635QXO5YY7EO4vyNCp4FBwTWiE6OLjkOsQAhHhCCYli4iTEezk0MXna8jvJeba9L0neSl+h66v8Mn39969O9oaHptVGGqSW/N/qgENV5zPi+OhgTiJY317Qwaa4/DhNK7/C5r/xWFpSPhsno6JBuItn9COa8hAc2jGfxhgaY7PUS0yfeHixYsX4rEIV2u4cfyVsdM892c1dXPp2t1U2sWmiTPp1KOFeQ4aXhxvVioN1+/DUfYYHVu4qiPTMNB+rBZOJy8dgeZ7zhHAcWaltobP5rmiQ23hqoWQ8SeoG8vCZnJ+dJqcCI43K5OGt7yXNQUzf9WkMAM4Fn68MDKNEI6/Io+Gu7yNFU29TKWRbUAAB5k4GRuZhsUZw8MFtIbTxl/VlEvU1EmG4ZDgpfhhNGcojVBzGnOSaHxn4F9Q5QUsVyJ3EZEJx7Ey04fTiOJ4i1JoNoGGA8dZVuwVWyRKaSiOibH5N465FNPCM00HmiCOv3pOSms2yfI5fpyzatlEooZOY2GMstVq1nRdNIDjJg9szWZOGMe/IYeGLn9cbLo0tuEav3Zqe6XS3pfdJt5AAzgLB9FsiuP4JyXQdP8PJzdEZwJnWiSq2zahMY0ftaDdDkjI35dN19T7cDLxkIFGaYRxnOWYOE1iHZbnw/GuKPTVAKUhOLi63W6XemkHOwizOOhVNOzwTGDEceqnJAw0SkPDu+XUn2nKhNKQ4GaJyDAJ2tvI7WvORnzoQPu6vi4Bxzkbl9QaseY01HmDQ2jW1oCmL+0vlmkADmpFhw60dRJxnPqKRJrhe86E3dlQGoKD9BrQAM7uRt9pLRVGI47jLcflDTRYnmPXu6WpkUjUXqPBu0ADCYKmy+LguWEDTQpOY0ZOa0Sb41zR1EiPBlVLAZCwU81EDE5rarA1XwsFKTj+rDBNBZYO23Mm6IOBHo39EWrDhoBVsQE47v2/aaTgeA8FHypmEgV2ae7TmuOr8cV6JLrWjW7XgtLQtH+0DAYnHWMHGqWRgeMkFgVbQ2hIxJvjryrxdENo8vk8tTGqpTCbHYwYnPT0QGsAh4YPxxO9gJ6pVOB3wbfnwGdYCoTSdHHQrzCbYNuwDMDJnGBpKhXAEWiOVxelSVToyjSHNWcCXt5QGrAJwmz28qYBOK0LDM0LsBFojnhrTia+04UlNKeuQm0ITTab3w/0JsQGcFrnGZoXgMPRHIk0FVhZbM+p39DGH0oDOEa4Tc224GWbtXGaoeHDkb7XkNbAyjS8zfGvKPBRZySaz2YB56CzwEsDbAyUOQc01IYbRz7N6M0JvdFT4EqAtobFse3tMJtdVzcg6WmGhrc5kml663LuOUAzo409PRrACX32DJpYBxwzBTQCOHJpCoAjdFqrK3DJCTSA86EZcmdT05EOOO4USyM01uDwHL8+lVy6eXMpOTW3yEVT4GiOou8GgIbB+bjTHmrzi9QGcNAcpXkNMiLN8RK3tNi125lO5325WCy/7XzaunMvfhSaF4RmdJz+KEgDrenD+VDdC4beChg6g5Pap3ktBccrPJlPPtjaKr7bIin+SbnTeXD70hFpOJvjTAJNtzjw+MlONMvWAQc/6tIADv9Yy+W+Vd/8fPfmzTuwKZbL79+Wb8ePMtC4m6MazW/q7i60rTIOA7jzC4coykBkIkIHE7zTCxH82Jh6oezOC28U0iaZ69YmSy/WkQwCvfKuNSkhzZaLhsIJJCH9yloObWhCEtO07KwV1i5zSVNbt+Iy7CgtdFD8vydJ/yc5zTnp+5529ZmgF2rAn89z3ryJFgdNpnO7+MefNTTP0pNAs4vT/u1bx77nfISGvTn91zfn/x0OD0NKOKjz+LsPG6PBF6VrzpGiwdbshbP47M8/pF8XsNssQIM4t19+4c2/fD5NcHqbH94bDkNEnOrqDI1PvK9OMzDQg32lfOb8H2jKs5bO/vEn8JS+BPWsaOy0Vdk8+vFNzkcywDxrvQtr8/5w2aZ21kh13lFtzUAEwtico0ODg1ZHJza1SL46CHlWKJomjTYI0tzVdbiIDHtzgMY/74eIOvJZg9z5RJUG/41gaM4RocHWwC2NzQbX0DIcg9GiTy9CdO0WI/w5UhxDa7PbZzaz4xAaD9CQgExJpTJriHNWedAilbpGmJpzxGgMeoMOANLkD2pwIDZjO/wy2gwQm0TH8GjJbYYo4kQawiGt8ZRoBsfCnslOb3gsNCTD+UClNTIcqhuCo0RjiKWL61k7JLteTMdMMhyDJGhjE+5bzT60UXjmqH2eEyE0HoIzFo4Jue2+vr7tXGvXUAhnjdjc+uhYXRrJxQTVM+do0uhtRXsmkShAEomMfctmk+GY9sIRVq2cWQzrrEWaPUADCY915uLxeIoEfi+Eh6qfOXfeqTdovg4MxawdUZpYej2TsO8mkVlP61VxII9WOaDRAqenQuMP5+Pxvt2k4n2WGpzxd/emwdZQz1rb0aPRL9oz9qpksoCjNmsGYZWzmqU21Efpjt3W+JPxVJ808XgMcbA4dQYNQ3GUPkI0lcOzcbFQosGAlU5t1oDGijQszZHS5HZLg9WZqmrOxHfH5TQ+pGF55hwVmt1BW7TjniHOusGkhCPSuBwOdpzys8br9SJNNU7KOzSGOHhUQ5ov/8LXY5q1/wMN4GzFdAqzVqZBHPpZg9bc9pIgTXXiyZC0OLc+kdPg6zHO2lGgeWGXpoA00iSyOkNdHJshWaZhb85AhcaPNLU4Fun7nIkfjslpSNhmDWle/fybs2fOnDl78l2mr/xq3xrE2cLjgGzWhFW3y+xgxyGt8ZZpPEhTayOExhBnKPReFY2jTKM6a+o4/3z2wntnz52fXV5uaWlZXp49f+6s6uX3IdKgTTFWz8aUXHW5nSIM66zBoM15uxRpwGY7PCi9IDhd3ZrSq7HPWn/P0o9nWpZnWzCzyy2f4uONMeyDhqOGV2tVOmUapzqOenN8zV6ggSjRwGnAEpJcfA6+X0ODOAyz1t/b9mAcClMTsPoUekoRptYY67cGUsimDbq9cIDGDTSIQz9rvuswaITGo0ADgfc4ks9zHp+WDJrDJ4Z11qA0zS13UKRKp+UNbQFoBw1t7GnbXja6Mg2EddYGoDVdIo0XaBRtQpKPDO6cxNaUaRhmDSK2ZgFp9qgO5amAfdDUbVBnJLfqDgILOw60pkLjTwKNig3iQG+QBl6tnP3OGuoATf8DlNlL56PXXzj4HFOmwSRw0zCkNcGgk+PAhXXWzNe7gIbEnwcaRZupkORj6rH3cdDMZsShn7VeFRrAOS+/jdCexiQbNNWzAGYkuRogNBrg+K5PTpVoPMZUSpEGzgKDYQnOaWyNrKc0OL29QKOS2bdf0UaAnQbP0NLAoAUDnBjWWYPWTFssoo03p1abbenH1KGxEyUavAOnnzWkUcU5q5EBO02hsKiX2eRWAwHOakUc6uaY2yanJi0WyyTWRsEmPyjBCf3wFqFxIg1Lc5BGFecEOwALDSaxjpOGgybSEBzGWTNfF2kIjvrTJtU3OexHnMFz2BoNcJBGJcvyj1y1p9Gn1WkKeNdZNWjWUhhnzdEGg1ZOA5MmjEm/ffP4ZTkNztp+j9I9PUijVhx8z3tgrVGiwc8I9Cb5oFVo2GYt4myzAE3FxrKdUqbp8w77EWcwdBxOaEizn+bIcZBGPctv47ucA2rNYiM0WVPtATq5yiMNy6xFHIQGbdqVbVJxI9QGcULvwLPGii9EP2tI02hx8ELigAYtq06TwM+kcdACPMpQzhrSYLztfSlFmm7SGrT5+8RrX3IOBwWObNaQpsHifMoAoE5jMGUz6q2xp2O1g7YT4F0uF5iwzpqz3zLd2dmJvencTinRtI75PR7UGZ7/mePwhVhmDWkaHrXjGpIgjWGkVJuiOk1CTpNccfNWF+JQzxrQdE5bOiH4vMmllFpDaCQ48/cDVocY5lnriCANw6ix07SKNvrFQqHhQcPk871RVymMs0aOAUQGbSa9ybhCa8JAgzjhe8M+l0MM86xFkKZhmxe1t3nxSmsrwTHp1zMUg6bLLUXdLi1wuH7L3RIN6nhaU/VphokL4njmm4MOCFNzaFsDNue0b00MaAiOLW0vqNJga3DRgrwbcehnjevtvNvejjj4wFGkQZy5J0HOqYajfvFJRwP56BWtWxPrbi3h6LcS+xg0vA9ojrohzDhcP6GR4Xjz8XqDJn41CnHmN61WfBmGZw7NoJGc1/gdzhvXusFGTKyoYpPJ4qBhbXYCAWLDOmswaEAjx4F3n/G9aUBGajO/5nA7IezNEVvz/G3eaOqGoE2jNBhhAWqDOLRHaVdPu0gjx8HbTllrpDhza76gE8KO09EBNM/f5mTTlStXKjqx9USjg4bJr7h4AsM4a1Z41hiNdXAMqbiMxi/CoM480rDNWmSA0Dx/m/e+7VawUWgNJnk/GgiCC9usuXo7HxmN9XC8xu24pDogpfd7u9BGbI054IQwNwdpnu9Z4N2PbwBNSQc3raETGr63aYsGg5Q4SBMhNAo4k0JfvLRsqVQ8lbSEvV0QxCE0+CIUzUGaAQoa7c/Qx7+6fKOCQ3RiW4kGBw0j2Dg+CGGZNZ+1hwyaEk6X1yjkwAV8tgWjx0NkEKdMQ43DSqP9e8+Xvmq6AZHY4PsbtUFDG/hoAG3omuPqWYHW1MOpXHp6J42t+XyrsQtkKtmlcQCNFjh0g6b9nc2ppsuXoTiS5sTWM/ugwceNGGocd2Tlkd5YDwd1KhRlF8QBGt7KaYHjG3jwmAJF87vOF5tuXK7BiS0mCo0OGt7XkOIwzJoLaIx6NRzMZFdVyjRWLXB8Phoa7T8jONl07bIYyaxdweKotQYvBWZkNvtqjrsHWgNRwrFUpcZm7qEzYIWw4xCa0ZZR6kn7QKsjWtO1a3KcWN6eaYgGbdqiAcChnbXSoJHQNufpGkdaw44jDtroKDXOslYn6Le+unBNhgM6U2nEQRq9rq6N0E9sqGct2EFo6HG8T9ecQKMFjtgaCNCMPteTwKkmsJE3h+BkMwU7JpFZ1wFNfZu2GZChnbUgtoZu1uawNYw4ZjPQiKGQ0fI7UKc3rl2oh2MoFjLlI0EhkbEXbUBTP8nrxIZy1gIdK4INTKib8/Qh0rDhmKE142Uaqlmb/VAbmhNNFyByHFHnylS6mC1kIAl7tqiLmXRKyS3M8CBDNWswaHmbjQHn6ZoVaZhwoDX/Ak05FDiz32j1sLl4oZQ9cbpjsdbFrWKxuLVo0ht0ykkuRcGGCicQARoxlDhzQIN/fxYch/nBxPj4+CjhoXrmLJ/RaNG+birJ1Js1wjMVg98M0Bk1m01iQzNr4qBBaJvTNedxAo0WOA7SGhKszT5ptPrPCD7YuHi1Hg5efJKM6FQj7PBgQ4ETGAAag4Ee5/YU+QYJOw6hefLvrVslnHGaWZt9+yWN3tn8dPGiCg6kjKOqkzc54BC931kjrbERGgacu0u826UBjs/hABpIVXMQh4KGOqeARhmnu8Hm4MXAvpvDw6ABDAPO9Fow4HKx4/icZZqa5hCZ0UOmeXnjopgLGs1abnOG57E4DTXHyfv0QMOE87QfFo0FB2n+nhBlKjiYQ6Y5DosGYZ81HDUuyvP7m7WAzwY0TDjTcP/tZsLB1kxMAA7RwebgiYCChnrRNq5eBRgNZy25BMUpyTR4Q8APrCRNBgoctOmEg4DbzY5DWjNUtsFZk5ykD5HmA6ABHC1nTVjhowSn0aM0x5uBxkSDgzrTm4GAmx2HcwLNEOBgc2TPnMOiOd508yqJprOWg+Jgc1RnjTfbBJMYBpy7C1AbJhykQRxsDoaChnbRblbhXNBi1gQTV8LhG5k13getEcMwa1MWM+9mxnECTQhtZM3B4hwCzYmNX28eAE5udSaKzVGetSgMGv6/b2hxpjeBhhWHIzQhxKnTHMA5BJpjH9/8tQan4RsCJZ2R0nGgkdMaDBrQMONML4ENIw6hGQyVcBSeOXgiUKRhf2vzKwRw0EbttAZpoDl5IVLBkdtI//mRQdOhjRwH0gjOdFvUzYhj5Z7cAxqSKpu9bggOnub1jV9+QRwtj9Km5IgDcFRPa1EH0FTC8syZ8kWD1DhIM1iFU/+0Br8Uadhz6otf9okDaRTHxmFz6uFEyaBh6GdtysvxQSYcq/XJveFBxFE5rbUcMM17QENwUAdxKqE9SgOOYUD5meNyR3tNhAZDPWvTay4+CKHGITT4A3QaeeaMKtOw1wZycLOWb1Y8rfHRhTzSsM3a9EM32lDglGnABiK1kTUHZUYPkObkhihzcLMmJDcDoLP3m9BA1LqZFEw6DMusTT8Mgg01jtv6ZD4s+7Fg6qe1g6J56+MvLl1CHFFH2xsCUz6nX+BBJ1A7ayDDL6zk8kDDjIM21Dgu631Co4gDkeFoToO1uURs2GdNKUJyp5mfmameNT4aDbTtJAUdhnXWxOcNBQ7S1PxYMLkNNgeCpzWk0bI2QCPH0fricySZ3FnyRWdmohCeB5aZqCuytCMk4a/TDifWxUUDlDhu6/05f5ikweagDrZG07z8xe/EpnbWtL/4HBGS+dX7S70+zh10Wc29C5sr+aQwgnOmxawZY75ogA6HtMbvV8BROa2NIo1mtfn9t0sUzaH8mDon5E2GlZ0VmwmocMy0aw7cCwRocCo0aKN0kpaf1pBGu5z8j717i42iCuMAvmu9gEUliAgCYuOFKOIFFFEeVEQF7wQvqC+u8fbQ2tCChLoQWi4Nd9gtZUNSSguhwK4BTCi4abdt9oFsmq5tI7tp+mDDA21NA00JBBIwfrPd9ut2Zs45c3pWZqbnM9EXn/jl+8/Z7xvOZO3ZAzjpjjXk+Rvqzz/hX/g/i+ycWAfYcOAESttb9gMNoXOIE4I00IxffG7PIA7GmpjBJ73E48TgtjYOHB/SHDXyzEGaZ4BGdNts2wY253Q75yeeWBNvw4zTkOMJGcbxJmig0IYaa9g5SCP6abMtgSPwmSO4jOJ0xRv9RnH8CRrEIXxhVz0hwEAT3TZbt0EJjbVvbm+sxTqDQYM4fp9CgziGT2sXnhkvnMb54tatAziYawYHn9g6Ap85/IPPhkhFox9x6IPPqgDQ4OU3HM+cCxBowmtG1lbEocfaL5aItS58R56pc/wKDdqocMiDT6QRXI9nbQIbu8VaDBqHHccfaO8r2484Rw11DhQGmsiamrVpEwmHfZ9jqljr+jcY8rPGmtI1RWVKccZaM3aNyHo/YWO/WOuCF0gYOwdo+gbvvsFij7UL6aGZvHiTUsZi7QcLxNqvXRVsOIlAK0rScMVaMwaa0Loza/t2Ag518GmOWNPCieV4Gv0MOMEETZFKB4oJp7pnHnaNyHK+u2k74AzY2CrWulYXUHGQhqVztBvn9TR9d+ix7TvARq9zfjRrrDHirPBSYy3ku9ZXWwRFaBzi4LMaaQTXW1k7EIfyzLFerHXlnCbj+ELezgSNSocVpyZtNGMX71BsNGLtnFlna0YGnzm7YvFQSBen1B+qgI8dYqljjTL4RBrxdeetHUohjqJjjcEnW+d819Ve2ggLai0cfyjQUd+HMmoc+uBTPA2eBHbs2wc26lizzT6noSsn7ged4TgB+Gnq7o5Ea2uLiDpHSac1pBFfU4EGbNSxZqN9Ts6urn87vCGINsQBmGCBqzMSwYuJSI+c/XqxNgdphNdzWWsAx7Kxxjr43NWV057tCYYGK+itaC8Dmf6q5Y211x1Qd89cfu/82bPn37v8+btFRtrH+9YATmqs2XHw+X1DLLa6s70j7q6ocMU72q8VRSL1q3WvkVSnmlas9cInOxdMn/1SuKnO7XK565rCL82e/rywHzdroIbh2HLwqbxDADyxSEN9fUMkEoshDAGHPCHofXvszHFhVxhcBsoddtWNG+MUM+a8NYCDsWbPwSfgKJX8r8bFREZj7eTF/V+8Ew67VBUOj1sgItI+XLMXaEZJrBm6HZc2vjlz4veOkiY3kgxtnqbpI7fJXLx3717eWLPYhIADhzQhOHoifjrb5QYcLZ2mcXeP+JR2td8GasDG/rGmi0OxgUKcthPx3dluKJd2hR99fqQ/PK/+sXdY51hy8Pm/x1rb0Xhedjbg6OrU1T04ski7unKlFo5d9zmiYi1JQ8EJzxyJzcO3VgIOxhppQmDXWFvBcVpra4vnVSRsSLHmfmAkz5x3oW+Gdc4Oq8bad6I6h44DNJUlFYijpxO+38kfaR/uBRp1rNl5nyMg1lrbXJUlYEPvnPP38r9pe3UjyKhizdb7HO5YQ5r98crdJVBUHEi1ydwn6FsbEadfx9KDz5/TGmvYNbn9H8ivoMda02zuOefKjVo4dt/njCTWoGtc3rzdKhzdRw7nr5yMxTvBxlisnVN1Du/FRCKL/2IitGHrnNYylwe+uQY2bLHWNJ/PZsJKsEntnFE2+DQca61Fbm8eFDNOHZyj+QY2OxEHCmzk4FM71pCm4HDys8UqHG2d81zTAeenYKPqnNG0zzGEk6SpPJzE2c2GU8d1Gpi8duNONc4aGWt6R+lobXZBZSUBR9PmUSfPyvPWoUM7d8pYY+2c1la3LxdsjHVOXZxnz/ba1UODONg5cp+jjVNW2+oqzYVixMG6h8NmVrFiQ4k1sLHti+zGJgR9HT5PLh1HbTOdx2ZncbEaxx77HOFH6bKWa74qsDHeOU1jeAadYFM8PNbkPkcTpyxaVunzeNQ4p6njm/OLjNvMWAs0KbFmj8FnWmKttiXu93oRx0CsnV/OMYS+WazCoU4ILBRrQjunpbOqwMuKk6pTx3EWePXm2kTnYKzJwacuTl/cX+VNxTlMirURngW+LAYbaqzZ/0V2lliL7vf4qgCHI9bcrjEcC4Ita9U49trnCDuttVwKwp0qup2zm3AgqHtprPEFwYdAM6gjJwREnGgJ2KhwQIc++Ky7n2NBULyFG8d+FxORcaJlXn8B4kCxHwjC8zkWBGu3bFHZyH2OJg58HixQoBTHM+f8Aj6bLTLWmHDg7k/lXhWeWAu/5+SwublFjSP3OZo4kXioFIon1sLTeRZrN4CGFmvyRfb+r1G6Qj6w4Yg19wMZHBd0frZ2M9BwxZo9LybSx1kdzQ75+HC4Xh6cXL55cyqOHHzq4UQVG8CBMoiTXHo6M2c+BTU1g9HmxmbESdrIfY4KBzPNx9M5D42BP+lFcxb+3n9PxJJ5kx68i24z7SbQqDsnFUe+yA46/TaBAAfO4emOGXPO9Jw8VXMKZOBOolM9PfMWjaUupG+Wp+Lc9sGniWMtFm8MqHCog8+S0/EvFv7Wm3KvNPicXTKJ0jtTboDNsFiz5z5HwOAzdkn5XovBWDtdcunoxZMa961VNy+cSd4Q3ChPxbH94HMEnQPf2A0CjqFYy8vubNO8kR3q7AekXahz1rry8nKzxZpZ9zk5K6pCfr+hWDtccbKVcI1k8xz9ccFds9YBzrDOkfscPZyIG2yMxFplRWcr8UMTgEPoG8AZbbHGjRNrDwXpOLjPqdzd2Ur+0ATg6I4FZt1QcDDW5OCThFMfLVAah/WZk1sCNLTbcZvf0Pt589nldQZxRvXgMwa3gCMOZfCZm+gaGk71t1MJNpRYky+yI06kqBQah+2Z48nrbKV+aALq7Dxtm4lvKjYy1hhwsHGCTLEGNC1s3zJoXqRjU76BgiNfZB+KUx/NRRxSrHkTNEw41Us0z2oT3ly3AXBSYk3uc0g4sU7lU7G0WKusqgQa1u/nnJ2ha8PQObZ8kZ2vc+CjICFqrFXlJmmYOqdnoa5NKo7c55BxcmDiGSTFGuAUAI2BG9lreibr2hiNtdF9MVF9xNVIjrVSD9Aw38gO1fyIpg3ApHaO3OdQcWJxQqx5vAHoGmMfmqiZ49Q6p21YNQTHjINPE8Zafazd3wg2mjil/uzuFqYb2RGnZt5d2jbDcOQ+h+WZ03061KgRayDj6aiNst3IjjZnl2Xq2CDOaBx88p3WIrF2TyMkW2Aojs8fLIh399WWGf3QRM3JRzRsPlJszB5rJtznrKiP1bfn+RsbgwPBFgiGArkgE9W+Nor4zDl1cpHGPE2xMdo58mKiRIFOd0e2xx9MlL+qJN5e1tKif98a4WuHBJvbH2sWPEpD5URikSL4toFS17pX9PWtqCXfv6qDAzaPaNi8+RXAII4cfBrCgaqPJKs+Sru6WD/WapY8qLbJ+PRy/lAcEww+LbXPGdGN7IhTszBDbeOcuwpsUnDkPiftN7KrP0Wp9fvGOSs/P3+VjLXb8qEJ7Jzq+xyaNlBmizXrTAgoOKxf2G2eqmUzF220Yk2+yC7g6mJq5/y2bLzme51fIQ5b58iLicidw3FaOzVJ+33o6yCTEmtyn5PmWFPj1CzQtHntcorNaB183oZYQ5veOTrXCyg2xFgz0eDToqc12uCzd4G2TaaSaagjB5+icehf2O3Ve7FzcmFhfr45Ys3iL7IjjLEv7J5ZlqFncyQFxxSDT4s+czhjbclU3auGluarcKDkhEB0rOmlWu9TDr1yfn69ECq/kPGZIy8mEnuU7r2P9JcKEzagUmimWLPohMBwrPVOIt5nU5iofhk5+PwfYw2KTOOYciRpo/xjxsGnjfc5F8k0jgmFgKMba/JF9jTuc6BryDXtypEBHJPFmg0nBIM6SEMq55dHAGcg1+TgM/04ycJAIxyiwWZIrMl9TpoHn0hDr2evII7qtCZfZBfdOUjDUK9dXw82ZjmtWf9FdmqsIQ21HruyfhDHPINPC7/IzhBrF+9wMNW0A0dScArNNSGw4ovslM7BrqGV81lonCE4cp+TbhzsGmrNhb4Z3jlmiDW77nOQhl5PKn2DOHKfk97TGgQae028DjKqzpH7HNGxhl3DXpmJvmF75siLiUYw+EQa5sqAw4Be58gX2QXGGtKw1xSwGcAx6+DTHrGGNMw2Bw4kbcw0IbDhi+xtSMMcah9p4kDJfY7IWMOuYS/n0gOIQ37myIuJOHCQhqNevTKAY64Jga32ORBoPPUw2PTjmHNCYPFYQxqOmrZ0vQ6O3OcIeuYADWd9otCY8rRmk31O230O3npy/fEhOHKfI3rwydM1OFIDG8SR+xxhncNPg2+sHzhO7xxrxJrp9jk5GGh8ofaCYmOK05rtLiZCGr6acOX4EByT73OsdZTGQOOs8S8cPA5F6Bw5+OSINaQZaaglcEw7IbDmPgcDjb8efuHgQYw1uc8RE2tCaByZTys2AzpynyMm1oqARkC98k8Sx6wTAgvucwTROCZAqPWfB0wxIbBDrLUKonGMXQqNQ+0ceTERO07RHQ5RNVexOWj205p1Bp/QNcJqIoRaAsc0EwKTz9bInVMkkMbhfBoah9Y58mIixs6pBRqBNSXROCY/rVlk8CmYxjHta0XGVKc1q77ILo4Gf+IcG8SR+xzOZw7SCK3H/jmWxNEffMqLieixBjTCK+NpwGF75siLifRxxNLgwPMYdo52rMmLiWixFkUakTX+5YNJHDn45OscpBFeUyDUCDimusHDnPscpBFdmS8rNqTTmryYSAMnzTR4jKZ1jjnvWzPHhCCdNI6JTxxLlAUmBCYcfKaVxuH85K+EjekmBFaItXTR4DT6v/bOoLWJKIjjs6wKYRHKGojRBZMYpSEhWEIIhuAlhxZKbQUVRNCbeBRE6EWoWBXRjyClICnYq8dc9CRePO2n2IuHNNBAC07WrjGmJumyu5l5O79D6P3HzJvM//WldZLKkYvsg8pBNSFTcv7IIZ/nkLrI/uUUhA0WTuvIjeQ50xGRGmTNbo1WDpMbn7NbfH4JvaF5hdNiM60RyXPCrxpvVEM5NKc1qnkOqomGZL7lyZE8ZyqwoUVF7Y8cyXNIVQ2SqLY8OQTzHHKLz6+oJjqu256cKfOcOF9kx6qJEr3a8uRInkNLDUA678lhnudM2hAwa2h95gr2kRzJc2hVDWLlWyesHPQSv4eJUM0MqLmFw2lD4DfPYacGu5prhuGG4KRtjZ0agJTX1STPoaYGtJLX1STPIaYGwPAKR/Icamq8LzmjlcPoBY9p5XBTA4BdbUxbo/PGZxB5DjM1YM23W8SntcAeJmKmBruaPSRnYIdRnjPtKM1MDc5qrhxZfNJTA2DMt1EOww2BrzyHlZr+N9DfciTPIacGoGK3pa3RVAN66bccyXPIqXGPHFcOxTwn+IvsrNQA1G1Xjo88R72HiYipcY8cptOar8UnJzWgF1AO+Q1BYLs1TmoAjGrbb+Wo9DARRTUAmXlXjup5zp/FJyM1/bigjbDNc056kZ2TGnceQGKc5/wgqwa02kDOuIvsqv7CLt2qQfRa2/eZw/9hIsJV0ydRaiPxzHOIq+mnoKgmlotP8moAkiiH64bAV57D4azxMFEO3cVn8G2NTdW4chRpa9NuCBipAUj15TDNc3wtPnk0tDFytqm0teDzHDZV48pBM2TynJAvsn/mpQblcJ3WfFxkZ6bmt5x45Dns1ExROUw2BJPk4Gsb/EA5MchznjSBIyhH+Tzne/M0sMS0Vc9zck0NmGJV20rnOTmOZ42HscYiz/G5+Mzxm9D+JlGzZ57nhHSRfX3hEvBGu5JXYvE5Iie3cBHYU6/y3BCMv8i+fuM8KECmao/KobIh8NnWHjV1UALLvY7L47+ppxulmU8Bf2PUbJYbguPznPVHuQugDlra5rwhGJKznruhwBTwN2bB9lM59PKcx3uXE6AYRinPcVr7t3Ier18F9dCv5G32ec7eZcX62aCvHclh+yL7XvMMKIpes21fZw6Rh4nYb2nGoaUKNvVp7T8PE6GapnJDwDBGZbRyXKjnOWoXzRFYOn6mtRkvPveaSuzPJmHgwMZsQ7B3Q6VNwKTS4ZTnfMgtKzuejaKn5202eY6y32n+h4XjNIsNQWMhNu1sgFnK2/TynHfDchoLZxUfnI9Hr1fzn3xUTnQPEzUay7E049pJVx2601qjEbeDZhgD7XwiuSH41rh8DmJO344d0rTmf0PwLbsYgzXAZBLpap7WtJbNXs6wvUwbeO0UHIdKnvMKzVwUMwP0esHZJpHnZJfiPQEch2auOc7Mf2E3u1CO7dQ8Di1Z23acGf7CbnZp8cIcCMdjpQvXnN3JeU4Ybe390rI0swmtrfLg2m7ki8/s+0VpZlNgpGo4tkX1gge6Oeyuls/LZDb1UF26tu1E0da63e5S8ZIiF8+jwkpX7ne2tsL9hd3u4cqyKce/r+ZWubXb2QhpWusebi4Wk1IxvjEy6dLNrQ4WUIAbgo+b3c3u6u0LspcJoHzSdzc6G52dnQDynM3Nj4eHK8VyUrwExFzCrKztbnX20Y3PPAfNPD84eP56sVg3ZFoOGiOTeli6vbOxs7//4oS7tTcHb96+WV0tXsgYIISFZqXK6dLdmy/2nz7dwY8xZ87rt73eW/w4WFm5d6VcTso8FglzifNmvVKsoCMsnWc/h+j1egc99PPyzp3bxeJy3UqcFy3RoxtGBqlfR6544N/1DHLR0OXAnykaYljJZNI0zVQqhZ/4tzWnaeJFEARBEARBEARBEARBEARBEARBEASBMr8ADJvUZ0bGgJQAAAAASUVORK5CYII=`;\r\n","import {\r\n  connect,\r\n  keyStores,\r\n  transactions as nearTransactions,\r\n  utils,\r\n} from \"near-api-js\";\r\nimport {\r\n  InjectedWallet,\r\n  Network,\r\n  Optional,\r\n  Transaction,\r\n  WalletBehaviourFactory,\r\n  WalletModuleFactory,\r\n} from \"@near-wallet-selector/core\";\r\nimport {\r\n  EMeteorWalletSignInType,\r\n  MeteorWallet as MeteorWalletSdk,\r\n} from \"@meteorwallet/sdk\";\r\nimport {\r\n  MeteorWalletParams_Injected,\r\n  MeteorWalletState,\r\n} from \"./meteor-wallet-types\";\r\nimport { createAction } from \"@near-wallet-selector/wallet-utils\";\r\nimport icon from \"./icon\";\r\n\r\nconst setupWalletState = async (\r\n  params: MeteorWalletParams_Injected,\r\n  network: Network\r\n): Promise<MeteorWalletState> => {\r\n  const keyStore = new keyStores.BrowserLocalStorageKeyStore(\r\n    window.localStorage,\r\n    \"_meteor_wallet\"\r\n  );\r\n\r\n  const near = await connect({\r\n    keyStore,\r\n    ...network,\r\n    headers: {},\r\n  });\r\n\r\n  const wallet = new MeteorWalletSdk({ near, appKeyPrefix: \"near_app\" });\r\n\r\n  return {\r\n    wallet,\r\n    keyStore,\r\n  };\r\n};\r\n\r\nconst createMeteorWalletInjected: WalletBehaviourFactory<\r\n  InjectedWallet,\r\n  { params: MeteorWalletParams_Injected }\r\n> = async ({ options, logger, store, params }) => {\r\n  const _state = await setupWalletState(params, options.network);\r\n\r\n  const cleanup = () => {\r\n    _state.keyStore.clear();\r\n  };\r\n\r\n  const getAccounts = () => {\r\n    const accountId = _state.wallet.getAccountId();\r\n\r\n    if (!accountId) {\r\n      return [];\r\n    }\r\n\r\n    return [{ accountId }];\r\n  };\r\n\r\n  const transformTransactions = async (\r\n    transactions: Array<Optional<Transaction, \"signerId\">>\r\n  ) => {\r\n    const account = _state.wallet.account()!;\r\n    const { networkId, signer, provider } = account.connection;\r\n\r\n    const localKey = await signer.getPublicKey(account.accountId, networkId);\r\n\r\n    for (const trx of transactions) {\r\n      if (trx.signerId !== account.accountId) {\r\n        throw new Error(\r\n          `Transaction had a signerId which didn't match the currently logged in account`\r\n        );\r\n      }\r\n    }\r\n\r\n    return Promise.all(\r\n      transactions.map(async (transaction, index) => {\r\n        const actions = transaction.actions.map((action) =>\r\n          createAction(action)\r\n        );\r\n        const accessKey = await account.accessKeyForTransaction(\r\n          transaction.receiverId,\r\n          actions,\r\n          localKey\r\n        );\r\n\r\n        if (!accessKey) {\r\n          throw new Error(\r\n            `Failed to find matching key for transaction sent to ${transaction.receiverId}`\r\n          );\r\n        }\r\n\r\n        const block = await provider.block({ finality: \"final\" });\r\n\r\n        return nearTransactions.createTransaction(\r\n          account.accountId,\r\n          utils.PublicKey.from(accessKey.public_key),\r\n          transaction.receiverId,\r\n          accessKey.access_key.nonce + index + 1,\r\n          actions,\r\n          utils.serialize.base_decode(block.header.hash)\r\n        );\r\n      })\r\n    );\r\n  };\r\n\r\n  return {\r\n    async signIn({ contractId, methodNames = [] }) {\r\n      logger.log(\"MeteorWallet:signIn\", {\r\n        contractId,\r\n        methodNames,\r\n      });\r\n\r\n      if (methodNames.length) {\r\n        await _state.wallet.requestSignIn({\r\n          methods: methodNames,\r\n          type: EMeteorWalletSignInType.SELECTED_METHODS,\r\n          contract_id: contractId,\r\n        });\r\n      } else {\r\n        await _state.wallet.requestSignIn({\r\n          type: EMeteorWalletSignInType.ALL_METHODS,\r\n          contract_id: contractId,\r\n        });\r\n      }\r\n\r\n      return getAccounts();\r\n    },\r\n\r\n    async signOut() {\r\n      if (_state.wallet.isSignedIn()) {\r\n        await _state.wallet.signOut();\r\n      }\r\n\r\n      cleanup();\r\n    },\r\n\r\n    async isSignedIn() {\r\n      if (!_state.wallet) {\r\n        return false;\r\n      }\r\n\r\n      return _state.wallet.isSignedIn();\r\n    },\r\n\r\n    async getAccounts() {\r\n      return getAccounts();\r\n    },\r\n\r\n    async verifyOwner({ message }) {\r\n      logger.log(\"MeteorWallet:verifyOwner\", { message });\r\n\r\n      const response = await _state.wallet.verifyOwner({\r\n        message,\r\n      });\r\n\r\n      if (response.success) {\r\n        return response.payload;\r\n      } else {\r\n        throw new Error(`Couldn't verify owner: ${response.message}`);\r\n      }\r\n    },\r\n\r\n    async signAndSendTransaction({ signerId, receiverId, actions }) {\r\n      logger.log(\"MeteorWallet:signAndSendTransaction\", {\r\n        signerId,\r\n        receiverId,\r\n        actions,\r\n      });\r\n\r\n      const { contract } = store.getState();\r\n\r\n      if (!_state.wallet.isSignedIn()) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      if (!receiverId && !contract) {\r\n        throw new Error(\"No receiver found to send the transaction to\");\r\n      }\r\n\r\n      const account = _state.wallet.account()!;\r\n\r\n      return account[\"signAndSendTransaction_direct\"]({\r\n        receiverId: receiverId ?? contract!.contractId,\r\n        actions: actions.map((action) => createAction(action)),\r\n      });\r\n    },\r\n\r\n    async signAndSendTransactions({ transactions }) {\r\n      logger.log(\"MeteorWallet:signAndSendTransactions\", {\r\n        transactions,\r\n      });\r\n\r\n      if (!_state.wallet.isSignedIn()) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      return _state.wallet.requestSignTransactions({\r\n        transactions: await transformTransactions(transactions),\r\n      });\r\n    },\r\n  };\r\n};\r\n\r\nexport function setupMeteorWallet({\r\n  iconUrl = icon,\r\n  deprecated = false,\r\n}: MeteorWalletParams_Injected = {}): WalletModuleFactory<InjectedWallet> {\r\n  return async () => {\r\n    return {\r\n      id: \"meteor-wallet\",\r\n      type: \"injected\",\r\n      metadata: {\r\n        available: true,\r\n        name: \"Meteor Wallet\",\r\n        description:\r\n          \"Securely store and stake your NEAR tokens and compatible assets with Meteor.\",\r\n        iconUrl,\r\n        deprecated,\r\n        downloadUrl: \"https://wallet.meteorwallet.app\",\r\n      },\r\n      init: (options) => {\r\n        return createMeteorWalletInjected({\r\n          ...options,\r\n          params: {\r\n            iconUrl,\r\n          },\r\n        });\r\n      },\r\n    };\r\n  };\r\n}\r\n","export { setupModal } from \"./lib/modal\";\r\n\r\nexport type {\r\n  WalletSelectorModal,\r\n  ModalOptions,\r\n  Theme,\r\n} from \"./lib/modal.types\";\r\n","import { ModuleState, Wallet } from \"@near-wallet-selector/core\";\r\nimport { DEFAULT_DERIVATION_PATH, modalState } from \"../modal\";\r\nimport { connectToWallet } from \"../render-modal\";\r\nimport { renderSpecifyDerivationPath } from \"./SpecifyDerivationPath\";\r\n\r\nexport function renderConnectHardwareWallet(module: ModuleState<Wallet>) {\r\n  if (!modalState) {\r\n    return;\r\n  }\r\n\r\n  modalState.derivationPath = DEFAULT_DERIVATION_PATH;\r\n\r\n  document.querySelector(\".modal-right\")!.innerHTML = `\r\n    <div class=\"nws-modal-body\">\r\n      <div class=\"nws-modal-header-wrapper\">\r\n        <div class=\"nws-modal-header\">\r\n          <h3 class=\"middleTitle\">Connect with Ledger</h3><button class=\"close-button\"><svg\r\n              xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" fill=\"#C1C1C1\">\r\n              <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n              <path\r\n                d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\">\r\n              </path>\r\n            </svg></button>\r\n        </div>\r\n      </div>\r\n      <div class=\"derivation-path-wrapper\">\r\n        <div class=\"enter-derivation-path\">\r\n          <div class=\"ledger-image\">\r\n            <svg width=\"317\" height=\"157\" viewBox=\"0 0 317 157\" fill=\"none\"\r\n              xmlns=\"http://www.w3.org/2000/svg\">\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M249.99 16.0994C270.063 -0.864155 289.788 1.58873 301.497 10.7365C307.402 15.3499 311.278 21.6575 312.267 28.1258C313.247 34.5412 311.413 41.2233 305.692 46.8044C297.366 54.9273 286.343 55.3362 273.015 51.5109C261.654 48.25 249.058 42.0377 235.726 35.4627L235.726 35.4626L235.717 35.458C233.367 34.2992 230.995 33.129 228.602 31.9618C212.742 24.2253 196.067 16.6575 179.842 13.8595C163.538 11.0479 147.552 13.0313 133.266 24.522C128.032 28.732 123.478 35.2086 121.716 44.8205C119.961 54.3947 120.992 66.9771 126.703 83.4311C135.432 108.583 132.899 126.677 123.575 138.063C114.217 149.491 97.5614 154.733 76.7887 153.121C55.0043 151.43 29.0621 142.206 3.29867 125.227L0.887817 127.942C27.2472 145.405 53.9251 154.952 76.5105 156.705C97.9028 158.365 115.96 153.035 126.356 140.341C136.785 127.606 139.045 108.029 130.099 82.2524C124.521 66.1801 123.642 54.2493 125.252 45.4687C126.854 36.7258 130.94 31.006 135.519 27.3232C148.794 16.6458 163.649 14.715 179.231 17.4021C194.891 20.1027 211.146 27.4463 227.026 35.1928C229.381 36.3415 231.729 37.5001 234.066 38.6531L234.073 38.6568C247.382 45.223 260.324 51.608 272.024 54.9662C285.819 58.9258 298.493 58.8501 308.202 49.3776C314.764 42.9759 316.974 35.1288 315.82 27.5826C314.675 20.0893 310.237 13.0029 303.71 7.90363C290.555 -2.37382 268.938 -4.62038 247.67 13.3537L249.99 16.0994Z\"\r\n                fill=\"url(#paint0_linear_3_672)\"></path>\r\n              <path d=\"M260.264 17.8767L177.605 89.4649L157.679 73.9664L239.23 3.85423L260.264 17.8767Z\" fill=\"#6A7075\">\r\n              </path>\r\n              <path d=\"M205.939 54.4577L199.764 50.2636L233.316 20.9053L239.907 25.8395L205.939 54.4577Z\" fill=\"#494E52\">\r\n              </path>\r\n              <path d=\"M260.264 17.8757L177.605 89.4639L182.033 98.3202L264.323 26.363L260.264 17.8757Z\" fill=\"#494E52\">\r\n              </path>\r\n              <path d=\"M177.236 89.4646L181.295 98.3209L165.059 85.7745L170.963 85.0365L177.236 89.4646Z\" fill=\"black\">\r\n              </path>\r\n              <path d=\"M93.4708 99.6384L91.9948 110.13L174.653 92.894L164.69 85.7749L93.4708 99.6384Z\" fill=\"#DCDADA\">\r\n              </path>\r\n              <path d=\"M93.1157 104.323L94.314 100.129L165.613 86.3483L169.208 89.344L93.1157 104.323Z\" fill=\"#C1C1C1\">\r\n              </path>\r\n              <path d=\"M94.2086 99.7963L86.0903 101.272L92.3635 110.129L94.2086 99.7963Z\" fill=\"#B3AAAA\"></path>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M86.0903 100.907L89.0027 74.1304L178.455 55.2416C184.695 53.9962 195.766 54.7675 197.177 63.7058C198.284 70.717 195.506 73.9943 191.628 77.3592C188.495 80.0671 180.152 82.4646 178.343 82.8944C178.293 82.9064 178.241 82.9188 178.186 82.9319C177.38 83.1245 176.007 83.4525 170.644 84.5088C169.085 84.8158 167.382 85.1501 165.557 85.5078L164.933 85.63C146.312 89.2764 115.528 95.2297 93.9844 99.3849C91.1808 99.9257 88.5337 100.436 86.0903 100.907ZM185.076 75.554C190.748 73.3535 193.99 68.0745 192.318 63.7631C190.645 59.4517 184.691 57.7405 179.019 59.941C173.347 62.1416 170.105 67.4206 171.778 71.732C173.45 76.0434 179.404 77.7546 185.076 75.554Z\"\r\n                fill=\"#F4F1E8\"></path>\r\n              <path d=\"M199.764 50.3994L196.768 48.3043L232.194 18.0454L233.316 21.6403L199.764 50.3994Z\" fill=\"black\">\r\n              </path>\r\n              <path d=\"M239.968 25.9943L232.588 20.4592V17.5071L241.813 24.5183L239.968 25.9943Z\" fill=\"black\"></path>\r\n              <ellipse cx=\"182.084\" cy=\"68.0811\" rx=\"10.242\" ry=\"7.46772\" transform=\"rotate(-23.7949 182.084 68.0811)\"\r\n                fill=\"#494E52\"></ellipse>\r\n              <ellipse cx=\"182.084\" cy=\"68.0816\" rx=\"6.68462\" ry=\"4.87394\" transform=\"rotate(-23.7949 182.084 68.0816)\"\r\n                fill=\"#494E52\"></ellipse>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M238.725 2.93094L260.368 17.2564L264.865 26.4556L181.615 99.0341L175.16 94.311L92.0028 110.947L85.3267 101.399L88.3269 73.8157L178.118 54.8553L238.725 2.93094ZM178.599 56.2622L89.6786 75.0388L86.9321 100.29C89.0979 99.8725 91.4124 99.4263 93.8446 98.9572C115.388 94.8019 146.171 88.8488 164.791 85.2026L165.415 85.0804C167.24 84.7228 168.943 84.3885 170.501 84.0816C175.853 83.0275 177.219 82.701 178.015 82.5107C178.07 82.4976 178.122 82.4852 178.173 82.4732C179.048 82.2652 181.558 81.5669 184.235 80.5851C186.742 79.6655 189.286 78.5354 190.802 77.3758L191.151 77.0922L191.644 76.6595C193.341 75.147 194.723 73.6739 195.61 71.871C196.571 69.916 196.982 67.5029 196.448 64.1178C195.8 60.0131 192.959 57.7574 189.408 56.6566C185.833 55.5483 181.637 55.6566 178.603 56.2615C178.601 56.2617 178.6 56.262 178.599 56.2622ZM192.631 77.7565L259.555 18.9531L263.042 26.0869L181.808 96.9078L178.132 89.5713L191.724 78.529C191.859 78.4249 191.988 78.32 192.11 78.2144L192.111 78.2136C192.286 78.0617 192.46 77.9094 192.631 77.7565ZM185.491 81.6908C185.24 81.7868 184.99 81.8802 184.743 81.9709C182.013 82.9723 179.447 83.6875 178.514 83.9093C178.463 83.9213 178.411 83.9338 178.356 83.9468C177.635 84.1192 176.472 84.3971 172.491 85.1919L177.172 88.4492L185.491 81.6908ZM176.631 89.8707L170.479 85.5903C169.306 85.8213 168.054 86.0673 166.731 86.3265L175.769 92.9276L179.548 95.6924L176.631 89.8707ZM164.758 86.7132C146.252 90.3362 116.027 96.1817 94.6324 100.308L93.2258 109.197L173.543 93.1293L164.758 86.7132ZM91.888 108.207L93.0909 100.606C91.0848 100.993 89.1642 101.363 87.3471 101.713L91.888 108.207ZM258.581 17.8436L197.306 71.6841C198.142 69.5779 198.41 67.0795 197.906 63.8876C197.143 59.0539 193.743 56.4549 189.845 55.2467C186.921 54.3402 183.662 54.1916 180.861 54.449L238.84 4.77668L258.581 17.8436ZM232.505 16.82L243.089 24.5643L205.915 56.5106L196.042 48.0665L232.505 16.82ZM232.118 19.096L198.312 48.0654L199.744 49.29L232.584 20.9424L232.118 19.096ZM233.456 22.1396L200.878 50.2604L205.913 54.5664L239.041 26.0969L233.456 22.1396ZM240.195 25.1054L240.717 24.6571L233.759 19.5663L234.06 20.7586L240.195 25.1054Z\"\r\n                fill=\"black\"></path>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M190.194 69.9744C191.32 68.1409 191.576 66.2271 190.942 64.5937C190.308 62.9603 188.829 61.7198 186.761 61.1254C184.691 60.5307 182.116 60.6196 179.553 61.6139C176.991 62.6081 175.029 64.2794 173.902 66.1141C172.776 67.9477 172.52 69.8614 173.154 71.4948C173.788 73.1282 175.267 74.3687 177.335 74.9631C179.405 75.5578 181.98 75.4689 184.543 74.4746C187.105 73.4804 189.067 71.8091 190.194 69.9744ZM185.077 75.8508C190.749 73.6502 193.991 68.3712 192.318 64.0598C190.645 59.7484 184.691 58.0372 179.019 60.2378C173.347 62.4383 170.105 67.7173 171.778 72.0287C173.451 76.3401 179.405 78.0513 185.077 75.8508Z\"\r\n                fill=\"black\"></path>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M187.391 69.169C188.127 67.9713 188.266 66.7721 187.881 65.7812C187.497 64.7903 186.586 63.9984 185.235 63.6102C183.883 63.2216 182.173 63.2741 180.456 63.9404C178.738 64.6068 177.441 65.7208 176.705 66.9196C175.969 68.1172 175.83 69.3165 176.215 70.3074C176.599 71.2983 177.511 72.0901 178.861 72.4783C180.214 72.8669 181.923 72.8144 183.64 72.1481C185.358 71.4818 186.655 70.3678 187.391 69.169ZM184.174 73.5242C188.156 71.9795 190.432 68.2738 189.257 65.2473C188.083 62.2208 183.904 61.0196 179.922 62.5643C175.94 64.1091 173.665 67.8148 174.839 70.8412C176.013 73.8677 180.193 75.0689 184.174 73.5242Z\"\r\n                fill=\"black\"></path>\r\n              <path\r\n                d=\"M240.499 41.2441C239.744 40.3649 239.844 39.04 240.724 38.285L249.781 30.5067C250.66 29.7516 251.985 29.8523 252.74 30.7315V30.7315C253.495 31.6108 253.395 32.9356 252.516 33.6907L243.458 41.469C242.579 42.224 241.254 42.1234 240.499 41.2441V41.2441Z\"\r\n                fill=\"black\"></path>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M250.743 31.6265L241.685 39.4048C241.424 39.6287 241.395 40.0217 241.619 40.2825C241.842 40.5433 242.235 40.5731 242.496 40.3492L251.554 32.5709C251.815 32.3469 251.845 31.954 251.621 31.6932C251.397 31.4324 251.004 31.4025 250.743 31.6265ZM240.724 38.285C239.844 39.04 239.744 40.3649 240.499 41.2441C241.254 42.1234 242.579 42.224 243.458 41.469L252.516 33.6907C253.395 32.9356 253.495 31.6108 252.74 30.7315C251.985 29.8523 250.66 29.7516 249.781 30.5067L240.724 38.285Z\"\r\n                fill=\"black\"></path>\r\n              <path\r\n                d=\"M205.779 71.4647C205.005 70.5642 205.108 69.2073 206.009 68.4339L214.989 60.7218C215.89 59.9485 217.247 60.0516 218.02 60.9521V60.9521C218.793 61.8526 218.69 63.2095 217.79 63.9829L208.809 71.695C207.909 72.4683 206.552 72.3652 205.779 71.4647V71.4647Z\"\r\n                fill=\"black\"></path>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M215.951 61.8416L206.97 69.5537C206.688 69.796 206.656 70.221 206.898 70.5031C207.141 70.7851 207.566 70.8174 207.848 70.5752L216.828 62.863C217.11 62.6208 217.143 62.1958 216.9 61.9137C216.658 61.6317 216.233 61.5994 215.951 61.8416ZM206.009 68.4339C205.108 69.2073 205.005 70.5642 205.779 71.4647C206.552 72.3652 207.909 72.4683 208.809 71.695L217.79 63.9829C218.69 63.2095 218.793 61.8526 218.02 60.9521C217.247 60.0516 215.89 59.9485 214.989 60.7218L206.009 68.4339Z\"\r\n                fill=\"black\"></path>\r\n              <circle cx=\"141.356\" cy=\"19.525\" r=\"10.1855\" fill=\"#FE89B4\"></circle>\r\n              <ellipse cx=\"139.062\" cy=\"14.7094\" rx=\"2.42519\" ry=\"1.94015\" transform=\"rotate(-34.544 139.062 14.7094)\"\r\n                fill=\"#FDF7FF\"></ellipse>\r\n              <circle cx=\"252.489\" cy=\"79.7577\" r=\"7.78893\" fill=\"#EC5236\"></circle>\r\n              <ellipse cx=\"250.434\" cy=\"76.3701\" rx=\"2.61272\" ry=\"2.09018\" transform=\"rotate(-34.544 250.434 76.3701)\"\r\n                fill=\"#EDB69D\"></ellipse>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M100.436 79.9254C100.461 79.6567 100.732 79.3897 101.042 79.329L106.657 78.2299C107.587 78.0478 108.281 78.5536 108.207 79.3596L107.759 84.2243C107.734 84.493 107.463 84.76 107.153 84.8207L100.416 86.1396C100.106 86.2003 99.8742 86.0317 99.899 85.7631L100.436 79.9254Z\"\r\n                fill=\"#B3AAAA\"></path>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M95.8553 81.7775C95.9294 80.9715 96.7437 80.1704 97.6739 79.9883L98.7968 79.7685C99.1069 79.7078 99.3382 79.8764 99.3135 80.1451L99.1344 82.091C99.1096 82.3597 98.8382 82.6267 98.5282 82.6874L96.2824 83.127C95.9723 83.1877 95.741 83.0191 95.7657 82.7505L95.8553 81.7775Z\"\r\n                fill=\"#B3AAAA\"></path>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M95.5865 84.6965C95.6112 84.4278 95.8826 84.1608 96.1927 84.1001L98.4385 83.6605C98.7486 83.5998 98.9799 83.7684 98.9552 84.037L98.7761 85.9829C98.7513 86.2516 98.4799 86.5186 98.1699 86.5793L95.9241 87.019C95.614 87.0797 95.3827 86.9111 95.4074 86.6424L95.5865 84.6965Z\"\r\n                fill=\"#B3AAAA\"></path>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M95.2282 88.5884C95.2529 88.3197 95.5244 88.0527 95.8344 87.992L98.0802 87.5524C98.3903 87.4917 98.6216 87.6603 98.5969 87.929L98.4178 89.8749C98.3931 90.1435 98.1216 90.4105 97.8116 90.4712L96.6887 90.6911C95.7584 90.8732 95.0645 90.3674 95.1387 89.5614L95.2282 88.5884Z\"\r\n                fill=\"#B3AAAA\"></path>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M99.7197 87.709C99.7444 87.4403 100.016 87.1733 100.326 87.1126L102.572 86.673C102.882 86.6123 103.113 86.7809 103.088 87.0496L102.909 88.9955C102.885 89.2641 102.613 89.5312 102.303 89.5919L100.057 90.0315C99.7472 90.0922 99.5159 89.9236 99.5406 89.6549L99.7197 87.709Z\"\r\n                fill=\"#B3AAAA\"></path>\r\n              <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M104.211 86.8298C104.236 86.5611 104.507 86.2941 104.817 86.2334L107.063 85.7938C107.373 85.7331 107.605 85.9017 107.58 86.1704L107.49 87.1433C107.416 87.9493 106.602 88.7504 105.672 88.9325L104.549 89.1523C104.239 89.213 104.007 89.0444 104.032 88.7757L104.211 86.8298Z\"\r\n                fill=\"#B3AAAA\"></path>\r\n              <defs>\r\n                <linearGradient id=\"paint0_linear_3_672\" x1=\"-44.5195\" y1=\"122.42\" x2=\"263.357\" y2=\"-8.65023\"\r\n                  gradientUnits=\"userSpaceOnUse\">\r\n                  <stop offset=\"0.110697\" stop-color=\"#232323\"></stop>\r\n                  <stop offset=\"1\" stop-color=\"#3D3D3D\"></stop>\r\n                </linearGradient>\r\n              </defs>\r\n            </svg></div>\r\n          <div class=\"ledger-description\">\r\n            <p>Make sure your Ledger is connected securely, and that the NEAR app is open on your device.</p>\r\n            <p class=\"specify-path\" id=\"specify-derivation-path-button\">Specify HD Path</p>\r\n          </div>\r\n          <div class=\"action-buttons\"><button class=\"middleButton\" id=\"continue-button\">Continue</button></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  document.getElementById(\"continue-button\")?.addEventListener(\"click\", () => {\r\n    connectToWallet(module);\r\n  });\r\n\r\n  document\r\n    .getElementById(\"specify-derivation-path-button\")\r\n    ?.addEventListener(\"click\", () => {\r\n      renderSpecifyDerivationPath(module);\r\n    });\r\n}\r\n","import { InjectedWallet, ModuleState } from \"@near-wallet-selector/core\";\r\nimport { modalState } from \"../modal\";\r\nimport { renderWhatIsAWallet } from \"./WhatIsAWallet\";\r\n\r\nfunction goToWallet(module: ModuleState) {\r\n  if (!modalState) {\r\n    return;\r\n  }\r\n\r\n  const { networkId } = modalState.selector.options.network;\r\n  let url = \"\";\r\n\r\n  if (module.type === \"injected\") {\r\n    url = (module as ModuleState<InjectedWallet>).metadata.downloadUrl;\r\n  }\r\n\r\n  // TODO: improve links to wallets other than injected type.\r\n  if (module.id === \"my-near-wallet\") {\r\n    const subdomain = networkId === \"testnet\" ? \"testnet\" : \"app\";\r\n    url = `https://${subdomain}.mynearwallet.com`;\r\n  }\r\n\r\n  if (module.id === \"near-wallet\") {\r\n    const subdomain = networkId === \"testnet\" ? \"testnet.\" : \"\";\r\n    url = `https://wallet.${subdomain}near.org`;\r\n  }\r\n\r\n  if ((url === \"\" && module.type === \"bridge\") || module.type === \"hardware\") {\r\n    return;\r\n  }\r\n\r\n  window.open(url, \"_blank\");\r\n}\r\n\r\nexport async function renderGetAWallet() {\r\n  if (!modalState) {\r\n    return;\r\n  }\r\n\r\n  document.querySelector(\".modal-right\")!.innerHTML = `\r\n    <div class=\"nws-modal-body\">\r\n      <div class=\"wallet-home-wrapper\">\r\n        <div class=\"nws-modal-header-wrapper\">\r\n        <button class=\"back-button\" id=\"back-button\"><svg width=\"8\" height=\"14\" viewBox=\"0 0 8 14\"\r\n              fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n              <path d=\"M7 13L1 7L7 1\" stroke=\"#6494EE\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\r\n              </path>\r\n            </svg>\r\n        </button>\r\n          <div class=\"nws-modal-header\">\r\n            <h3 class=\"middleTitle\">Get a Wallet</h3><button class=\"close-button\"><svg xmlns=\"http://www.w3.org/2000/svg\"\r\n                height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" fill=\"#C1C1C1\">\r\n                <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n                <path\r\n                  d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\">\r\n                </path>\r\n              </svg></button>\r\n          </div>\r\n        </div>\r\n        <div class=\"get-wallet-wrapper\" id=\"wallets\">\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  const filterByType = (item: { type: string }) => {\r\n    return item.type !== \"bridge\" && item.type !== \"hardware\";\r\n  };\r\n\r\n  const filteredModules = modalState.modules.filter(filterByType).slice(0, 3);\r\n\r\n  for (let i = 0; i < filteredModules.length; i++) {\r\n    document.getElementById(\"wallets\")?.insertAdjacentHTML(\r\n      \"beforeend\",\r\n      `\r\n    <div class=\"single-wallet-get\">\r\n      <div class=\"icon\">\r\n      <img\r\n          src=\"${filteredModules[i].metadata.iconUrl}\"\r\n          alt=\"${filteredModules[i].metadata.name}\"></div>\r\n      <div class=\"content\">\r\n        <div class=\"title\">${filteredModules[i].metadata.name}</div>\r\n        <div class=\"description\">${\r\n          filteredModules[i].metadata.description\r\n            ? filteredModules[i].metadata.description\r\n            : \"\"\r\n        }</div>\r\n      </div>\r\n      <div class=\"button-get\">\r\n        <button class=\"get-wallet\" id=\"${filteredModules[i].id}\">Get</button>\r\n      </div>\r\n    </div>\r\n`\r\n    );\r\n  }\r\n\r\n  Array.from(document.querySelectorAll(\".get-wallet\")).forEach((button) => {\r\n    button.addEventListener(\"click\", () => {\r\n      if (!modalState) {\r\n        return;\r\n      }\r\n\r\n      const module = modalState.modules.find((m) => m.id === button.id);\r\n\r\n      if (!module) {\r\n        return;\r\n      }\r\n\r\n      goToWallet(module);\r\n    });\r\n  });\r\n\r\n  document.getElementById(\"back-button\")?.addEventListener(\"click\", () => {\r\n    renderWhatIsAWallet();\r\n  });\r\n}\r\n","import { ModuleState, Wallet } from \"@near-wallet-selector/core\";\r\nimport { modalState } from \"../modal\";\r\nimport { HardwareWalletAccountState } from \"../render-modal\";\r\nimport { renderLedgerSelectAccount } from \"./LedgerSelectAccount\";\r\nimport { renderWalletConnectionFailed } from \"./WalletConnectionFailed\";\r\n\r\nexport async function renderLedgerAccountsOverviewList(\r\n  module: ModuleState<Wallet>,\r\n  accounts: Array<HardwareWalletAccountState>,\r\n  selectedAccounts: Array<HardwareWalletAccountState>\r\n) {\r\n  document.querySelector(\".modal-right\")!.innerHTML = `\r\n    <div class=\"nws-modal-body\">\r\n    <div class=\"nws-modal-header-wrapper\">\r\n      <button class=\"back-button\" id=\"back-button\"><svg width=\"8\" height=\"14\" viewBox=\"0 0 8 14\"\r\n            fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M7 13L1 7L7 1\" stroke=\"#6494EE\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\r\n            </path>\r\n          </svg>\r\n      </button>\r\n        <div class=\"nws-modal-header\">\r\n          <h3 class=\"middleTitle\">Connecting ${selectedAccounts.length} Account</h3><button class=\"close-button\"><svg xmlns=\"http://www.w3.org/2000/svg\"\r\n              height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" fill=\"#C1C1C1\">\r\n              <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n              <path\r\n                d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\">\r\n              </path>\r\n            </svg></button>\r\n        </div>\r\n      </div>\r\n      <div class=\"derivation-path-wrapper\">\r\n        <div class=\"overview-wrapper\">\r\n          <p>Overview the list of authorized account(s), complete sign in by clicking the button below.</p>\r\n          <div class=\"accounts\" id=\"accounts\"></div>\r\n          <div class=\"action-buttons\"><button class=\"middleButton\" id=\"finish-button\">Finish</button></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  for (let i = 0; i < selectedAccounts.length; i++) {\r\n    document.getElementById(\"accounts\")?.insertAdjacentHTML(\r\n      \"beforeend\",\r\n      `\r\n        <div>\r\n          <div class=\"account\">\r\n            <span>${selectedAccounts[i].accountId}</span>\r\n          </div>\r\n        </div>\r\n      `\r\n    );\r\n  }\r\n\r\n  document.getElementById(\"back-button\")?.addEventListener(\"click\", () => {\r\n    renderLedgerSelectAccount(module, accounts);\r\n  });\r\n\r\n  document\r\n    .getElementById(\"finish-button\")\r\n    ?.addEventListener(\"click\", async () => {\r\n      try {\r\n        if (!modalState) {\r\n          return;\r\n        }\r\n\r\n        const wallet = await module.wallet();\r\n        wallet.signIn({\r\n          contractId: modalState.options.contractId,\r\n          methodNames: modalState.options.methodNames,\r\n          accounts: selectedAccounts,\r\n        });\r\n\r\n        modalState.container.children[0].classList.remove(\"open\");\r\n      } catch (err) {\r\n        await renderWalletConnectionFailed(module, err as Error);\r\n      }\r\n    });\r\n}\r\n","import { ModuleState, Wallet } from \"@near-wallet-selector/core\";\r\nimport { modalState } from \"../modal\";\r\nimport { HardwareWalletAccountState } from \"../render-modal\";\r\nimport { renderLedgerAccountsOverviewList } from \"./LedgerAccountsOverviewList\";\r\nimport { renderSpecifyDerivationPath } from \"./SpecifyDerivationPath\";\r\n\r\nexport async function renderLedgerSelectAccount(\r\n  module: ModuleState<Wallet>,\r\n  accounts: Array<HardwareWalletAccountState>\r\n) {\r\n  if (!modalState) {\r\n    return;\r\n  }\r\n\r\n  document.querySelector(\".modal-right\")!.innerHTML = `\r\n    <div class=\"nws-modal-body\">\r\n      <div class=\"nws-modal-header-wrapper\"><button class=\"back-button\" id=\"back-button\"><svg width=\"8\" height=\"14\" viewBox=\"0 0 8 14\"\r\n            fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M7 13L1 7L7 1\" stroke=\"#6494EE\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\r\n            </path>\r\n          </svg></button>\r\n        <div class=\"nws-modal-header\">\r\n          <h3 class=\"middleTitle\">Select Your Accounts</h3><button class=\"close-button\"><svg\r\n              xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" fill=\"#C1C1C1\">\r\n              <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n              <path\r\n                d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\">\r\n              </path>\r\n            </svg></button>\r\n        </div>\r\n      </div>\r\n      <div class=\"derivation-path-wrapper\">\r\n        <div class=\"choose-ledger-account-form-wrapper\">\r\n          <p>We found ${\r\n            accounts.length\r\n          } accounts on your device. Select the account(s) you wish to connect.</p>\r\n          <div class=\"button-wrapper\"><button id=\"change-derivation-path-button\">HD.../${modalState.derivationPath.slice(\r\n            -2,\r\n            -1\r\n          )}</button></div>\r\n          <form class=\"form\">\r\n            <div>\r\n              <div class=\"nws-form-control\">\r\n                <div id=\"accounts\"></div>\r\n              <div class=\"action-buttons\"><button class=\"middleButton\" id=\"connect-button\">Connect</button></div>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  for (let i = 0; i < accounts.length; i++) {\r\n    document.getElementById(\"accounts\")?.insertAdjacentHTML(\r\n      \"beforeend\",\r\n      `\r\n      <div class=\"account\">\r\n        <input type=\"checkbox\" id=\"${\r\n          accounts[i].accountId\r\n        }\" name=\"account\" value=\"${accounts[i].accountId}\" ${\r\n        i === 0 ? \"checked\" : \"\"\r\n      }>\r\n        <label for=\"${accounts[i].accountId}\"> ${accounts[i].accountId}</label>\r\n        <br>\r\n      </div>\r\n      `\r\n    );\r\n  }\r\n\r\n  document\r\n    .getElementById(\"change-derivation-path-button\")\r\n    ?.addEventListener(\"click\", () => {\r\n      renderSpecifyDerivationPath(module);\r\n    });\r\n\r\n  document.getElementById(\"connect-button\")?.addEventListener(\"click\", (e) => {\r\n    e.preventDefault();\r\n\r\n    const accountCheckStatuses = Array.from(\r\n      document.querySelectorAll(\"input[name='account']\")\r\n    ).map((el) => (el as HTMLInputElement).checked);\r\n\r\n    const checkedAccounts = accounts.filter(\r\n      (_account, i) => accountCheckStatuses[i]\r\n    );\r\n\r\n    if (checkedAccounts.length < 1) {\r\n      return;\r\n    }\r\n\r\n    renderLedgerAccountsOverviewList(module, accounts, checkedAccounts);\r\n  });\r\n}\r\n","import { ModuleState, Wallet } from \"@near-wallet-selector/core\";\r\nimport { renderConnectHardwareWallet } from \"./ConnectHardwareWallet\";\r\n\r\nexport async function renderNoLedgerAccountsFound(module: ModuleState<Wallet>) {\r\n  document.querySelector(\".modal-right\")!.innerHTML = `\r\n    <div class=\"nws-modal-body\">\r\n      <div class=\"nws-modal-header-wrapper\"><button class=\"back-button\" id=\"back-button\"><svg width=\"8\" height=\"14\" viewBox=\"0 0 8 14\"\r\n            fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M7 13L1 7L7 1\" stroke=\"#6494EE\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\r\n            </path>\r\n          </svg></button>\r\n        <div class=\"nws-modal-header\">\r\n          <h3 class=\"middleTitle\">No Accounts Found</h3><button class=\"close-button\"><svg xmlns=\"http://www.w3.org/2000/svg\"\r\n              height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" fill=\"#C1C1C1\">\r\n              <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n              <path\r\n                d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\">\r\n              </path>\r\n            </svg></button>\r\n        </div>\r\n      </div>\r\n      <div class=\"derivation-path-wrapper\">\r\n        <div class=\"no-accounts-found-wrapper\">\r\n          <p>Can't found any account associated with this Ledger. Please create a new NEAR account on <a\r\n              href=\"https://testnet.mynearwallet.com/create\" target=\"_blank\">MyNearWallet</a> or connect an another Ledger.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  document.getElementById(\"back-button\")?.addEventListener(\"click\", () => {\r\n    renderConnectHardwareWallet(module);\r\n  });\r\n}\r\n","import { ModuleState, Wallet } from \"@near-wallet-selector/core\";\r\nimport { modalState } from \"../modal\";\r\nimport { resolveAccounts } from \"../render-modal\";\r\nimport { renderConnectHardwareWallet } from \"./ConnectHardwareWallet\";\r\nimport { renderLedgerAccountsOverviewList } from \"./LedgerAccountsOverviewList\";\r\nimport { renderLedgerSelectAccount } from \"./LedgerSelectAccount\";\r\nimport { renderNoLedgerAccountsFound } from \"./NoLedgerAccountsFound\";\r\nimport { renderWalletConnecting } from \"./WalletConnecting\";\r\nimport { renderWalletConnectionFailed } from \"./WalletConnectionFailed\";\r\n\r\nexport function renderSpecifyDerivationPath(module: ModuleState<Wallet>) {\r\n  if (!modalState) {\r\n    return;\r\n  }\r\n\r\n  document.querySelector(\".modal-right\")!.innerHTML = `\r\n    <div class=\"nws-modal-body\">\r\n      <div class=\"nws-modal-header-wrapper\"><button class=\"back-button\" id=\"back-button\"><svg width=\"8\" height=\"14\" viewBox=\"0 0 8 14\"\r\n            fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M7 13L1 7L7 1\" stroke=\"#6494EE\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\r\n            </path>\r\n          </svg></button>\r\n        <div class=\"nws-modal-header\">\r\n          <h3 class=\"middleTitle\">Specify HD Path</h3><button class=\"close-button\"><svg xmlns=\"http://www.w3.org/2000/svg\"\r\n              height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" fill=\"#C1C1C1\">\r\n              <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n              <path\r\n                d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\">\r\n              </path>\r\n            </svg></button>\r\n        </div>\r\n      </div>\r\n      <div class=\"derivation-path-wrapper\">\r\n        <div class=\"specify-path-wrapper\">\r\n          <div class=\"change-path-wrapper\">\r\n            <div class=\"display-path\"><span>44'/397'/0'/0'/</span></div>\r\n            <div class=\"change-path\">\r\n              <div class=\"path-value\"><span id=\"derivation-path-index\"></span></div>\r\n              <div class=\"buttons-wrapper\">\r\n                <button id=\"increase-index-button\">\r\n                  <svg width=\"10\" height=\"7\" viewBox=\"0 0 10 7\" fill=\"none\"\r\n                    xmlns=\"http://www.w3.org/2000/svg\">\r\n                    <path d=\"M9 5.4762L5 1.4762L1 5.4762\" stroke=\"#4F7CD1\" stroke-width=\"1.5\" stroke-linecap=\"round\"\r\n                      stroke-linejoin=\"round\"></path>\r\n                  </svg>\r\n                </button>\r\n                <button id=\"decrease-index-button\">\r\n                  <svg width=\"10\" height=\"7\" viewBox=\"0 0 10 7\" fill=\"none\"\r\n                    xmlns=\"http://www.w3.org/2000/svg\">\r\n                    <path d=\"M1 1.52382L5 5.52382L9 1.52382\" stroke=\"#4F7CD1\" stroke-width=\"1.5\" stroke-linecap=\"round\"\r\n                      stroke-linejoin=\"round\"></path>\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <p class=\"path-description\">Enter your preferred HD path, then scan for any active accounts.</p>\r\n          <div class=\"action-buttons\"><button class=\"middleButton\" id=\"scan-button\">Scan</button></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  const derivationPathIndexElement = document.getElementById(\r\n    \"derivation-path-index\"\r\n  )!;\r\n\r\n  derivationPathIndexElement.innerText = modalState.derivationPath.slice(\r\n    -2,\r\n    -1\r\n  );\r\n\r\n  document\r\n    .getElementById(\"increase-index-button\")\r\n    ?.addEventListener(\"click\", () => {\r\n      if (!modalState) {\r\n        return;\r\n      }\r\n\r\n      const nextIndex = parseInt(derivationPathIndexElement!.innerText) + 1;\r\n      modalState.derivationPath =\r\n        modalState.derivationPath.slice(0, -2) + nextIndex.toString() + \"'\";\r\n      derivationPathIndexElement.innerText = nextIndex.toString();\r\n    });\r\n\r\n  document\r\n    .getElementById(\"decrease-index-button\")\r\n    ?.addEventListener(\"click\", () => {\r\n      if (!modalState) {\r\n        return;\r\n      }\r\n\r\n      const nextIndex = parseInt(derivationPathIndexElement!.innerText) - 1;\r\n      modalState.derivationPath =\r\n        modalState.derivationPath.slice(0, -2) + nextIndex.toString() + \"'\";\r\n      if (nextIndex >= 0) {\r\n        derivationPathIndexElement.innerText = nextIndex.toString();\r\n      }\r\n    });\r\n\r\n  document.getElementById(\"back-button\")?.addEventListener(\"click\", () => {\r\n    renderConnectHardwareWallet(module);\r\n  });\r\n\r\n  document\r\n    .getElementById(\"scan-button\")\r\n    ?.addEventListener(\"click\", async () => {\r\n      try {\r\n        const wallet = await module.wallet();\r\n        renderWalletConnecting(module);\r\n        const accounts = await resolveAccounts(wallet);\r\n\r\n        if (!accounts || accounts.length < 1) {\r\n          return renderNoLedgerAccountsFound(module);\r\n        }\r\n\r\n        if (accounts.length === 1) {\r\n          renderLedgerAccountsOverviewList(module, accounts, accounts);\r\n        }\r\n\r\n        renderLedgerSelectAccount(module, accounts);\r\n      } catch (err) {\r\n        await renderWalletConnectionFailed(module, err as Error);\r\n      }\r\n    });\r\n}\r\n","import { ModuleState, Wallet } from \"@near-wallet-selector/core\";\r\n\r\nexport async function renderWalletAccount(\r\n  module: ModuleState<Wallet> | null = null\r\n) {\r\n  document.querySelector(\".modal-right\")!.innerHTML = `\r\n    <div class=\"nws-modal-body\">\r\n    <div class=\"nws-modal-header\">\r\n        <div><span class=\"connected-flag\">Connected</span></div>\r\n        <button class=\"close-button\">\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\"\r\n              height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" fill=\"#C1C1C1\">\r\n              <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n              <path\r\n                d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\">\r\n              </path>\r\n          </svg>\r\n        </button>\r\n      </div>\r\n      <div class=\"connecting-wrapper\">\r\n        <div class=\"content\">\r\n          <div class=\"icon\"><img src=\"${module?.metadata.iconUrl}\" alt=\"${module?.metadata.name}\"></div>\r\n          <h3 class=\"connecting-name\">${module?.metadata.name}</h3>\r\n          <div class=\"wallet-connected-success\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"24\" height=\"24\" rx=\"12\" fill=\"#51BD7C\"></rect><path d=\"M7.75 12.75L10 15.25L16.25 8.75\" stroke=\"currentColor\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg><span>Connection Successful</span></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n}\r\n","import { ModuleState, Wallet } from \"@near-wallet-selector/core\";\r\n\r\nexport async function renderWalletConnecting(\r\n  module: ModuleState<Wallet> | null = null\r\n) {\r\n  document.querySelector(\".modal-right\")!.innerHTML = `\r\n    <div class=\"nws-modal-body\">\r\n      <div class=\"nws-modal-header\">\r\n        <h3 class=\"middleTitle\"></h3>\r\n        <button class=\"close-button\">\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\"\r\n              height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" fill=\"#C1C1C1\">\r\n              <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n              <path\r\n                d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\">\r\n              </path>\r\n          </svg>\r\n        </button>\r\n      </div>\r\n      <div class=\"connecting-wrapper\">\r\n        <div class=\"content\">\r\n          <div class=\"icon\"><img src=\"${module?.metadata.iconUrl}\" alt=\"${module?.metadata.name}\"></div>\r\n          <h3 class=\"connecting-name\">${module?.metadata.name}</h3>\r\n          <div class=\"connecting-details\">\r\n            <div class=\"spinner\"><img\r\n                src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAR3SURBVHgBpVZ9aJVVGH+e55z33bi7zY9hMz+yMAeNoEIq6A9ZRKQWEsQNFIIpsf5Y9E+GsD9iBEEDMUkDa6ShRKKZYIWiRkaKaUGUGCKOTGMF84PNO99773vOefq9720yK5ZzD/dwPt/nd37P17lEk5Qnuz9roUkKT7T5bNe+QjTNLCHv24h1Xgh+OmtwQYPH2jUXwlnW9NRooqePfLS6MmmQ59cdeEGJlkJZA5MGVecoAwghBYZTVY9ftuaDSy8x8w9fbFl95JZAXuw9dmelkvRAyXxS7wMFryG4bIyWZiqzPgMhaFfGfn3NY3AZG9sPf/Dy8HidZvxkZc/h1pqnPlKey6yspMqUd9jVAEYY6RCGDQTwjGDwGTgAlbwRijV1C9vanz577tT+6r+YrOz5rlXFrQ/qZ+FbDxCfXS5oOgxln4v473f3rbgwdn7FK5/MCaH2eAg6X8g3K2iBMTiBkNJVKbod+ze9mgPZsY/UaicYzCE1HgpZc558olCTjTvWLxv9p1n3bV45iO7T5zq3TU9j9xTOLwQ5D9t48aEYrtGj2P/2BpNS78nZJoRdlDsYd8vphz273lqyhW5Rnlnz3hOe6SEwghvxPUMTVfYe2rpuUOqOkZeIxdSbsSJ8eTIAmXy5tftrMPkzi0C4B2ZDNHp+INvLQURkhYiJ6gDGko376DbEJ8k3mcnYBSeSM2ptL/XGsurNnxfnDIQNwCKADO1845Ef6Tbk0M51g4joMgncDyBmkrtsNEMQovcDxGYsGL2yDNAUxPv0VySs4yxhfeYbabJg0Awg+ILylEB6nKMpSOp0WCR1+QSuD4ELljNDEfyRrdXPCU1BTEgD7pyOzVmC2iBm0KgYAMCEeXovoClIjdKiVdQ3FYbzmatxWRqMPcNsDHyfNWskWk5TkJhNEwVyxA6hLL5clLJsW7voFxa6LiR5CCOeWzo3XFxKtyEdy3tnp7VahAoDp6PEVGvJye09l3P7K9k9WQijXBv4B6WG+0pvD0ybFEBHZ6OPh+/OGaBsIvNRAGp/ZHv1jJeon+omszBkFsr3FhsLB7rev3JLQKVSyfjmaW2BJSavDlqR7c5VrR+4AbLttbkXMehH7gjA8gZiD/tq+Or/ABZ3dUW/J62LcPUGcrW8pKSVFAg6cHz3O0l25qZHa/XGwWPg9aAwwzdZAaDX+7tbNsMYf5+bpaUS0dDQEF8rtsUxCbI5e5KRzGhBMiqNxllKju7d8NOYXjseRBytQngcVDL3wD9H+7vf3YS7mnnzqrZpwSxrwkh04cpM5NTMyJdHbIgaESyxJ6tZ5cDbw3qd0tqVCp25Se/4yYdr5/zm/ehjwvpxZHgN0Wlub0/Yt7awdykqRYFHy6NUQVrBd4o6p6ngrVL2Bo8ksuJqoXzq9Ln9m6rj9U74b6Wjo8OeP082aY5NUxRsYzwDkeFsU+MdUU3U4PG0QtbahqhadDMuHTy4fvS/9EwIUpdeuW/ZiShOipFxURRbNdWETFMRZrCFlEZGkuPHdycTafgLExNiI6YfUpcAAAAASUVORK5CYII=\"\r\n                alt=\"loading-icon\"></div><span>Connecting to ${module?.metadata.name}...</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  `;\r\n}\r\n","import { ModuleState, Wallet } from \"@near-wallet-selector/core\";\r\nimport { connectToWallet } from \"../render-modal\";\r\n\r\nexport async function renderWalletConnectionFailed(\r\n  module: ModuleState<Wallet>,\r\n  err: Error\r\n) {\r\n  document.querySelector(\".modal-right\")!.innerHTML = `\r\n    <div class=\"nws-modal-body\">\r\n      <div class=\"nws-modal-header\">\r\n        <h3 class=\"middleTitle\"></h3>\r\n        <button class=\"close-button\">\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\"\r\n              height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" fill=\"#C1C1C1\">\r\n              <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n              <path\r\n                d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\">\r\n              </path>\r\n          </svg>\r\n        </button>\r\n      </div>\r\n      <div class=\"alert-message connecting-wrapper connecting-wrapper-err\">\r\n        <div class=\"content\">\r\n          <div class=\"icon\"><img src=\"${module.metadata.iconUrl}\" alt=\"${\r\n    module.metadata.name\r\n  }\"></div>\r\n          <h3 class=\"connecting-name\">${module.metadata.name}</h3>\r\n          <div class=\"connecting-details\">\r\n            <div class=\"connection\">\r\n              <div class=\"error-wrapper\">\r\n                <div class=\"error\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\"\r\n                    xmlns=\"http:/*www.w3.org/2000/svg\">*/ <rect width=\"24\" height=\"24\" rx=\"12\" fill=\"#CE5A6F\"></rect>\r\n                    <path d=\"M17.25 6.75L6.75 17.25\" stroke=\"currentColor\" stroke-width=\"1.5\" stroke-linecap=\"round\"\r\n                      stroke-linejoin=\"round\"></path>\r\n                    <path d=\"M6.75 6.75L17.25 17.25\" stroke=\"currentColor\" stroke-width=\"1.5\" stroke-linecap=\"round\"\r\n                      stroke-linejoin=\"round\"></path>\r\n                  </svg>Connection Failed</div>\r\n                  <p>${err && err.message ? err.message : \"\"}</p>${\r\n    !module?.metadata.deprecated && module?.metadata.available\r\n      ? \"<button id='retry-button'>Retry</button>\"\r\n      : \"\"\r\n  }\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  document.getElementById(\"retry-button\")?.addEventListener(\"click\", () => {\r\n    connectToWallet(module);\r\n  });\r\n}\r\n","import { ModuleState, Wallet } from \"@near-wallet-selector/core\";\r\nimport { modalState } from \"../modal\";\r\n\r\nexport function renderWalletNotInstalled(\r\n  module: ModuleState<Wallet> & {\r\n    metadata: {\r\n      downloadUrl?: string;\r\n    };\r\n  }\r\n) {\r\n  if (!modalState) {\r\n    return;\r\n  }\r\n\r\n  document.querySelector(\".modal-right\")!.innerHTML = `\r\n    <div class=\"nws-modal-body\">\r\n      <div class=\"nws-modal-header-wrapper\"><button class=\"back-button\"><svg width=\"8\" height=\"14\" viewBox=\"0 0 8 14\"\r\n            fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M7 13L1 7L7 1\" stroke=\"#6494EE\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\r\n            </path>\r\n          </svg></button>\r\n        <div class=\"nws-modal-header\">\r\n          <h3 class=\"middleTitle\"></h3><button class=\"close-button\"><svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\"\r\n              viewBox=\"0 0 24 24\" width=\"24\" fill=\"#C1C1C1\">\r\n              <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n              <path\r\n                d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\">\r\n              </path>\r\n            </svg></button>\r\n        </div>\r\n      </div>\r\n      <div class=\"wallet-not-installed-wrapper\">\r\n        <div class=\"wallet-data\">\r\n          <div class=\"wallet-icon-box\"><img\r\n              src=\"${module.metadata.iconUrl}\" alt=\"${module.metadata.name}\"></div>\r\n          <p>${module.metadata.name}</p>\r\n        </div>\r\n        <p>You'll need to install ${module.metadata.name} to continue. After installing<span class=\"refresh-link\" id=\"refresh-page-lint\">&nbsp;refresh the\r\n            page.</span></p>\r\n        <div class=\"action-buttons\"><button class=\"middleButton\" id=\"download-button\">Open ${module.metadata.name}</button></div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  document\r\n    .getElementById(\"refresh-page-lint\")\r\n    ?.addEventListener(\"click\", () => {\r\n      window.location.reload();\r\n    });\r\n\r\n  document.getElementById(\"download-button\")?.addEventListener(\"click\", () => {\r\n    if (module.type !== \"injected\") {\r\n      return;\r\n    }\r\n\r\n    window.open(module.metadata.downloadUrl, \"_blank\");\r\n  });\r\n}\r\n","import { renderGetAWallet } from \"./GetAWallet\";\r\n\r\nexport async function renderWhatIsAWallet() {\r\n  document.querySelector(\".modal-right\")!.innerHTML = `\r\n    <div class=\"nws-modal-body\">\r\n      <div class=\"wallet-home-wrapper\">\r\n        <div class=\"nws-modal-header-wrapper\">\r\n          <div class=\"nws-modal-header\">\r\n            <h3 class=\"middleTitle\">What is a Wallet?</h3>\r\n            <button class=\"close-button\">\r\n              <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" fill=\"#C1C1C1\">\r\n                <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n                <path\r\n                  d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\">\r\n                </path>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"wallet-info-wrapper  what-wallet-hide\">\r\n          <div class=\"wallet-what\">\r\n            <div class=\"content-side\">\r\n              <h3>Secure &amp; Manage Your Digital Assets</h3>\r\n              <p>Safely store and transfer your crypto and NFTs.</p>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"wallet-what\">\r\n              <div class=\"content-side\">\r\n                  <h3>Log In to Any NEAR App</h3>\r\n                  <p>No need to create new accounts or credentials. Connect your wallet and you are good to go!</p>\r\n              </div>\r\n          </div>\r\n\r\n            <div class=\"button-spacing\"></div>\r\n              <button class=\"middleButton\" id=\"get-a-wallet-button\">Get a Wallet</button>\r\n        </div>\r\n\r\n        <div class=\"what-wallet-mobile\">\r\n          <p>\r\n            Use a wallet to secure and manage your NEAR assets, and to log in\r\n            to any NEAR app without the need for usernames and passwords.\r\n          </p>\r\n          <button class=\"middleButton\" id=\"get-a-wallet-button-mobile\">Get a Wallet</button>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  document\r\n    .getElementById(\"get-a-wallet-button\")\r\n    ?.addEventListener(\"click\", () => {\r\n      renderGetAWallet();\r\n    });\r\n\r\n  document\r\n    .getElementById(\"get-a-wallet-button-mobile\")\r\n    ?.addEventListener(\"click\", () => {\r\n      renderGetAWallet();\r\n    });\r\n}\r\n","import type {\r\n  ModuleState,\r\n  Wallet,\r\n  WalletSelector,\r\n} from \"@near-wallet-selector/core\";\r\nimport { renderModal } from \"./render-modal\";\r\nimport type {\r\n  WalletSelectorModal,\r\n  ModalOptions,\r\n  ModalRoute,\r\n} from \"./modal.types\";\r\nimport { renderWhatIsAWallet } from \"./components/WhatIsAWallet\";\r\nimport { renderWalletAccount } from \"./components/WalletAccount\";\r\n\r\nconst MODAL_ELEMENT_ID = \"near-wallet-selector-modal\";\r\nexport const DEFAULT_DERIVATION_PATH = \"44'/397'/0'/0'/1'\";\r\n\r\nlet modalInstance: WalletSelectorModal | null = null;\r\n\r\ntype ModalState = {\r\n  container: HTMLElement;\r\n  selector: WalletSelector;\r\n  options: ModalOptions;\r\n  route: ModalRoute;\r\n  modules: Array<ModuleState<Wallet>>;\r\n  derivationPath: string;\r\n};\r\n\r\nexport let modalState: ModalState | null = null;\r\n\r\nexport function updateModalState(newModalState: ModalState) {\r\n  modalState = newModalState;\r\n}\r\n\r\nif (typeof window !== \"undefined\") {\r\n  const el = document.createElement(\"div\");\r\n  el.id = MODAL_ELEMENT_ID;\r\n  document.body.appendChild(el);\r\n}\r\n\r\nexport const setupModal = (\r\n  selector: WalletSelector,\r\n  options: ModalOptions\r\n): WalletSelectorModal => {\r\n  modalState = {\r\n    container: document.getElementById(MODAL_ELEMENT_ID)!,\r\n    selector,\r\n    options,\r\n    route: {\r\n      name: \"WalletOptions\",\r\n    },\r\n    modules: [],\r\n    derivationPath: DEFAULT_DERIVATION_PATH,\r\n  };\r\n\r\n  modalState.selector.store.observable.subscribe((state) => {\r\n    if (!modalState) {\r\n      return;\r\n    }\r\n\r\n    state.modules.sort((current, next) => {\r\n      if (current.metadata.deprecated === next.metadata.deprecated) {\r\n        return 0;\r\n      }\r\n\r\n      return current.metadata.deprecated ? 1 : -1;\r\n    });\r\n\r\n    modalState.modules = state.modules;\r\n  });\r\n\r\n  const close = (e: KeyboardEvent) => {\r\n    if (e.key === \"Escape\") {\r\n      if (!modalState) {\r\n        return;\r\n      }\r\n\r\n      modalState.container.children[0].classList.remove(\"open\");\r\n    }\r\n  };\r\n  window.addEventListener(\"keydown\", close);\r\n\r\n  renderModal();\r\n\r\n  if (!modalInstance) {\r\n    modalInstance = {\r\n      show: () => {\r\n        if (!modalState) {\r\n          return;\r\n        }\r\n        renderModal();\r\n        const selectedWalletId =\r\n          modalState.selector.store.getState().selectedWalletId;\r\n        if (selectedWalletId) {\r\n          const module = modalState.modules.find(\r\n            (m) => m.id === selectedWalletId\r\n          );\r\n          renderWalletAccount(module);\r\n        } else {\r\n          renderWhatIsAWallet();\r\n        }\r\n        modalState.container.children[0].classList.add(\"open\");\r\n      },\r\n      hide: () => {\r\n        if (!modalState) {\r\n          return;\r\n        }\r\n        modalState.container.children[0].classList.remove(\"open\");\r\n      },\r\n    };\r\n  }\r\n\r\n  return modalInstance;\r\n};\r\n","import {\r\n  HardwareWallet,\r\n  HardwareWalletAccount,\r\n  ModuleState,\r\n  Wallet,\r\n} from \"@near-wallet-selector/core\";\r\nimport { renderConnectHardwareWallet } from \"./components/ConnectHardwareWallet\";\r\nimport { renderLedgerAccountsOverviewList } from \"./components/LedgerAccountsOverviewList\";\r\nimport { renderLedgerSelectAccount } from \"./components/LedgerSelectAccount\";\r\nimport { renderNoLedgerAccountsFound } from \"./components/NoLedgerAccountsFound\";\r\nimport { renderWalletConnecting } from \"./components/WalletConnecting\";\r\nimport { renderWalletConnectionFailed } from \"./components/WalletConnectionFailed\";\r\nimport { renderWalletNotInstalled } from \"./components/WalletNotInstalled\";\r\nimport { modalState } from \"./modal\";\r\nimport { renderWalletAccount } from \"./components/WalletAccount\";\r\n\r\nexport type HardwareWalletAccountState = HardwareWalletAccount & {\r\n  selected: boolean;\r\n};\r\n\r\nconst getAccountIds = async (publicKey: string): Promise<Array<string>> => {\r\n  if (!modalState) {\r\n    return [];\r\n  }\r\n\r\n  const response = await fetch(\r\n    `${modalState.selector.options.network.indexerUrl}/publicKey/ed25519:${publicKey}/accounts`\r\n  );\r\n\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to get account id from public key\");\r\n  }\r\n\r\n  const accountIds = await response.json();\r\n\r\n  if (!Array.isArray(accountIds) || !accountIds.length) {\r\n    return [];\r\n  }\r\n\r\n  return accountIds;\r\n};\r\n\r\nexport const resolveAccounts = async (\r\n  wallet: Wallet\r\n): Promise<Array<HardwareWalletAccountState> | null> => {\r\n  if (!modalState) {\r\n    return [];\r\n  }\r\n\r\n  const publicKey = await (wallet as HardwareWallet).getPublicKey(\r\n    modalState.derivationPath\r\n  );\r\n  try {\r\n    const accountIds = await getAccountIds(publicKey);\r\n\r\n    return accountIds.map((accountId, index) => {\r\n      return {\r\n        derivationPath: modalState!.derivationPath,\r\n        publicKey,\r\n        accountId,\r\n        selected: index === 0,\r\n      };\r\n    });\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n};\r\n\r\nexport async function connectToWallet(module: ModuleState<Wallet>) {\r\n  if (!modalState) {\r\n    return;\r\n  }\r\n\r\n  const { selectedWalletId } = modalState.selector.store.getState();\r\n\r\n  if (selectedWalletId === module.id) {\r\n    renderWalletAccount(module);\r\n    return;\r\n  }\r\n\r\n  try {\r\n    if (module.type === \"injected\" && !module.metadata.available) {\r\n      return renderWalletNotInstalled(module);\r\n    }\r\n\r\n    if (module.metadata.deprecated) {\r\n      return renderWalletConnectionFailed(\r\n        module,\r\n        new Error(\"Wallet is deprecated\")\r\n      );\r\n    }\r\n\r\n    const wallet = await module.wallet();\r\n\r\n    await renderWalletConnecting(module);\r\n\r\n    if (wallet.type === \"hardware\") {\r\n      const accounts = await resolveAccounts(wallet);\r\n\r\n      if (!accounts || accounts.length < 1) {\r\n        return renderNoLedgerAccountsFound(module);\r\n      }\r\n\r\n      if (accounts.length === 1) {\r\n        return renderLedgerAccountsOverviewList(module, accounts, accounts);\r\n      } else {\r\n        return renderLedgerSelectAccount(module, accounts);\r\n      }\r\n    }\r\n\r\n    await wallet.signIn({\r\n      contractId: modalState.options.contractId,\r\n      methodNames: modalState.options.methodNames,\r\n    });\r\n\r\n    modalState.container.children[0].classList.remove(\"open\");\r\n  } catch (err) {\r\n    const { name } = module.metadata;\r\n    const message = err instanceof Error ? err.message : \"Something went wrong\";\r\n\r\n    await renderWalletConnectionFailed(\r\n      module,\r\n      new Error(`Failed to sign in with ${name}: ${message}`)\r\n    );\r\n  }\r\n}\r\n\r\nexport function renderModal() {\r\n  if (!modalState) {\r\n    return;\r\n  }\r\n\r\n  modalState.container.innerHTML = `\r\n    <div class=\"nws-modal-wrapper ${\r\n      modalState.options.theme === \"dark\" ? \"dark-theme\" : \"\"\r\n    }\">\r\n      <div class=\"nws-modal-overlay\"></div>\r\n      <div class=\"nws-modal\">\r\n        <div class=\"modal-left\">\r\n          <div class=\"modal-left-title\">\r\n            <h2>Connect Your Wallet</h2>\r\n          </div>\r\n          <div class=\"nws-modal-body\">\r\n            <div class=\"wallet-options-wrapper\">\r\n              <ul class=\"options-list\"></ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-right\"></div>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  for (let i = 0; i < modalState.modules.length; i++) {\r\n    const module = modalState.modules[i];\r\n    const { name, description, iconUrl } = module.metadata;\r\n    document.querySelector(\".options-list\")?.insertAdjacentHTML(\r\n      \"beforeend\",\r\n      `\r\n        <div class=\"single-wallet ${\r\n          module.id === modalState.selector.store.getState().selectedWalletId\r\n            ? \"selected-wallet connected-wallet\"\r\n            : \"\"\r\n        } sidebar ${\r\n        module.metadata.deprecated ? \"deprecated-wallet\" : \"\"\r\n      }\" id=\"module-${module.id}\">\r\n          <div class=\"icon\"><img src=\"${iconUrl}\" alt=\"${name}\"></div>\r\n          <div class=\"content\">\r\n            <div class=\"title\">${name}</div>\r\n            <div class=\"description\">${description}</div>\r\n          </div>\r\n          ${\r\n            module.metadata.deprecated\r\n              ? `\r\n              <div class=\"warning-triangle\">\r\n                <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M4.95215 16.3536L10.2152 5.85657C10.9531 4.38481 13.0538 4.38519 13.7912 5.85723L19.0494 16.3543C19.7156 17.6841 18.7486 19.25 17.2612 19.25H6.74001C5.25228 19.25 4.28535 17.6835 4.95215 16.3536Z\" stroke=\"#E6B73E\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path><path d=\"M12 10V12\" stroke=\"#E6B73E\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path><path d=\"M12.5 16C12.5 16.2761 12.2761 16.5 12 16.5C11.7239 16.5 11.5 16.2761 11.5 16C11.5 15.7239 11.7239 15.5 12 15.5C12.2761 15.5 12.5 15.7239 12.5 16Z\" stroke=\"#E6B73E\"></path></svg>\r\n              </div>\r\n                `\r\n              : \"\"\r\n          }\r\n        </div>\r\n      `\r\n    );\r\n\r\n    document\r\n      .getElementById(\"module-\" + module.id)\r\n      ?.addEventListener(\"click\", () => {\r\n        document.querySelectorAll(\".selected-wallet\").forEach((element) => {\r\n          element.classList.remove(\"selected-wallet\");\r\n        });\r\n\r\n        document\r\n          .getElementById(\"module-\" + module.id)\r\n          ?.classList.add(\"selected-wallet\");\r\n\r\n        if (module.type === \"hardware\") {\r\n          return renderConnectHardwareWallet(module);\r\n        }\r\n        connectToWallet(module);\r\n      });\r\n  }\r\n\r\n  document\r\n    .querySelector(\".nws-modal-overlay\")\r\n    ?.addEventListener(\"click\", () => {\r\n      if (!modalState) {\r\n        return;\r\n      }\r\n      modalState.container.children[0].classList.remove(\"open\");\r\n    });\r\n\r\n  document.addEventListener(\"click\", (e) => {\r\n    if (!modalState) {\r\n      return;\r\n    }\r\n\r\n    const target = e.target as HTMLElement;\r\n\r\n    if (target && target.className === \"close-button\") {\r\n      modalState.container.children[0].classList.remove(\"open\");\r\n    }\r\n  });\r\n}\r\n","export { setupMyNearWallet } from \"./lib/my-near-wallet\";\r\nexport type { MyNearWalletParams } from \"./lib/my-near-wallet\";\r\n","export default `data:image/png;base64,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`;\r\n","import {\r\n  WalletConnection,\r\n  connect,\r\n  keyStores,\r\n  transactions as nearTransactions,\r\n  utils,\r\n} from \"near-api-js\";\r\nimport type {\r\n  WalletModuleFactory,\r\n  WalletBehaviourFactory,\r\n  BrowserWallet,\r\n  Transaction,\r\n  Optional,\r\n  Network,\r\n} from \"@near-wallet-selector/core\";\r\nimport { createAction } from \"@near-wallet-selector/wallet-utils\";\r\nimport icon from \"./icon\";\r\n\r\nexport interface MyNearWalletParams {\r\n  walletUrl?: string;\r\n  iconUrl?: string;\r\n  deprecated?: boolean;\r\n}\r\n\r\ninterface MyNearWalletState {\r\n  wallet: WalletConnection;\r\n  keyStore: keyStores.BrowserLocalStorageKeyStore;\r\n}\r\n\r\ninterface MyNearWalletExtraOptions {\r\n  walletUrl: string;\r\n}\r\n\r\nconst resolveWalletUrl = (network: Network, walletUrl?: string) => {\r\n  if (walletUrl) {\r\n    return walletUrl;\r\n  }\r\n\r\n  switch (network.networkId) {\r\n    case \"mainnet\":\r\n      return \"https://app.mynearwallet.com\";\r\n    case \"testnet\":\r\n      return \"https://testnet.mynearwallet.com\";\r\n    default:\r\n      throw new Error(\"Invalid wallet url\");\r\n  }\r\n};\r\n\r\nconst setupWalletState = async (\r\n  params: MyNearWalletExtraOptions,\r\n  network: Network\r\n): Promise<MyNearWalletState> => {\r\n  const keyStore = new keyStores.BrowserLocalStorageKeyStore();\r\n\r\n  const near = await connect({\r\n    keyStore,\r\n    walletUrl: params.walletUrl,\r\n    ...network,\r\n    headers: {},\r\n  });\r\n\r\n  const wallet = new WalletConnection(near, \"near_app\");\r\n\r\n  // Cleanup up any pending keys (cancelled logins).\r\n  if (!wallet.isSignedIn()) {\r\n    await keyStore.clear();\r\n  }\r\n\r\n  return {\r\n    wallet,\r\n    keyStore,\r\n  };\r\n};\r\n\r\nconst MyNearWallet: WalletBehaviourFactory<\r\n  BrowserWallet,\r\n  { params: MyNearWalletExtraOptions }\r\n> = async ({ metadata, options, store, params, logger }) => {\r\n  const _state = await setupWalletState(params, options.network);\r\n\r\n  const cleanup = () => {\r\n    _state.keyStore.clear();\r\n  };\r\n\r\n  const getAccounts = () => {\r\n    const accountId: string | null = _state.wallet.getAccountId();\r\n\r\n    if (!accountId) {\r\n      return [];\r\n    }\r\n\r\n    return [{ accountId }];\r\n  };\r\n\r\n  const transformTransactions = async (\r\n    transactions: Array<Optional<Transaction, \"signerId\">>\r\n  ) => {\r\n    const account = _state.wallet.account();\r\n    const { networkId, signer, provider } = account.connection;\r\n\r\n    const localKey = await signer.getPublicKey(account.accountId, networkId);\r\n\r\n    return Promise.all(\r\n      transactions.map(async (transaction, index) => {\r\n        const actions = transaction.actions.map((action) =>\r\n          createAction(action)\r\n        );\r\n        const accessKey = await account.accessKeyForTransaction(\r\n          transaction.receiverId,\r\n          actions,\r\n          localKey\r\n        );\r\n\r\n        if (!accessKey) {\r\n          throw new Error(\r\n            `Failed to find matching key for transaction sent to ${transaction.receiverId}`\r\n          );\r\n        }\r\n\r\n        const block = await provider.block({ finality: \"final\" });\r\n\r\n        return nearTransactions.createTransaction(\r\n          account.accountId,\r\n          utils.PublicKey.from(accessKey.public_key),\r\n          transaction.receiverId,\r\n          accessKey.access_key.nonce + index + 1,\r\n          actions,\r\n          utils.serialize.base_decode(block.header.hash)\r\n        );\r\n      })\r\n    );\r\n  };\r\n\r\n  return {\r\n    async signIn({ contractId, methodNames }) {\r\n      const existingAccounts = getAccounts();\r\n\r\n      if (existingAccounts.length) {\r\n        return existingAccounts;\r\n      }\r\n\r\n      await _state.wallet.requestSignIn({ contractId, methodNames });\r\n\r\n      return getAccounts();\r\n    },\r\n\r\n    async signOut() {\r\n      if (_state.wallet.isSignedIn()) {\r\n        _state.wallet.signOut();\r\n      }\r\n\r\n      cleanup();\r\n    },\r\n\r\n    async getAccounts() {\r\n      return getAccounts();\r\n    },\r\n\r\n    async verifyOwner({ message, callbackUrl, meta }) {\r\n      logger.log(\"verifyOwner\", { message });\r\n\r\n      const account = _state.wallet.account();\r\n\r\n      if (!account) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n      const locationUrl =\r\n        typeof window !== \"undefined\" ? window.location.href : \"\";\r\n\r\n      const url = callbackUrl || locationUrl;\r\n\r\n      if (!url) {\r\n        throw new Error(`The callbackUrl is missing for ${metadata.name}`);\r\n      }\r\n\r\n      const encodedUrl = encodeURIComponent(url);\r\n      const extraMeta = meta ? `&meta=${meta}` : \"\";\r\n\r\n      window.location.replace(\r\n        `${params.walletUrl}/verify-owner?message=${message}&callbackUrl=${encodedUrl}${extraMeta}`\r\n      );\r\n\r\n      return;\r\n    },\r\n\r\n    async signAndSendTransaction({\r\n      signerId,\r\n      receiverId,\r\n      actions,\r\n      callbackUrl,\r\n    }) {\r\n      logger.log(\"signAndSendTransaction\", {\r\n        signerId,\r\n        receiverId,\r\n        actions,\r\n        callbackUrl,\r\n      });\r\n\r\n      const { contract } = store.getState();\r\n\r\n      if (!_state.wallet.isSignedIn() || !contract) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      const account = _state.wallet.account();\r\n\r\n      return account[\"signAndSendTransaction\"]({\r\n        receiverId: receiverId || contract.contractId,\r\n        actions: actions.map((action) => createAction(action)),\r\n        walletCallbackUrl: callbackUrl,\r\n      });\r\n    },\r\n\r\n    async signAndSendTransactions({ transactions, callbackUrl }) {\r\n      logger.log(\"signAndSendTransactions\", { transactions, callbackUrl });\r\n\r\n      if (!_state.wallet.isSignedIn()) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      return _state.wallet.requestSignTransactions({\r\n        transactions: await transformTransactions(transactions),\r\n        callbackUrl,\r\n      });\r\n    },\r\n  };\r\n};\r\n\r\nexport function setupMyNearWallet({\r\n  walletUrl,\r\n  iconUrl = icon,\r\n  deprecated = false,\r\n}: MyNearWalletParams = {}): WalletModuleFactory<BrowserWallet> {\r\n  return async () => {\r\n    return {\r\n      id: \"my-near-wallet\",\r\n      type: \"browser\",\r\n      metadata: {\r\n        name: \"MyNearWallet\",\r\n        description:\r\n          \"NEAR wallet to store, buy, send and stake assets for DeFi.\",\r\n        iconUrl,\r\n        deprecated,\r\n        available: true,\r\n      },\r\n      init: (options) => {\r\n        return MyNearWallet({\r\n          ...options,\r\n          params: {\r\n            walletUrl: resolveWalletUrl(options.options.network, walletUrl),\r\n          },\r\n        });\r\n      },\r\n    };\r\n  };\r\n}\r\n","export { setupNearWallet } from \"./lib/near-wallet\";\r\nexport type { NearWalletParams } from \"./lib/near-wallet\";\r\n","export default `data:image/png;base64,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`;\r\n","import {\r\n  WalletModuleFactory,\r\n  BrowserWallet,\r\n  Network,\r\n} from \"@near-wallet-selector/core\";\r\nimport {\r\n  setupMyNearWallet,\r\n  MyNearWalletParams,\r\n} from \"@near-wallet-selector/my-near-wallet\";\r\nimport icon from \"./icon\";\r\n\r\nexport type NearWalletParams = MyNearWalletParams;\r\n\r\nconst resolveWalletUrl = (network: Network, walletUrl?: string) => {\r\n  if (walletUrl) {\r\n    return walletUrl;\r\n  }\r\n\r\n  switch (network.networkId) {\r\n    case \"mainnet\":\r\n      return \"https://wallet.near.org\";\r\n    case \"testnet\":\r\n      return \"https://wallet.testnet.near.org\";\r\n    default:\r\n      throw new Error(\"Invalid wallet url\");\r\n  }\r\n};\r\n\r\nexport function setupNearWallet({\r\n  walletUrl,\r\n  iconUrl = icon,\r\n  deprecated = false,\r\n}: NearWalletParams = {}): WalletModuleFactory<BrowserWallet> {\r\n  return async (options) => {\r\n    const wallet = await setupMyNearWallet({\r\n      walletUrl: resolveWalletUrl(options.options.network, walletUrl),\r\n      iconUrl,\r\n    })(options);\r\n\r\n    if (!wallet) {\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      ...wallet,\r\n      id: \"near-wallet\",\r\n      metadata: {\r\n        ...wallet.metadata,\r\n        name: \"NEAR Wallet\",\r\n        description: \"Web wallet for NEAR Protocol\",\r\n        iconUrl,\r\n        deprecated,\r\n        available: true,\r\n      },\r\n    };\r\n  };\r\n}\r\n","export { setupNightlyConnect } from \"./lib/nightly-connect\";\r\nexport type { SetupNightlyConnectParams } from \"./lib/nightly-connect\";\r\n","export default `data:image/png;base64,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`;\r\n","import { Signer, transactions as nearTransactions, utils } from \"near-api-js\";\r\nimport {\r\n  AppMetadata,\r\n  AppNear,\r\n  clearPersistedSessionAccountId,\r\n  clearPersistedSessionId,\r\n  clearPersistedSessionPublicKey,\r\n  getPersistedSessionAccountId,\r\n  getPersistedSessionId,\r\n  getPersistedSessionPublicKey,\r\n  NETWORK,\r\n  NightlyConnectModal,\r\n  setPersistedSessionAccountId,\r\n  setPersistedSessionPublicKey,\r\n} from \"@nightlylabs/connect-near\";\r\nimport {\r\n  BridgeWallet,\r\n  getActiveAccount,\r\n  Optional,\r\n  Transaction,\r\n  WalletBehaviourFactory,\r\n  WalletModuleFactory,\r\n} from \"@near-wallet-selector/core\";\r\nimport { signTransactions } from \"@near-wallet-selector/wallet-utils\";\r\nimport type { FinalExecutionOutcome } from \"near-api-js/lib/providers\";\r\nimport icon from \"./icon\";\r\n\r\nexport interface NightlyConnectParams {\r\n  appMetadata: AppMetadata;\r\n  url?: string;\r\n  timeout?: number;\r\n}\r\n\r\ninterface NightlyConnectAccount {\r\n  accountId: string;\r\n  publicKey: utils.PublicKey;\r\n}\r\n\r\ninterface NightlyConnectState {\r\n  client: AppNear | null;\r\n  modal: NightlyConnectModal;\r\n  accounts: Array<NightlyConnectAccount>;\r\n}\r\n\r\nconst setupNightlyConnectState = (): NightlyConnectState => {\r\n  return {\r\n    client: null,\r\n    modal: new NightlyConnectModal(),\r\n    accounts: [],\r\n  };\r\n};\r\n\r\nconst NightlyConnect: WalletBehaviourFactory<\r\n  BridgeWallet,\r\n  { params: NightlyConnectParams }\r\n> = async ({ metadata, store, params, logger, options, provider, emitter }) => {\r\n  const _state = setupNightlyConnectState();\r\n\r\n  const getAccounts = () => {\r\n    return _state.accounts;\r\n  };\r\n\r\n  const signer: Signer = {\r\n    createKey: () => {\r\n      throw new Error(\"Not implemented\");\r\n    },\r\n    getPublicKey: async (accountId) => {\r\n      const accounts = getAccounts();\r\n      const account = accounts.find((a) => a.accountId === accountId);\r\n\r\n      if (!account) {\r\n        throw new Error(\"Failed to find public key for account\");\r\n      }\r\n\r\n      return utils.PublicKey.from(account.publicKey);\r\n    },\r\n    signMessage: async (message, accountId) => {\r\n      const accounts = getAccounts();\r\n      const account = accounts.find((a) => a.accountId === accountId);\r\n\r\n      if (!account) {\r\n        throw new Error(\"Failed to find account for signing\");\r\n      }\r\n\r\n      try {\r\n        const tx = nearTransactions.Transaction.decode(Buffer.from(message));\r\n        const signedTx = await _state.client!.signTransaction(tx);\r\n\r\n        return {\r\n          signature: signedTx.signature.data,\r\n          publicKey: tx.publicKey,\r\n        };\r\n      } catch (err) {\r\n        logger.log(\"Failed to sign message\");\r\n        logger.error(err);\r\n\r\n        throw Error(\"Invalid message. Only transactions can be signed\");\r\n      }\r\n    },\r\n  };\r\n\r\n  const signOut = async () => {\r\n    clearPersistedSessionId();\r\n    clearPersistedSessionPublicKey();\r\n    clearPersistedSessionAccountId();\r\n    _state.client?.ws.close();\r\n  };\r\n\r\n  const transformTransactions = (\r\n    transactions: Array<Optional<Transaction, \"signerId\" | \"receiverId\">>\r\n  ): Array<Transaction> => {\r\n    const account = getActiveAccount(store.getState());\r\n    const { contract } = store.getState();\r\n\r\n    if (!account || !contract) {\r\n      throw new Error(\"Wallet not signed in\");\r\n    }\r\n\r\n    return transactions.map((transaction) => {\r\n      return {\r\n        signerId: transaction.signerId || account.accountId,\r\n        receiverId: transaction.receiverId || contract.contractId,\r\n        actions: transaction.actions,\r\n      };\r\n    });\r\n  };\r\n\r\n  return {\r\n    async signIn() {\r\n      return new Promise((resolve, reject) => {\r\n        const existingAccounts = getAccounts();\r\n\r\n        if (existingAccounts.length) {\r\n          return resolve(existingAccounts);\r\n        }\r\n\r\n        let persistedId = getPersistedSessionId();\r\n        const persistedPubkey = getPersistedSessionPublicKey();\r\n        const persistedAccountId = getPersistedSessionAccountId();\r\n\r\n        if (\r\n          params.appMetadata.persistent !== false &&\r\n          persistedId !== null &&\r\n          (persistedPubkey === null || persistedAccountId === null)\r\n        ) {\r\n          clearPersistedSessionId();\r\n          persistedId = null;\r\n        }\r\n\r\n        try {\r\n          AppNear.build({\r\n            ...params,\r\n            onUserConnect: (account) => {\r\n              setPersistedSessionPublicKey(account.publicKey.toString());\r\n              setPersistedSessionAccountId(account.accountId.toString());\r\n              _state.accounts.push(account);\r\n              _state.modal.onClose = undefined;\r\n              _state.modal.closeModal();\r\n              resolve(getAccounts());\r\n            },\r\n          }).then((client) => {\r\n            client.ws.onclose = () => {\r\n              _state.client = null;\r\n              _state.accounts = [];\r\n              emitter.emit(\"signedOut\", null);\r\n            };\r\n            _state.client = client;\r\n\r\n            if (\r\n              params.appMetadata.persistent !== false &&\r\n              persistedId === client.sessionId &&\r\n              persistedPubkey !== null &&\r\n              persistedAccountId !== null\r\n            ) {\r\n              _state.accounts.push({\r\n                accountId: persistedAccountId,\r\n                publicKey: utils.PublicKey.from(persistedPubkey),\r\n              });\r\n              _state.modal.onClose = undefined;\r\n              resolve(getAccounts());\r\n            } else {\r\n              _state.modal.openModal(client.sessionId, NETWORK.NEAR);\r\n              _state.modal.onClose = () => {\r\n                reject(new Error(\"User cancelled pairing\"));\r\n              };\r\n            }\r\n          });\r\n        } catch (err) {\r\n          signOut();\r\n          reject(err);\r\n        }\r\n      });\r\n    },\r\n\r\n    signOut,\r\n\r\n    async getAccounts() {\r\n      return getAccounts().map(({ accountId }) => ({ accountId }));\r\n    },\r\n\r\n    async verifyOwner({ message }) {\r\n      logger.log(\"NightlyConnect:verifyOwner\", { message });\r\n\r\n      throw new Error(`Method not supported by ${metadata.name}`);\r\n    },\r\n\r\n    async signAndSendTransaction({ signerId, receiverId, actions }) {\r\n      logger.log(\"signAndSendTransaction\", { signerId, receiverId, actions });\r\n\r\n      const accounts = getAccounts();\r\n\r\n      if (!_state.client?.sessionId || !accounts.length) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      const [signedTx] = await signTransactions(\r\n        transformTransactions([{ signerId, receiverId, actions }]),\r\n        signer,\r\n        options.network\r\n      );\r\n\r\n      return provider.sendTransaction(signedTx);\r\n    },\r\n\r\n    async signAndSendTransactions({ transactions }) {\r\n      logger.log(\"signAndSendTransactions\", { transactions });\r\n\r\n      const accounts = getAccounts();\r\n\r\n      if (!_state.client?.sessionId || !accounts.length) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      const signedTxs = await signTransactions(\r\n        transformTransactions(transactions),\r\n        signer,\r\n        options.network\r\n      );\r\n\r\n      const results: Array<FinalExecutionOutcome> = [];\r\n\r\n      for (let i = 0; i < signedTxs.length; i++) {\r\n        results.push(await provider.sendTransaction(signedTxs[i]));\r\n      }\r\n\r\n      return results;\r\n    },\r\n  };\r\n};\r\n\r\nexport type SetupNightlyConnectParams = NightlyConnectParams & {\r\n  iconUrl?: string;\r\n  deprecated?: boolean;\r\n};\r\n\r\nexport function setupNightlyConnect({\r\n  appMetadata,\r\n  timeout,\r\n  url,\r\n  iconUrl = icon,\r\n  deprecated = false,\r\n}: SetupNightlyConnectParams): WalletModuleFactory<BridgeWallet> {\r\n  return async () => {\r\n    return {\r\n      id: \"nightly-connect\",\r\n      type: \"bridge\",\r\n      metadata: {\r\n        name: \"Nightly Connect\",\r\n        description: \"Upcoming cutting-edge crypto bridge wallet.\",\r\n        iconUrl: iconUrl,\r\n        deprecated,\r\n        available: true,\r\n      },\r\n      init: (options) => {\r\n        return NightlyConnect({\r\n          ...options,\r\n          params: {\r\n            appMetadata,\r\n            timeout,\r\n            url,\r\n          },\r\n        });\r\n      },\r\n    };\r\n  };\r\n}\r\n","export { setupNightly } from \"./lib/nightly\";\r\nexport type { NightlyWalletParams } from \"./lib/nightly\";\r\n","export default `data:image/png;base64,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`;\r\n","import type {\r\n  InjectedWallet,\r\n  WalletBehaviourFactory,\r\n  WalletModuleFactory,\r\n  WalletSelectorStore,\r\n} from \"@near-wallet-selector/core\";\r\nimport { Optional, Transaction, waitFor } from \"@near-wallet-selector/core\";\r\nimport { signTransactions } from \"@near-wallet-selector/wallet-utils\";\r\nimport { isMobile } from \"is-mobile\";\r\nimport { Signer, utils, transactions as nearTransactions } from \"near-api-js\";\r\nimport type { NearNightly, InjectedNightly } from \"./injected-nightly\";\r\nimport type { FinalExecutionOutcome } from \"near-api-js/lib/providers\";\r\nimport icon from \"./icon\";\r\n\r\ndeclare global {\r\n  interface Window {\r\n    nightly: InjectedNightly | undefined;\r\n  }\r\n}\r\n\r\ninterface NightlyState {\r\n  wallet: NearNightly;\r\n}\r\n\r\nconst setupNightlyState = async (\r\n  store: WalletSelectorStore\r\n): Promise<NightlyState> => {\r\n  const { selectedWalletId } = store.getState();\r\n  const wallet = window.nightly!.near!;\r\n\r\n  // Attempt to reconnect wallet if previously selected.\r\n  if (selectedWalletId === \"nightly\") {\r\n    await wallet.connect(undefined, true).catch(() => null);\r\n  }\r\n\r\n  return {\r\n    wallet,\r\n  };\r\n};\r\nconst isInstalled = () => {\r\n  return waitFor(() => !!window.nightly!.near!).catch(() => false);\r\n};\r\nconst Nightly: WalletBehaviourFactory<InjectedWallet> = async ({\r\n  metadata,\r\n  options,\r\n  store,\r\n  logger,\r\n  provider,\r\n}) => {\r\n  const _state = await setupNightlyState(store);\r\n\r\n  const getAccounts = () => {\r\n    const { accountId, publicKey } = _state.wallet.account;\r\n\r\n    if (!accountId) {\r\n      return [];\r\n    }\r\n\r\n    return [\r\n      {\r\n        accountId,\r\n        publicKey: publicKey.toString(),\r\n      },\r\n    ];\r\n  };\r\n\r\n  const transformTransactions = (\r\n    transactions: Array<Optional<Transaction, \"signerId\" | \"receiverId\">>\r\n  ): Array<Transaction> => {\r\n    const accounts = getAccounts();\r\n    const { contract } = store.getState();\r\n\r\n    if (!accounts.length || !contract) {\r\n      throw new Error(\"Wallet not signed in\");\r\n    }\r\n\r\n    return transactions.map((transaction) => {\r\n      return {\r\n        signerId: transaction.signerId || accounts[0].accountId,\r\n        receiverId: transaction.receiverId || contract.contractId,\r\n        actions: transaction.actions,\r\n      };\r\n    });\r\n  };\r\n\r\n  const signer: Signer = {\r\n    createKey: () => {\r\n      throw new Error(\"Not implemented\");\r\n    },\r\n    getPublicKey: async (accountId) => {\r\n      const accounts = getAccounts();\r\n      const account = accounts.find((a) => a.accountId === accountId);\r\n\r\n      if (!account) {\r\n        throw new Error(\"Failed to find public key for account\");\r\n      }\r\n\r\n      return utils.PublicKey.from(account.publicKey);\r\n    },\r\n    signMessage: async (message, accountId) => {\r\n      const accounts = getAccounts();\r\n      const account = accounts.find((a) => a.accountId === accountId);\r\n\r\n      if (!account) {\r\n        throw new Error(\"Failed to find account for signing\");\r\n      }\r\n\r\n      try {\r\n        const tx = nearTransactions.Transaction.decode(Buffer.from(message));\r\n        const signedTx = await _state.wallet.signTransaction(tx);\r\n\r\n        return {\r\n          signature: signedTx.signature.data,\r\n          publicKey: tx.publicKey,\r\n        };\r\n      } catch (err) {\r\n        logger.log(\"Failed to sign message\");\r\n        logger.error(err);\r\n\r\n        throw Error(\"Invalid message. Only transactions can be signed\");\r\n      }\r\n    },\r\n  };\r\n\r\n  return {\r\n    async signIn() {\r\n      const existingAccounts = getAccounts();\r\n\r\n      if (existingAccounts.length) {\r\n        return existingAccounts;\r\n      }\r\n\r\n      await _state.wallet.connect();\r\n\r\n      return getAccounts();\r\n    },\r\n\r\n    async signOut() {\r\n      await _state.wallet.disconnect();\r\n    },\r\n\r\n    async getAccounts() {\r\n      return getAccounts().map(({ accountId }) => ({ accountId }));\r\n    },\r\n\r\n    async verifyOwner({ message }) {\r\n      logger.log(\"Nightly:verifyOwner\", { message });\r\n\r\n      throw new Error(`Method not supported by ${metadata.name}`);\r\n    },\r\n\r\n    async signAndSendTransaction({ signerId, receiverId, actions }) {\r\n      logger.log(\"signAndSendTransaction\", { signerId, receiverId, actions });\r\n\r\n      const { contract } = store.getState();\r\n      const accounts = getAccounts();\r\n\r\n      if (!accounts.length || !contract) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      const [signedTx] = await signTransactions(\r\n        transformTransactions([{ signerId, receiverId, actions }]),\r\n        signer,\r\n        options.network\r\n      );\r\n\r\n      return provider.sendTransaction(signedTx);\r\n    },\r\n\r\n    async signAndSendTransactions({ transactions }) {\r\n      logger.log(\"signAndSendTransactions\", { transactions });\r\n\r\n      const signedTxs = await signTransactions(\r\n        transformTransactions(transactions),\r\n        signer,\r\n        options.network\r\n      );\r\n\r\n      const results: Array<FinalExecutionOutcome> = [];\r\n\r\n      for (let i = 0; i < signedTxs.length; i++) {\r\n        results.push(await provider.sendTransaction(signedTxs[i]));\r\n      }\r\n\r\n      return results;\r\n    },\r\n  };\r\n};\r\n\r\nexport interface NightlyWalletParams {\r\n  iconUrl?: string;\r\n  deprecated?: boolean;\r\n}\r\nexport function setupNightly({\r\n  iconUrl = icon,\r\n  deprecated = false,\r\n}: NightlyWalletParams = {}): WalletModuleFactory<InjectedWallet> {\r\n  return async () => {\r\n    const mobile = isMobile();\r\n    const installed = await isInstalled();\r\n\r\n    if (mobile) {\r\n      return null;\r\n    }\r\n\r\n    await waitFor(() => !!window.nightly?.near, {\r\n      timeout: 300,\r\n    }).catch(() => false);\r\n\r\n    return {\r\n      id: \"nightly\",\r\n      type: \"injected\",\r\n      metadata: {\r\n        name: \"Nightly\",\r\n        description: \"Upcoming cutting-edge crypto wallet.\",\r\n        iconUrl,\r\n        // Will replace we open beta with stable version\r\n        downloadUrl: \"https://www.nightly.app\",\r\n        deprecated,\r\n        available: installed,\r\n      },\r\n      init: Nightly,\r\n    };\r\n  };\r\n}\r\n","export { setupSender } from \"./lib/sender\";\r\nexport type { SenderParams } from \"./lib/sender\";\r\n","export default `data:image/png;base64,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`;\r\n","import { isMobile } from \"is-mobile\";\r\nimport {\r\n  WalletModuleFactory,\r\n  WalletBehaviourFactory,\r\n  InjectedWallet,\r\n  Action,\r\n  Transaction,\r\n  FunctionCallAction,\r\n  Optional,\r\n} from \"@near-wallet-selector/core\";\r\nimport { waitFor } from \"@near-wallet-selector/core\";\r\nimport type { InjectedSender } from \"./injected-sender\";\r\nimport icon from \"./icon\";\r\n\r\ndeclare global {\r\n  interface Window {\r\n    near: InjectedSender | undefined;\r\n  }\r\n}\r\n\r\nexport interface SenderParams {\r\n  iconUrl?: string;\r\n  deprecated?: boolean;\r\n}\r\n\r\ninterface SenderState {\r\n  wallet: InjectedSender;\r\n}\r\n\r\nconst isInstalled = () => {\r\n  return waitFor(() => !!window.near?.isSender).catch(() => false);\r\n};\r\n\r\nconst setupSenderState = (): SenderState => {\r\n  const wallet = window.near!;\r\n\r\n  return {\r\n    wallet,\r\n  };\r\n};\r\n\r\nconst Sender: WalletBehaviourFactory<InjectedWallet> = async ({\r\n  options,\r\n  metadata,\r\n  store,\r\n  provider,\r\n  emitter,\r\n  logger,\r\n}) => {\r\n  const _state = setupSenderState();\r\n\r\n  const cleanup = () => {\r\n    for (const key in _state.wallet.callbacks) {\r\n      _state.wallet.remove(key);\r\n    }\r\n  };\r\n\r\n  const signOut = async () => {\r\n    if (!_state.wallet.isSignedIn()) {\r\n      return;\r\n    }\r\n\r\n    cleanup();\r\n\r\n    const res = await _state.wallet.signOut();\r\n\r\n    if (res === true) {\r\n      return;\r\n    }\r\n\r\n    const error = new Error(\r\n      typeof res.error === \"string\" ? res.error : res.error.type\r\n    );\r\n\r\n    // Prevent signing out by throwing.\r\n    if (error.message === \"User reject\") {\r\n      throw error;\r\n    }\r\n\r\n    // Continue signing out but log the issue.\r\n    logger.log(\"Failed to sign out\");\r\n    logger.error(error);\r\n  };\r\n\r\n  const setupEvents = () => {\r\n    _state.wallet.on(\"accountChanged\", async (newAccountId) => {\r\n      logger.log(\"onAccountChange\", newAccountId);\r\n      emitter.emit(\"signedOut\", null);\r\n    });\r\n\r\n    _state.wallet.on(\"rpcChanged\", async (rpc) => {\r\n      logger.log(\"onNetworkChange\", rpc);\r\n\r\n      if (options.network.networkId !== rpc.networkId) {\r\n        await signOut();\r\n\r\n        emitter.emit(\"signedOut\", null);\r\n        emitter.emit(\"networkChanged\", { networkId: rpc.networkId });\r\n      }\r\n    });\r\n  };\r\n\r\n  const getAccounts = () => {\r\n    const accountId = _state.wallet.getAccountId();\r\n\r\n    if (!accountId) {\r\n      return [];\r\n    }\r\n\r\n    return [{ accountId }];\r\n  };\r\n\r\n  const isValidActions = (\r\n    actions: Array<Action>\r\n  ): actions is Array<FunctionCallAction> => {\r\n    return actions.every((x) => x.type === \"FunctionCall\");\r\n  };\r\n\r\n  const transformActions = (actions: Array<Action>) => {\r\n    const validActions = isValidActions(actions);\r\n\r\n    if (!validActions) {\r\n      throw new Error(\r\n        `Only 'FunctionCall' actions types are supported by ${metadata.name}`\r\n      );\r\n    }\r\n\r\n    return actions.map((x) => x.params);\r\n  };\r\n\r\n  const transformTransactions = (\r\n    transactions: Array<Optional<Transaction, \"signerId\">>\r\n  ) => {\r\n    return transactions.map((transaction) => {\r\n      return {\r\n        receiverId: transaction.receiverId,\r\n        actions: transformActions(transaction.actions),\r\n      };\r\n    });\r\n  };\r\n\r\n  if (_state.wallet && _state.wallet.isSignedIn()) {\r\n    setupEvents();\r\n  }\r\n\r\n  return {\r\n    async signIn({ contractId, methodNames }) {\r\n      const existingAccounts = getAccounts();\r\n\r\n      if (existingAccounts.length) {\r\n        return existingAccounts;\r\n      }\r\n\r\n      const { accessKey, error } = await _state.wallet.requestSignIn({\r\n        contractId,\r\n        methodNames,\r\n      });\r\n\r\n      if (!accessKey || error) {\r\n        await signOut();\r\n\r\n        throw new Error(\r\n          (typeof error === \"string\" ? error : error.type) ||\r\n            \"Failed to sign in\"\r\n        );\r\n      }\r\n\r\n      setupEvents();\r\n\r\n      return getAccounts();\r\n    },\r\n\r\n    signOut,\r\n\r\n    async getAccounts() {\r\n      return getAccounts();\r\n    },\r\n\r\n    async verifyOwner({ message }) {\r\n      logger.log(\"Sender:verifyOwner\", { message });\r\n\r\n      const account = _state.wallet.account();\r\n\r\n      if (!account) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      // Note: When the wallet is locked, Sender returns an empty Signer interface.\r\n      // Even after unlocking the wallet, the user will need to refresh to gain\r\n      // access to these methods.\r\n      if (!account.connection.signer.signMessage) {\r\n        throw new Error(\"Wallet is locked\");\r\n      }\r\n\r\n      const networkId = options.network.networkId;\r\n      const accountId = account.accountId;\r\n      const pubKey = await account.connection.signer.getPublicKey(\r\n        accountId,\r\n        networkId\r\n      );\r\n      const block = await provider.block({ finality: \"final\" });\r\n\r\n      const data = {\r\n        accountId,\r\n        message,\r\n        blockId: block.header.hash,\r\n        publicKey: Buffer.from(pubKey.data).toString(\"base64\"),\r\n        keyType: pubKey.keyType,\r\n      };\r\n      const encoded = JSON.stringify(data);\r\n\r\n      const signed = await account.connection.signer.signMessage(\r\n        new Uint8Array(Buffer.from(encoded)),\r\n        accountId,\r\n        networkId\r\n      );\r\n\r\n      return {\r\n        ...data,\r\n        signature: Buffer.from(signed.signature).toString(\"base64\"),\r\n        keyType: signed.publicKey.keyType,\r\n      };\r\n    },\r\n\r\n    async signAndSendTransaction({ signerId, receiverId, actions }) {\r\n      logger.log(\"signAndSendTransaction\", { signerId, receiverId, actions });\r\n\r\n      const { contract } = store.getState();\r\n\r\n      if (!_state.wallet.isSignedIn() || !contract) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      return _state.wallet\r\n        .signAndSendTransaction({\r\n          receiverId: receiverId || contract.contractId,\r\n          actions: transformActions(actions),\r\n        })\r\n        .then((res) => {\r\n          if (res.error) {\r\n            throw new Error(res.error);\r\n          } else if (res.response && \"error\" in res.response) {\r\n            throw new Error(res.response.error.message);\r\n          }\r\n\r\n          // Shouldn't happen but avoids inconsistent responses.\r\n          if (!res.response?.length) {\r\n            throw new Error(\"Invalid response\");\r\n          }\r\n\r\n          return res.response[0];\r\n        });\r\n    },\r\n\r\n    async signAndSendTransactions({ transactions }) {\r\n      logger.log(\"signAndSendTransactions\", { transactions });\r\n\r\n      if (!_state.wallet.isSignedIn()) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      return _state.wallet\r\n        .requestSignTransactions({\r\n          transactions: transformTransactions(transactions),\r\n        })\r\n        .then((res) => {\r\n          if (res.error) {\r\n            throw new Error(res.error);\r\n          } else if (res.response && \"error\" in res.response) {\r\n            throw new Error(res.response.error.message);\r\n          }\r\n\r\n          // Shouldn't happen but avoids inconsistent responses.\r\n          if (!res.response?.length) {\r\n            throw new Error(\"Invalid response\");\r\n          }\r\n\r\n          return res.response;\r\n        });\r\n    },\r\n  };\r\n};\r\n\r\nexport function setupSender({\r\n  iconUrl = icon,\r\n  deprecated = false,\r\n}: SenderParams = {}): WalletModuleFactory<InjectedWallet> {\r\n  return async () => {\r\n    const mobile = isMobile();\r\n    const installed = await isInstalled();\r\n\r\n    if (mobile) {\r\n      return null;\r\n    }\r\n\r\n    // Add extra wait to ensure Sender's sign in status is read from the\r\n    // browser extension background env.\r\n    await waitFor(() => !!window.near?.isSignedIn(), { timeout: 300 }).catch(\r\n      () => false\r\n    );\r\n\r\n    return {\r\n      id: \"sender\",\r\n      type: \"injected\",\r\n      metadata: {\r\n        name: \"Sender\",\r\n        description: \"Browser extension wallet built on NEAR.\",\r\n        iconUrl,\r\n        downloadUrl:\r\n          \"https://chrome.google.com/webstore/detail/sender-wallet/epapihdplajcdnnkdeiahlgigofloibg\",\r\n        deprecated,\r\n        available: installed,\r\n      },\r\n      init: Sender,\r\n    };\r\n  };\r\n}\r\n","export { setupWalletConnect } from \"./lib/wallet-connect\";\r\nexport type { WalletConnectParams } from \"./lib/wallet-connect\";\r\n","export default `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAir0lEQVR42u3deZxcVZn/8c9zbnV3dhIim6CMCIyK4rigM6S6AUEZcRu3EQGRJV0NmA3CYiASCGtkT0Do6gRB1AEFdRBRfrKYdAUU1JERl0FUUBCCQEL2dNc9398f1RGMZOmku+pW1/N+vfrVL0hX3adu3ee555577jngnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc85tO6t1AG7gTCimAcgBORO5JrNR5cDOpHqVjFcB4xGjgGZBi0ELgGCdwTqgB2Ml8LyJ5yyx55oiz6yTVsooQ+VncSGJtf6sbmB4Aahj+WI6CjHGAqMlxkvaG9gd2BV4tcFYwXAqib7+JwcEIOn7DRCBtO93mUoxWEelMKwRLAP+YvCU4Akze9SM5yVWAMtLhWRlrfeF2zpeAOrA269JGddESMXIXmMPxN6gPYE3AHtQSfoxQBOVBE/6fgZS2vdTBnqB5cATwB+A34I9hvFos+wPiWnVC2Xiz08a6BDcQPMCkFEHdaW2LmXc6BbGL1ujtyYJBxjsA7wa2AUYQeUMbtTue1TfTwRWA08L/gL8Ko0sHD/cHl7ew/PNxtJ72xPVep+6f+QFIGPaiuXtIrwV8c4oDuiJvL0lYTsqCV8vp9QUWL2uzIvNOX4eYCHGTxOzhxe2Jy/WOjj3Ei8ANZZfICONY016XYSPGPyr4E3ATlSa8/X+HYnKZcMS4NfAj834b7A/NjWFZfcda94yqKF6P7jqVuv8mChqb2B/SR8G3gVsb9AMlawZSuylz9QDvAA8aGa3G9xPsEe7J4a01jE2Ii8AVZa/Lh2jwD5InwLeA+xFJenDtr1z3YlUisHvgHvN7Bal/GrxicnyWgfWSLwAVEn+uvL2CuQRnwX+DdiR+rmmH2wp8CzwAIEbLVIqdeReqHVQjcALwCBq60oNY2xMdZjgU8ABwCga72y/pSKwElgI3BKC3YlY1l3wOwiDxQvAIJlQLI9FHAycCLwDGFvrmOrMMuBnwLWIexafkFtW64CGIi8AA2xCZzrcjAMkHQccCozG9/PWErACuMvMrpdYuLgjWVProIYSPzAHSOuX00Av+0RpCvBBKrfxfP8ODFG5jXiHYfOshUe6j/HnEQaCH6DbqLUrJcIOiCORTgD2xDv3BksKPIZxHcbXAvbX7nbf1dvCC8A2yHeWmzGbIHQ64gAqD964wbcGY6FhX0RaXOrI9dQ6oHrlBWAr5YvlHSXagZOojM33fVldAp4GvmRGV6mQe7bWAdUjP2j76aAFaa6nrP2AmcDB9D1T72pmHXCPxPktTfbQfccn5VoHVE+8APRDa1ccgeLRUZxB5RFc33/ZIIknksAcS8JXFh0fVtc6oHrhB/AW2r+z/BozOx3paCrP3rvsWY7ZV2LUFx84IffnWgdTD7wAbMaB16ekqd4dIxcAbVQm3XDZ1QssCoGzkiT85EfH+aDLTfECsAn5zjQH/LvQJcDe+BDeehGBRw07zbAfdHcE7xfYCD+gNyJfTIcDxwl1Upl6y/dV/QjAG4Q6hY7r+y7dK/AWwCt419x0TFOLpgOTgXG1jsdtk6XAvN4eu+zByf6o8Ya8AGzggC+n43rWalYItFOZhsvVv9VRdCVNdm7p+GRprYPJEi8AL3Pg/PJOa3s4LyQcbX5/f0iRWBcjNw1vYuZ97bkltY4nK7wA9Jkwv7yzUi4HPmF13NMfBeFl36qAcgpNyd+m9P7bb6v8Ri9NJf63370pSRJeei8B2uC961CvxK2W45TFE3PP1DqYLKjvr3OAtHalu8aoy4GPUUmCutQbiS2JlctRyxNjCfBMqrDko29iyW2/1vNNQasQazBbA6xBVAbMGCOA4UjDBcPX9NrID+xt4+/6vXZqTrRTjOws2KkpsTHlVDmzuu4QLQPfMrNTSoXkqVoHU2t1e7APlLZiulsadSXwH9TfU3xl4EXMXgQeXdXDT47cz375jV/ynNALZryQRlv26X1Z941HpKbwd3ONbjjLzt9OBr0R+9S+Zj/4vbUY6dhyZPvRw2z7T+5jr+r6KW8ZluPdGHsjbQdsR30dRzng45KStmI6bVEhebLWAdVSQ7cAWrvS3RQ1V/Bh6if5o5k9jfgZ8AsZP7dgv1TU0hdWs/o305J1g7nxt12TtozIMcIC4yTeYuLtwL9gvEPSLtTP7dIUuL1njU15aFrjFoGGLQD5+ekuRK6V9EGymvwCGVhldNvzhv0KuBPjp0H2y4hWAGmpozZz5uU7UwMSMxst9BbgnYjDhPYBxguaTGT5KEt713Lbjq+zE+74cGPeHcjuVzOI8sW0GXGh0FSy2nwVpCm9LYn9L8ZdqfFdxGNmtrS7kM059PNdMSFqHMaeQXwoikPLUfsmgaasHmkS6xQ59YGTclfXOpZayOjXMrjyxfSNkr4HvK7WsWzE8rRs//u6t9jNz/2eu6yXP60yeha310frev+uyEjRXE702vGvs0Of+rUOD03sC8rqQ1Q/TCy8f1FGC+tgyubZb5AJvZbKnH3ZYiw3bDHiJiKLxo+3p/+rzepu7rv7K4WqB3js+P/VH56SvmPQhtlnhCagbD1NaTAqVMZ9NNxjxA1ZAKisa7+GjIz0M1hn2M8iXAf2PYxlP54c4o9rHdgAWLCvReCpfDHeYnCX4AOGnSDiO8jMYCt7MoiGnG24MS8BOuM4KX4T4+AahyLMHmsRN4yx8PUlxCceGOKLYLyrmNpOhN2XKx5RNo5B2pMaHoflXp4jDYf/ZGq4p9b7phYaswUQbGnSZBeka7Q3gddUe/MCElgGdnMM1pVGHvlOwRpiYssHKwXu8QnFeCmmHwRZO+jwWOWFUwSUe1k+aqxdPHwY3bXeL7XSkC0AgENuVbJuafxoGnW5UdUioNTsVzvKLlpldvs9BVtZ631RS+8valSL9OElQTNC1D5U6ZgsR160aBdMPTRc8+k9reGu/derj27lQXD3JywdvnP4zkhsWoQnqrTZtQG71UI40uCWRk9+gO9X9sEtwcKRAbsVWFuFzS4Ngdl/Xc28Rk5+aOAWwHqfvl7JE7n4wbhMV4RmXmeDtkfsaTNdYbIbYhL+unhiw+/6v5OfLyyNO8h0jGQng3YZpE29AHZuZSpxX2bMj0Lg/d9Uohjf/9yzujKX4/XJALaLYgpNOXskYqeB7i0Vkoa41t9a+WLaDPYeQ5eUy3pzGNgxms8Zdi6V5B/UIdP1wgtAn9k9MSy8Tf++6nldGXLsNRAtAUVi83AeSMrhFGQP3dNuQ7qHf6C8p0sW0X4xiZeX1/JvlgzIpepfDfsCxo2lQlKNy4y60LB9ABs6uznEc99jd40bbpPK4rfb/IZGGiN37PPu0G7N9qAn/5a7t91kOXtwz3eE9phyB5UHd7bFs4adBXzZk//veQF4mfxOIX1qFXcHsynAb7b+nazH4CuSTRoxgt/cfbQ3tPrrvmONUWP5jcwmmfEV2OrbpM8Y9nngxlKHX35tyI/MV5AvpgE4QNJc4M39e7WtNbPrQBeUCslztf4sQ0G+mL4K7CykE4SG9eOlzxicDnZzqSPprfXnyCIvABvRVwRaJc2jUgQ2u6/MbB3YPIPzuwvhxVp/hqGktRi3E8wETZa02SHEBk+ZcYbEN0odOU/+jfACsAn5YhoQ+wvNBd62yT82W2Nm84ALSu3Bp58eBK1dcYzEWUiThTYx1789ZabpBrd1F3K+KMgmeAHYjHxnGoB3C11NpQj8wz4zbK0Fu1xwcak9rKh1zENZvhhHG3w+SqfwipcD9ifMTgV9e3HBVwreHC8AW6Bv5pt3AfOE9vv7f7U1wewyM+Ysag8NP7KvGtq64qgonSExnZe1BMzsT4adLLi9VPDlwLaEF4At1FopAm8XXCP0ToMEbJVhl2Bc2l0Iq2odYyPJFzVSpukW41TBSDN73LAzDLtjUcEabmKPreUFoB9aO8sG9mbBJGCPgN0a4Ks/6vDkr4XW6zV8mOmAtb3sZsb/gP1iUbsnvxtk+c50VL4zHd/WGRvzceqMaeuSj2fZSplvAUwolltMNprKdNgrugvBb+kMgNautFnS6Mp/2Qp/RmFgtBZjU99+DRgrsv7MQWYLwFHdMfz+Yf1L0qyPI96qyui6BzH7BtgfSoXMhp5pbTdF0zq9UZFPIr0DQNhPLXBr04jwm/uO9CHLWyNfjCD2AP0n8C5QM8bDaa/dtu9+9ovOd4VMzu2YySyacFPaFNbpY2kvMy3wBl6at7/XzB4EO92wH3cX/GDtjwMWKInSexXj+RL78tKMUGWMh5MkfCEE++GPjvXr6P5oLcqE/hXpi0Lv4qW1JVNFfps0cX6uxW677zPZuy2ZuQJwyH+luTVLdXg05oTAq185aHvEzE7CrNTtD9lskYPmx5CK90fFedIrT4duxh+DhclJ4Pv3HZ/NM1bWtHXJJOUlfUnoFYeNx8hfcpHTW7a3W+7+dLaKQKYKQFtX2hSlI2LkYjN23sSfyrDfWLCTkHV3F+pv6uxqOmB+TKL4gKS5knbf1N+a2RNmNiUY31s4sfHmye+P1i4FUKuiviT0RjaRTxLPEPh8YuHr3e3Z6cfKTO9p2/y0KUZ9RmLOZpIfwITepKhrkQ5sK3ov8Ma0VpL/Q5LmbS75ASTtLmleFB9qXRCzuWRaBrR1KSAdqKhrhd7EZk6mZuxMZI4Ujzroy2lmlp/PROIc0pU2xajPCi6mHwt2CL1R6EtCB7cWYyY+S5a0dSmR+Ejfmf+1W/o6Sa+VNFeRjxzQJS8CG2gtxiDp4L5m/xu39HVm7CQxp7dXnz24KxtFoOaXAK0L0malOlbifOBVW/ch7FGMKWbc3d2eeLMVyBdjYvCxqHgFsOtWvs1TwcLJgm+VGnDZrFfSWkwTYYcgzRXaeyvf5jmDmSHYlxe11/b2a03Pmm3zY3NMmShxIVuZ/AB9X8TVSIe2FssNf8bKF2MO+KTQtiQ/wK6SrgA+2feeDa1ybOlQpKu3IfkBXiW4UGLiQV2xuZafqWYtgNau2ILUHqXZwLgB+TDGH4BpwJ2lQq4hz1itxZgTfAp0qaTN9aVsEcOewezUALcsatCHbFqL5URwGHClxB4D8Z4GS83sbDPrWtQeajJgqCYtgHxnbJZ0gqTzGKDkB5DYQ3Al8KF8MW24lkBrV8wBn0YDl/wAQjsjXSo4om8bDaW1M00EH5IGLvkBBOMknSfphHxnbVoCVW8BtBZji6TPCZ0NbDdIn+pPhk0XfKdRngnPF2MTcCTSxUKDsvKxYc9idgbwtVKDDMnOd6Y54CMyXY7Y4o7U/jB4EWy2mV3TXahuS6CqLYB8MR2mymwusxis5AcQr5V0KfDxfDEd8mesfFdsAo4WmjNYyQ8gtKOkOcDRfdsc0iZUjp2PC102WMkPINhOaJakyfli7M+ch9usagVgv2vjMMTUvjN/NdaH3x3pMuA/88Vs3HIZDPmu2Iw4VtJFSDsO/ha1Y2VbHJuvcQfWYOo7Zv5T6FJgs+MnBsCYSm5o6lvmVq8IVKUA3ParmCunahf6AjC6Wh+OSi/2F4HDW4dgEch3xhak4yRdCNqhelvWDpIuRByXL6abnaCz3vQdK4dTOXZ2q+KmRyN9oTdV+zd/WZ2+lqoUgBt/Hg9rSnQGMLIa29vArpLmRDhql4uHThHIF8stoHZJ54PGVz8CjZfi+YhCJZahYa/L06YIR/Vd6mzLLdStIhg5qlln3PSLeFg1tleVAvDsSgpNgcFa7HFL7CLporHDOPoPz6vum635Ynk40CF0HlCD5P+b8UKzgY6+mOraY8+pebsWjpZ0EdTueG3JscuSlRSqsa2qFIAk2J7V2tZGiZ1GNuvCGx6Kx/58Zf0WgQmd6XDgJIlzgLG1jgcYK3GO4KS+2OrSouVqvv6heGwSdCH9GI4+SEKukjODv6EqfaCHgJrejjOD5oQd7/qdzrvgAU084rv9WmEmE/Kd6QhgksTZDOD4iQEwDnE2xqS+GOvKrJUadtViTbzvjzovMXas+fj4Sq48VI0NVaUAWLBrDP6vGtvaZBxAaGKHJx+Ls59dosL779z8CjNZke9MR4GmgmZSnbso/TUGaSZoaiXW+vChb8eW/7lbhScfj7MtsMNArAq9rQz+z4JdU41tVaUABPGgmZ0NPF2N7W0yFoPEGL+mN85aviyeeGyV77tujXwxHQk6WTCDbCb/emMqMerkSszZNvG6OGzp6njic0/FWYkxPgvJDzxtZmcH8WA1NlaVArCoEGJOdnswTgH+Uo1tbooZENheyzVrielz7/3v7F4O5DvTMUinCk6nurdQt9ZowemSTpvQmWa2WB3yLQ37S9Dn4gpmWY7tM5L8fwnG9BDs9kWF6szIVNWP/Z4b0mRtjz5u4jKqe391U3vgxZDYRaNSu+r7hZCptePzxXQ00hmCqUDdNKv7rATmGjan1JFkaq3ED34tDlu2RlMVNQMN4ojUfpB40gLThzXbbfccU71H2qvaM3/vMUk6jPAtg2kSf6rmtjdKbBfLOnMtcdqhN8TMdGC9dW46FulMwcnUX/LTF/M00Iy3zk3H1jqY9d53QxyxpidOi2WdmaHk/1Mwpg0jfKuayQ81uDV3byGUx4yybxOYJvF4tbe/EWN64ayeXk0/pBhrfiur8ydxbBJ0lmAKkJmitBVGCKbkEp01d3EcW+tg3luMw3t7NX1tL2eZZaMvReJxEqaNGW3fvqcGj1rX7Mrn0K/FZMWKeBhwpdnAPWK5jTtjVWL2RRK7bOHxtVnua/bP4rj7f6GZS3t0Ui6Q2b6J/uhJWTsmZ186ZH87f8abw9JaxHDg/DhSqaan6HTVZkTqP4iRPwZj6shx4c7/96nazLhU066Pj10Xw1NJPCzp5UpLeH0tY/nbDjFWh2CXEWzOouOqWwQOuzFuv1xxVs8qCk25oZH8AALKZdY2jaA4ujmc+4MjwwvV3P5BXXFElD6fStOVkRaVyvw+NjNtj55w59c/V7sp2Gve99l2S0x6no/vLUeuamliW6ZZGridYrbGjMsTbM6P2sOKamzzfV9Jx69Yq3MpMzEk1M34hP6IZdbRbPNHtdisHx4dnq/GNg/siqNTdAaRU+LLlhKvFQFr1vHosISpzTuGHy78ZG3nWqx5AQA4/ncx/OaH8ZC1kbnDK0Wg5nGZ2VrDrjS4cFFhcIvAYTfGHVatibN7jeMM6naY8paI0NMcuX7UCDv7e59N/jqY22orajTozIimSbW/1Suh1b08OjrYlL3eZ3dfv1ftF1+peaKtd/sjMVzQHQ8CrsoF9ql1PACGrTWzeYLzS4UwKLeyDr45vmrtinihIsfYS0tKDWmCXgvcMHx0OPPuw8Nzg7GNfDGOMZjZNwFNzZMfYG2ZX6WRadcdmtz7r3tnYzGbzMyl/+E3h5jK7jOzScAjVFpLNSU0TNIU0Ky2rjjgt4wOLcadelbEOY2U/AAGTYocs25FnPO+YjrgD960FeN2VGbYmZKR5BfwSGI2eVWPZSb5IUMtgPXyxdSAVklzgX2zEKOZrTO4NgQ7d+HEsGwg3vPAG9Od0rWak8IRjZT8LyfoTeDrYZidsfCzyZKBeM8D5sexMWqWxIkiE896CPilYZMNurs7kpqf2F6u5sn1SlqLaZD0b4J5wL9kIU4z6zHjOiyc0z3RtulW1oHXp7ukqebEyKd5aYXeRlUOgZtDYqcvPC7ZpmdFWudrHIrnSJwgZeKRbwEPA5MNu7/UkWTmzL9ezRNrY/KdqYH+ta8IvD0LsZpZD9j8gH1hUcG26lbWQV1xl7J0WZQ+iSf/emUL9s0cNv1H7WGrikBbUdtHNLtvlqSsJP/PgSlm9kCpkK0z/3o1T6pN6SsC7xRcDeyXhXjNrCdg12M2c1G79etW1oHz467lqMskfRxP/g2Vzey2JNj0hRPDU/15Ydt8jSfq/CgdJzKT/A8Bk83soawmP2QgoTYn35kieCfGPKR3ZyFmw3oxuwE4q1QIW3Qr64AFcTdFXRGjPiqo+aIl5UgMxpOh8oF2IxsdwmkI9u0Q7OSFx4cnt+QF+a64g4kLhI6RlIW+FGH2E8Rk4KeLO2r+VW9SFr70TSp1JJjxM0MnAveTjbsDTUjHABe1FuNmp+JuW5C+JkbNjcpG8kcRmwL3tDSFjw1vCR+TuAfIwvVpEqM+GqPmti1IX7O5P27tijsiLpIylPxwv6ETzfhZ1pMfMnA23VL5YhmwfYWuQexPBoqXYWXgq2Y2o7sQnnmlv2mbH3eP0lxFfTALMQNpb+SHu29nU795RPIowITOdG/QVcB7yUCBAqKZ3ZEEm7JwYnjilf6gtRh3FroIcZRQFi6nIsb9YJMMPVwqZCGkzaubAgCQ7ypD5M19fQJtWYjfsF7gZjM7o7vw9x1YbV3xnyTNk3SYMpL8wF0Rpj3Qkfvdy/9hQmd5L+AK4N/JSBEIZncim9zdER5/+T+0FuMufdN2Hy4yc+ZfZDCp1JF7pNbB9EcWDsotVmrPAfYIZieC/YgMNFv7DsAjBJe0FuOr1///tmJ8XZSuzljy32lmU4LZ7/7hX81+hzEV+F7f39ZaiNJhQte0FuPfnhbt28eXAEdkJPlj5Vi0kzCrq+SHDJxBt1a+mL5BYh7oPWQgwcysDHYr6ELDckIXSnpfFmKjMsvsd4FTF3fk/rCpP8x3lvcQXAp8iGzcqYiG/dDMZgiVwc4EfULKSrPf7jWYXCokv611MFujbgsAQL4Y9wJdLelgstFsTYFfUxnZtzfZSP7UsG8JTl3ckWzRLEz5zvS1oEsFHyUjRQB4FOgF3kRGvmszuwdsUqkQfrftb1cbdV0AAPLFuGdl2LAOJRsJlyVlM/sWcGqpkPy5Py/Md6avAS4RPmbhFUQzuwtsSqkQHqt1MNui7hOmVAiPGXwO7Ptk49o1K8rAN4BT+pv8AKWO5M+g6X3vUdNFXTImNez7Znyu3pMfhkABACh1JH80YxLYnXgRAOg1s5vNOK1USPo1qu7lSh25pwxOM7ObqTS/G11qZndiTOpuT/5Y62AGwpAoAAClQvJ4XxH4Lo1dBHoN+5qh00qF3DavwVDqyP0FdJphX6Oxi0Dad2xNKhWSx2sdzECp+z6ADU0opruZuEroI2Sjs6iaes3sJmBGqZA8O5BvPKGY7mhwkaTP0HiPL6dg/23G1FIh2aIhyvViyBUAgNauuKukKyV9lIYpAtYb+p5P6N7C5xP6q7UYd0BcENExZOMefDWkZvZtM5vW3d6/h5TqwZC5BHi57vbwFGZTzLiVxujA6jGYD8wYrOQH6HvvGX3b6qn1h66Cshm3YjZlKCY/DNECAFBqD0+DTTPjmwztIrDOsC7MZnYXBn+m3e6O8DxmMw3rAtbV+sMPorIZ38RsWmkr5yioB0O2AACUCskzATvZ4GaGZhHoMazTzGaWCtWba79UCC+Y2Uwz62RotgTKGDcHs5NL7ckz2/522TUk+wA2lO9KdyDqUsERDJ1BLWsN6wSbVeoIL9YigHxl8s1zJJ0AQ2Yhk7IZX0+Cnbpw4uBOW54FDVEAANq64g6p4hzEUdR5L7Zh6wy72oxzB3vNgs1pK8bRglmSJmVkEs5t0YvZV0OwM7onDl5fSpY0TAEAyBfL2yO+KPgM9bsAxxqzcLWJ2d0dYWWtgwFo64qjJL4QFScDNV99Zyv1GNxECKeX2qu7dFktDek+gA2VCrkXcsbpMr5MfV67rjGzqzDOzUryAyxqDysFsw27ClhT63i2Qo/gy7mcndFIyQ8N1gJYL18sj42RC8w4HupmHb7Vhl0Rgl20qL02KxdvzgHFOCJFMySdQkYW4dwciXWIBUngrO6O3LJax1NtDVkAAA5aUB67pofZwWg3y3wH1upgdqmwOaVCWF3rYDYl3xVHIJ0haToZWYZ7YyTWRtE1vMnOvm9isqzW8dRCwxYAgHxnebtUOsfMTrCM9mIbtgrjklzOLvnRcdlO/vXaFsQRsaxThU4nq0VArE2lztBks+6fmKvJXZQsaKg+gA2VOnIvDk85O4prEJlLLoOVmF0csDn1kvwAi44Pq5NgXzQLFwOZ6atYT2J1CteMSe0LjZz80OAtgPXefX06hpU6KzQzKVhmrl1XBLOLAnbFwkJYW+tgtkZbZxwmdHJEM4DRtY4HII2spperGWEX/HhiMigrPtcTLwB9JtyUjlzxvM4a1sKUplDzZutyMy5sDslV9060ukz+9Q7q0rBepVMkzgLG1DKWdWVWlXuYO3oHu6D7qCSTHanV1tCXAC+3+DPJqt1GcmFPmcul2jVbBcuCMXtYc7ii3pMf4L52W9vcFK60wGxgWa3iKEdW9qRc/s6d7EJP/pd4C2ADb7s6HdGc6LRcYDrVb7YuJdh5I82+9P8mhiH1oE3bV2NLXBVPjHC2wbgqb37FujKXLVtnlzx2SlI3fSnV4AXgFeSL6QiJaVR6sberxjYlXghm54weaZ3fPyrU4yClzfrATbHpxTU6IY06JxjbV2mzLxpcgtkVpYIn/4a8AGzEhM50OGgKMINBLgIx8nzSZGdLtmBx+9A682+odUFsIcbjyymzgzF+kDf3InCxmV1VKiT1OEJx0HkfwEYs7kjW9A1tPR9YOljbiZHncsbM3ZPQNdSTH6D7+LBuVwtdZsyMYjAfuFkKnA92pSf/xnkLYDPyxXRY3+OuZzOQ166Ccplnc5GzwuvDjd0fCA014eb+d8Wm+Gj8LIELkhybXWG5n5YZzAa7ttSR1H1H6mDyFsBmlArJWsyuxZgFDMiMOwJWrWXJsNE24/V7hxsaLfkB7j809P7z28INueH2+ZWrWTKAb/08MAvsS578m+ctgC2UL6bNguORzoNtu3Zd2cPTOw+zz//zR+zrc3cMQ3Gmoi12/P8p9+TCeMQLqS5uDuyyjW/3PNjZwILFHcmQv5waCN4C2EKlQtJjaIGZnQlbf+1q8PSasp122B6e/AAL/tnKH97Lvt6b2mnAtsy991czO9NM8z35t5y3APopX0ybEEcLXQTs0M+XP2lw2qqy3fo/n0saPvlfbr9r01xLwickXQLs1s+X/9XMZoC+UirkGu5yalt4AdgK+WJsknQk6GJgpy182Z/N7BTgO6WCJ/8ryRfTHOI/hC4HXrOFL1ti2Ocx+1qp0Hh9KdvKC8BWynfGHOjTQpew+SLwuGGnYNxeKiSNvGzZZuU700TwYSpF4J828+dLzOw0sP8qFfxyamt4AdgG+WJMQJ+SdBmw80b+7HHDpgLfK3V48m+JCZ1pYvABoavYSBEweAbsVILdUmr35N9a3gm4DUqFkJqFWzCbAvyev1+UtGzwiGEnAXd48m+5xR1JinGHmZ0EPMLfr+mQAr/HbCoWbvbk3zbeAhgAE7oUAulb08gJwexNSBGzhw2ulfhtqSNRrWOsR63F1IA3SDoReCtmQdKvE6xTwX7R3R5irWOsd14ABtD+16UjRjeHsWvSSBRLfQjqwMgX0+G5xMY1AytTLbvfH+pxzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOeecc84555xzzjnnnHPOOecy5f8DP47LVlAysbUAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDYtMjNUMTQ6MzU6MDkrMDA6MDD1AeMiAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA2LTIzVDE0OjM1OjA5KzAwOjAwhFxbngAAAABJRU5ErkJggg==`;\r\n","import Client from \"@walletconnect/sign-client\";\r\nimport type { SignClientTypes, EngineTypes } from \"@walletconnect/types\";\r\nimport QRCodeModal from \"@walletconnect/qrcode-modal\";\r\nimport { SessionTypes } from \"@walletconnect/types\";\r\n\r\nclass WalletConnectClient {\r\n  private client: Client;\r\n\r\n  async init(opts: SignClientTypes.Options) {\r\n    this.client = await Client.init(opts);\r\n  }\r\n\r\n  get session() {\r\n    return this.client.session;\r\n  }\r\n\r\n  on<Event extends SignClientTypes.Event>(\r\n    event: Event,\r\n    callback: (args: SignClientTypes.EventArguments[Event]) => void\r\n  ) {\r\n    this.client.on(event, callback);\r\n\r\n    return {\r\n      remove: () => this.client.removeListener(event, callback),\r\n    };\r\n  }\r\n\r\n  once<Event extends SignClientTypes.Event>(\r\n    event: Event,\r\n    callback: (args: SignClientTypes.EventArguments[Event]) => void\r\n  ) {\r\n    this.client.once(event, callback);\r\n  }\r\n\r\n  async connect(params: EngineTypes.ConnectParams) {\r\n    return new Promise<SessionTypes.Struct>((resolve, reject) => {\r\n      this.client\r\n        .connect(params)\r\n        .then(({ uri, approval }) => {\r\n          if (uri) {\r\n            QRCodeModal.open(uri, () => {\r\n              reject(new Error(\"User cancelled pairing\"));\r\n            });\r\n          }\r\n\r\n          approval()\r\n            .then(resolve)\r\n            .catch(reject)\r\n            .finally(() => QRCodeModal.close());\r\n        })\r\n        .catch(reject);\r\n    });\r\n  }\r\n\r\n  async request<Response>(\r\n    params: EngineTypes.RequestParams\r\n  ): Promise<Response> {\r\n    return this.client.request(params);\r\n  }\r\n\r\n  async disconnect(params: EngineTypes.DisconnectParams) {\r\n    return this.client.disconnect(params);\r\n  }\r\n}\r\n\r\nexport default WalletConnectClient;\r\n","import {\r\n  InMemorySigner,\r\n  KeyPair,\r\n  keyStores,\r\n  transactions as nearTransactions,\r\n  providers,\r\n  utils,\r\n} from \"near-api-js\";\r\nimport { AccessKeyView } from \"near-api-js/lib/providers/provider\";\r\nimport type { SignClientTypes, SessionTypes } from \"@walletconnect/types\";\r\nimport type {\r\n  WalletModuleFactory,\r\n  WalletBehaviourFactory,\r\n  BridgeWallet,\r\n  Subscription,\r\n  Transaction,\r\n} from \"@near-wallet-selector/core\";\r\nimport { getActiveAccount } from \"@near-wallet-selector/core\";\r\nimport { createAction } from \"@near-wallet-selector/wallet-utils\";\r\n\r\nimport WalletConnectClient from \"./wallet-connect-client\";\r\nimport icon from \"./icon\";\r\n\r\nexport interface WalletConnectParams {\r\n  projectId: string;\r\n  metadata: SignClientTypes.Metadata;\r\n  relayUrl?: string;\r\n  iconUrl?: string;\r\n  chainId?: string;\r\n  deprecated?: boolean;\r\n}\r\n\r\ninterface WalletConnectExtraOptions {\r\n  chainId?: string;\r\n  projectId: string;\r\n  metadata: SignClientTypes.Metadata;\r\n  relayUrl: string;\r\n}\r\n\r\ninterface LimitedAccessKeyPair {\r\n  accountId: string;\r\n  keyPair: KeyPair;\r\n}\r\n\r\ninterface LimitedAccessAccount {\r\n  accountId: string;\r\n  publicKey: string;\r\n}\r\n\r\ninterface WalletConnectAccount {\r\n  accountId: string;\r\n  publicKey: string;\r\n}\r\n\r\ninterface WalletConnectState {\r\n  client: WalletConnectClient;\r\n  session: SessionTypes.Struct | null;\r\n  keystore: keyStores.KeyStore;\r\n  subscriptions: Array<Subscription>;\r\n}\r\n\r\nconst WC_METHODS = [\r\n  \"near_signIn\",\r\n  \"near_signOut\",\r\n  \"near_getAccounts\",\r\n  \"near_signTransaction\",\r\n  \"near_signTransactions\",\r\n];\r\n\r\nconst WC_EVENTS = [\"chainChanged\", \"accountsChanged\"];\r\n\r\nconst setupWalletConnectState = async (\r\n  id: string,\r\n  params: WalletConnectExtraOptions\r\n): Promise<WalletConnectState> => {\r\n  const client = new WalletConnectClient();\r\n  let session: SessionTypes.Struct | null = null;\r\n  const keystore = new keyStores.BrowserLocalStorageKeyStore(\r\n    window.localStorage,\r\n    `near-wallet-selector:${id}:keystore:`\r\n  );\r\n\r\n  await client.init({\r\n    projectId: params.projectId,\r\n    metadata: params.metadata,\r\n    relayUrl: params.relayUrl,\r\n  });\r\n\r\n  if (client.session.length) {\r\n    const lastKeyIndex = client.session.keys.length - 1;\r\n    session = client.session.get(client.session.keys[lastKeyIndex]);\r\n  }\r\n\r\n  return {\r\n    client,\r\n    session,\r\n    keystore,\r\n    subscriptions: [],\r\n  };\r\n};\r\n\r\nconst WalletConnect: WalletBehaviourFactory<\r\n  BridgeWallet,\r\n  { params: WalletConnectExtraOptions }\r\n> = async ({\r\n  id,\r\n  options,\r\n  store,\r\n  params,\r\n  provider,\r\n  emitter,\r\n  logger,\r\n  metadata,\r\n}) => {\r\n  const _state = await setupWalletConnectState(id, params);\r\n\r\n  const getChainId = () => {\r\n    if (params.chainId) {\r\n      return params.chainId;\r\n    }\r\n\r\n    const { networkId } = options.network;\r\n\r\n    if ([\"mainnet\", \"testnet\"].includes(networkId)) {\r\n      return `near:${networkId}`;\r\n    }\r\n\r\n    throw new Error(\"Invalid chain id\");\r\n  };\r\n\r\n  const getAccounts = () => {\r\n    return (_state.session?.namespaces[\"near\"].accounts || []).map((x) => ({\r\n      accountId: x.split(\":\")[2],\r\n    }));\r\n  };\r\n\r\n  const cleanup = async () => {\r\n    _state.subscriptions.forEach((subscription) => subscription.remove());\r\n\r\n    _state.subscriptions = [];\r\n    _state.session = null;\r\n\r\n    await _state.keystore.clear();\r\n  };\r\n\r\n  const validateAccessKey = (\r\n    transaction: Transaction,\r\n    accessKey: AccessKeyView\r\n  ) => {\r\n    if (accessKey.permission === \"FullAccess\") {\r\n      return accessKey;\r\n    }\r\n\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    const { receiver_id, method_names } = accessKey.permission.FunctionCall;\r\n\r\n    if (transaction.receiverId !== receiver_id) {\r\n      return null;\r\n    }\r\n\r\n    return transaction.actions.every((action) => {\r\n      if (action.type !== \"FunctionCall\") {\r\n        return false;\r\n      }\r\n\r\n      const { methodName, deposit } = action.params;\r\n\r\n      if (method_names.length && method_names.includes(methodName)) {\r\n        return false;\r\n      }\r\n\r\n      return parseFloat(deposit) <= 0;\r\n    });\r\n  };\r\n\r\n  const signTransactions = async (transactions: Array<Transaction>) => {\r\n    const signer = new InMemorySigner(_state.keystore);\r\n    const signedTransactions: Array<nearTransactions.SignedTransaction> = [];\r\n\r\n    const block = await provider.block({ finality: \"final\" });\r\n\r\n    for (let i = 0; i < transactions.length; i += 1) {\r\n      const transaction = transactions[i];\r\n      const publicKey = await signer.getPublicKey(\r\n        transaction.signerId,\r\n        options.network.networkId\r\n      );\r\n\r\n      if (!publicKey) {\r\n        throw new Error(\"No public key found\");\r\n      }\r\n\r\n      const accessKey = await provider.query<AccessKeyView>({\r\n        request_type: \"view_access_key\",\r\n        finality: \"final\",\r\n        account_id: transaction.signerId,\r\n        public_key: publicKey.toString(),\r\n      });\r\n\r\n      if (!validateAccessKey(transaction, accessKey)) {\r\n        throw new Error(\"Invalid access key\");\r\n      }\r\n\r\n      const tx = nearTransactions.createTransaction(\r\n        transactions[i].signerId,\r\n        utils.PublicKey.from(publicKey.toString()),\r\n        transactions[i].receiverId,\r\n        accessKey.nonce + i + 1,\r\n        transaction.actions.map((action) => createAction(action)),\r\n        utils.serialize.base_decode(block.header.hash)\r\n      );\r\n\r\n      const [, signedTx] = await nearTransactions.signTransaction(\r\n        tx,\r\n        signer,\r\n        transactions[i].signerId,\r\n        options.network.networkId\r\n      );\r\n\r\n      signedTransactions.push(signedTx);\r\n    }\r\n\r\n    return signedTransactions;\r\n  };\r\n\r\n  const requestAccounts = async () => {\r\n    return _state.client.request<Array<WalletConnectAccount>>({\r\n      topic: _state.session!.topic,\r\n      chainId: getChainId(),\r\n      request: {\r\n        method: \"near_getAccounts\",\r\n        params: {},\r\n      },\r\n    });\r\n  };\r\n\r\n  const requestSignTransaction = async (transaction: Transaction) => {\r\n    const accounts = await requestAccounts();\r\n    const account = accounts.find((x) => x.accountId === transaction.signerId);\r\n\r\n    if (!account) {\r\n      throw new Error(\"Invalid signer id\");\r\n    }\r\n\r\n    const [block, accessKey] = await Promise.all([\r\n      provider.block({ finality: \"final\" }),\r\n      provider.query<AccessKeyView>({\r\n        request_type: \"view_access_key\",\r\n        finality: \"final\",\r\n        account_id: transaction.signerId,\r\n        public_key: account.publicKey,\r\n      }),\r\n    ]);\r\n\r\n    const tx = nearTransactions.createTransaction(\r\n      transaction.signerId,\r\n      utils.PublicKey.from(account.publicKey),\r\n      transaction.receiverId,\r\n      accessKey.nonce + 1,\r\n      transaction.actions.map((action) => createAction(action)),\r\n      utils.serialize.base_decode(block.header.hash)\r\n    );\r\n\r\n    const result = await _state.client.request<Uint8Array>({\r\n      topic: _state.session!.topic,\r\n      chainId: getChainId(),\r\n      request: {\r\n        method: \"near_signTransaction\",\r\n        params: { transaction: tx.encode() },\r\n      },\r\n    });\r\n\r\n    return nearTransactions.SignedTransaction.decode(Buffer.from(result));\r\n  };\r\n\r\n  const requestSignTransactions = async (transactions: Array<Transaction>) => {\r\n    if (!transactions.length) {\r\n      return [];\r\n    }\r\n\r\n    const txs: Array<nearTransactions.Transaction> = [];\r\n\r\n    const [block, accounts] = await Promise.all([\r\n      provider.block({ finality: \"final\" }),\r\n      requestAccounts(),\r\n    ]);\r\n\r\n    for (let i = 0; i < transactions.length; i += 1) {\r\n      const transaction = transactions[i];\r\n      const account = accounts.find(\r\n        (x) => x.accountId === transaction.signerId\r\n      );\r\n\r\n      if (!account) {\r\n        throw new Error(\"Invalid signer id\");\r\n      }\r\n\r\n      const accessKey = await provider.query<AccessKeyView>({\r\n        request_type: \"view_access_key\",\r\n        finality: \"final\",\r\n        account_id: transaction.signerId,\r\n        public_key: account.publicKey,\r\n      });\r\n\r\n      txs.push(\r\n        nearTransactions.createTransaction(\r\n          transaction.signerId,\r\n          utils.PublicKey.from(account.publicKey),\r\n          transaction.receiverId,\r\n          accessKey.nonce + i + 1,\r\n          transaction.actions.map((action) => createAction(action)),\r\n          utils.serialize.base_decode(block.header.hash)\r\n        )\r\n      );\r\n    }\r\n\r\n    const results = await _state.client.request<Array<Uint8Array>>({\r\n      topic: _state.session!.topic,\r\n      chainId: getChainId(),\r\n      request: {\r\n        method: \"near_signAndSendTransactions\",\r\n        params: { transactions: txs.map((x) => x.encode()) },\r\n      },\r\n    });\r\n\r\n    return results.map((result) => {\r\n      return nearTransactions.SignedTransaction.decode(Buffer.from(result));\r\n    });\r\n  };\r\n\r\n  const createLimitedAccessKeyPairs = (): Array<LimitedAccessKeyPair> => {\r\n    const accounts = getAccounts();\r\n\r\n    return accounts.map(({ accountId }) => ({\r\n      accountId,\r\n      keyPair: utils.KeyPair.fromRandom(\"ed25519\"),\r\n    }));\r\n  };\r\n\r\n  const requestSignIn = async (\r\n    permission: nearTransactions.FunctionCallPermission\r\n  ) => {\r\n    const keyPairs = createLimitedAccessKeyPairs();\r\n    const limitedAccessAccounts: Array<LimitedAccessAccount> = keyPairs.map(\r\n      ({ accountId, keyPair }) => ({\r\n        accountId,\r\n        publicKey: keyPair.getPublicKey().toString(),\r\n      })\r\n    );\r\n\r\n    await _state.client.request({\r\n      topic: _state.session!.topic,\r\n      chainId: getChainId(),\r\n      request: {\r\n        method: \"near_signIn\",\r\n        params: {\r\n          permission: permission,\r\n          accounts: limitedAccessAccounts,\r\n        },\r\n      },\r\n    });\r\n\r\n    for (let i = 0; i < keyPairs.length; i += 1) {\r\n      const { accountId, keyPair } = keyPairs[i];\r\n\r\n      await _state.keystore.setKey(\r\n        options.network.networkId,\r\n        accountId,\r\n        keyPair\r\n      );\r\n    }\r\n  };\r\n\r\n  const requestSignOut = async () => {\r\n    const accounts = getAccounts();\r\n    const limitedAccessAccounts: Array<LimitedAccessAccount> = [];\r\n\r\n    for (let i = 0; i < accounts.length; i += 1) {\r\n      const account = accounts[i];\r\n      const keyPair = await _state.keystore.getKey(\r\n        options.network.networkId,\r\n        account.accountId\r\n      );\r\n\r\n      if (!keyPair) {\r\n        continue;\r\n      }\r\n\r\n      limitedAccessAccounts.push({\r\n        accountId: account.accountId,\r\n        publicKey: keyPair.getPublicKey().toString(),\r\n      });\r\n    }\r\n\r\n    if (!limitedAccessAccounts.length) {\r\n      return;\r\n    }\r\n\r\n    await _state.client.request({\r\n      topic: _state.session!.topic,\r\n      chainId: getChainId(),\r\n      request: {\r\n        method: \"near_signOut\",\r\n        params: {\r\n          accounts: limitedAccessAccounts,\r\n        },\r\n      },\r\n    });\r\n\r\n    for (let i = 0; i < limitedAccessAccounts.length; i += 1) {\r\n      const { accountId } = limitedAccessAccounts[i];\r\n\r\n      await _state.keystore.removeKey(options.network.networkId, accountId);\r\n    }\r\n  };\r\n\r\n  const signOut = async () => {\r\n    if (_state.session) {\r\n      await requestSignOut();\r\n\r\n      await _state.client.disconnect({\r\n        topic: _state.session.topic,\r\n        reason: {\r\n          code: 5900,\r\n          message: \"User disconnected\",\r\n        },\r\n      });\r\n    }\r\n\r\n    await cleanup();\r\n  };\r\n\r\n  const setupEvents = () => {\r\n    _state.subscriptions.push(\r\n      _state.client.on(\"session_update\", (event) => {\r\n        logger.log(\"Session Update\", event);\r\n\r\n        if (event.topic === _state.session?.topic) {\r\n          _state.session = {\r\n            ..._state.client.session.get(event.topic),\r\n            namespaces: event.params.namespaces,\r\n          };\r\n\r\n          emitter.emit(\"accountsChanged\", { accounts: getAccounts() });\r\n        }\r\n      })\r\n    );\r\n\r\n    _state.subscriptions.push(\r\n      _state.client.on(\"session_delete\", async (event) => {\r\n        logger.log(\"Session Deleted\", event);\r\n\r\n        if (event.topic === _state.session?.topic) {\r\n          await cleanup();\r\n          emitter.emit(\"signedOut\", null);\r\n        }\r\n      })\r\n    );\r\n  };\r\n\r\n  if (_state.session) {\r\n    setupEvents();\r\n  }\r\n\r\n  return {\r\n    async signIn({ contractId, methodNames = [] }) {\r\n      const existingAccounts = getAccounts();\r\n\r\n      if (existingAccounts.length) {\r\n        return existingAccounts;\r\n      }\r\n\r\n      try {\r\n        _state.session = await _state.client.connect({\r\n          requiredNamespaces: {\r\n            near: {\r\n              chains: [getChainId()],\r\n              methods: WC_METHODS,\r\n              events: WC_EVENTS,\r\n            },\r\n          },\r\n        });\r\n\r\n        await requestSignIn({ receiverId: contractId, methodNames });\r\n\r\n        setupEvents();\r\n\r\n        return getAccounts();\r\n      } catch (err) {\r\n        await signOut();\r\n\r\n        throw err;\r\n      }\r\n    },\r\n\r\n    signOut,\r\n\r\n    async getAccounts() {\r\n      return getAccounts();\r\n    },\r\n\r\n    async verifyOwner({ message }) {\r\n      logger.log(\"WalletConnect:verifyOwner\", { message });\r\n\r\n      throw new Error(`Method not supported by ${metadata.name}`);\r\n    },\r\n\r\n    async signAndSendTransaction({ signerId, receiverId, actions }) {\r\n      logger.log(\"signAndSendTransaction\", { signerId, receiverId, actions });\r\n\r\n      const { contract } = store.getState();\r\n\r\n      if (!_state.session || !contract) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      const account = getActiveAccount(store.getState());\r\n\r\n      if (!account) {\r\n        throw new Error(\"No active account\");\r\n      }\r\n\r\n      const resolvedTransaction: Transaction = {\r\n        signerId: signerId || account.accountId,\r\n        receiverId: receiverId || contract.contractId,\r\n        actions,\r\n      };\r\n\r\n      try {\r\n        const [signedTx] = await signTransactions([resolvedTransaction]);\r\n        return provider.sendTransaction(signedTx);\r\n      } catch (err) {\r\n        logger.log(\"Falling back to WalletConnect to sign transaction\", err);\r\n\r\n        const signedTx = await requestSignTransaction(resolvedTransaction);\r\n        return provider.sendTransaction(signedTx);\r\n      }\r\n    },\r\n\r\n    async signAndSendTransactions({ transactions }) {\r\n      logger.log(\"signAndSendTransactions\", { transactions });\r\n\r\n      const { contract } = store.getState();\r\n\r\n      if (!_state.session || !contract) {\r\n        throw new Error(\"Wallet not signed in\");\r\n      }\r\n\r\n      const account = getActiveAccount(store.getState());\r\n\r\n      if (!account) {\r\n        throw new Error(\"No active account\");\r\n      }\r\n\r\n      const resolvedTransactions = transactions.map((x) => ({\r\n        signerId: x.signerId || account.accountId,\r\n        receiverId: x.receiverId,\r\n        actions: x.actions,\r\n      }));\r\n\r\n      try {\r\n        const signedTxs = await signTransactions(resolvedTransactions);\r\n        const results: Array<providers.FinalExecutionOutcome> = [];\r\n\r\n        for (let i = 0; i < signedTxs.length; i += 1) {\r\n          results.push(await provider.sendTransaction(signedTxs[i]));\r\n        }\r\n\r\n        return results;\r\n      } catch (err) {\r\n        const signedTxs = await requestSignTransactions(resolvedTransactions);\r\n        const results: Array<providers.FinalExecutionOutcome> = [];\r\n\r\n        for (let i = 0; i < signedTxs.length; i += 1) {\r\n          results.push(await provider.sendTransaction(signedTxs[i]));\r\n        }\r\n\r\n        return results;\r\n      }\r\n    },\r\n  };\r\n};\r\n\r\nexport function setupWalletConnect({\r\n  projectId,\r\n  metadata,\r\n  chainId,\r\n  relayUrl = \"wss://relay.walletconnect.com\",\r\n  iconUrl = icon,\r\n  deprecated = false,\r\n}: WalletConnectParams): WalletModuleFactory<BridgeWallet> {\r\n  return async () => {\r\n    return {\r\n      id: \"wallet-connect\",\r\n      type: \"bridge\",\r\n      metadata: {\r\n        name: \"WalletConnect\",\r\n        description: \"Bridge wallet for NEAR.\",\r\n        iconUrl,\r\n        deprecated,\r\n        available: true,\r\n      },\r\n      init: (options) => {\r\n        return WalletConnect({\r\n          ...options,\r\n          params: {\r\n            projectId,\r\n            metadata,\r\n            relayUrl,\r\n            chainId,\r\n          },\r\n        });\r\n      },\r\n    };\r\n  };\r\n}\r\n","export { createAction, signTransactions } from \"./lib/wallet-utils\";\r\n","import { BN } from \"bn.js\";\r\nimport { utils, transactions } from \"near-api-js\";\r\nimport type { AddKeyPermission, Action } from \"@near-wallet-selector/core\";\r\n\r\nconst getAccessKey = (permission: AddKeyPermission) => {\r\n  if (permission === \"FullAccess\") {\r\n    return transactions.fullAccessKey();\r\n  }\r\n\r\n  const { receiverId, methodNames = [] } = permission;\r\n  const allowance = permission.allowance\r\n    ? new BN(permission.allowance)\r\n    : undefined;\r\n\r\n  return transactions.functionCallAccessKey(receiverId, methodNames, allowance);\r\n};\r\n\r\nexport const createAction = (action: Action) => {\r\n  switch (action.type) {\r\n    case \"CreateAccount\":\r\n      return transactions.createAccount();\r\n    case \"DeployContract\": {\r\n      const { code } = action.params;\r\n\r\n      return transactions.deployContract(code);\r\n    }\r\n    case \"FunctionCall\": {\r\n      const { methodName, args, gas, deposit } = action.params;\r\n\r\n      return transactions.functionCall(\r\n        methodName,\r\n        args,\r\n        new BN(gas),\r\n        new BN(deposit)\r\n      );\r\n    }\r\n    case \"Transfer\": {\r\n      const { deposit } = action.params;\r\n\r\n      return transactions.transfer(new BN(deposit));\r\n    }\r\n    case \"Stake\": {\r\n      const { stake, publicKey } = action.params;\r\n\r\n      return transactions.stake(new BN(stake), utils.PublicKey.from(publicKey));\r\n    }\r\n    case \"AddKey\": {\r\n      const { publicKey, accessKey } = action.params;\r\n\r\n      return transactions.addKey(\r\n        utils.PublicKey.from(publicKey),\r\n        // TODO: Use accessKey.nonce? near-api-js seems to think 0 is fine?\r\n        getAccessKey(accessKey.permission)\r\n      );\r\n    }\r\n    case \"DeleteKey\": {\r\n      const { publicKey } = action.params;\r\n\r\n      return transactions.deleteKey(utils.PublicKey.from(publicKey));\r\n    }\r\n    case \"DeleteAccount\": {\r\n      const { beneficiaryId } = action.params;\r\n\r\n      return transactions.deleteAccount(beneficiaryId);\r\n    }\r\n    default:\r\n      throw new Error(\"Invalid action type\");\r\n  }\r\n};\r\n","import {\r\n  utils,\r\n  transactions as nearTransactions,\r\n  Signer,\r\n  providers,\r\n} from \"near-api-js\";\r\nimport type { Network, Transaction } from \"@near-wallet-selector/core\";\r\nimport type { AccessKeyView } from \"near-api-js/lib/providers/provider\";\r\nimport { createAction } from \"./create-action\";\r\n\r\nexport const signTransactions = async (\r\n  transactions: Array<Transaction>,\r\n  signer: Signer,\r\n  network: Network\r\n) => {\r\n  const provider = new providers.JsonRpcProvider({\r\n    url: network.nodeUrl,\r\n  });\r\n\r\n  const signedTransactions: Array<nearTransactions.SignedTransaction> = [];\r\n\r\n  for (let i = 0; i < transactions.length; i++) {\r\n    const publicKey = await signer.getPublicKey(\r\n      transactions[i].signerId,\r\n      network.networkId\r\n    );\r\n\r\n    const [block, accessKey] = await Promise.all([\r\n      provider.block({ finality: \"final\" }),\r\n      provider.query<AccessKeyView>({\r\n        request_type: \"view_access_key\",\r\n        finality: \"final\",\r\n        account_id: transactions[i].signerId,\r\n        public_key: publicKey.toString(),\r\n      }),\r\n    ]);\r\n\r\n    const actions = transactions[i].actions.map((action) =>\r\n      createAction(action)\r\n    );\r\n\r\n    const transaction = nearTransactions.createTransaction(\r\n      transactions[i].signerId,\r\n      utils.PublicKey.from(publicKey.toString()),\r\n      transactions[i].receiverId,\r\n      accessKey.nonce + i + 1,\r\n      actions,\r\n      utils.serialize.base_decode(block.header.hash)\r\n    );\r\n\r\n    const response = await nearTransactions.signTransaction(\r\n      transaction,\r\n      signer,\r\n      transactions[i].signerId,\r\n      network.networkId\r\n    );\r\n\r\n    signedTransactions.push(response[1]);\r\n  }\r\n\r\n  return signedTransactions;\r\n};\r\n","import { createAction } from \"./create-action\";\r\nimport { signTransactions } from \"./sign-transactions\";\r\n\r\nexport { createAction, signTransactions };\r\n","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */"],"names":["setupWalletSelector","setupDefaultWallets","setupNearWallet","setupSender","setupMathWallet","setupNightly","setupMeteorWallet","setupNightlyConnect","setupWalletConnect","setupModal","CONTRACT_ID","i0","ctx_r0","AppComponent","constructor","ngOnInit","initialize","catch","err","console","error","alert","_selector","network","debug","modules","projectId","metadata","name","description","url","icons","appMetadata","additionalInfo","application","icon","_modal","contractId","state","store","getState","accounts","accountId","find","account","active","_a","window","selector","modal","selectors","decls","vars","consts","template","providers","utils","distinctUntilChanged","map","SUGGESTED_DONATION","BOATLOAD_OF_GAS","format","parseNearAmount","ContentComponent","messages","Promise","all","getMessages","getAccount","subscribeToEvents","options","provider","JsonRpcProvider","nodeUrl","query","request_type","finality","account_id","then","data","Object","signIn","show","signOut","wallet","log","switchWallet","method_name","args_base64","res","JSON","parse","Buffer","from","result","toString","switchAccount","currentIndex","findIndex","x","nextIndex","length","nextAccountId","setActiveAccount","onVerifyOwner","owner","verifyOwner","message","stringify","Error","subscription","observable","pipe","subscribe","nextAccounts","addMessages","donation","multiple","contract","signAndSendTransaction","signerId","actions","type","params","methodName","args","text","gas","deposit","transactions","i","push","receiverId","signAndSendTransactions","onSubmit","e","fieldset","target","elements","disabled","value","checked","nextMessages","focus","ngOnDestroy","unsubscribe","inputs","wait","ms","resolve","setTimeout","poll","cb","interval","remaining","waitFor","opts","timeout","race","Math","floor","EventEmitter","Logger","logger","PACKAGE_NAME","PENDING_CONTRACT","PENDING_SELECTED_WALLET_ID","JsonStorage","WalletModules","factories","storage","emitter","instances","validateWallet","id","getWallet","getAccounts","resolveStorageState","jsonStorage","pendingSelectedWalletId","getItem","pendingContract","removeItem","selectedWalletId","selectedWallet","signOutWallet","walletId","onWalletSignedOut","onWalletSignedIn","methodNames","module","getModule","setItem","dispatch","payload","setupWalletEmitter","on","event","networkId","emit","decorateWallet","_signIn","_signOut","setupInstance","available","init","toReadOnly","setup","some","instance","Subject","BehaviorSubject","scan","CONTRACT","SELECTED_WALLET_ID","reducer","action","accountStates","activeAccountIndex","activeAccount","isActiveAccountRemoved","createStore","initialState","state$","actions$","syncStorage","prevState","storageKey","property","getValue","next","asObservable","resolveOptions","Provider","walletSelectorInstance","walletModules","isSignedIn","Boolean","eventName","callback","off","setupMyNearWallet","setupLedger","TransportWebHID","CLA","INS_SIGN","INS_GET_PUBLIC_KEY","INS_GET_APP_VERSION","P1_LAST","P1_MORE","P1_IGNORE","P2_IGNORE","parseDerivationPath","derivationPath","parts","split","concat","part","endsWith","abs","parseInt","slice","i32","charCodeAt","isLedgerSupported","navigator","hid","LedgerClient","transport","create","handleDisconnect","close","key","setScrambleKey","remove","send","major","minor","patch","Array","serialize","base_encode","subarray","getVersion","CHUNK_SIZE","allData","offset","isLastChunk","response","isMobile","signTransactions","getActiveAccount","STORAGE_ACCOUNTS","setupLedgerState","client","subscriptions","Ledger","_state","signer","createKey","getPublicKey","a","PublicKey","publicKey","signMessage","signature","sign","cleanup","forEach","isConnected","disconnect","connectLedgerDevice","connect","validateAccessKey","viewAccessKey","accessKey","permission","transformTransactions","transaction","existingAccounts","ledgerAccounts","signedTransactions","sendTransaction","results","iconUrl","deprecated","mobile","supported","isInstalled","nearWalletApi","setupMathWalletState","MathWallet","login","logout","pubKey","block","blockId","header","hash","keyType","encoded","signed","Uint8Array","installed","downloadUrl","keyStores","nearTransactions","EMeteorWalletSignInType","MeteorWallet","MeteorWalletSdk","createAction","setupWalletState","keyStore","BrowserLocalStorageKeyStore","localStorage","near","headers","appKeyPrefix","createMeteorWalletInjected","clear","getAccountId","connection","localKey","trx","index","accessKeyForTransaction","createTransaction","public_key","access_key","nonce","base_decode","requestSignIn","methods","SELECTED_METHODS","contract_id","ALL_METHODS","success","requestSignTransactions","modalState","renderWhatIsAWallet","goToWallet","subdomain","open","renderGetAWallet","document","querySelector","innerHTML","filterByType","item","filteredModules","filter","getElementById","insertAdjacentHTML","querySelectorAll","button","addEventListener","m","_b","renderLedgerSelectAccount","renderWalletConnectionFailed","renderLedgerAccountsOverviewList","selectedAccounts","_c","container","children","classList","renderSpecifyDerivationPath","preventDefault","accountCheckStatuses","el","checkedAccounts","_account","renderConnectHardwareWallet","renderNoLedgerAccountsFound","resolveAccounts","renderWalletConnecting","derivationPathIndexElement","innerText","_d","renderWalletAccount","connectToWallet","renderWalletNotInstalled","getAccountIds","fetch","indexerUrl","ok","accountIds","json","isArray","selected","renderModal","theme","element","add","className","WalletConnection","resolveWalletUrl","walletUrl","MyNearWallet","callbackUrl","meta","locationUrl","location","href","encodedUrl","encodeURIComponent","extraMeta","replace","walletCallbackUrl","AppNear","clearPersistedSessionAccountId","clearPersistedSessionId","clearPersistedSessionPublicKey","getPersistedSessionAccountId","getPersistedSessionId","getPersistedSessionPublicKey","NETWORK","NightlyConnectModal","setPersistedSessionAccountId","setPersistedSessionPublicKey","setupNightlyConnectState","NightlyConnect","tx","Transaction","decode","signedTx","signTransaction","ws","reject","persistedId","persistedPubkey","persistedAccountId","persistent","build","onUserConnect","onClose","undefined","closeModal","onclose","sessionId","openModal","NEAR","signedTxs","setupNightlyState","nightly","Nightly","isSender","setupSenderState","Sender","callbacks","setupEvents","newAccountId","rpc","isValidActions","every","transformActions","validActions","Client","QRCodeModal","WalletConnectClient","session","removeListener","once","uri","approval","finally","request","InMemorySigner","WC_METHODS","WC_EVENTS","setupWalletConnectState","keystore","relayUrl","lastKeyIndex","keys","get","WalletConnect","getChainId","chainId","includes","namespaces","receiver_id","method_names","FunctionCall","parseFloat","requestAccounts","topic","method","requestSignTransaction","encode","SignedTransaction","txs","createLimitedAccessKeyPairs","keyPair","KeyPair","fromRandom","keyPairs","limitedAccessAccounts","setKey","requestSignOut","getKey","removeKey","reason","code","requiredNamespaces","chains","events","resolvedTransaction","resolvedTransactions"],"sourceRoot":"webpack:///"}