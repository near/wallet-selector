"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5154],{53807:function(e,t,r){r.d(t,{b:function(){return s}});var i=r(34406);let s={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(void 0!==i&&void 0!==i.env?i.env.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org"}},23470:function(e,t,r){r.d(t,{p:function(){return s}});var i=r(53807);let s={caipNetworkIdToNumber:e=>e?Number(e.split(":")[1]):void 0,parseEvmChainId(e){return"string"==typeof e?this.caipNetworkIdToNumber(e):e},getNetworksByNamespace:(e,t)=>e?.filter(e=>e.chainNamespace===t)||[],getFirstNetworkByNamespace(e,t){return this.getNetworksByNamespace(e,t)[0]},getNetworkNameByCaipNetworkId(e,t){if(!t)return;let r=e.find(e=>e.caipNetworkId===t);if(r)return r.name;let[s]=t.split(":");return i.b.CHAIN_NAME_MAP?.[s]||void 0}}},54990:function(e,t,r){r.d(t,{$U:function(){return a},Vk:function(){return s},mr:function(){return n},uJ:function(){return i}});let i={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections"};function s(e){if(!e)throw Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${e}:connected_connector_id`}let n={setItem(e,t){a()&&void 0!==t&&localStorage.setItem(e,t)},getItem(e){if(a())return localStorage.getItem(e)||void 0},removeItem(e){a()&&localStorage.removeItem(e)},clear(){a()&&localStorage.clear()}};function a(){return"undefined"!=typeof window&&"undefined"!=typeof localStorage}},63642:function(e,t,r){r.d(t,{t:function(){return i}});function i(e,t){return"light"===t?{"--w3m-accent":e?.["--w3m-accent"]||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":e?.["--w3m-accent"]||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}},70066:function(e,t,r){r.d(t,{N:function(){return d}});var i=r(1495),s=r(24997),n=r(67007),a=r(72054),o=r(38750),c=r(12309),l=r(14406);let h=(0,i.sj)({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[]}),d=(0,a.P)({state:h,replaceState(e){e&&Object.assign(h,(0,i.iH)(e))},subscribe:e=>c.R.subscribeChainProp("accountState",t=>{if(t)return e(t)}),subscribeKey(e,t,r){let i;return c.R.subscribeChainProp("accountState",r=>{if(r){let s=r[e];i!==s&&(i=s,t(s))}},r)},setStatus(e,t){c.R.setAccountProp("status",e,t)},getCaipAddress:e=>c.R.getAccountProp("caipAddress",e),setCaipAddress(e,t){let r=e?n.j.getPlainAddress(e):void 0;t===c.R.state.activeChain&&(c.R.state.activeCaipAddress=e),c.R.setAccountProp("caipAddress",e,t),c.R.setAccountProp("address",r,t)},setBalance(e,t,r){c.R.setAccountProp("balance",e,r),c.R.setAccountProp("balanceSymbol",t,r)},setProfileName(e,t){c.R.setAccountProp("profileName",e,t)},setProfileImage(e,t){c.R.setAccountProp("profileImage",e,t)},setUser(e,t){c.R.setAccountProp("user",e,t)},setAddressExplorerUrl(e,t){c.R.setAccountProp("addressExplorerUrl",e,t)},setSmartAccountDeployed(e,t){c.R.setAccountProp("smartAccountDeployed",e,t)},setCurrentTab(e){c.R.setAccountProp("currentTab",e,c.R.state.activeChain)},setTokenBalance(e,t){e&&c.R.setAccountProp("tokenBalance",e,t)},setShouldUpdateToAddress(e,t){c.R.setAccountProp("shouldUpdateToAddress",e,t)},setAllAccounts(e,t){c.R.setAccountProp("allAccounts",e,t)},addAddressLabel(e,t,r){let i=c.R.getAccountProp("addressLabels",r)||new Map;i.set(e,t),c.R.setAccountProp("addressLabels",i,r)},removeAddressLabel(e,t){let r=c.R.getAccountProp("addressLabels",t)||new Map;r.delete(e),c.R.setAccountProp("addressLabels",r,t)},setConnectedWalletInfo(e,t){c.R.setAccountProp("connectedWalletInfo",e,t,!1)},setPreferredAccountType(e,t){c.R.setAccountProp("preferredAccountTypes",{...h.preferredAccountTypes,[t]:e},t)},setPreferredAccountTypes(e){h.preferredAccountTypes=e},setSocialProvider(e,t){e&&c.R.setAccountProp("socialProvider",e,t)},setSocialWindow(e,t){c.R.setAccountProp("socialWindow",e?(0,i.iH)(e):void 0,t)},setFarcasterUrl(e,t){c.R.setAccountProp("farcasterUrl",e,t)},async fetchTokenBalance(e){h.balanceLoading=!0;let t=c.R.state.activeCaipNetwork?.caipNetworkId,r=c.R.state.activeCaipNetwork?.chainNamespace,i=c.R.state.activeCaipAddress,a=i?n.j.getPlainAddress(i):void 0;if(h.lastRetry&&!n.j.isAllowedRetry(h.lastRetry,30*s.bq.ONE_SEC_MS))return h.balanceLoading=!1,[];try{if(a&&t&&r){let e=await o.L.getBalance(a,t),i=e.balances.filter(e=>"0"!==e.quantity.decimals);return d.setTokenBalance(i,r),h.lastRetry=void 0,h.balanceLoading=!1,i}}catch(t){h.lastRetry=Date.now(),e?.(t),l.K.showError("Token Balance Unavailable")}finally{h.balanceLoading=!1}return[]},resetAccount(e){c.R.resetAccount(e)}})},6912:function(e,t,r){r.d(t,{B:function(){return c}});var i=r(1495),s=r(63243),n=r(72054),a=r(79187);let o=(0,i.sj)({message:"",variant:"info",open:!1}),c=(0,n.P)({state:o,subscribeKey:(e,t)=>(0,s.VW)(o,e,t),open(e,t){let{debug:r}=a.h.state,{shortMessage:i,longMessage:s}=e;r&&(o.message=i,o.variant=t,o.open=!0),s&&console.error("function"==typeof s?s():s)},close(){o.open=!1,o.message="",o.variant="info"}})},88049:function(e,t,r){r.d(t,{Q:function(){return y}});var i=r(1495),s=r(63243),n=r(62661),a=r(67007),o=r(70748),c=r(21052),l=r(70580),h=r(2013),d=r(12309),u=r(32410),p=r(37517),g=r(79187);let f=a.j.getApiUrl(),m=new o.V({baseUrl:f,clientId:null}),w=(0,i.sj)({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),y={state:w,subscribeKey:(e,t)=>(0,s.VW)(w,e,t),_getSdkProperties(){let{projectId:e,sdkType:t,sdkVersion:r}=g.h.state;return{projectId:e,st:t||"appkit",sv:r||"html-wagmi-4.2.2"}},_filterOutExtensions:e=>g.h.state.isUniversalProvider?e.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):e,async _fetchWalletImage(e){let t=`${m.baseUrl}/getWalletImage/${e}`,r=await m.getBlob({path:t,params:y._getSdkProperties()});h.W.setWalletImage(e,URL.createObjectURL(r))},async _fetchNetworkImage(e){let t=`${m.baseUrl}/public/getAssetImage/${e}`,r=await m.getBlob({path:t,params:y._getSdkProperties()});h.W.setNetworkImage(e,URL.createObjectURL(r))},async _fetchConnectorImage(e){let t=`${m.baseUrl}/public/getAssetImage/${e}`,r=await m.getBlob({path:t,params:y._getSdkProperties()});h.W.setConnectorImage(e,URL.createObjectURL(r))},async _fetchCurrencyImage(e){let t=`${m.baseUrl}/public/getCurrencyImage/${e}`,r=await m.getBlob({path:t,params:y._getSdkProperties()});h.W.setCurrencyImage(e,URL.createObjectURL(r))},async _fetchTokenImage(e){let t=`${m.baseUrl}/public/getTokenImage/${e}`,r=await m.getBlob({path:t,params:y._getSdkProperties()});h.W.setTokenImage(e,URL.createObjectURL(r))},_filterWalletsByPlatform(e){let t=a.j.isMobile()?e?.filter(e=>{if(e.mobile_link||e.id===c.m.COINBASE.id)return!0;let t="solana"===d.R.state.activeChain;return t&&(e.id===c.m.SOLFLARE.id||e.id===c.m.PHANTOM.id)}):e;return t},async fetchProjectConfig(){let e=await m.get({path:"/appkit/v1/config",params:y._getSdkProperties()});return e.features},async fetchAllowedOrigins(){try{let{allowedOrigins:e}=await m.get({path:"/projects/v1/origins",params:y._getSdkProperties()});return e}catch(e){return[]}},async fetchNetworkImages(){let e=d.R.getAllRequestedCaipNetworks(),t=e?.map(({assets:e})=>e?.imageId).filter(Boolean).filter(e=>!n.f.getNetworkImageById(e));t&&await Promise.allSettled(t.map(e=>y._fetchNetworkImage(e)))},async fetchConnectorImages(){let{connectors:e}=u.A.state,t=e.map(({imageId:e})=>e).filter(Boolean);await Promise.allSettled(t.map(e=>y._fetchConnectorImage(e)))},async fetchCurrencyImages(e=[]){await Promise.allSettled(e.map(e=>y._fetchCurrencyImage(e)))},async fetchTokenImages(e=[]){await Promise.allSettled(e.map(e=>y._fetchTokenImage(e)))},async fetchWallets(e){let t=e.exclude??[],r=y._getSdkProperties();r.sv.startsWith("html-core-")&&t.push(...Object.values(c.m).map(e=>e.id));let i=await m.get({path:"/getWallets",params:{...y._getSdkProperties(),...e,page:String(e.page),entries:String(e.entries),include:e.include?.join(","),exclude:t.join(",")}}),s=y._filterWalletsByPlatform(i?.data);return{data:s||[],count:i?.count}},async fetchFeaturedWallets(){let{featuredWalletIds:e}=g.h.state;if(e?.length){let t={...y._getSdkProperties(),page:1,entries:e?.length??4,include:e},{data:r}=await y.fetchWallets(t),i=[...r].sort((t,r)=>e.indexOf(t.id)-e.indexOf(r.id)),s=i.map(e=>e.image_id).filter(Boolean);await Promise.allSettled(s.map(e=>y._fetchWalletImage(e))),w.featured=i,w.allFeatured=i}},async fetchRecommendedWallets(){try{w.isFetchingRecommendedWallets=!0;let{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:r}=g.h.state,i=[...t??[],...r??[]].filter(Boolean),s=d.R.getRequestedCaipNetworkIds().join(","),{data:n,count:a}=await y.fetchWallets({page:1,entries:4,include:e,exclude:i,chains:s}),o=l.M.getRecentWallets(),c=n.map(e=>e.image_id).filter(Boolean),h=o.map(e=>e.image_id).filter(Boolean);await Promise.allSettled([...c,...h].map(e=>y._fetchWalletImage(e))),w.recommended=n,w.allRecommended=n,w.count=a??0}catch{}finally{w.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:e}){let{includeWalletIds:t,excludeWalletIds:r,featuredWalletIds:i}=g.h.state,s=d.R.getRequestedCaipNetworkIds().join(","),n=[...w.recommended.map(({id:e})=>e),...r??[],...i??[]].filter(Boolean),{data:o,count:c}=await y.fetchWallets({page:e,entries:40,include:t,exclude:n,chains:s}),l=o.slice(0,20).map(e=>e.image_id).filter(Boolean);await Promise.allSettled(l.map(e=>y._fetchWalletImage(e))),w.wallets=a.j.uniqueBy([...w.wallets,...y._filterOutExtensions(o)],"id").filter(e=>e.chains?.some(e=>s.includes(e))),w.count=c>w.count?c:w.count,w.page=e},async initializeExcludedWallets({ids:e}){let t={page:1,entries:e.length,include:e},{data:r}=await y.fetchWallets(t);r&&r.forEach(e=>{w.excludedWallets.push({rdns:e.rdns,name:e.name})})},async searchWallet({search:e,badge:t}){let{includeWalletIds:r,excludeWalletIds:i}=g.h.state,s=d.R.getRequestedCaipNetworkIds().join(",");w.search=[];let n={page:1,entries:100,search:e?.trim(),badge_type:t,include:r,exclude:i,chains:s},{data:o}=await y.fetchWallets(n);p.X.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:t??"",search:e??""}});let c=o.map(e=>e.image_id).filter(Boolean);await Promise.allSettled([...c.map(e=>y._fetchWalletImage(e)),a.j.wait(300)]),w.search=y._filterOutExtensions(o)},initPromise(e,t){let r=w.promises[e];return r||(w.promises[e]=t())},prefetch({fetchConnectorImages:e=!0,fetchFeaturedWallets:t=!0,fetchRecommendedWallets:r=!0,fetchNetworkImages:i=!0}={}){let s=[e&&y.initPromise("connectorImages",y.fetchConnectorImages),t&&y.initPromise("featuredWallets",y.fetchFeaturedWallets),r&&y.initPromise("recommendedWallets",y.fetchRecommendedWallets),i&&y.initPromise("networkImages",y.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(s)},prefetchAnalyticsConfig(){g.h.state.features?.analytics&&y.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{let{isAnalyticsEnabled:e}=await m.get({path:"/getAnalyticsConfig",params:y._getSdkProperties()});g.h.setFeatures({analytics:e})}catch(e){g.h.setFeatures({analytics:!1})}},filterByNamespaces(e){if(!e?.length){w.featured=w.allFeatured,w.recommended=w.allRecommended;return}let t=d.R.getRequestedCaipNetworkIds().join(",");w.featured=w.allFeatured.filter(e=>e.chains?.some(e=>t.includes(e))),w.recommended=w.allRecommended.filter(e=>e.chains?.some(e=>t.includes(e))),w.filteredWallets=w.wallets.filter(e=>e.chains?.some(e=>t.includes(e)))},clearFilterByNamespaces(){w.filteredWallets=[]},setFilterByNamespace(e){if(!e){w.featured=w.allFeatured,w.recommended=w.allRecommended;return}let t=d.R.getRequestedCaipNetworkIds().join(",");w.featured=w.allFeatured.filter(e=>e.chains?.some(e=>t.includes(e))),w.recommended=w.allRecommended.filter(e=>e.chains?.some(e=>t.includes(e))),w.filteredWallets=w.wallets.filter(e=>e.chains?.some(e=>t.includes(e)))}}},2013:function(e,t,r){r.d(t,{W:function(){return o}});var i=r(1495),s=r(63243),n=r(72054);let a=(0,i.sj)({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),o=(0,n.P)({state:a,subscribeNetworkImages:e=>(0,i.Ld)(a.networkImages,()=>e(a.networkImages)),subscribeKey:(e,t)=>(0,s.VW)(a,e,t),subscribe:e=>(0,i.Ld)(a,()=>e(a)),setWalletImage(e,t){a.walletImages[e]=t},setNetworkImage(e,t){a.networkImages[e]=t},setChainImage(e,t){a.chainImages[e]=t},setConnectorImage(e,t){a.connectorImages={...a.connectorImages,[e]:t}},setTokenImage(e,t){a.tokenImages[e]=t},setCurrencyImage(e,t){a.currencyImages[e]=t}})},38750:function(e,t,r){r.d(t,{L:function(){return f}});var i=r(1495),s=r(24997),n=r(67007),a=r(70748),o=r(70580),c=r(70066),l=r(12309),h=r(79187),d=r(14406);let u={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},p=n.j.getBlockchainApiUrl(),g=(0,i.sj)({clientId:null,api:new a.V({baseUrl:p,clientId:null}),supportedChains:{http:[],ws:[]}}),f={state:g,async get(e){let{st:t,sv:r}=f.getSdkProperties(),i=h.h.state.projectId,s={...e.params||{},st:t,sv:r,projectId:i};return g.api.get({...e,params:s})},getSdkProperties(){let{sdkType:e,sdkVersion:t}=h.h.state;return{st:e||"unknown",sv:t||"unknown"}},async isNetworkSupported(e){if(!e)return!1;try{g.supportedChains.http.length||await f.getSupportedNetworks()}catch(e){return!1}return g.supportedChains.http.includes(e)},async getSupportedNetworks(){try{let e=await f.get({path:"v1/supported-chains"});return g.supportedChains=e,e}catch{return g.supportedChains}},async fetchIdentity({address:e,caipNetworkId:t}){let r=await f.isNetworkSupported(t);if(!r)return{avatar:"",name:""};let i=o.M.getIdentityFromCacheForAddress(e);if(i)return i;let s=await f.get({path:`/v1/identity/${e}`,params:{sender:l.R.state.activeCaipAddress?n.j.getPlainAddress(l.R.state.activeCaipAddress):void 0}});return o.M.updateIdentityCache({address:e,identity:s,timestamp:Date.now()}),s},async fetchTransactions({account:e,cursor:t,onramp:r,signal:i,cache:s,chainId:n}){let a=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);return a?f.get({path:`/v1/account/${e}/history`,params:{cursor:t,onramp:r,chainId:n},signal:i,cache:s}):{data:[],next:void 0}},async fetchSwapQuote({amount:e,userAddress:t,from:r,to:i,gasPrice:s}){let n=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);return n?f.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:e,userAddress:t,from:r,to:i,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:e}){let t=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);return t?f.get({path:"/v1/convert/tokens",params:{chainId:e}}):{tokens:[]}},async fetchTokenPrice({addresses:e}){let t=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);return t?g.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:e,projectId:h.h.state.projectId},headers:{"Content-Type":"application/json"}}):{fungibles:[]}},async fetchSwapAllowance({tokenAddress:e,userAddress:t}){let r=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);return r?f.get({path:"/v1/convert/allowance",params:{tokenAddress:e,userAddress:t},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:e}){let{st:t,sv:r}=f.getSdkProperties(),i=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);if(!i)throw Error("Network not supported for Gas Price");return f.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:e,st:t,sv:r}})},async generateSwapCalldata({amount:e,from:t,to:r,userAddress:i,disableEstimate:n}){let a=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);if(!a)throw Error("Network not supported for Swaps");return g.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:e,eip155:{slippage:s.bq.CONVERT_SLIPPAGE_TOLERANCE},projectId:h.h.state.projectId,from:t,to:r,userAddress:i,disableEstimate:n}})},async generateApproveCalldata({from:e,to:t,userAddress:r}){let{st:i,sv:s}=f.getSdkProperties(),n=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);if(!n)throw Error("Network not supported for Swaps");return f.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:r,from:e,to:t,st:i,sv:s}})},async getBalance(e,t,r){let{st:i,sv:s}=f.getSdkProperties(),n=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);if(!n)return d.K.showError("Token Balance Unavailable"),{balances:[]};let a=`${t}:${e}`,c=o.M.getBalanceCacheForCaipAddress(a);if(c)return c;let h=await f.get({path:`/v1/account/${e}/balance`,params:{currency:"usd",chainId:t,forceUpdate:r,st:i,sv:s}});return o.M.updateBalanceCache({caipAddress:a,balance:h,timestamp:Date.now()}),h},async lookupEnsName(e){let t=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);return t?f.get({path:`/v1/profile/account/${e}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:e}){let t=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);return t?f.get({path:`/v1/profile/reverse/${e}`,params:{sender:c.N.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(e){let t=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);return t?f.get({path:`/v1/profile/suggestions/${e}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:e,address:t,message:r,signature:i}){let s=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);return s?g.api.post({path:"/v1/profile/account",body:{coin_type:e,address:t,message:r,signature:i},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:e,partnerUserId:t,defaultNetwork:r,purchaseAmount:i,paymentAmount:s}){let n=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);if(!n)return"";let a=await g.api.post({path:"/v1/generators/onrampurl",params:{projectId:h.h.state.projectId},body:{destinationWallets:e,defaultNetwork:r,partnerUserId:t,defaultExperience:"buy",presetCryptoAmount:i,presetFiatAmount:s}});return a.url},async getOnrampOptions(){let e=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);if(!e)return{paymentCurrencies:[],purchaseCurrencies:[]};try{let e=await f.get({path:"/v1/onramp/options"});return e}catch(e){return u}},async getOnrampQuote({purchaseCurrency:e,paymentCurrency:t,amount:r,network:i}){try{let s=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);if(!s)return null;let n=await g.api.post({path:"/v1/onramp/quote",params:{projectId:h.h.state.projectId},body:{purchaseCurrency:e,paymentCurrency:t,amount:r,network:i}});return n}catch(e){return{coinbaseFee:{amount:r,currency:t.id},networkFee:{amount:r,currency:t.id},paymentSubtotal:{amount:r,currency:t.id},paymentTotal:{amount:r,currency:t.id},purchaseAmount:{amount:r,currency:t.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(e){let t=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);return t?f.get({path:`/v1/sessions/${e}`}):[]},async revokeSmartSession(e,t,r){let i=await f.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId);return i?g.api.post({path:`/v1/sessions/${e}/revoke`,params:{projectId:h.h.state.projectId},body:{pci:t,signature:r}}):{success:!1}},setClientId(e){g.clientId=e,g.api=new a.V({baseUrl:p,clientId:e})}}},12309:function(e,t,r){r.d(t,{R:function(){return I}});var i=r(1495),s=r(63243),n=r(23470),a=r(53807),o=r(24997),c=r(67007),l=r(70580),h=r(72054),d=r(70066),u=r(98905),p=r(32410),g=r(37517),f=r(46560),m=r(79187),w=r(26067),y=r(64695),b=r(64616);let v={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[],user:void 0},E={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},C=(0,i.sj)({chains:(0,s.Yr)(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),I=(0,h.P)({state:C,subscribe:e=>(0,i.Ld)(C,()=>{e(C)}),subscribeKey:(e,t)=>(0,s.VW)(C,e,t),subscribeChainProp(e,t,r){let s;return(0,i.Ld)(C.chains,()=>{let i=r||C.activeChain;if(i){let r=C.chains.get(i)?.[e];s!==r&&(s=r,t(r))}})},initialize(e,t,r){let{chainId:s,namespace:n}=l.M.getActiveNetworkProps(),a=t?.find(e=>e.id.toString()===s?.toString()),o=e.find(e=>e?.namespace===n),c=o||e?.[0],h=e.map(e=>e.namespace).filter(e=>void 0!==e),d=new Set(m.h.state.enableEmbedded?[...h]:[...t?.map(e=>e.chainNamespace)??[]]);e?.length!==0&&c||(C.noAdapters=!0),!C.noAdapters&&(C.activeChain=c?.namespace,C.activeCaipNetwork=a,I.setChainNetworkData(c?.namespace,{caipNetwork:a}),C.activeChain&&w.I.set({activeChain:c?.namespace})),d.forEach(e=>{let s=t?.filter(t=>t.chainNamespace===e);I.state.chains.set(e,{namespace:e,networkState:(0,i.sj)({...E,caipNetwork:s?.[0]}),accountState:(0,i.sj)(v),caipNetworks:s??[],...r}),I.setRequestedCaipNetworks(s??[],e)})},removeAdapter(e){if(C.activeChain===e){let t=Array.from(C.chains.entries()).find(([t])=>t!==e);if(t){let e=t[1]?.caipNetworks?.[0];e&&I.setActiveCaipNetwork(e)}}C.chains.delete(e)},addAdapter(e,{networkControllerClient:t,connectionControllerClient:r},i){C.chains.set(e.namespace,{namespace:e.namespace,networkState:{...E,caipNetwork:i[0]},accountState:v,caipNetworks:i,connectionControllerClient:r,networkControllerClient:t}),I.setRequestedCaipNetworks(i?.filter(t=>t.chainNamespace===e.namespace)??[],e.namespace)},addNetwork(e){let t=C.chains.get(e.chainNamespace);if(t){let r=[...t.caipNetworks||[]];t.caipNetworks?.find(t=>t.id===e.id)||r.push(e),C.chains.set(e.chainNamespace,{...t,caipNetworks:r}),I.setRequestedCaipNetworks(r,e.chainNamespace),p.A.filterByNamespace(e.chainNamespace,!0)}},removeNetwork(e,t){let r=C.chains.get(e);if(r){let i=C.activeCaipNetwork?.id===t,s=[...r.caipNetworks?.filter(e=>e.id!==t)||[]];i&&r?.caipNetworks?.[0]&&I.setActiveCaipNetwork(r.caipNetworks[0]),C.chains.set(e,{...r,caipNetworks:s}),I.setRequestedCaipNetworks(s||[],e),0===s.length&&p.A.filterByNamespace(e,!1)}},setAdapterNetworkState(e,t){let r=C.chains.get(e);r&&(r.networkState={...r.networkState||E,...t},C.chains.set(e,r))},setChainAccountData(e,t,r=!0){if(!e)throw Error("Chain is required to update chain account data");let i=C.chains.get(e);if(i){let r={...i.accountState||v,...t};C.chains.set(e,{...i,accountState:r}),(1===C.chains.size||C.activeChain===e)&&(t.caipAddress&&(C.activeCaipAddress=t.caipAddress),d.N.replaceState(r))}},setChainNetworkData(e,t){if(!e)return;let r=C.chains.get(e);if(r){let i={...r.networkState||E,...t};C.chains.set(e,{...r,networkState:i})}},setAccountProp(e,t,r,i=!0){I.setChainAccountData(r,{[e]:t},i),"status"===e&&"disconnected"===t&&r&&p.A.removeConnectorId(r)},setActiveNamespace(e){C.activeChain=e;let t=e?C.chains.get(e):void 0,r=t?.networkState?.caipNetwork;r?.id&&e&&(C.activeCaipAddress=t?.accountState?.caipAddress,C.activeCaipNetwork=r,I.setChainNetworkData(e,{caipNetwork:r}),l.M.setActiveCaipNetworkId(r?.caipNetworkId),w.I.set({activeChain:e,selectedNetworkId:r?.caipNetworkId}))},setActiveCaipNetwork(e){if(!e)return;C.activeChain!==e.chainNamespace&&I.setIsSwitchingNamespace(!0);let t=C.chains.get(e.chainNamespace);C.activeChain=e.chainNamespace,C.activeCaipNetwork=e,I.setChainNetworkData(e.chainNamespace,{caipNetwork:e}),t?.accountState?.address?C.activeCaipAddress=`${e.chainNamespace}:${e.id}:${t?.accountState?.address}`:C.activeCaipAddress=void 0,I.setAccountProp("caipAddress",C.activeCaipAddress,e.chainNamespace),t&&d.N.replaceState(t.accountState),b.S.resetSend(),w.I.set({activeChain:C.activeChain,selectedNetworkId:C.activeCaipNetwork?.caipNetworkId}),l.M.setActiveCaipNetworkId(e.caipNetworkId);let r=I.checkIfSupportedNetwork(e.chainNamespace);r||!m.h.state.enableNetworkSwitch||m.h.state.allowUnsupportedChain||u.l.state.wcBasic||I.showUnsupportedChainUI()},addCaipNetwork(e){if(!e)return;let t=C.chains.get(e.chainNamespace);t&&t?.caipNetworks?.push(e)},async switchActiveNamespace(e){if(!e)return;let t=e!==I.state.activeChain,r=I.getNetworkData(e)?.caipNetwork,i=I.getCaipNetworkByNamespace(e,r?.id);t&&i&&await I.switchActiveNetwork(i)},async switchActiveNetwork(e){let t=I.state.chains.get(I.state.activeChain),r=!t?.caipNetworks?.some(e=>e.id===C.activeCaipNetwork?.id),i=I.getNetworkControllerClient(e.chainNamespace);if(i){try{await i.switchCaipNetwork(e),r&&f.I.close()}catch(e){y.P.goBack()}g.X.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:e.caipNetworkId}})}},getNetworkControllerClient(e){let t=e||C.activeChain,r=C.chains.get(t);if(!r)throw Error("Chain adapter not found");if(!r.networkControllerClient)throw Error("NetworkController client not set");return r.networkControllerClient},getConnectionControllerClient(e){let t=e||C.activeChain;if(!t)throw Error("Chain is required to get connection controller client");let r=C.chains.get(t);if(!r?.connectionControllerClient)throw Error("ConnectionController client not set");return r.connectionControllerClient},getAccountProp(e,t){let r=C.activeChain;if(t&&(r=t),!r)return;let i=C.chains.get(r)?.accountState;if(i)return i[e]},getNetworkProp(e,t){let r=C.chains.get(t)?.networkState;if(r)return r[e]},getRequestedCaipNetworks(e){let t=C.chains.get(e),{approvedCaipNetworkIds:r=[],requestedCaipNetworks:i=[]}=t?.networkState||{},s=c.j.sortRequestedNetworks(r,i);return s},getAllRequestedCaipNetworks(){let e=[];return C.chains.forEach(t=>{let r=I.getRequestedCaipNetworks(t.namespace);e.push(...r)}),e},setRequestedCaipNetworks(e,t){I.setAdapterNetworkState(t,{requestedCaipNetworks:e});let r=I.getAllRequestedCaipNetworks(),i=r.map(e=>e.chainNamespace),s=Array.from(new Set(i));p.A.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){let e=[];return C.chains.forEach(t=>{let r=I.getApprovedCaipNetworkIds(t.namespace);e.push(...r)}),e},getActiveCaipNetwork:()=>C.activeCaipNetwork,getActiveCaipAddress:()=>C.activeCaipAddress,getApprovedCaipNetworkIds(e){let t=C.chains.get(e),r=t?.networkState?.approvedCaipNetworkIds||[];return r},async setApprovedCaipNetworksData(e){let t=I.getNetworkControllerClient(),r=await t?.getApprovedCaipNetworksData();I.setAdapterNetworkState(e,{approvedCaipNetworkIds:r?.approvedCaipNetworkIds,supportsAllNetworks:r?.supportsAllNetworks})},checkIfSupportedNetwork(e,t){let r=t||C.activeCaipNetwork,i=I.getRequestedCaipNetworks(e);return!i.length||i?.some(e=>e.id===r?.id)},checkIfSupportedChainId(e){if(!C.activeChain)return!0;let t=I.getRequestedCaipNetworks(C.activeChain);return t?.some(t=>t.id===e)},setSmartAccountEnabledNetworks(e,t){I.setAdapterNetworkState(t,{smartAccountEnabledNetworks:e})},checkIfSmartAccountEnabled(){let e=n.p.caipNetworkIdToNumber(C.activeCaipNetwork?.caipNetworkId),t=C.activeChain;if(!t||!e)return!1;let r=I.getNetworkProp("smartAccountEnabledNetworks",t);return!!r?.includes(Number(e))},getActiveNetworkTokenAddress(){let e=C.activeCaipNetwork?.chainNamespace||"eip155",t=C.activeCaipNetwork?.id||1,r=o.bq.NATIVE_TOKEN_ADDRESS[e];return`${e}:${t}:${r}`},showUnsupportedChainUI(){f.I.open({view:"UnsupportedChain"})},checkIfNamesSupported(){let e=C.activeCaipNetwork;return!!(e?.chainNamespace&&o.bq.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(e.chainNamespace))},resetNetwork(e){I.setAdapterNetworkState(e,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]})},resetAccount(e){if(!e)throw Error("Chain is required to set account prop");C.activeCaipAddress=void 0,I.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountTypes:void 0,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,allAccounts:[],user:void 0,status:"disconnected"}),p.A.removeConnectorId(e)},setIsSwitchingNamespace(e){C.isSwitchingNamespace=e},getFirstCaipNetworkSupportsAuthConnector(){let e=[];if(C.chains.forEach(t=>{a.b.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>e===t.namespace)&&t.namespace&&e.push(t.namespace)}),e.length>0){let t=e[0];return t?C.chains.get(t)?.caipNetworks?.[0]:void 0}},getAccountData:e=>e?I.state.chains.get(e)?.accountState:d.N.state,getNetworkData(e){let t=e||C.activeChain;if(t)return I.state.chains.get(t)?.networkState},getCaipNetworkByNamespace(e,t){if(!e)return;let r=I.state.chains.get(e),i=r?.caipNetworks?.find(e=>e.id===t);return i||r?.networkState?.caipNetwork||r?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){let e=p.A.state.filterByNamespace,t=e?[C.chains.get(e)]:Array.from(C.chains.values());return t.flatMap(e=>e?.caipNetworks||[]).map(e=>e.caipNetworkId)},getCaipNetworks:e=>e?I.getRequestedCaipNetworks(e):I.getAllRequestedCaipNetworks()})},98905:function(e,t,r){let i;r.d(t,{l:function(){return C}});var s=r(1495),n=r(63243),a=r(67007),o=r(70580),c=r(72054),l=r(70066),h=r(12309),d=r(32410),u=r(37517),p=r(46560),g=r(64695),f=r(22950),m=r(38750),w=r(79187),y=r(14406);let b=(0,s.sj)({transactions:[],coinbaseTransactions:{},transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),v=(0,c.P)({state:b,subscribe:e=>(0,s.Ld)(b,()=>e(b)),setLastNetworkInView(e){b.lastNetworkInView=e},async fetchTransactions(e,t){if(!e)throw Error("Transactions can't be fetched without an accountAddress");b.loading=!0;try{let r=await m.L.fetchTransactions({account:e,cursor:b.next,onramp:t,cache:"coinbase"===t?"no-cache":void 0,chainId:h.R.state.activeCaipNetwork?.caipNetworkId}),i=v.filterSpamTransactions(r.data),s=v.filterByConnectedChain(i),n=[...b.transactions,...s];b.loading=!1,"coinbase"===t?b.coinbaseTransactions=v.groupTransactionsByYearAndMonth(b.coinbaseTransactions,r.data):(b.transactions=n,b.transactionsByYear=v.groupTransactionsByYearAndMonth(b.transactionsByYear,s)),b.empty=0===n.length,b.next=r.next?r.next:void 0}catch(r){let t=h.R.state.activeChain;u.X.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:e,projectId:w.h.state.projectId,cursor:b.next,isSmartAccount:l.N.state.preferredAccountTypes?.[t]===f.y_.ACCOUNT_TYPES.SMART_ACCOUNT}}),y.K.showError("Failed to fetch transactions"),b.loading=!1,b.empty=!0,b.next=void 0}},groupTransactionsByYearAndMonth(e={},t=[]){let r=e;return t.forEach(e=>{let t=new Date(e.metadata.minedAt).getFullYear(),i=new Date(e.metadata.minedAt).getMonth(),s=r[t]??{},n=s[i]??[],a=n.filter(t=>t.id!==e.id);r[t]={...s,[i]:[...a,e].sort((e,t)=>new Date(t.metadata.minedAt).getTime()-new Date(e.metadata.minedAt).getTime())}}),r},filterSpamTransactions:e=>e.filter(e=>{let t=e.transfers.every(e=>!0===e.nft_info?.flags.is_spam);return!t}),filterByConnectedChain(e){let t=h.R.state.activeCaipNetwork?.caipNetworkId,r=e.filter(e=>e.metadata.chain===t);return r},clearCursor(){b.next=void 0},resetTransactions(){b.transactions=[],b.transactionsByYear={},b.lastNetworkInView=void 0,b.loading=!1,b.empty=!1,b.next=void 0}},"API_ERROR"),E=(0,s.sj)({connections:new Map,wcError:!1,buffering:!1,status:"disconnected"}),C=(0,c.P)({state:E,subscribeKey:(e,t)=>(0,n.VW)(E,e,t),_getClient:()=>E._client,setClient(e){E._client=(0,s.iH)(e)},async connectWalletConnect(){if(a.j.isTelegram()||a.j.isSafari()&&a.j.isIos()){if(i){await i,i=void 0;return}if(!a.j.isPairingExpired(E?.wcPairingExpiry)){let e=E.wcUri;E.wcUri=e;return}i=C._getClient()?.connectWalletConnect?.().catch(()=>void 0),C.state.status="connecting",await i,i=void 0,E.wcPairingExpiry=void 0,C.state.status="connected"}else await C._getClient()?.connectWalletConnect?.()},async connectExternal(e,t,r=!0){await C._getClient()?.connectExternal?.(e),r&&h.R.setActiveNamespace(t)},async reconnectExternal(e){await C._getClient()?.reconnectExternal?.(e);let t=e.chain||h.R.state.activeChain;t&&d.A.setConnectorId(e.id,t)},async setPreferredAccountType(e,t){p.I.setLoading(!0,h.R.state.activeChain);let r=d.A.getAuthConnector();r&&(l.N.setPreferredAccountType(e,t),await r.provider.setPreferredAccount(e),o.M.setPreferredAccountTypes(l.N.state.preferredAccountTypes??{[t]:e}),await C.reconnectExternal(r),p.I.setLoading(!1,h.R.state.activeChain),u.X.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:e,network:h.R.state.activeCaipNetwork?.caipNetworkId||""}}))},signMessage:async e=>C._getClient()?.signMessage(e),parseUnits:(e,t)=>C._getClient()?.parseUnits(e,t),formatUnits:(e,t)=>C._getClient()?.formatUnits(e,t),sendTransaction:async e=>C._getClient()?.sendTransaction(e),getCapabilities:async e=>C._getClient()?.getCapabilities(e),grantPermissions:async e=>C._getClient()?.grantPermissions(e),walletGetAssets:async e=>C._getClient()?.walletGetAssets(e)??{},estimateGas:async e=>C._getClient()?.estimateGas(e),writeContract:async e=>C._getClient()?.writeContract(e),getEnsAddress:async e=>C._getClient()?.getEnsAddress(e),getEnsAvatar:async e=>C._getClient()?.getEnsAvatar(e),checkInstalled:e=>C._getClient()?.checkInstalled?.(e)||!1,resetWcConnection(){E.wcUri=void 0,E.wcPairingExpiry=void 0,E.wcLinking=void 0,E.recentWallet=void 0,E.status="disconnected",v.resetTransactions(),o.M.deleteWalletConnectDeepLink()},resetUri(){E.wcUri=void 0,E.wcPairingExpiry=void 0,i=void 0},finalizeWcConnection(){let{wcLinking:e,recentWallet:t}=C.state;e&&o.M.setWalletConnectDeepLink(e),t&&o.M.setAppKitRecent(t),u.X.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:e?"mobile":"qrcode",name:g.P.state.data?.wallet?.name||"Unknown"}})},setWcBasic(e){E.wcBasic=e},setUri(e){E.wcUri=e,E.wcPairingExpiry=a.j.getPairingExpiry()},setWcLinking(e){E.wcLinking=e},setWcError(e){E.wcError=e,E.buffering=!1},setRecentWallet(e){E.recentWallet=e},setBuffering(e){E.buffering=e},setStatus(e){E.status=e},async disconnect(e){try{await C._getClient()?.disconnect(e)}catch(e){throw new c.g("Failed to disconnect","INTERNAL_SDK_ERROR",e)}},setConnections(e,t){E.connections.set(t,e)},switchAccount({connection:e,address:t,namespace:r}){let i=d.A.state.activeConnectorIds[r],s=i===e.connectorId;if(s){let e=h.R.state.activeCaipNetwork;if(e){let i=`${r}:${e.id}:${t}`;l.N.setCaipAddress(i,r)}else console.warn(`No current network found for namespace "${r}"`)}else{let t=d.A.getConnector(e.connectorId);t?C.connectExternal(t,r):console.warn(`No connector found for namespace "${r}"`)}}})},32410:function(e,t,r){r.d(t,{A:function(){return w}});var i=r(1495),s=r(63243),n=r(53807),a=r(63642),o=r(21052),c=r(70580),l=r(72054),h=r(88049),d=r(12309),u=r(79187),p=r(64695),g=r(10375);let f={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},m=(0,i.sj)({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:{...f},filterByNamespaceMap:{eip155:!0,solana:!0,polkadot:!0,bip122:!0,cosmos:!0}}),w=(0,l.P)({state:m,subscribe:e=>(0,i.Ld)(m,()=>{e(m)}),subscribeKey:(e,t)=>(0,s.VW)(m,e,t),initialize(e){e.forEach(e=>{let t=c.M.getConnectedConnectorId(e);t&&w.setConnectorId(t,e)})},setActiveConnector(e){e&&(m.activeConnector=(0,i.iH)(e))},setConnectors(e){let t=e.filter(e=>!m.allConnectors.some(t=>t.id===e.id&&w.getConnectorName(t.name)===w.getConnectorName(e.name)&&t.chain===e.chain));t.forEach(e=>{"MULTI_CHAIN"!==e.type&&m.allConnectors.push((0,i.iH)(e))});let r=w.getEnabledNamespaces(),s=w.getEnabledConnectors(r);m.connectors=w.mergeMultiChainConnectors(s)},filterByNamespaces(e){Object.keys(m.filterByNamespaceMap).forEach(e=>{m.filterByNamespaceMap[e]=!1}),e.forEach(e=>{m.filterByNamespaceMap[e]=!0}),w.updateConnectorsForEnabledNamespaces()},filterByNamespace(e,t){m.filterByNamespaceMap[e]=t,w.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){let e=w.getEnabledNamespaces(),t=w.getEnabledConnectors(e),r=w.areAllNamespacesEnabled();m.connectors=w.mergeMultiChainConnectors(t),r?h.Q.clearFilterByNamespaces():h.Q.filterByNamespaces(e)},getEnabledNamespaces:()=>Object.entries(m.filterByNamespaceMap).filter(([e,t])=>t).map(([e])=>e),getEnabledConnectors:e=>m.allConnectors.filter(t=>e.includes(t.chain)),areAllNamespacesEnabled:()=>Object.values(m.filterByNamespaceMap).every(e=>e),mergeMultiChainConnectors(e){let t=w.generateConnectorMapByName(e),r=[];return t.forEach(e=>{let t=e[0],i=t?.id===n.b.CONNECTOR_ID.AUTH;e.length>1&&t?r.push({name:t.name,imageUrl:t.imageUrl,imageId:t.imageId,connectors:[...e],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:t?.id||""}):t&&r.push(t)}),r},generateConnectorMapByName(e){let t=new Map;return e.forEach(e=>{let{name:r}=e,i=w.getConnectorName(r);if(!i)return;let s=t.get(i)||[],n=s.find(t=>t.chain===e.chain);n||s.push(e),t.set(i,s)}),t},getConnectorName:e=>e&&({"Trust Wallet":"Trust"})[e]||e,getUniqueConnectorsByName(e){let t=[];return e.forEach(e=>{t.find(t=>t.chain===e.chain)||t.push(e)}),t},addConnector(e){if(e.id===n.b.CONNECTOR_ID.AUTH){let t=(0,i.CO)(u.h.state),r=g.u.getSnapshot().themeMode,s=g.u.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,projectId:t.projectId,sdkType:t.sdkType}),e?.provider?.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:(0,a.t)(s,r)}),w.setConnectors([e])}else w.setConnectors([e])},getAuthConnector(e){let t=e||d.R.state.activeChain,r=m.connectors.find(e=>e.id===n.b.CONNECTOR_ID.AUTH);if(r){if(r?.connectors?.length){let e=r.connectors.find(e=>e.chain===t);return e}return r}},getAnnouncedConnectorRdns:()=>m.connectors.filter(e=>"ANNOUNCED"===e.type).map(e=>e.info?.rdns),getConnectorById:e=>m.allConnectors.find(t=>t.id===e),getConnector(e,t){let r=m.allConnectors.filter(e=>e.chain===d.R.state.activeChain);return r.find(r=>r.explorerId===e||r.info?.rdns===t)},syncIfAuthConnector(e){if("ID_AUTH"!==e.id)return;let t=(0,i.CO)(u.h.state),r=g.u.getSnapshot().themeMode,s=g.u.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,sdkType:t.sdkType,projectId:t.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:(0,a.t)(s,r)})},getConnectorsByNamespace(e){let t=m.allConnectors.filter(t=>t.chain===e);return w.mergeMultiChainConnectors(t)},selectWalletConnector(e){let t=w.getConnector(e.id,e.rdns),r=d.R.state.activeChain;o.R.handleMobileDeeplinkRedirect(t?.explorerId||e.id,r),t?p.P.push("ConnectingExternal",{connector:t}):p.P.push("ConnectingWalletConnect",{wallet:e})},getConnectors:e=>e?w.getConnectorsByNamespace(e):w.mergeMultiChainConnectors(m.allConnectors),setFilterByNamespace(e){m.filterByNamespace=e,m.connectors=w.getConnectors(e),h.Q.setFilterByNamespace(e)},setConnectorId(e,t){e&&(m.activeConnectorIds={...m.activeConnectorIds,[t]:e},c.M.setConnectedConnectorId(t,e))},removeConnectorId(e){m.activeConnectorIds={...m.activeConnectorIds,[e]:void 0},c.M.deleteConnectedConnectorId(e)},getConnectorId(e){if(e)return m.activeConnectorIds[e]},isConnected:e=>e?!!m.activeConnectorIds[e]:Object.values(m.activeConnectorIds).some(e=>!!e),resetConnectorIds(){m.activeConnectorIds={...f}}})},37517:function(e,t,r){r.d(t,{X:function(){return f}});var i=r(1495),s=r(53807),n=r(54990),a=r(67007),o=r(70748),c=r(70066),l=r(6912),h=r(79187);let d=a.j.getAnalyticsUrl(),u=new o.V({baseUrl:d,clientId:null}),p=["MODAL_CREATED"],g=(0,i.sj)({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),f={state:g,subscribe:e=>(0,i.Ld)(g,()=>e(g)),getSdkProperties(){let{projectId:e,sdkType:t,sdkVersion:r}=h.h.state;return{projectId:e,st:t,sv:r||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(e){try{let t=c.N.state.address;if(p.includes(e.data.event)||"undefined"==typeof window)return;await u.post({path:"/e",params:f.getSdkProperties(),body:{eventId:a.j.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:e.timestamp,props:{...e.data,address:t}}}),g.reportedErrors.FORBIDDEN=!1}catch(t){let e=t instanceof Error&&t.cause instanceof Response&&t.cause.status===s.b.HTTP_STATUS_CODES.FORBIDDEN&&!g.reportedErrors.FORBIDDEN;e&&(l.B.open({shortMessage:"Invalid App Configuration",longMessage:`Origin ${(0,n.$U)()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),g.reportedErrors.FORBIDDEN=!0)}},sendEvent(e){g.timestamp=Date.now(),g.data=e,h.h.state.features?.analytics&&f._sendAnalyticsEvent(g)}}},46560:function(e,t,r){r.d(t,{I:function(){return b}});var i=r(1495),s=r(63243),n=r(67007),a=r(53807),o=r(70066),c=r(12309),l=r(32410),h=r(64695);let d={onSwitchNetwork({network:e,ignoreSwitchConfirmation:t=!1}){let r=c.R.state.activeCaipNetwork,i=h.P.state.data,s=e.id===r?.id;if(s)return;let n=o.N.getCaipAddress(c.R.state.activeChain),d=e.chainNamespace!==c.R.state.activeChain,u=o.N.getCaipAddress(e.chainNamespace),p=l.A.getConnectorId(c.R.state.activeChain),g=p===a.b.CONNECTOR_ID.AUTH,f=a.b.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(t=>t===e.chainNamespace);t||g&&f?h.P.push("SwitchNetwork",{...i,network:e}):n&&d&&!u?h.P.push("SwitchActiveChain",{switchToChain:e.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:e}):h.P.push("SwitchNetwork",{...i,network:e})}};var u=r(72054),p=r(88049),g=r(98905),f=r(37517),m=r(79187),w=r(26067);let y=(0,i.sj)({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),b=(0,u.P)({state:y,subscribe:e=>(0,i.Ld)(y,()=>e(y)),subscribeKey:(e,t)=>(0,s.VW)(y,e,t),async open(e){let t="connected"===o.N.state.status,r=e?.namespace,i=c.R.state.activeChain,s=c.R.getAccountData(e?.namespace)?.caipAddress;if(g.l.state.wcBasic?p.Q.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await p.Q.prefetch({fetchConnectorImages:!t,fetchFeaturedWallets:!t,fetchRecommendedWallets:!t}),l.A.setFilterByNamespace(e?.namespace),b.setLoading(!0,r),r&&r&&r!==i){let e=c.R.getNetworkData(r)?.caipNetwork||c.R.getRequestedCaipNetworks(r)[0];e&&d.onSwitchNetwork({network:e,ignoreSwitchConfirmation:!0})}else{let t=c.R.state.noAdapters;m.h.state.manualWCControl||t&&!s?n.j.isMobile()?h.P.reset("AllWallets"):h.P.reset("ConnectingWalletConnectBasic"):e?.view?h.P.reset(e.view,e.data):s?h.P.reset("Account"):h.P.reset("Connect")}y.open=!0,w.I.set({open:!0}),f.X.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){let e=m.h.state.enableEmbedded,t=!!c.R.state.activeCaipAddress;y.open&&f.X.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:t}}),y.open=!1,h.P.reset("Connect"),b.clearLoading(),e?t?h.P.replace("Account"):h.P.push("Connect"):w.I.set({open:!1}),g.l.resetUri()},setLoading(e,t){t&&y.loadingNamespaceMap.set(t,e),y.loading=e,w.I.set({loading:e})},clearLoading(){y.loadingNamespaceMap.clear(),y.loading=!1},shake(){y.shake||(y.shake=!0,setTimeout(()=>{y.shake=!1},500))}})},79187:function(e,t,r){r.d(t,{h:function(){return l}});var i=r(1495),s=r(63243),n=r(24997),a=r(67007);let o={getFeatureValue(e,t){let r=t?.[e];return void 0===r?n.bq.DEFAULT_FEATURES[e]:r},filterSocialsByPlatform(e){if(!e||!e.length)return e;if(a.j.isTelegram()){if(a.j.isIos())return e.filter(e=>"google"!==e);if(a.j.isMac())return e.filter(e=>"x"!==e);if(a.j.isAndroid())return e.filter(e=>!["facebook","x"].includes(e))}return e}},c=(0,i.sj)({features:n.bq.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:n.bq.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{}}),l={state:c,subscribeKey:(e,t)=>(0,s.VW)(c,e,t),setOptions(e){Object.assign(c,e)},setRemoteFeatures(e){if(!e)return;let t={...c.remoteFeatures,...e};c.remoteFeatures=t,c.remoteFeatures?.socials&&(c.remoteFeatures.socials=o.filterSocialsByPlatform(c.remoteFeatures.socials))},setFeatures(e){if(!e)return;c.features||(c.features=n.bq.DEFAULT_FEATURES);let t={...c.features,...e};c.features=t},setProjectId(e){c.projectId=e},setCustomRpcUrls(e){c.customRpcUrls=e},setAllWallets(e){c.allWallets=e},setIncludeWalletIds(e){c.includeWalletIds=e},setExcludeWalletIds(e){c.excludeWalletIds=e},setFeaturedWalletIds(e){c.featuredWalletIds=e},setTokens(e){c.tokens=e},setTermsConditionsUrl(e){c.termsConditionsUrl=e},setPrivacyPolicyUrl(e){c.privacyPolicyUrl=e},setCustomWallets(e){c.customWallets=e},setIsSiweEnabled(e){c.isSiweEnabled=e},setIsUniversalProvider(e){c.isUniversalProvider=e},setSdkVersion(e){c.sdkVersion=e},setMetadata(e){c.metadata=e},setDisableAppend(e){c.disableAppend=e},setEIP6963Enabled(e){c.enableEIP6963=e},setDebug(e){c.debug=e},setEnableWalletConnect(e){c.enableWalletConnect=e},setEnableWalletGuide(e){c.enableWalletGuide=e},setEnableAuthLogger(e){c.enableAuthLogger=e},setEnableWallets(e){c.enableWallets=e},setPreferUniversalLinks(e){c.experimental_preferUniversalLinks=e},setHasMultipleAddresses(e){c.hasMultipleAddresses=e},setSIWX(e){c.siwx=e},setConnectMethodsOrder(e){c.features={...c.features,connectMethodsOrder:e}},setWalletFeaturesOrder(e){c.features={...c.features,walletFeaturesOrder:e}},setSocialsOrder(e){c.remoteFeatures={...c.remoteFeatures,socials:e}},setCollapseWallets(e){c.features={...c.features,collapseWallets:e}},setEnableEmbedded(e){c.enableEmbedded=e},setAllowUnsupportedChain(e){c.allowUnsupportedChain=e},setManualWCControl(e){c.manualWCControl=e},setEnableNetworkSwitch(e){c.enableNetworkSwitch=e},setDefaultAccountTypes(e={}){Object.entries(e).forEach(([e,t])=>{t&&(c.defaultAccountTypes[e]=t)})},setUniversalProviderConfigOverride(e){c.universalProviderConfigOverride=e},getUniversalProviderConfigOverride:()=>c.universalProviderConfigOverride,getSnapshot:()=>(0,i.CO)(c)}},26067:function(e,t,r){r.d(t,{I:function(){return a}});var i=r(1495),s=r(63243);let n=(0,i.sj)({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),a={state:n,subscribe:e=>(0,i.Ld)(n,()=>e(n)),subscribeOpen:e=>(0,s.VW)(n,"open",e),set(e){Object.assign(n,{...n,...e})}}},64695:function(e,t,r){r.d(t,{P:function(){return u}});var i=r(1495),s=r(63243),n=r(72054),a=r(70066),o=r(12309),c=r(32410),l=r(46560),h=r(79187);let d=(0,i.sj)({view:"Connect",history:["Connect"],transactionStack:[]}),u=(0,n.P)({state:d,subscribeKey:(e,t)=>(0,s.VW)(d,e,t),pushTransactionStack(e){d.transactionStack.push(e)},popTransactionStack(e){let t=d.transactionStack.pop();if(!t)return;let{onSuccess:r,onError:i,onCancel:s}=t;switch(e){case"success":r?.();break;case"error":i?.(),u.goBack();break;case"cancel":s?.(),u.goBack()}},push(e,t){e!==d.view&&(d.view=e,d.history.push(e),d.data=t)},reset(e,t){d.view=e,d.history=[e],d.data=t},replace(e,t){let r=d.history.at(-1);r!==e&&(d.view=e,d.history[d.history.length-1]=e,d.data=t)},goBack(){let e=o.R.state.activeCaipAddress,t="ConnectingFarcaster"===u.state.view,r=!e&&t;if(d.history.length>1){d.history.pop();let[t]=d.history.slice(-1);t&&(e&&"Connect"===t?d.view="Account":d.view=t)}else l.I.close();d.data?.wallet&&(d.data.wallet=void 0),setTimeout(()=>{if(r){a.N.setFarcasterUrl(void 0,o.R.state.activeChain);let e=c.A.getAuthConnector();e?.provider?.reload();let t=(0,i.CO)(h.h.state);e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,projectId:t.projectId,sdkType:t.sdkType})}},100)},goBackToIndex(e){if(d.history.length>1){d.history=d.history.slice(0,e+1);let[t]=d.history.slice(-1);t&&(d.view=t)}},goBackOrCloseModal(){u.state.history.length>1?u.goBack():l.I.close()}})},64616:function(e,t,r){r.d(t,{S:function(){return S}});var i=r(1495),s=r(63243),n=r(47342);let a={bigNumber:e=>new n.Z(e||0),multiply(e,t){if(void 0===e||void 0===t)return new n.Z(0);let r=new n.Z(e),i=new n.Z(t);return r.times(i)},formatNumberToLocalString:(e,t=2)=>void 0===e?"0.00":"number"==typeof e?e.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}):parseFloat(e).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}),parseLocalStringToNumber:e=>void 0===e?0:parseFloat(e.replace(/,/gu,""))},o=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],c=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],l=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}];var h=r(53807);let d={getERC20Abi:e=>h.b.USDT_CONTRACT_ADDRESSES.includes(e)?l:o,getSwapAbi:()=>c};var u=r(22950),p=r(24997),g=r(67007),f=r(70066),m=r(38750),w=r(12309),y=r(98905),b=r(34551);let v={createBalance(e,t){let r={name:e.metadata.name||"",symbol:e.metadata.symbol||"",decimals:e.metadata.decimals||0,value:e.metadata.value||0,price:e.metadata.price||0,iconUrl:e.metadata.iconUrl||""};return{name:r.name,symbol:r.symbol,chainId:t,address:"native"===e.address?void 0:this.convertAddressToCAIP10Address(e.address,t),value:r.value,price:r.price,quantity:{decimals:r.decimals.toString(),numeric:this.convertHexToBalance({hex:e.balance,decimals:r.decimals})},iconUrl:r.iconUrl}},convertHexToBalance:({hex:e,decimals:t})=>(0,b.b)(BigInt(e),t),convertAddressToCAIP10Address:(e,t)=>`${t}:${e}`,createCAIP2ChainId:(e,t)=>`${t}:${parseInt(e,16)}`,getChainIdHexFromCAIP2ChainId(e){let t=e.split(":");if(t.length<2||!t[1])return"0x0";let r=t[1],i=parseInt(r,10);return isNaN(i)?"0x0":`0x${i.toString(16)}`},isWalletGetAssetsResponse(e){return"object"==typeof e&&null!==e&&Object.values(e).every(e=>Array.isArray(e)&&e.every(e=>this.isValidAsset(e)))},isValidAsset:e=>"object"==typeof e&&null!==e&&"string"==typeof e.address&&"string"==typeof e.balance&&("ERC20"===e.type||"NATIVE"===e.type)&&"object"==typeof e.metadata&&null!==e.metadata&&"string"==typeof e.metadata.name&&"string"==typeof e.metadata.symbol&&"number"==typeof e.metadata.decimals&&"number"==typeof e.metadata.price&&"string"==typeof e.metadata.iconUrl},E={async getMyTokensWithBalance(e){let t=f.N.state.address,r=w.R.state.activeCaipNetwork;if(!t||!r)return[];if("eip155"===r.chainNamespace){let e=await this.getEIP155Balances(t,r);if(e)return this.filterLowQualityTokens(e)}let i=await m.L.getBalance(t,r.caipNetworkId,e);return this.filterLowQualityTokens(i.balances)},async getEIP155Balances(e,t){try{let r=v.getChainIdHexFromCAIP2ChainId(t.caipNetworkId),i=await y.l.getCapabilities(e);if(!i?.[r]?.assetDiscovery?.supported)return null;let s=await y.l.walletGetAssets({account:e,chainFilter:[r]});if(!v.isWalletGetAssetsResponse(s))return null;let n=s[r]||[];return n.map(e=>v.createBalance(e,t.caipNetworkId))}catch(e){return null}},filterLowQualityTokens:e=>e.filter(e=>"0"!==e.quantity.decimals),mapBalancesToSwapTokens:e=>e?.map(e=>({...e,address:e?.address?e.address:w.R.getActiveNetworkTokenAddress(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1}))||[]};var C=r(72054),I=r(37517),N=r(64695),A=r(14406);let _=(0,i.sj)({tokenBalances:[],loading:!1}),S=(0,C.P)({state:_,subscribe:e=>(0,i.Ld)(_,()=>e(_)),subscribeKey:(e,t)=>(0,s.VW)(_,e,t),setToken(e){e&&(_.token=(0,i.iH)(e))},setTokenAmount(e){_.sendTokenAmount=e},setReceiverAddress(e){_.receiverAddress=e},setReceiverProfileImageUrl(e){_.receiverProfileImageUrl=e},setReceiverProfileName(e){_.receiverProfileName=e},setNetworkBalanceInUsd(e){_.networkBalanceInUSD=e},setLoading(e){_.loading=e},async sendToken(){try{switch(S.setLoading(!0),w.R.state.activeCaipNetwork?.chainNamespace){case"eip155":await S.sendEvmToken();return;case"solana":await S.sendSolanaToken();return;default:throw Error("Unsupported chain")}}finally{S.setLoading(!1)}},async sendEvmToken(){let e=w.R.state.activeChain,t=f.N.state.preferredAccountTypes?.[e];if(!S.state.sendTokenAmount||!S.state.receiverAddress)throw Error("An amount and receiver address are required");if(!S.state.token)throw Error("A token is required");S.state.token?.address?(I.X.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:t===u.y_.ACCOUNT_TYPES.SMART_ACCOUNT,token:S.state.token.address,amount:S.state.sendTokenAmount,network:w.R.state.activeCaipNetwork?.caipNetworkId||""}}),await S.sendERC20Token({receiverAddress:S.state.receiverAddress,tokenAddress:S.state.token.address,sendTokenAmount:S.state.sendTokenAmount,decimals:S.state.token.quantity.decimals})):(I.X.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:t===u.y_.ACCOUNT_TYPES.SMART_ACCOUNT,token:S.state.token.symbol||"",amount:S.state.sendTokenAmount,network:w.R.state.activeCaipNetwork?.caipNetworkId||""}}),await S.sendNativeToken({receiverAddress:S.state.receiverAddress,sendTokenAmount:S.state.sendTokenAmount,decimals:S.state.token.quantity.decimals}))},async fetchTokenBalance(e){_.loading=!0;let t=w.R.state.activeCaipNetwork?.caipNetworkId,r=w.R.state.activeCaipNetwork?.chainNamespace,i=w.R.state.activeCaipAddress,s=i?g.j.getPlainAddress(i):void 0;if(_.lastRetry&&!g.j.isAllowedRetry(_.lastRetry,30*p.bq.ONE_SEC_MS))return _.loading=!1,[];try{if(s&&t&&r){let e=await E.getMyTokensWithBalance();return _.tokenBalances=e,_.lastRetry=void 0,e}}catch(t){_.lastRetry=Date.now(),e?.(t),A.K.showError("Token Balance Unavailable")}finally{_.loading=!1}return[]},fetchNetworkBalance(){if(0===_.tokenBalances.length)return;let e=E.mapBalancesToSwapTokens(_.tokenBalances);if(!e)return;let t=e.find(e=>e.address===w.R.getActiveNetworkTokenAddress());t&&(_.networkBalanceInUSD=t?a.multiply(t.quantity.numeric,t.price).toString():"0")},async sendNativeToken(e){N.P.pushTransactionStack({});let t=e.receiverAddress,r=f.N.state.address,i=y.l.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));await y.l.sendTransaction({chainNamespace:"eip155",to:t,address:r,data:"0x",value:i??BigInt(0)}),I.X.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:f.N.state.preferredAccountTypes?.eip155===u.y_.ACCOUNT_TYPES.SMART_ACCOUNT,token:S.state.token?.symbol||"",amount:e.sendTokenAmount,network:w.R.state.activeCaipNetwork?.caipNetworkId||""}}),y.l._getClient()?.updateBalance("eip155"),S.resetSend()},async sendERC20Token(e){N.P.pushTransactionStack({onSuccess(){N.P.replace("Account")}});let t=y.l.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));if(f.N.state.address&&e.sendTokenAmount&&e.receiverAddress&&e.tokenAddress){let r=g.j.getPlainAddress(e.tokenAddress);await y.l.writeContract({fromAddress:f.N.state.address,tokenAddress:r,args:[e.receiverAddress,t??BigInt(0)],method:"transfer",abi:d.getERC20Abi(r),chainNamespace:"eip155"}),S.resetSend()}},async sendSolanaToken(){if(!S.state.sendTokenAmount||!S.state.receiverAddress)throw Error("An amount and receiver address are required");N.P.pushTransactionStack({onSuccess(){N.P.replace("Account")}}),await y.l.sendTransaction({chainNamespace:"solana",to:S.state.receiverAddress,value:S.state.sendTokenAmount}),y.l._getClient()?.updateBalance("solana"),S.resetSend()},resetSend(){_.token=void 0,_.sendTokenAmount=void 0,_.receiverAddress=void 0,_.receiverProfileImageUrl=void 0,_.receiverProfileName=void 0,_.loading=!1,_.tokenBalances=[]}})},14406:function(e,t,r){r.d(t,{K:function(){return c}});var i=r(1495),s=r(63243),n=r(67007);let a=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),o=(0,i.sj)({...a}),c={state:o,subscribeKey:(e,t)=>(0,s.VW)(o,e,t),showLoading(e,t={}){this._showMessage({message:e,variant:"loading",...t})},showSuccess(e){this._showMessage({message:e,variant:"success"})},showSvg(e,t){this._showMessage({message:e,svg:t})},showError(e){let t=n.j.parseError(e);this._showMessage({message:t,variant:"error"})},hide(){o.message=a.message,o.variant=a.variant,o.svg=a.svg,o.open=a.open,o.autoClose=a.autoClose},_showMessage({message:e,svg:t,variant:r="success",autoClose:i=a.autoClose}){o.open?(o.open=!1,setTimeout(()=>{o.message=e,o.variant=r,o.svg=t,o.open=!0,o.autoClose=i},150)):(o.message=e,o.variant=r,o.svg=t,o.open=!0,o.autoClose=i)}}},10375:function(e,t,r){r.d(t,{u:function(){return l}});var i=r(1495),s=r(63642),n=r(72054),a=r(32410);let o=(0,i.sj)({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),c={state:o,subscribe:e=>(0,i.Ld)(o,()=>e(o)),setThemeMode(e){o.themeMode=e;try{let t=a.A.getAuthConnector();if(t){let r=c.getSnapshot().themeVariables;t.provider.syncTheme({themeMode:e,themeVariables:r,w3mThemeVariables:(0,s.t)(r,e)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(e){o.themeVariables={...o.themeVariables,...e};try{let e=a.A.getAuthConnector();if(e){let t=c.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:t,w3mThemeVariables:(0,s.t)(o.themeVariables,o.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot:()=>(0,i.CO)(o)},l=(0,n.P)(c)},62661:function(e,t,r){r.d(t,{f:function(){return c}});var i=r(1495),s=r(88049),n=r(2013);let a={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:""},o=(0,i.sj)({networkImagePromises:{}}),c={async fetchWalletImage(e){if(e)return await s.Q._fetchWalletImage(e),this.getWalletImageById(e)},async fetchNetworkImage(e){if(!e)return;let t=this.getNetworkImageById(e);return t||(o.networkImagePromises[e]||(o.networkImagePromises[e]=s.Q._fetchNetworkImage(e)),await o.networkImagePromises[e],this.getNetworkImageById(e))},getWalletImageById(e){if(e)return n.W.state.walletImages[e]},getWalletImage:e=>e?.image_url?e?.image_url:e?.image_id?n.W.state.walletImages[e.image_id]:void 0,getNetworkImage:e=>e?.assets?.imageUrl?e?.assets?.imageUrl:e?.assets?.imageId?n.W.state.networkImages[e.assets.imageId]:void 0,getNetworkImageById(e){if(e)return n.W.state.networkImages[e]},getConnectorImage:e=>e?.imageUrl?e.imageUrl:e?.imageId?n.W.state.connectorImages[e.imageId]:void 0,getChainImage:e=>n.W.state.networkImages[a[e]]}},24997:function(e,t,r){r.d(t,{a$:function(){return a},bq:function(){return o},gy:function(){return n}});var i=r(34406);let s=(void 0!==i&&void 0!==i.env?i.env.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",n=[{label:"Coinbase",name:"coinbase",feeRange:"1-2%",url:"",supportedChains:["eip155"]},{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],a="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",o={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:s,SECURE_SITE_DASHBOARD:`${s}/dashboard`,SECURE_SITE_FAVICON:`${s}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],WC_COINBASE_PAY_SDK_CHAINS:["ethereum","arbitrum","polygon","berachain","avalanche-c-chain","optimism","celo","base"],WC_COINBASE_PAY_SDK_FALLBACK_CHAIN:"ethereum",WC_COINBASE_PAY_SDK_CHAIN_NAME_MAP:{Ethereum:"ethereum","Arbitrum One":"arbitrum",Polygon:"polygon",Berachain:"berachain",Avalanche:"avalanche-c-chain","OP Mainnet":"optimism",Celo:"celo",Base:"base"},WC_COINBASE_ONRAMP_APP_ID:"bf18c88d-495a-463b-b249-0b9d3656cf5e",SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:["eip155","solana"],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:["eip155"],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:["eip155","solana"],ACTIVITY_ENABLED_CHAIN_NAMESPACES:["eip155"],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:["eip155","solana"],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["coinbase","meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"}}},67007:function(e,t,r){r.d(t,{j:function(){return a}});var i=r(53807),s=r(24997),n=r(70580);let a={isMobile(){return!!this.isClient()&&!!("function"==typeof window?.matchMedia&&window?.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent))},checkCaipNetwork:(e,t="")=>e?.caipNetworkId.toLocaleLowerCase().includes(t.toLowerCase()),isAndroid(){if(!this.isMobile())return!1;let e=window?.navigator.userAgent.toLowerCase();return a.isMobile()&&e.includes("android")},isIos(){if(!this.isMobile())return!1;let e=window?.navigator.userAgent.toLowerCase();return e.includes("iphone")||e.includes("ipad")},isSafari(){if(!this.isClient())return!1;let e=window?.navigator.userAgent.toLowerCase();return e.includes("safari")},isClient:()=>"undefined"!=typeof window,isPairingExpired:e=>!e||e-Date.now()<=s.bq.TEN_SEC_MS,isAllowedRetry:(e,t=s.bq.ONE_SEC_MS)=>Date.now()-e>=t,copyToClopboard(e){navigator.clipboard.writeText(e)},isIframe(){try{return window?.self!==window?.top}catch(e){return!1}},isSafeApp(){if(a.isClient()&&window.self!==window.top)try{let e=window?.location?.ancestorOrigins?.[0];if(e){let t=new URL(e),r=new URL("https://app.safe.global");return t.hostname===r.hostname}}catch{}return!1},getPairingExpiry:()=>Date.now()+s.bq.FOUR_MINUTES_MS,getNetworkId:e=>e?.split(":")[1],getPlainAddress:e=>e?.split(":")[2],wait:async e=>new Promise(t=>{setTimeout(t,e)}),debounce(e,t=500){let r;return(...i)=>{r&&clearTimeout(r),r=setTimeout(function(){e(...i)},t)}},isHttpUrl:e=>e.startsWith("http://")||e.startsWith("https://"),formatNativeUrl(e,t,r=null){if(a.isHttpUrl(e))return this.formatUniversalUrl(e,t);let i=e,s=r;i.includes("://")||(i=`${i=e.replaceAll("/","").replaceAll(":","")}://`),i.endsWith("/")||(i=`${i}/`),s&&!s?.endsWith("/")&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(t=encodeURIComponent(t));let n=encodeURIComponent(t);return{redirect:`${i}wc?uri=${n}`,redirectUniversalLink:s?`${s}wc?uri=${n}`:void 0,href:i}},formatUniversalUrl(e,t){if(!a.isHttpUrl(e))return this.formatNativeUrl(e,t);let r=e;r.endsWith("/")||(r=`${r}/`);let i=encodeURIComponent(t);return{redirect:`${r}wc?uri=${i}`,href:r}},getOpenTargetForPlatform(e){return"popupWindow"===e?e:this.isTelegram()?n.M.getTelegramSocialProvider()?"_top":"_blank":e},openHref(e,t,r){window?.open(e,this.getOpenTargetForPlatform(t),r||"noreferrer noopener")},returnOpenHref(e,t,r){return window?.open(e,this.getOpenTargetForPlatform(t),r||"noreferrer noopener")},isTelegram:()=>"undefined"!=typeof window&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto),isPWA(){if("undefined"==typeof window)return!1;let e=window.matchMedia?.("(display-mode: standalone)")?.matches,t=window?.navigator?.standalone;return!!(e||t)},async preloadImage(e){let t=new Promise((t,r)=>{let i=new Image;i.onload=t,i.onerror=r,i.crossOrigin="anonymous",i.src=e});return Promise.race([t,a.wait(2e3)])},formatBalance(e,t){let r="0.000";if("string"==typeof e){let t=Number(e);if(t){let e=Math.floor(1e3*t)/1e3;e&&(r=e.toString())}}return`${r}${t?` ${t}`:""}`},formatBalance2(e,t){let r;if("0"===e)r="0";else if("string"==typeof e){let t=Number(e);t&&(r=t.toString().match(/^-?\d+(?:\.\d{0,3})?/u)?.[0])}return{value:r??"0",rest:"0"===r?"000":"",symbol:t}},getApiUrl:()=>i.b.W3M_API_URL,getBlockchainApiUrl:()=>i.b.BLOCKCHAIN_API_RPC_URL,getAnalyticsUrl:()=>i.b.PULSE_API_URL,getUUID:()=>crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),parseError:e=>"string"==typeof e?e:"string"==typeof e?.issues?.[0]?.message?e.issues[0].message:e instanceof Error?e.message:"Unknown error",sortRequestedNetworks(e,t=[]){let r={};return t&&e&&(e.forEach((e,t)=>{r[e]=t}),t.sort((e,t)=>{let i=r[e.id],s=r[t.id];return void 0!==i&&void 0!==s?i-s:void 0!==i?-1:void 0!==s?1:0})),t},calculateBalance(e){let t=0;for(let r of e)t+=r.value??0;return t},formatTokenBalance(e){let t=e.toFixed(2),[r,i]=t.split(".");return{dollars:r,pennies:i}},isAddress(e,t="eip155"){switch(t){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(e)&&(/^(?:0x)?[0-9a-f]{40}$/iu.test(e)||/^(?:0x)?[0-9A-F]{40}$/iu.test(e)))return!0;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(e);default:return!1}},uniqueBy(e,t){let r=new Set;return e.filter(e=>{let i=e[t];return!r.has(i)&&(r.add(i),!0)})},generateSdkVersion(e,t,r){let i=0===e.length,n=i?s.bq.ADAPTER_TYPES.UNIVERSAL:e.map(e=>e.adapterType).join(",");return`${t}-${n}-${r}`},createAccount:(e,t,r,i,s)=>({namespace:e,address:t,type:r,publicKey:i,path:s}),isCaipAddress(e){if("string"!=typeof e)return!1;let t=e.split(":"),r=t[0];return 3===t.filter(Boolean).length&&r in i.b.CHAIN_NAME_MAP},isMac(){let e=window?.navigator.userAgent.toLowerCase();return e.includes("macintosh")&&!e.includes("safari")},formatTelegramSocialLoginUrl(e){let t=`--${encodeURIComponent(window?.location.href)}`,r="state=",i=new URL(e);if("auth.magic.link"===i.host){let i="provider_authorization_url=",s=e.substring(e.indexOf(i)+i.length),n=this.injectIntoUrl(decodeURIComponent(s),r,t);return e.replace(s,encodeURIComponent(n))}return this.injectIntoUrl(e,r,t)},injectIntoUrl(e,t,r){let i=e.indexOf(t);if(-1===i)throw Error(`${t} parameter not found in the URL: ${e}`);let s=e.indexOf("&",i),n=t.length,a=-1!==s?s:e.length,o=e.substring(0,i+n),c=e.substring(i+n,a),l=e.substring(s);return o+(c+r)+l}}},70748:function(e,t,r){async function i(...e){let t=await fetch(...e);if(!t.ok){let e=Error(`HTTP status code: ${t.status}`,{cause:t});throw e}return t}r.d(t,{V:function(){return s}});class s{constructor({baseUrl:e,clientId:t}){this.baseUrl=e,this.clientId=t}async get({headers:e,signal:t,cache:r,...s}){let n=this.createUrl(s),a=await i(n,{method:"GET",headers:e,signal:t,cache:r});return a.json()}async getBlob({headers:e,signal:t,...r}){let s=this.createUrl(r),n=await i(s,{method:"GET",headers:e,signal:t});return n.blob()}async post({body:e,headers:t,signal:r,...s}){let n=this.createUrl(s),a=await i(n,{method:"POST",headers:t,body:e?JSON.stringify(e):void 0,signal:r});return a.json()}async put({body:e,headers:t,signal:r,...s}){let n=this.createUrl(s),a=await i(n,{method:"PUT",headers:t,body:e?JSON.stringify(e):void 0,signal:r});return a.json()}async delete({body:e,headers:t,signal:r,...s}){let n=this.createUrl(s),a=await i(n,{method:"DELETE",headers:t,body:e?JSON.stringify(e):void 0,signal:r});return a.json()}createUrl({path:e,params:t}){let r=new URL(e,this.baseUrl);return t&&Object.entries(t).forEach(([e,t])=>{t&&r.searchParams.append(e,t)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}}},21052:function(e,t,r){r.d(t,{R:function(){return n},m:function(){return s}});var i=r(53807);let s={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"}},n={handleMobileDeeplinkRedirect(e,t){let r=window.location.href,n=encodeURIComponent(r);if(e===s.PHANTOM.id&&!("phantom"in window)){let e=r.startsWith("https")?"https":"http",t=r.split("/")[2],i=encodeURIComponent(`${e}://${t}`);window.location.href=`${s.PHANTOM.url}/ul/browse/${n}?ref=${i}`}e!==s.SOLFLARE.id||"solflare"in window||(window.location.href=`${s.SOLFLARE.url}/ul/v1/browse/${n}?ref=${n}`),t!==i.b.CHAIN.SOLANA||e!==s.COINBASE.id||"coinbaseSolana"in window||(window.location.href=`${s.COINBASE.url}/dapp?cb_url=${n}`)}}},7113:function(e,t,r){r.d(t,{w:function(){return f}}),r(18776),r(66282),r(81154),r(55494),r(22699),r(48834).Buffer,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var i=r(53807),s=r(22950),n=r(70066),a=r(12309),o=r(98905),c=r(32410),l=r(37517),h=r(46560),d=r(79187),u=r(64695),p=r(14406),g=r(67007);let f={getSIWX:()=>d.h.state.siwx,async initializeIfEnabled(){let e=d.h.state.siwx,t=a.R.getActiveCaipAddress();if(!(e&&t))return;let[r,i,s]=t.split(":");if(a.R.checkIfSupportedNetwork(r))try{let t=await e.getSessions(`${r}:${i}`,s);if(t.length)return;await h.I.open({view:"SIWXSignMessage"})}catch(e){console.error("SIWXUtil:initializeIfEnabled",e),l.X.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await o.l._getClient()?.disconnect().catch(console.error),u.P.reset("Connect"),p.K.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){let e=d.h.state.siwx,t=g.j.getPlainAddress(a.R.getActiveCaipAddress()),r=a.R.getActiveCaipNetwork(),s=o.l._getClient();if(!e)throw Error("SIWX is not enabled");if(!t)throw Error("No ActiveCaipAddress found");if(!r)throw Error("No ActiveCaipNetwork or client found");if(!s)throw Error("No ConnectionController client found");try{let n=await e.createMessage({chainId:r.caipNetworkId,accountAddress:t}),a=n.toString(),o=c.A.getConnectorId(r.chainNamespace);o===i.b.CONNECTOR_ID.AUTH&&u.P.pushTransactionStack({});let d=await s.signMessage(a);await e.addSession({data:n,message:a,signature:d}),h.I.close(),l.X.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(t){let e=this.getSIWXEventProperties();h.I.state.open&&"ApproveTransaction"!==u.P.state.view||await h.I.open({view:"SIWXSignMessage"}),e.isSmartAccount?p.K.showError("This application might not support Smart Accounts"):p.K.showError("Signature declined"),l.X.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:e}),console.error("SWIXUtil:requestSignMessage",t)}},async cancelSignMessage(){try{let e=this.getSIWX(),t=e?.getRequired?.();t?await o.l.disconnect():h.I.close(),u.P.reset("Connect"),l.X.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getSessions(){let e=d.h.state.siwx,t=g.j.getPlainAddress(a.R.getActiveCaipAddress()),r=a.R.getActiveCaipNetwork();return e&&t&&r?e.getSessions(r.caipNetworkId,t):[]},async isSIWXCloseDisabled(){let e=this.getSIWX();if(e){let t="ApproveTransaction"===u.P.state.view,r="SIWXSignMessage"===u.P.state.view;if(t||r)return e.getRequired?.()&&0===(await this.getSessions()).length}return!1},async universalProviderAuthenticate({universalProvider:e,chains:t,methods:r}){let i=f.getSIWX(),s=new Set(t.map(e=>e.split(":")[0]));if(!i||1!==s.size||!s.has("eip155"))return!1;let o=await i.createMessage({chainId:a.R.getActiveCaipNetwork()?.caipNetworkId||"",accountAddress:""}),c=await e.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:r,chains:[o.chainId,...t.filter(e=>e!==o.chainId)]});if(p.K.showLoading("Authenticating...",{autoClose:!1}),n.N.setConnectedWalletInfo({...c.session.peer.metadata,name:c.session.peer.metadata.name,icon:c.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"},Array.from(s)[0]),c?.auths?.length){let t=c.auths.map(t=>{let r=e.client.formatAuthMessage({request:t.p,iss:t.p.iss});return{data:{...t.p,accountAddress:t.p.iss.split(":").slice(-1).join(""),chainId:t.p.iss.split(":").slice(2,4).join(":"),uri:t.p.aud,version:t.p.version||o.version,expirationTime:t.p.exp,issuedAt:t.p.iat,notBefore:t.p.nbf},message:r,signature:t.s.s,cacao:t}});try{await i.setSessions(t),l.X.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:f.getSIWXEventProperties()})}catch(t){throw console.error("SIWX:universalProviderAuth - failed to set sessions",t),l.X.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:f.getSIWXEventProperties()}),await e.disconnect().catch(console.error),t}finally{p.K.hide()}}return!0},getSIWXEventProperties(){let e=a.R.state.activeChain;return{network:a.R.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:n.N.state.preferredAccountTypes?.[e]===s.y_.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){let e=this.getSIWX();e&&await e.setSessions([])}}},70580:function(e,t,r){r.d(t,{M:function(){return s}});var i=r(54990);let s={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5},isCacheExpired:(e,t)=>Date.now()-e>t,getActiveNetworkProps(){let e=s.getActiveNamespace(),t=s.getActiveCaipNetworkId(),r=t?t.split(":")[1]:void 0,i=r?isNaN(Number(r))?r:Number(r):void 0;return{namespace:e,caipNetworkId:t,chainId:i}},setWalletConnectDeepLink({name:e,href:t}){try{i.mr.setItem(i.uJ.DEEPLINK_CHOICE,JSON.stringify({href:t,name:e}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{let e=i.mr.getItem(i.uJ.DEEPLINK_CHOICE);if(e)return JSON.parse(e)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{i.mr.removeItem(i.uJ.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(e){try{i.mr.setItem(i.uJ.ACTIVE_NAMESPACE,e)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(e){try{i.mr.setItem(i.uJ.ACTIVE_CAIP_NETWORK_ID,e),s.setActiveNamespace(e.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return i.mr.getItem(i.uJ.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{i.mr.removeItem(i.uJ.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(e){try{let t=(0,i.Vk)(e);i.mr.removeItem(t)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(e){try{let t=s.getRecentWallets(),r=t.find(t=>t.id===e.id);r||(t.unshift(e),t.length>2&&t.pop(),i.mr.setItem(i.uJ.RECENT_WALLETS,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{let e=i.mr.getItem(i.uJ.RECENT_WALLETS);return e?JSON.parse(e):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(e,t){try{let r=(0,i.Vk)(e);i.mr.setItem(r,t)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{let e=i.mr.getItem(i.uJ.ACTIVE_NAMESPACE);return e}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(e){if(e)try{let t=(0,i.Vk)(e);return i.mr.getItem(t)}catch(t){console.info("Unable to get connected connector id in namespace ",e)}},setConnectedSocialProvider(e){try{i.mr.setItem(i.uJ.CONNECTED_SOCIAL,e)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return i.mr.getItem(i.uJ.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{i.mr.removeItem(i.uJ.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return i.mr.getItem(i.uJ.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){let e=i.mr.getItem(i.uJ.ACTIVE_CAIP_NETWORK_ID),t=e?.split(":")?.[1];return t},setConnectionStatus(e){try{i.mr.setItem(i.uJ.CONNECTION_STATUS,e)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return i.mr.getItem(i.uJ.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{let e=i.mr.getItem(i.uJ.CONNECTED_NAMESPACES);if(!e?.length)return[];return e.split(",")}catch{return[]}},setConnectedNamespaces(e){try{let t=Array.from(new Set(e));i.mr.setItem(i.uJ.CONNECTED_NAMESPACES,t.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(e){try{let t=s.getConnectedNamespaces();t.includes(e)||(t.push(e),s.setConnectedNamespaces(t))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(e){try{let t=s.getConnectedNamespaces(),r=t.indexOf(e);r>-1&&(t.splice(r,1),s.setConnectedNamespaces(t))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return i.mr.getItem(i.uJ.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(e){try{i.mr.setItem(i.uJ.TELEGRAM_SOCIAL_PROVIDER,e)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{i.mr.removeItem(i.uJ.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let e={};try{let t=i.mr.getItem(i.uJ.PORTFOLIO_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromBalanceCache(e){try{let t=s.getBalanceCache();i.mr.setItem(i.uJ.PORTFOLIO_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getBalanceCacheForCaipAddress(e){try{let t=s.getBalanceCache(),r=t[e];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.portfolio))return r.balance;s.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateBalanceCache(e){try{let t=s.getBalanceCache();t[e.caipAddress]=e,i.mr.setItem(i.uJ.PORTFOLIO_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getNativeBalanceCache(){let e={};try{let t=i.mr.getItem(i.uJ.NATIVE_BALANCE_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromNativeBalanceCache(e){try{let t=s.getBalanceCache();i.mr.setItem(i.uJ.NATIVE_BALANCE_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getNativeBalanceCacheForCaipAddress(e){try{let t=s.getNativeBalanceCache(),r=t[e];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.nativeBalance))return r;console.info("Discarding cache for address",e),s.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateNativeBalanceCache(e){try{let t=s.getNativeBalanceCache();t[e.caipAddress]=e,i.mr.setItem(i.uJ.NATIVE_BALANCE_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getEnsCache(){let e={};try{let t=i.mr.getItem(i.uJ.ENS_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get ens name cache")}return e},getEnsFromCacheForAddress(e){try{let t=s.getEnsCache(),r=t[e];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.ens))return r.ens;s.removeEnsFromCache(e)}catch{console.info("Unable to get ens name from cache",e)}},updateEnsCache(e){try{let t=s.getEnsCache();t[e.address]=e,i.mr.setItem(i.uJ.ENS_CACHE,JSON.stringify(t))}catch{console.info("Unable to update ens name cache",e)}},removeEnsFromCache(e){try{let t=s.getEnsCache();i.mr.setItem(i.uJ.ENS_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove ens name from cache",e)}},getIdentityCache(){let e={};try{let t=i.mr.getItem(i.uJ.IDENTITY_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get identity cache")}return e},getIdentityFromCacheForAddress(e){try{let t=s.getIdentityCache(),r=t[e];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.identity))return r.identity;s.removeIdentityFromCache(e)}catch{console.info("Unable to get identity from cache",e)}},updateIdentityCache(e){try{let t=s.getIdentityCache();t[e.address]={identity:e.identity,timestamp:e.timestamp},i.mr.setItem(i.uJ.IDENTITY_CACHE,JSON.stringify(t))}catch{console.info("Unable to update identity cache",e)}},removeIdentityFromCache(e){try{let t=s.getIdentityCache();i.mr.setItem(i.uJ.IDENTITY_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove identity from cache",e)}},clearAddressCache(){try{i.mr.removeItem(i.uJ.PORTFOLIO_CACHE),i.mr.removeItem(i.uJ.NATIVE_BALANCE_CACHE),i.mr.removeItem(i.uJ.ENS_CACHE),i.mr.removeItem(i.uJ.IDENTITY_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(e){try{i.mr.setItem(i.uJ.PREFERRED_ACCOUNT_TYPES,JSON.stringify(e))}catch{console.info("Unable to set preferred account types",e)}},getPreferredAccountTypes(){try{let e=i.mr.getItem(i.uJ.PREFERRED_ACCOUNT_TYPES);if(!e)return{};return JSON.parse(e)}catch{console.info("Unable to get preferred account types")}return{}},setConnections(e,t){try{let r={...s.getConnections(),[t]:e};i.mr.setItem(i.uJ.CONNECTIONS,JSON.stringify(r))}catch(e){console.error("Unable to sync connections to storage",e)}},getConnections(){try{let e=i.mr.getItem(i.uJ.CONNECTIONS);if(!e)return{};return JSON.parse(e)}catch(e){return console.error("Unable to get connections from storage",e),{}}}}},72054:function(e,t,r){r.d(t,{g:function(){return u},P:function(){return g}});var i=r(1495),s=r(63243),n=r(67007),a=r(70748),o=r(79187);let c=Object.freeze({enabled:!0,events:[]}),l=new a.V({baseUrl:n.j.getAnalyticsUrl(),clientId:null}),h=(0,i.sj)({...c}),d={state:h,subscribeKey:(e,t)=>(0,s.VW)(h,e,t),async sendError(e,t){if(!h.enabled)return;let r=Date.now(),i=h.events.filter(e=>{let t=new Date(e.properties.timestamp||"").getTime();return r-t<6e4});if(i.length>=5)return;let s={type:"error",event:t,properties:{errorType:e.name,errorMessage:e.message,stackTrace:e.stack,timestamp:new Date().toISOString()}};h.events.push(s);try{if("undefined"==typeof window)return;let{projectId:r,sdkType:i,sdkVersion:s}=o.h.state;await l.post({path:"/e",params:{projectId:r,st:i,sv:s||"html-wagmi-4.2.2"},body:{eventId:n.j.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:t,errorType:e.name,errorMessage:e.message,stackTrace:e.stack}}})}catch{}},enable(){h.enabled=!0},disable(){h.enabled=!1},clearEvents(){h.events=[]}};class u extends Error{constructor(e,t,r){super(e),this.name="AppKitError",this.category=t,this.originalError=r,Object.setPrototypeOf(this,u.prototype);let i=!1;if(r instanceof Error&&"string"==typeof r.stack&&r.stack){let e=r.stack,t=e.indexOf("\n");if(t>-1){let r=e.substring(t+1);this.stack=`${this.name}: ${this.message}
${r}`,i=!0}}i||(Error.captureStackTrace?Error.captureStackTrace(this,u):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function p(e,t){let r=e instanceof u?e:new u(e instanceof Error?e.message:String(e),t,e);throw d.sendError(r,r.category),r}function g(e,t="INTERNAL_SDK_ERROR"){let r={};return Object.keys(e).forEach(i=>{let s=e[i];if("function"==typeof s){let e=s;e="AsyncFunction"===s.constructor.name?async(...e)=>{try{return await s(...e)}catch(e){return p(e,t)}}:(...e)=>{try{return s(...e)}catch(e){return p(e,t)}},r[i]=e}else r[i]=s}),r}},10171:function(e,t,r){r.d(t,{C:function(){return p}});var i=r(53807),s=r(79187),n=r(70580),a=r(88049),o=r(67007),c=r(98905),l=r(12309),h=r(32410),d=r(35247),u=r(45435);let p={getConnectorsByType(e,t,r){let{customWallets:i}=s.h.state,a=n.M.getRecentWallets(),o=u.J.filterOutDuplicateWallets(t),c=u.J.filterOutDuplicateWallets(r),l=e.filter(e=>"MULTI_CHAIN"===e.type),h=e.filter(e=>"ANNOUNCED"===e.type),d=e.filter(e=>"INJECTED"===e.type),p=e.filter(e=>"EXTERNAL"===e.type);return{custom:i,recent:a,external:p,multiChain:l,announced:h,injected:d,recommended:o,featured:c}},showConnector(e){let t=e.info?.rdns,r=!!t&&a.Q.state.excludedWallets.some(e=>!!e.rdns&&e.rdns===t),i=!!e.name&&a.Q.state.excludedWallets.some(t=>d.g.isLowerCaseMatch(t.name,e.name));if("INJECTED"===e.type){let s="Browser Wallet"===e.name;if(s&&(!o.j.isMobile()||o.j.isMobile()&&!t&&!c.l.checkInstalled())||r||i)return!1}return"ANNOUNCED"!==e.type&&"EXTERNAL"!==e.type||!r&&!i},getIsConnectedWithWC(){let e=Array.from(l.R.state.chains.values()),t=e.some(e=>{let t=h.A.getConnectorId(e.namespace);return t===i.b.CONNECTOR_ID.WALLET_CONNECT});return t},getConnectorTypeOrder({recommended:e,featured:t,custom:r,recent:i,announced:n,injected:a,multiChain:o,external:c,overriddenConnectors:l=s.h.state.features?.connectorTypeOrder??[]}){let h=p.getIsConnectedWithWC(),d=s.h.state.enableWalletConnect,u=[{type:"walletConnect",isEnabled:d&&!h},{type:"recent",isEnabled:i.length>0},{type:"injected",isEnabled:[...a,...n,...o].length>0},{type:"featured",isEnabled:t.length>0},{type:"custom",isEnabled:r&&r.length>0},{type:"external",isEnabled:c.length>0},{type:"recommended",isEnabled:e.length>0}],g=u.filter(e=>e.isEnabled),f=new Set(g.map(e=>e.type)),m=l.filter(e=>f.has(e)).map(e=>({type:e,isEnabled:!0})),w=g.filter(({type:e})=>{let t=m.some(({type:t})=>t===e);return!t});return Array.from(new Set([...m,...w].map(({type:e})=>e)))}}},30141:function(e,t,r){r.d(t,{b:function(){return s}});var i=r(34406);let s={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(void 0!==i&&void 0!==i.env?i.env.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}}},45435:function(e,t,r){r.d(t,{J:function(){return d}});var i=r(79187),s=r(32410),n=r(70580),a=r(67007),o=r(88049),c=r(35247),l=r(10171),h=r(30141);let d={filterOutDuplicatesByRDNS(e){let t=i.h.state.enableEIP6963?s.A.state.connectors:[],r=n.M.getRecentWallets(),o=t.map(e=>e.info?.rdns).filter(Boolean),c=r.map(e=>e.rdns).filter(Boolean),l=o.concat(c);if(l.includes("io.metamask.mobile")&&a.j.isMobile()){let e=l.indexOf("io.metamask.mobile");l[e]="io.metamask"}let h=e.filter(e=>!l.includes(String(e?.rdns)));return h},filterOutDuplicatesByIds(e){let t=s.A.state.connectors.filter(e=>"ANNOUNCED"===e.type||"INJECTED"===e.type),r=n.M.getRecentWallets(),i=t.map(e=>e.explorerId),a=r.map(e=>e.id),o=i.concat(a),c=e.filter(e=>!o.includes(e?.id));return c},filterOutDuplicateWallets(e){let t=this.filterOutDuplicatesByRDNS(e),r=this.filterOutDuplicatesByIds(t);return r},markWalletsAsInstalled(e){let{connectors:t}=s.A.state,{featuredWalletIds:r}=i.h.state,n=t.filter(e=>"ANNOUNCED"===e.type).reduce((e,t)=>(t.info?.rdns&&(e[t.info.rdns]=!0),e),{}),a=e.map(e=>({...e,installed:!!e.rdns&&!!n[e.rdns??""]})),o=a.sort((e,t)=>{let i=Number(t.installed)-Number(e.installed);if(0!==i)return i;if(r?.length){let i=r.indexOf(e.id),s=r.indexOf(t.id);if(-1!==i&&-1!==s)return i-s;if(-1!==i)return -1;if(-1!==s)return 1}return 0});return o},getConnectOrderMethod(e,t){let r=e?.connectMethodsOrder||i.h.state.features?.connectMethodsOrder,n=t||s.A.state.connectors;if(r)return r;let{injected:a,announced:c}=l.C.getConnectorsByType(n,o.Q.state.recommended,o.Q.state.featured),d=a.filter(l.C.showConnector),u=c.filter(l.C.showConnector);return d.length||u.length?["wallet","email","social"]:h.b.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(e){let t=!!e.rdns&&o.Q.state.excludedWallets.some(t=>t.rdns===e.rdns),r=!!e.name&&o.Q.state.excludedWallets.some(t=>c.g.isLowerCaseMatch(t.name,e.name));return t||r}}},6089:function(e,t,r){r.d(t,{Hg:function(){return s.H},Mo:function(){return f.M},n:function(){return i.n},Hs:function(){return i.Hs},R:function(){return i.R}});var i=r(21340),s=r(72645),n=r(28879),a=r(16017),o=r(77491),c=r(53193);n.extend(o),n.extend(c);let l={...a,name:"en-web3-modal",relativeTime:{future:"in %s",past:"%s ago",s:"%d sec",m:"1 min",mm:"%d min",h:"1 hr",hh:"%d hrs",d:"1 d",dd:"%d d",M:"1 mo",MM:"%d mo",y:"1 yr",yy:"%d yr"}},h=["January","February","March","April","May","June","July","August","September","October","November","December"];n.locale("en-web3-modal",l);let d={getMonthNameByIndex:e=>h[e],getYear:(e=new Date().toISOString())=>n(e).year(),getRelativeDateFromNow:e=>n(e).locale("en-web3-modal").fromNow(!0),formatDate:(e,t="DD MMM")=>n(e).format(t)},u=["receive","deposit","borrow","claim"],p=["withdraw","repay","burn"],g={getTransactionGroupTitle(e,t){let r=d.getYear(),i=d.getMonthNameByIndex(t),s=e===r?i:`${i} ${e}`;return s},getTransactionImages(e){let[t,r]=e,i=!!t&&e?.every(e=>!!e.nft_info),s=e?.length>1,n=e?.length===2;return n&&!i?[this.getTransactionImage(t),this.getTransactionImage(r)]:s?e.map(e=>this.getTransactionImage(e)):[this.getTransactionImage(t)]},getTransactionImage:e=>({type:g.getTransactionTransferTokenType(e),url:g.getTransactionImageURL(e)}),getTransactionImageURL(e){let t;let r=!!e?.nft_info,i=!!e?.fungible_info;return e&&r?t=e?.nft_info?.content?.preview?.url:e&&i&&(t=e?.fungible_info?.icon?.url),t},getTransactionTransferTokenType:e=>e?.fungible_info?"FUNGIBLE":e?.nft_info?"NFT":void 0,getTransactionDescriptions(e){let t=e?.metadata?.operationType,r=e?.transfers,i=e?.transfers?.length>0,n=e?.transfers?.length>1,a=i&&r?.every(e=>!!e?.fungible_info),[o,c]=r,l=this.getTransferDescription(o);if(this.getTransferDescription(c),!i)return("send"===t||"receive"===t)&&a?[l=s.H.getTruncateString({string:e?.metadata.sentFrom,charsStart:4,charsEnd:6,truncate:"middle"}),s.H.getTruncateString({string:e?.metadata.sentTo,charsStart:4,charsEnd:6,truncate:"middle"})]:[e.metadata.status];if(n)return r.map(e=>this.getTransferDescription(e));let h="";return u.includes(t)?h="+":p.includes(t)&&(h="-"),[l=h.concat(l)]},getTransferDescription(e){let t="";return e&&(e?.nft_info?t=e?.nft_info?.name||"-":e?.fungible_info&&(t=this.getFungibleTransferDescription(e)||"-")),t},getFungibleTransferDescription(e){if(!e)return null;let t=this.getQuantityFixedValue(e?.quantity.numeric),r=[t,e?.fungible_info?.symbol].join(" ").trim();return r},getQuantityFixedValue(e){if(!e)return null;let t=parseFloat(e);return t.toFixed(3)}};var f=r(2180)},21340:function(e,t,r){let i,s,n;r.d(t,{Bp:function(){return g},ET:function(){return u},Hs:function(){return l},R:function(){return h},ZM:function(){return p},n:function(){return c}});var a=r(44920),o=r(63642);function c(e,t){i=document.createElement("style"),s=document.createElement("style"),n=document.createElement("style"),i.textContent=d(e).core.cssText,s.textContent=d(e).dark.cssText,n.textContent=d(e).light.cssText,document.head.appendChild(i),document.head.appendChild(s),document.head.appendChild(n),l(t)}function l(e){s&&n&&("light"===e?(s.removeAttribute("media"),n.media="enabled"):(n.removeAttribute("media"),s.media="enabled"))}function h(e){i&&s&&n&&(i.textContent=d(e).core.cssText,s.textContent=d(e).dark.cssText,n.textContent=d(e).light.cssText)}function d(e){return{core:a.iv`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${(0,a.$m)(e?.["--w3m-color-mix-strength"]?`${e["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${(0,a.$m)(e?.["--w3m-font-family"]||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${(0,a.$m)(e?.["--w3m-font-size-master"]||"10px")};
        --w3m-border-radius-master: ${(0,a.$m)(e?.["--w3m-border-radius-master"]||"4px")};
        --w3m-z-index: ${(0,a.$m)(e?.["--w3m-z-index"]||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:a.iv`
      :root {
        --w3m-color-mix: ${(0,a.$m)(e?.["--w3m-color-mix"]||"#fff")};
        --w3m-accent: ${(0,a.$m)((0,o.t)(e,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${(0,a.$m)((0,o.t)(e,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:a.iv`
      :root {
        --w3m-color-mix: ${(0,a.$m)(e?.["--w3m-color-mix"]||"#000")};
        --w3m-accent: ${(0,a.$m)((0,o.t)(e,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${(0,a.$m)((0,o.t)(e,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}let u=a.iv`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,p=a.iv`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,g=a.iv`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`},72645:function(e,t,r){r.d(t,{H:function(){return i}});let i={getSpacingStyles:(e,t)=>Array.isArray(e)?e[t]?`var(--wui-spacing-${e[t]})`:void 0:"string"==typeof e?`var(--wui-spacing-${e})`:void 0,getFormattedDate:e=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(e),getHostName(e){try{let t=new URL(e);return t.hostname}catch(e){return""}},getTruncateString:({string:e,charsStart:t,charsEnd:r,truncate:i})=>e.length<=t+r?e:"end"===i?`${e.substring(0,t)}...`:"start"===i?`...${e.substring(e.length-r)}`:`${e.substring(0,Math.floor(t))}...${e.substring(e.length-Math.floor(r))}`,generateAvatarColors(e){let t=e.toLowerCase().replace(/^0x/iu,"").replace(/[^a-f0-9]/gu,""),r=t.substring(0,6).padEnd(6,"0"),i=this.hexToRgb(r),s=getComputedStyle(document.documentElement).getPropertyValue("--w3m-border-radius-master"),n=Number(s?.replace("px","")),a=100-3*n,o=`${a}% ${a}% at 65% 40%`,c=[];for(let e=0;e<5;e+=1){let t=this.tintColor(i,.15*e);c.push(`rgb(${t[0]}, ${t[1]}, ${t[2]})`)}return`
    --local-color-1: ${c[0]};
    --local-color-2: ${c[1]};
    --local-color-3: ${c[2]};
    --local-color-4: ${c[3]};
    --local-color-5: ${c[4]};
    --local-radial-circle: ${o}
   `},hexToRgb(e){let t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t]},tintColor(e,t){let[r,i,s]=e;return[Math.round(r+(255-r)*t),Math.round(i+(255-i)*t),Math.round(s+(255-s)*t)]},isNumber:e=>/^[0-9]+$/u.test(e),getColorTheme:e=>e||("undefined"!=typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)")?.matches?"dark":"light":"dark"),splitBalance(e){let t=e.split(".");return 2===t.length?[t[0],t[1]]:["0","00"]},roundNumber(e,t,r){let i=e.toString().length>=t?Number(e).toFixed(r):e;return i},formatNumberToLocalString:(e,t=2)=>void 0===e?"0.00":"number"==typeof e?e.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}):parseFloat(e).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t})}},2180:function(e,t,r){r.d(t,{M:function(){return i}});function i(e){return function(t){return"function"==typeof t?(customElements.get(e)||customElements.define(e,t),t):function(e,t){let{kind:r,elements:i}=t;return{kind:r,elements:i,finisher(t){customElements.get(e)||customElements.define(e,t)}}}(e,t)}}},42375:function(e,t,r){r.d(t,{b:function(){return i}});let i={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"}},35247:function(e,t,r){r.d(t,{g:function(){return s}});var i=r(42375);let s={getCaipTokens(e){if(!e)return;let t={};return Object.entries(e).forEach(([e,r])=>{t[`${i.b.EIP155}:${e}`]=r}),t},isLowerCaseMatch:(e,t)=>e?.toLowerCase()===t?.toLowerCase()}},22950:function(e,t,r){r.d(t,{y_:function(){return s}});var i=r(34406);void 0!==i&&void 0!==i.env&&i.env.NEXT_PUBLIC_SECURE_SITE_SDK_URL,void 0!==i&&void 0!==i.env&&i.env.NEXT_PUBLIC_DEFAULT_LOG_LEVEL,void 0!==i&&void 0!==i.env&&i.env.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION;let s={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}}},25154:function(e,t,r){let i;r.r(t),r.d(t,{AppKit:function(){return gD},createAppKit:function(){return gL}});var s,n,a,o,c=r(32410),l=r(98905),h=r(67007),d=r(79187),u=r(22699),p=r.n(u),g=r(16220),f=r(764),m=r(18776),w=r(5774),y=Object.defineProperty,b=(e,t,r)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,v=(e,t,r)=>b(e,"symbol"!=typeof t?t+"":t,r);class E extends w.q{constructor(e){super(),this.opts=e,v(this,"protocol","wc"),v(this,"version",2)}}var C=Object.defineProperty,I=(e,t,r)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,N=(e,t,r)=>I(e,"symbol"!=typeof t?t+"":t,r);class A extends w.q{constructor(e,t){super(),this.core=e,this.logger=t,N(this,"records",new Map)}}class _{constructor(e,t){this.logger=e,this.core=t}}class S extends w.q{constructor(e,t){super(),this.relayer=e,this.logger=t}}class P extends w.q{constructor(e){super()}}class O{constructor(e,t,r,i){this.core=e,this.logger=t,this.name=r}}class T extends w.q{constructor(e,t){super(),this.relayer=e,this.logger=t}}class R extends w.q{constructor(e,t){super(),this.core=e,this.logger=t}}class k{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}}class x{constructor(e,t){this.projectId=e,this.logger=t}}class U{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}}var D=r(10666),L=r(42325),M=r(89406),B=r(54924),j=r(4997),q=r(51726),$=r(50693),F=r(4576),z=r(27546),H=r(34406),W=r(48834).Buffer;Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let V={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};function K(){return"u">typeof H&&"u">typeof H.versions&&"u">typeof H.versions.node}function G(){return!(0,j.getDocument)()&&!!(0,j.getNavigator)()&&"ReactNative"===navigator.product}function J(){return!K()&&!!(0,j.getNavigator)()&&!!(0,j.getDocument)()}function Y(){return G()?V.reactNative:K()?V.node:J()?V.browser:V.unknown}function Z(){var e;try{return G()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Application)?null==(e=r.g.Application)?void 0:e.applicationId:void 0}catch{return}}function X(e,t,i){let s=function(){if(Y()===V.reactNative&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)){let{OS:e,Version:t}=r.g.Platform;return[e,t].join("-")}let e=(0,B.qY)();if(null===e)return"unknown";let t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),n=function(){var e;let t=Y();return t===V.browser?[t,(null==(e=(0,j.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),["js",i].join("-"),s,n].join("/")}function Q(e){return Object.fromEntries(e.entries())}function ee(e){return new Map(Object.entries(e))}function et(e,t,r){return new Promise(async(i,s)=>{let n=setTimeout(()=>s(Error(r)),t);try{let t=await e;i(t)}catch(e){s(e)}clearTimeout(n)})}function er(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw Error(`Unknown expirer target type: ${e}`)}function ei(e,t){return(0,D.fromMiliseconds)((t||Date.now())+(0,D.toMiliseconds)(e))}function es(e){return Date.now()>=(0,D.toMiliseconds)(e)}function en(e,t){return`${e}${t?`:${t}`:""}`}function ea(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function eo(){return"u">typeof H&&"true"===H.env.IS_VITEST}function ec(e){return W.from(e,"base64").toString("utf-8")}function el(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function eh(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function ed(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");el(e.outputLen),el(e.blockLen)}function eu(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function ep(e,t){eh(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}let eg=BigInt(4294967296-1),ef=BigInt(32),em=(e,t,r)=>e<<r|t>>>32-r,ew=(e,t,r)=>t<<r|e>>>32-r,ey=(e,t,r)=>t<<r-32|e>>>64-r,eb=(e,t,r)=>e<<r-32|t>>>64-r,ev="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function eE(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function eC(e,t){return e<<32-t|e>>>t}let eI=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function eN(e){for(let r=0;r<e.length;r++){var t;e[r]=(t=e[r])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}}function eA(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(e)),eh(e),e}class e_{clone(){return this._cloneInto()}}function eS(e){let t=t=>e().update(eA(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function eP(e=32){if(ev&&"function"==typeof ev.getRandomValues)return ev.getRandomValues(new Uint8Array(e));if(ev&&"function"==typeof ev.randomBytes)return ev.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}let eO=[],eT=[],eR=[],ek=BigInt(0),ex=BigInt(1),eU=BigInt(2),eD=BigInt(7),eL=BigInt(256),eM=BigInt(113);for(let e=0,t=ex,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],eO.push(2*(5*i+r)),eT.push((e+1)*(e+2)/2%64);let s=ek;for(let e=0;e<7;e++)(t=(t<<ex^(t>>eD)*eM)%eL)&eU&&(s^=ex<<(ex<<BigInt(e))-ex);eR.push(s)}let[eB,ej]=function(e,t=!1){let r=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:n,l:a}=function(e,t=!1){return t?{h:Number(e&eg),l:Number(e>>ef&eg)}:{h:0|Number(e>>ef&eg),l:0|Number(e&eg)}}(e[s],t);[r[s],i[s]]=[n,a]}return[r,i]}(eR,!0),eq=(e,t,r)=>r>32?ey(e,t,r):em(e,t,r),e$=(e,t,r)=>r>32?eb(e,t,r):ew(e,t,r);class eF extends e_{constructor(e,t,r,i=!1,s=24){var n;if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,el(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(n=this.state,new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)))}keccak(){eI||eN(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,s=(t+2)%10,n=r[s],a=r[s+1],o=eq(n,a,1)^r[i],c=e$(n,a,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=o,e[t+r+1]^=c}let t=e[2],s=e[3];for(let r=0;r<24;r++){let i=eT[r],n=eq(t,s,i),a=e$(t,s,i),o=eO[r];t=e[o],s=e[o+1],e[o]=n,e[o+1]=a}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=eB[i],e[1]^=ej[i]}r.fill(0)}(this.state32,this.rounds),eI||eN(this.state32),this.posOut=0,this.pos=0}update(e){eu(this);let{blockLen:t,state:r}=this;e=eA(e);let i=e.length;for(let s=0;s<i;){let n=Math.min(t-this.pos,i-s);for(let t=0;t<n;t++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){eu(this,!1),eh(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();let n=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+n),i),this.posOut+=n,i+=n}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return el(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ep(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:n}=this;return e||(e=new eF(t,r,i,n,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=n,e.destroyed=this.destroyed,e}}function ez(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function eH(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function eW(e,...t){if(!eH(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function eV(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function eK(e){if("boolean"!=typeof e)throw Error(`boolean expected, not ${e}`)}eS(()=>new eF(136,1,32)),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let eG=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),eJ=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),eY=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];if(!eY)throw Error("Non little-endian hardware is not supported");function eZ(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(eH(e))e=e0(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function eX(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&t.byteOffset%4!=0)throw Error("invalid output, must be aligned");return t}function eQ(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(4294967295),a=Number(r>>s&n),o=Number(r&n);e.setUint32(t+(i?4:0),a,i),e.setUint32(t+(i?0:4),o,i)}function e0(e){return Uint8Array.from(e)}function e1(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}let e2=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),e5=e2("expand 16-byte k"),e3=e2("expand 32-byte k"),e4=eG(e5),e8=eG(e3);function e6(e,t){return e<<t|e>>>32-t}function e9(e){return e.byteOffset%4==0}let e7=4294967296-1,te=new Uint32Array,tt=(e,t)=>255&e[t++]|(255&e[t++])<<8;class tr{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,eW(e=eZ(e),32);let t=tt(e,0),r=tt(e,2),i=tt(e,4),s=tt(e,6),n=tt(e,8),a=tt(e,10),o=tt(e,12),c=tt(e,14);this.r[0]=8191&t,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|n<<12)&255,this.r[5]=n>>>1&8190,this.r[6]=(n>>>14|a<<2)&8191,this.r[7]=(a>>>11|o<<5)&8065,this.r[8]=(o>>>8|c<<8)&8191,this.r[9]=c>>>5&127;for(let t=0;t<8;t++)this.pad[t]=tt(e,16+2*t)}process(e,t,r=!1){let{h:i,r:s}=this,n=s[0],a=s[1],o=s[2],c=s[3],l=s[4],h=s[5],d=s[6],u=s[7],p=s[8],g=s[9],f=tt(e,t+0),m=tt(e,t+2),w=tt(e,t+4),y=tt(e,t+6),b=tt(e,t+8),v=tt(e,t+10),E=tt(e,t+12),C=tt(e,t+14),I=i[0]+(8191&f),N=i[1]+((f>>>13|m<<3)&8191),A=i[2]+((m>>>10|w<<6)&8191),_=i[3]+((w>>>7|y<<9)&8191),S=i[4]+((y>>>4|b<<12)&8191),P=i[5]+(b>>>1&8191),O=i[6]+((b>>>14|v<<2)&8191),T=i[7]+((v>>>11|E<<5)&8191),R=i[8]+((E>>>8|C<<8)&8191),k=i[9]+(C>>>5|(r?0:2048)),x=0,U=0+I*n+N*(5*g)+A*(5*p)+_*(5*u)+S*(5*d);x=U>>>13,U&=8191,U+=P*(5*h)+O*(5*l)+T*(5*c)+R*(5*o)+k*(5*a),x+=U>>>13,U&=8191;let D=x+I*a+N*n+A*(5*g)+_*(5*p)+S*(5*u);x=D>>>13,D&=8191,D+=P*(5*d)+O*(5*h)+T*(5*l)+R*(5*c)+k*(5*o),x+=D>>>13,D&=8191;let L=x+I*o+N*a+A*n+_*(5*g)+S*(5*p);x=L>>>13,L&=8191,L+=P*(5*u)+O*(5*d)+T*(5*h)+R*(5*l)+k*(5*c),x+=L>>>13,L&=8191;let M=x+I*c+N*o+A*a+_*n+S*(5*g);x=M>>>13,M&=8191,M+=P*(5*p)+O*(5*u)+T*(5*d)+R*(5*h)+k*(5*l),x+=M>>>13,M&=8191;let B=x+I*l+N*c+A*o+_*a+S*n;x=B>>>13,B&=8191,B+=P*(5*g)+O*(5*p)+T*(5*u)+R*(5*d)+k*(5*h),x+=B>>>13,B&=8191;let j=x+I*h+N*l+A*c+_*o+S*a;x=j>>>13,j&=8191,j+=P*n+O*(5*g)+T*(5*p)+R*(5*u)+k*(5*d),x+=j>>>13,j&=8191;let q=x+I*d+N*h+A*l+_*c+S*o;x=q>>>13,q&=8191,q+=P*a+O*n+T*(5*g)+R*(5*p)+k*(5*u),x+=q>>>13,q&=8191;let $=x+I*u+N*d+A*h+_*l+S*c;x=$>>>13,$&=8191,$+=P*o+O*a+T*n+R*(5*g)+k*(5*p),x+=$>>>13,$&=8191;let F=x+I*p+N*u+A*d+_*h+S*l;x=F>>>13,F&=8191,F+=P*c+O*o+T*a+R*n+k*(5*g),x+=F>>>13,F&=8191;let z=x+I*g+N*p+A*u+_*d+S*h;x=z>>>13,z&=8191,z+=P*l+O*c+T*o+R*a+k*n,x+=z>>>13,z&=8191,U=8191&(x=(x=(x<<2)+x|0)+U|0),x>>>=13,D+=x,i[0]=U,i[1]=D,i[2]=L,i[3]=M,i[4]=B,i[5]=j,i[6]=q,i[7]=$,i[8]=F,i[9]=z}finalize(){let{h:e,pad:t}=this,r=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=i,i=e[t]>>>13,e[t]&=8191;e[0]+=5*i,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+i,i=r[t]>>>13,r[t]&=8191;r[9]-=8192;let s=(1^i)-1;for(let e=0;e<10;e++)r[e]&=s;s=~s;for(let t=0;t<10;t++)e[t]=e[t]&s|r[t];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let n=e[0]+t[0];e[0]=65535&n;for(let r=1;r<8;r++)n=(e[r]+t[r]|0)+(n>>>16)|0,e[r]=65535&n;e1(r)}update(e){eV(this);let{buffer:t,blockLen:r}=this;e=eZ(e);let i=e.length;for(let s=0;s<i;){let n=Math.min(r-this.pos,i-s);if(n===r){for(;r<=i-s;s+=r)this.process(e,s);continue}t.set(e.subarray(s,s+n),this.pos),this.pos+=n,s+=n,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){e1(this.h,this.r,this.buffer,this.pad)}digestInto(e){eV(this),function(e,t){eW(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;let{buffer:t,h:r}=this,{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let s=0;for(let t=0;t<8;t++)e[s++]=r[t]>>>0,e[s++]=r[t]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}}let ti=function(e){let t=(t,r)=>e(r).update(eZ(t)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new tr(e)),ts=function(e,t){let{allowShortKeys:r,extendNonceFn:i,counterLength:s,counterRight:n,rounds:a}=function(e,t){if(null==t||"object"!=typeof t)throw Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw Error("core must be a function");return ez(s),ez(a),eK(n),eK(r),(t,o,c,l,h=0)=>{eW(t),eW(o),eW(c);let d=c.length;if(void 0===l&&(l=new Uint8Array(d)),eW(l),ez(h),h<0||h>=e7)throw Error("arx: counter overflow");if(l.length<d)throw Error(`arx: output (${l.length}) is shorter than data (${d})`);let u=[],p=t.length,g,f;if(32===p)u.push(g=e0(t)),f=e8;else if(16===p&&r)(g=new Uint8Array(32)).set(t),g.set(t,16),f=e4,u.push(g);else throw Error(`arx: invalid 32-byte key, got length=${p}`);e9(o)||u.push(o=e0(o));let m=eG(g);if(i){if(24!==o.length)throw Error("arx: extended nonce must be 24 bytes");i(f,m,eG(o.subarray(0,16)),m),o=o.subarray(16)}let w=16-s;if(w!==o.length)throw Error(`arx: nonce must be ${w} or 16 bytes`);if(12!==w){let e=new Uint8Array(12);e.set(o,n?0:12-o.length),o=e,u.push(o)}let y=eG(o);return function(e,t,r,i,s,n,a,o){let c=s.length,l=new Uint8Array(64),h=eG(l),d=e9(s)&&e9(n),u=d?eG(s):te,p=d?eG(n):te;for(let g=0;g<c;a++){if(e(t,r,i,h,a,o),a>=e7)throw Error("arx: counter overflow");let f=Math.min(64,c-g);if(d&&64===f){let e=g/4;if(g%4!=0)throw Error("arx: invalid block position");for(let t=0,r;t<16;t++)p[r=e+t]=u[r]^h[t];g+=64;continue}for(let e=0,t;e<f;e++)n[t=g+e]=s[t]^l[e];g+=f}}(e,f,m,y,c,l,h,a),e1(...u),l}}(function(e,t,r,i,s,n=20){let a=e[0],o=e[1],c=e[2],l=e[3],h=t[0],d=t[1],u=t[2],p=t[3],g=t[4],f=t[5],m=t[6],w=t[7],y=r[0],b=r[1],v=r[2],E=a,C=o,I=c,N=l,A=h,_=d,S=u,P=p,O=g,T=f,R=m,k=w,x=s,U=y,D=b,L=v;for(let e=0;e<n;e+=2)O=O+(x=e6(x^(E=E+A|0),16))|0,E=E+(A=e6(A^O,12))|0,O=O+(x=e6(x^E,8))|0,A=e6(A^O,7),T=T+(U=e6(U^(C=C+_|0),16))|0,C=C+(_=e6(_^T,12))|0,T=T+(U=e6(U^C,8))|0,_=e6(_^T,7),R=R+(D=e6(D^(I=I+S|0),16))|0,I=I+(S=e6(S^R,12))|0,R=R+(D=e6(D^I,8))|0,S=e6(S^R,7),k=k+(L=e6(L^(N=N+P|0),16))|0,N=N+(P=e6(P^k,12))|0,k=k+(L=e6(L^N,8))|0,P=e6(P^k,7),R=R+(L=e6(L^(E=E+_|0),16))|0,E=E+(_=e6(_^R,12))|0,R=R+(L=e6(L^E,8))|0,_=e6(_^R,7),k=k+(x=e6(x^(C=C+S|0),16))|0,C=C+(S=e6(S^k,12))|0,k=k+(x=e6(x^C,8))|0,S=e6(S^k,7),O=O+(U=e6(U^(I=I+P|0),16))|0,I=I+(P=e6(P^O,12))|0,O=O+(U=e6(U^I,8))|0,P=e6(P^O,7),T=T+(D=e6(D^(N=N+A|0),16))|0,N=N+(A=e6(A^T,12))|0,T=T+(D=e6(D^N,8))|0,A=e6(A^T,7);let M=0;i[M++]=a+E|0,i[M++]=o+C|0,i[M++]=c+I|0,i[M++]=l+N|0,i[M++]=h+A|0,i[M++]=d+_|0,i[M++]=u+S|0,i[M++]=p+P|0,i[M++]=g+O|0,i[M++]=f+T|0,i[M++]=m+R|0,i[M++]=w+k|0,i[M++]=s+x|0,i[M++]=y+U|0,i[M++]=b+D|0,i[M++]=v+L|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),tn=new Uint8Array(16),ta=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(tn.subarray(r))},to=new Uint8Array(32);function tc(e,t,r,i,s){let n=e(t,r,to),a=ti.create(n);s&&ta(a,s),ta(a,i);let o=new Uint8Array(16),c=eJ(o);eQ(c,0,BigInt(s?s.length:0),!0),eQ(c,8,BigInt(i.length),!0),a.update(o);let l=a.digest();return e1(n,o),l}let tl=((e,t)=>{function r(i,...s){if(eW(i),void 0!==e.nonceLength){let t=s[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?eW(t):eW(t,e.nonceLength)}let n=e.tagLength;n&&void 0!==s[1]&&eW(s[1]);let a=t(i,...s),o=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");eW(t)}},c=!1;return{encrypt(e,t){if(c)throw Error("cannot encrypt() twice with same key + nonce");return c=!0,eW(e),o(a.encrypt.length,t),a.encrypt(e,t)},decrypt(e,t){if(eW(e),n&&e.length<n)throw Error("invalid ciphertext length: smaller than tagLength="+n);return o(a.decrypt.length,t),a.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:64,nonceLength:12,tagLength:16},(e,t,r)=>({encrypt(i,s){let n=i.length;(s=eX(n+16,s,!1)).set(i);let a=s.subarray(0,-16);ts(e,t,a,a,1);let o=tc(ts,e,t,a,r);return s.set(o,n),e1(o),s},decrypt(i,s){s=eX(i.length-16,s,!1);let n=i.subarray(0,-16),a=i.subarray(-16),o=tc(ts,e,t,n,r);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}(a,o))throw Error("invalid tag");return s.set(i.subarray(0,-16)),ts(e,t,s,s,1),e1(o),s}}));class th extends e_{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,ed(e);let r=eA(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),s.fill(0)}update(e){return eu(this),this.iHash.update(e),this}digestInto(e){eu(this),eh(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:n,outputLen:a}=this;return e.finished=i,e.destroyed=s,e.blockLen=n,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let td=(e,t,r)=>new th(e,t).update(r).digest();td.create=(e,t)=>new th(e,t);let tu=new Uint8Array([0]),tp=new Uint8Array,tg=(e,t,r,i,s)=>{var n;return function(e,t,r,i=32){if(ed(e),el(i),i>255*e.outputLen)throw Error("Length should be <= 255*HashLen");let s=Math.ceil(i/e.outputLen);void 0===r&&(r=tp);let n=new Uint8Array(s*e.outputLen),a=td.create(e,t),o=a._cloneInto(),c=new Uint8Array(a.outputLen);for(let t=0;t<s;t++)tu[0]=t+1,o.update(0===t?tp:c).update(r).update(tu).digestInto(c),n.set(c,e.outputLen*t),a._cloneInto(o);return a.destroy(),o.destroy(),c.fill(0),tu.fill(0),n.slice(0,i)}(e,(n=r,ed(e),void 0===n&&(n=new Uint8Array(e.outputLen)),td(e,eA(n),eA(t))),i,s)};class tf extends e_{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=eE(this.buffer)}update(e){eu(this);let{view:t,buffer:r,blockLen:i}=this;e=eA(e);let s=e.length;for(let n=0;n<s;){let a=Math.min(i-this.pos,s-n);if(a===i){let t=eE(e);for(;i<=s-n;n+=i)this.process(t,n);continue}r.set(e.subarray(n,n+a),this.pos),this.pos+=a,n+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){eu(this),ep(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:s}=this,{pos:n}=this;t[n++]=128,this.buffer.subarray(n).fill(0),this.padOffset>i-n&&(this.process(r,0),n=0);for(let e=n;e<i;e++)t[e]=0;(function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(4294967295),a=Number(r>>s&n),o=Number(r&n);e.setUint32(t+(i?4:0),a,i),e.setUint32(t+(i?0:4),o,i)})(r,i-8,BigInt(8*this.length),s),this.process(r,0);let a=eE(e),o=this.outputLen;if(o%4)throw Error("_sha2: outputLen should be aligned to 32bit");let c=o/4,l=this.get();if(c>l.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)a.setUint32(4*e,l[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:s,destroyed:n,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=n,i%t&&e.buffer.set(r),e}}let tm=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),tw=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ty=new Uint32Array(64);class tb extends tf{constructor(){super(64,32,8,!1),this.A=0|tw[0],this.B=0|tw[1],this.C=0|tw[2],this.D=0|tw[3],this.E=0|tw[4],this.F=0|tw[5],this.G=0|tw[6],this.H=0|tw[7]}get(){let{A:e,B:t,C:r,D:i,E:s,F:n,G:a,H:o}=this;return[e,t,r,i,s,n,a,o]}set(e,t,r,i,s,n,a,o){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|s,this.F=0|n,this.G=0|a,this.H=0|o}process(e,t){for(let r=0;r<16;r++,t+=4)ty[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=ty[e-15],r=ty[e-2],i=eC(t,7)^eC(t,18)^t>>>3,s=eC(r,17)^eC(r,19)^r>>>10;ty[e]=s+ty[e-7]+i+ty[e-16]|0}let{A:r,B:i,C:s,D:n,E:a,F:o,G:c,H:l}=this;for(let e=0;e<64;e++){var h,d,u,p;let t=eC(a,6)^eC(a,11)^eC(a,25),g=l+t+((h=a)&o^~h&c)+tm[e]+ty[e]|0,f=(eC(r,2)^eC(r,13)^eC(r,22))+((d=r)&(u=i)^d&(p=s)^u&p)|0;l=c,c=o,o=a,a=n+g|0,n=s,s=i,i=r,r=g+f|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,n=n+this.D|0,a=a+this.E|0,o=o+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,i,s,n,a,o,c,l)}roundClean(){ty.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}let tv=eS(()=>new tb),tE=BigInt(0),tC=BigInt(1),tI=BigInt(2);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function tN(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function tA(e){if(!tN(e))throw Error("Uint8Array expected")}function t_(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)}let tS=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function tP(e){tA(e);let t="";for(let r=0;r<e.length;r++)t+=tS[e[r]];return t}function tO(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function tT(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?tE:BigInt("0x"+e)}let tR={_0:48,_9:57,A:65,F:70,a:97,f:102};function tk(e){return e>=tR._0&&e<=tR._9?e-tR._0:e>=tR.A&&e<=tR.F?e-(tR.A-10):e>=tR.a&&e<=tR.f?e-(tR.a-10):void 0}function tx(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,s=0;t<r;t++,s+=2){let r=tk(e.charCodeAt(s)),n=tk(e.charCodeAt(s+1));if(void 0===r||void 0===n){let t=e[s]+e[s+1];throw Error('hex string expected, got non-hex character "'+t+'" at index '+s)}i[t]=16*r+n}return i}function tU(e){return tT(tP(e))}function tD(e){return tA(e),tT(tP(Uint8Array.from(e).reverse()))}function tL(e,t){return tx(e.toString(16).padStart(2*t,"0"))}function tM(e,t){return tL(e,t).reverse()}function tB(e,t,r){let i;if("string"==typeof t)try{i=tx(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(tN(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let s=i.length;if("number"==typeof r&&s!==r)throw Error(e+" of length "+r+" expected, got "+s);return i}function tj(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];tA(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let s=e[t];r.set(s,i),i+=s.length}return r}let tq=e=>"bigint"==typeof e&&tE<=e;function t$(e,t,r){return tq(e)&&tq(t)&&tq(r)&&t<=e&&e<r}function tF(e,t,r,i){if(!t$(t,r,i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}function tz(e){let t;for(t=0;e>tE;e>>=tC,t+=1);return t}let tH=e=>(tI<<BigInt(e-1))-tC,tW=e=>new Uint8Array(e),tV=e=>Uint8Array.from(e);function tK(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=tW(e),s=tW(e),n=0,a=()=>{i.fill(1),s.fill(0),n=0},o=(...e)=>r(s,i,...e),c=(e=tW())=>{s=o(tV([0]),e),i=o(),0!==e.length&&(s=o(tV([1]),e),i=o())},l=()=>{if(n++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){i=o();let t=i.slice();r.push(t),e+=i.length}return tj(...r)};return(e,t)=>{let r;for(a(),c(e);!(r=t(l()));)c();return a(),r}}let tG={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||tN(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function tJ(e,t,r={}){let i=(t,r,i)=>{let s=tG[r];if("function"!=typeof s)throw Error("invalid validator function");let n=e[t];if(!(i&&void 0===n)&&!s(n,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+n)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0);return e}let tY=()=>{throw Error("not implemented")};function tZ(e){let t=new WeakMap;return(r,...i)=>{let s=t.get(r);if(void 0!==s)return s;let n=e(r,...i);return t.set(r,n),n}}var tX=Object.freeze({__proto__:null,isBytes:tN,abytes:tA,abool:t_,bytesToHex:tP,numberToHexUnpadded:tO,hexToNumber:tT,hexToBytes:tx,bytesToNumberBE:tU,bytesToNumberLE:tD,numberToBytesBE:tL,numberToBytesLE:tM,numberToVarBytesBE:function(e){return tx(tO(e))},ensureBytes:tB,concatBytes:tj,equalBytes:function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r},utf8ToBytes:function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))},inRange:t$,aInRange:tF,bitLen:tz,bitGet:function(e,t){return e>>BigInt(t)&tC},bitSet:function(e,t,r){return e|(r?tC:tE)<<BigInt(t)},bitMask:tH,createHmacDrbg:tK,validateObject:tJ,notImplemented:tY,memoized:tZ});let tQ=BigInt(0),t0=BigInt(1),t1=BigInt(2),t2=BigInt(3),t5=BigInt(4),t3=BigInt(5),t4=BigInt(8);function t8(e,t){let r=e%t;return r>=tQ?r:t+r}function t6(e,t,r){if(t<tQ)throw Error("invalid exponent, negatives unsupported");if(r<=tQ)throw Error("invalid modulus");if(r===t0)return tQ;let i=t0;for(;t>tQ;)t&t0&&(i=i*e%r),e=e*e%r,t>>=t0;return i}function t9(e,t,r){let i=e;for(;t-- >tQ;)i*=i,i%=r;return i}function t7(e,t){if(e===tQ)throw Error("invert: expected non-zero number");if(t<=tQ)throw Error("invert: expected positive modulus, got "+t);let r=t8(e,t),i=t,s=tQ,n=t0;for(;r!==tQ;){let e=i/r,t=i%r,a=s-n*e;i=r,r=t,s=n,n=a}if(i!==t0)throw Error("invert: does not exist");return t8(s,t)}let re=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function rt(e,t){let r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function rr(e,t,r=!1,i={}){let s;if(e<=tQ)throw Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:n,nByteLength:a}=rt(e,t);if(a>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let o=Object.freeze({ORDER:e,isLE:r,BITS:n,BYTES:a,MASK:tH(n),ZERO:tQ,ONE:t0,create:t=>t8(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return tQ<=t&&t<e},is0:e=>e===tQ,isOdd:e=>(e&t0)===t0,neg:t=>t8(-t,e),eql:(e,t)=>e===t,sqr:t=>t8(t*t,e),add:(t,r)=>t8(t+r,e),sub:(t,r)=>t8(t-r,e),mul:(t,r)=>t8(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<tQ)throw Error("invalid exponent, negatives unsupported");if(r===tQ)return e.ONE;if(r===t0)return t;let i=e.ONE,s=t;for(;r>tQ;)r&t0&&(i=e.mul(i,s)),s=e.sqr(s),r>>=t0;return i})(o,e,t),div:(t,r)=>t8(t*t7(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>t7(t,e),sqrt:i.sqrt||(t=>(s||(s=function(e){if(e%t5===t2){let t=(e+t0)/t5;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}if(e%t4===t3){let t=(e-t3)/t4;return function(e,r){let i=e.mul(r,t1),s=e.pow(i,t),n=e.mul(r,s),a=e.mul(e.mul(n,t1),s),o=e.mul(n,e.sub(a,e.ONE));if(!e.eql(e.sqr(o),r))throw Error("Cannot find square root");return o}}return function(e){let t,r,i;let s=(e-t0)/t1;for(t=e-t0,r=0;t%t1===tQ;t/=t1,r++);for(i=t1;i<e&&t6(i,s,e)!==e-t0;i++)if(i>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===r){let t=(e+t0)/t5;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}let n=(t+t0)/t1;return function(e,a){if(e.pow(a,s)===e.neg(e.ONE))throw Error("Cannot find square root");let o=r,c=e.pow(e.mul(e.ONE,i),t),l=e.pow(a,n),h=e.pow(a,t);for(;!e.eql(h,e.ONE);){if(e.eql(h,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(h);t<o&&!e.eql(r,e.ONE);t++)r=e.sqr(r);let r=e.pow(c,t0<<BigInt(o-t-1));c=e.sqr(r),l=e.mul(l,r),h=e.mul(h,c),o=t}return l}}(e)}(e)),s(o,t))),invertBatch:e=>(function(e,t){let r=Array(t.length),i=t.reduce((t,i,s)=>e.is0(i)?t:(r[s]=t,e.mul(t,i)),e.ONE),s=e.inv(i);return t.reduceRight((t,i,s)=>e.is0(i)?t:(r[s]=e.mul(t,r[s]),e.mul(t,i)),s),r})(o,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?tM(e,a):tL(e,a),fromBytes:e=>{if(e.length!==a)throw Error("Field.fromBytes: expected "+a+" bytes, got "+e.length);return r?tD(e):tU(e)}});return Object.freeze(o)}function ri(e){if("bigint"!=typeof e)throw Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function rs(e){let t=ri(e);return t+Math.ceil(t/2)}let rn=BigInt(0),ra=BigInt(1);function ro(e,t){let r=t.negate();return e?r:t}function rc(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function rl(e,t){return rc(e,t),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}let rh=new WeakMap,rd=new WeakMap;function ru(e){return rd.get(e)||1}function rp(e){return function(e){let t=re.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});tJ(e,t)}(e.Fp),tJ(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...rt(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);let rg=BigInt(0),rf=BigInt(1),rm=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);let rw=BigInt(1),ry=BigInt(2),rb=BigInt(3),rv=BigInt(5);BigInt(8);let rE=function(e){let t=(tJ(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})),{P:r}=t,i=e=>t8(e,r),s=t.montgomeryBits,n=Math.ceil(s/8),a=t.nByteLength,o=t.adjustScalarBytes||(e=>e),c=t.powPminus2||(e=>t6(e,r-BigInt(2),r));function l(e,t,r){let s=i(e*(t-r));return[t=i(t-s),r=i(r+s)]}let h=(t.a-BigInt(2))/BigInt(4);function d(e,t){let d=function(e){let t=tB("u coordinate",e,n);return 32===a&&(t[31]&=127),tD(t)}(t),u=function(e){let t=tB("scalar",e),r=t.length;if(r!==n&&r!==a)throw Error("invalid scalar, expected "+n+" or "+a+" bytes, got "+r);return tD(o(t))}(e),p=function(e,t){tF("u",e,rg,r),tF("scalar",t,rg,r);let n=rf,a=rg,o=e,d=rf,u=rg,p;for(let r=BigInt(s-1);r>=rg;r--){let s=t>>r&rf;u^=s,n=(p=l(u,n,o))[0],o=p[1],a=(p=l(u,a,d))[0],d=p[1],u=s;let c=n+a,g=i(c*c),f=n-a,m=i(f*f),w=g-m,y=o+d,b=o-d,v=i(b*c),E=i(y*f),C=v+E,I=v-E;o=i(C*C),d=i(e*i(I*I)),n=i(g*m),a=i(w*(g+i(h*w)))}n=(p=l(u,n,o))[0],o=p[1],a=(p=l(u,a,d))[0],d=p[1];let g=c(a);return i(n*g)}(d,u);if(p===rg)throw Error("invalid private or public key received");return tM(i(p),n)}let u=tM(i(t.Gu),n);function p(e){return d(e,u)}return{scalarMult:d,scalarMultBase:p,getSharedSecret:(e,t)=>d(e,t),getPublicKey:e=>p(e),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:u}}({P:rm,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let{pow_p_5_8:t,b2:r}=function(e){let t=BigInt(10),r=BigInt(20),i=BigInt(40),s=BigInt(80),n=e*e%rm*e%rm,a=t9(n,ry,rm)*n%rm,o=t9(a,rw,rm)*e%rm,c=t9(o,rv,rm)*o%rm,l=t9(c,t,rm)*c%rm,h=t9(l,r,rm)*l%rm,d=t9(h,i,rm)*h%rm,u=t9(d,s,rm)*d%rm,p=t9(u,s,rm)*d%rm,g=t9(p,t,rm)*c%rm;return{pow_p_5_8:t9(g,ry,rm)*e%rm,b2:n}}(e);return t8(t9(t,rb,rm)*r,rm)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:eP});function rC(e){void 0!==e.lowS&&t_("lowS",e.lowS),void 0!==e.prehash&&t_("prehash",e.prehash)}let{bytesToNumberBE:rI,hexToBytes:rN}=tX,rA={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{let{Err:r}=rA;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,s=tO(i);if(s.length/2&128)throw new r("tlv.encode: long form length too big");let n=i>127?tO(s.length/2|128):"";return tO(e)+n+s+t},decode(e,t){let{Err:r}=rA,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let s=t[i++],n=0;if(128&s){let e=127&s;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let a=t.subarray(i,i+e);if(a.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===a[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of a)n=n<<8|e;if(i+=e,n<128)throw new r("tlv.decode(long): not minimal encoding")}else n=s;let a=t.subarray(i,i+n);if(a.length!==n)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(i+n)}}},_int:{encode(e){let{Err:t}=rA;if(e<r_)throw new t("integer: negative integers are not allowed");let r=tO(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=rA;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return rI(e)}},toSig(e){let{Err:t,_int:r,_tlv:i}=rA,s="string"==typeof e?rN(e):e;tA(s);let{v:n,l:a}=i.decode(48,s);if(a.length)throw new t("invalid signature: left bytes after parsing");let{v:o,l:c}=i.decode(2,n),{v:l,l:h}=i.decode(2,c);if(h.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(o),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=rA,i=t.encode(2,r.encode(e.r)),s=t.encode(2,r.encode(e.s));return t.encode(48,i+s)}},r_=BigInt(0),rS=BigInt(1);BigInt(2);let rP=BigInt(3);BigInt(4);let rO=rr(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),rT=rO.create(BigInt("-3")),rR=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),rk=function(e,t){let r=t=>(function(e){let t=function(e){let t=rp(e);return tJ(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:r,n:i}=t,s=r.BYTES+1,n=2*r.BYTES+1;function a(e){return t8(e,i)}let{ProjectivePoint:o,normPrivateKeyToScalar:c,weierstrassEquation:l,isWithinCurveOrder:h}=function(e){var t;let r=function(e){let t=rp(e);tJ(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:i,a:s}=t;if(r){if(!i.eql(s,i.ZERO))throw Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:i}=r,s=rr(r.n,r.nBitLength),n=r.toBytes||((e,t,r)=>{let s=t.toAffine();return tj(Uint8Array.from([4]),i.toBytes(s.x),i.toBytes(s.y))}),a=r.fromBytes||(e=>{let t=e.subarray(1),r=i.fromBytes(t.subarray(0,i.BYTES)),s=i.fromBytes(t.subarray(i.BYTES,2*i.BYTES));return{x:r,y:s}});function o(e){let{a:t,b:s}=r,n=i.sqr(e),a=i.mul(n,e);return i.add(i.add(a,i.mul(e,t)),s)}if(!i.eql(i.sqr(r.Gy),o(r.Gx)))throw Error("bad generator point: equation left != right");function c(e){let t;let{allowedPrivateKeyLengths:i,nByteLength:s,wrapPrivateKey:n,n:a}=r;if(i&&"bigint"!=typeof e){if(tN(e)&&(e=tP(e)),"string"!=typeof e||!i.includes(e.length))throw Error("invalid private key");e=e.padStart(2*s,"0")}try{t="bigint"==typeof e?e:tU(tB("private key",e,s))}catch{throw Error("invalid private key, expected hex or "+s+" bytes, got "+typeof e)}return n&&(t=t8(t,a)),tF("private key",t,rS,a),t}function l(e){if(!(e instanceof u))throw Error("ProjectivePoint expected")}let h=tZ((e,t)=>{let{px:r,py:s,pz:n}=e;if(i.eql(n,i.ONE))return{x:r,y:s};let a=e.is0();null==t&&(t=a?i.ONE:i.inv(n));let o=i.mul(r,t),c=i.mul(s,t),l=i.mul(n,t);if(a)return{x:i.ZERO,y:i.ZERO};if(!i.eql(l,i.ONE))throw Error("invZ was invalid");return{x:o,y:c}}),d=tZ(e=>{if(e.is0()){if(r.allowInfinityPoint&&!i.is0(e.py))return;throw Error("bad point: ZERO")}let{x:t,y:s}=e.toAffine();if(!i.isValid(t)||!i.isValid(s))throw Error("bad point: x or y not FE");let n=i.sqr(s),a=o(t);if(!i.eql(n,a))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class u{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!i.isValid(e))throw Error("x required");if(null==t||!i.isValid(t))throw Error("y required");if(null==r||!i.isValid(r))throw Error("z required");Object.freeze(this)}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!i.isValid(t)||!i.isValid(r))throw Error("invalid affine point");if(e instanceof u)throw Error("projective point not allowed");let s=e=>i.eql(e,i.ZERO);return s(t)&&s(r)?u.ZERO:new u(t,r,i.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){let t=i.invertBatch(e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(u.fromAffine)}static fromHex(e){let t=u.fromAffine(a(tB("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return u.BASE.multiply(c(e))}static msm(e,t){return function(e,t,r,i){if(function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}(i,t),r.length!==i.length)throw Error("arrays of points and scalars must have equal length");let s=e.ZERO,n=tz(BigInt(r.length)),a=n>12?n-3:n>4?n-2:n?2:1,o=(1<<a)-1,c=Array(o+1).fill(s),l=Math.floor((t.BITS-1)/a)*a,h=s;for(let e=l;e>=0;e-=a){c.fill(s);for(let t=0;t<i.length;t++){let s=i[t],n=Number(s>>BigInt(e)&BigInt(o));c[n]=c[n].add(r[t])}let t=s;for(let e=c.length-1,r=s;e>0;e--)r=r.add(c[e]),t=t.add(r);if(h=h.add(t),0!==e)for(let e=0;e<a;e++)h=h.double()}return h}(u,s,e,t)}_setWindowSize(e){g.setWindowSize(this,e)}assertValidity(){d(this)}hasEvenY(){let{y:e}=this.toAffine();if(i.isOdd)return!i.isOdd(e);throw Error("Field doesn't support isOdd")}equals(e){l(e);let{px:t,py:r,pz:s}=this,{px:n,py:a,pz:o}=e,c=i.eql(i.mul(t,o),i.mul(n,s)),h=i.eql(i.mul(r,o),i.mul(a,s));return c&&h}negate(){return new u(this.px,i.neg(this.py),this.pz)}double(){let{a:e,b:t}=r,s=i.mul(t,rP),{px:n,py:a,pz:o}=this,c=i.ZERO,l=i.ZERO,h=i.ZERO,d=i.mul(n,n),p=i.mul(a,a),g=i.mul(o,o),f=i.mul(n,a);return f=i.add(f,f),h=i.mul(n,o),h=i.add(h,h),c=i.mul(e,h),l=i.mul(s,g),l=i.add(c,l),c=i.sub(p,l),l=i.add(p,l),l=i.mul(c,l),c=i.mul(f,c),h=i.mul(s,h),g=i.mul(e,g),f=i.sub(d,g),f=i.mul(e,f),f=i.add(f,h),h=i.add(d,d),d=i.add(h,d),d=i.add(d,g),d=i.mul(d,f),l=i.add(l,d),g=i.mul(a,o),g=i.add(g,g),d=i.mul(g,f),c=i.sub(c,d),h=i.mul(g,p),h=i.add(h,h),h=i.add(h,h),new u(c,l,h)}add(e){l(e);let{px:t,py:s,pz:n}=this,{px:a,py:o,pz:c}=e,h=i.ZERO,d=i.ZERO,p=i.ZERO,g=r.a,f=i.mul(r.b,rP),m=i.mul(t,a),w=i.mul(s,o),y=i.mul(n,c),b=i.add(t,s),v=i.add(a,o);b=i.mul(b,v),v=i.add(m,w),b=i.sub(b,v),v=i.add(t,n);let E=i.add(a,c);return v=i.mul(v,E),E=i.add(m,y),v=i.sub(v,E),E=i.add(s,n),h=i.add(o,c),E=i.mul(E,h),h=i.add(w,y),E=i.sub(E,h),p=i.mul(g,v),h=i.mul(f,y),p=i.add(h,p),h=i.sub(w,p),p=i.add(w,p),d=i.mul(h,p),w=i.add(m,m),w=i.add(w,m),y=i.mul(g,y),v=i.mul(f,v),w=i.add(w,y),y=i.sub(m,y),y=i.mul(g,y),v=i.add(v,y),m=i.mul(w,v),d=i.add(d,m),m=i.mul(E,v),h=i.mul(b,h),h=i.sub(h,m),m=i.mul(b,w),p=i.mul(E,p),p=i.add(p,m),new u(h,d,p)}subtract(e){return this.add(e.negate())}is0(){return this.equals(u.ZERO)}wNAF(e){return g.wNAFCached(this,e,u.normalizeZ)}multiplyUnsafe(e){let{endo:t,n:s}=r;tF("scalar",e,r_,s);let n=u.ZERO;if(e===r_)return n;if(this.is0()||e===rS)return this;if(!t||g.hasPrecomputes(this))return g.wNAFCachedUnsafe(this,e,u.normalizeZ);let{k1neg:a,k1:o,k2neg:c,k2:l}=t.splitScalar(e),h=n,d=n,p=this;for(;o>r_||l>r_;)o&rS&&(h=h.add(p)),l&rS&&(d=d.add(p)),p=p.double(),o>>=rS,l>>=rS;return a&&(h=h.negate()),c&&(d=d.negate()),d=new u(i.mul(d.px,t.beta),d.py,d.pz),h.add(d)}multiply(e){let t,s;let{endo:n,n:a}=r;if(tF("scalar",e,rS,a),n){let{k1neg:r,k1:a,k2neg:o,k2:c}=n.splitScalar(e),{p:l,f:h}=this.wNAF(a),{p:d,f:p}=this.wNAF(c);l=g.constTimeNegate(r,l),d=g.constTimeNegate(o,d),d=new u(i.mul(d.px,n.beta),d.py,d.pz),t=l.add(d),s=h.add(p)}else{let{p:r,f:i}=this.wNAF(e);t=r,s=i}return u.normalizeZ([t,s])[0]}multiplyAndAddUnsafe(e,t,r){let i=u.BASE,s=(e,t)=>t!==r_&&t!==rS&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t),n=s(this,t).add(s(e,r));return n.is0()?void 0:n}toAffine(e){return h(this,e)}isTorsionFree(){let{h:e,isTorsionFree:t}=r;if(e===rS)return!0;if(t)return t(u,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:e,clearCofactor:t}=r;return e===rS?this:t?t(u,this):this.multiplyUnsafe(r.h)}toRawBytes(e=!0){return t_("isCompressed",e),this.assertValidity(),n(u,this,e)}toHex(e=!0){return t_("isCompressed",e),tP(this.toRawBytes(e))}}u.BASE=new u(r.Gx,r.Gy,i.ONE),u.ZERO=new u(i.ZERO,i.ONE,i.ZERO);let p=r.nBitLength,g=(t=r.endo?Math.ceil(p/2):p,{constTimeNegate:ro,hasPrecomputes:e=>1!==ru(e),unsafeLadder(e,t,r=u.ZERO){let i=e;for(;t>rn;)t&ra&&(r=r.add(i)),i=i.double(),t>>=ra;return r},precomputeWindow(e,r){let{windows:i,windowSize:s}=rl(r,t),n=[],a=e,o=a;for(let e=0;e<i;e++){o=a,n.push(o);for(let e=1;e<s;e++)o=o.add(a),n.push(o);a=o.double()}return n},wNAF(e,r,i){let{windows:s,windowSize:n}=rl(e,t),a=u.ZERO,o=u.BASE,c=BigInt(2**e-1),l=2**e,h=BigInt(e);for(let e=0;e<s;e++){let t=e*n,s=Number(i&c);i>>=h,s>n&&(s-=l,i+=ra);let d=t+Math.abs(s)-1,u=e%2!=0,p=s<0;0===s?o=o.add(ro(u,r[t])):a=a.add(ro(p,r[d]))}return{p:a,f:o}},wNAFUnsafe(e,r,i,s=u.ZERO){let{windows:n,windowSize:a}=rl(e,t),o=BigInt(2**e-1),c=2**e,l=BigInt(e);for(let e=0;e<n;e++){let t=e*a;if(i===rn)break;let n=Number(i&o);if(i>>=l,n>a&&(n-=c,i+=ra),0===n)continue;let h=r[t+Math.abs(n)-1];n<0&&(h=h.negate()),s=s.add(h)}return s},getPrecomputes(e,t,r){let i=rh.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&rh.set(t,r(i))),i},wNAFCached(e,t,r){let i=ru(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)},wNAFCachedUnsafe(e,t,r,i){let s=ru(e);return 1===s?this.unsafeLadder(e,t,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,r),t,i)},setWindowSize(e,r){rc(r,t),rd.set(e,r),rh.delete(e)}});return{CURVE:r,ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:function(e){return t$(e,rS,r.n)}}}({...t,toBytes(e,t,i){let s=t.toAffine(),n=r.toBytes(s.x);return t_("isCompressed",i),i?tj(Uint8Array.from([t.hasEvenY()?2:3]),n):tj(Uint8Array.from([4]),n,r.toBytes(s.y))},fromBytes(e){let t=e.length,i=e[0],a=e.subarray(1);if(t===s&&(2===i||3===i)){let e;let t=tU(a);if(!t$(t,rS,r.ORDER))throw Error("Point is not on curve");let s=l(t);try{e=r.sqrt(s)}catch(t){let e=t instanceof Error?": "+t.message:"";throw Error("Point is not on curve"+e)}let n=(e&rS)===rS;return(1&i)==1!==n&&(e=r.neg(e)),{x:t,y:e}}if(t===n&&4===i){let e=r.fromBytes(a.subarray(0,r.BYTES)),t=r.fromBytes(a.subarray(r.BYTES,2*r.BYTES));return{x:e,y:t}}throw Error("invalid Point, expected length of "+s+", or uncompressed "+n+", got "+t)}}),d=e=>tP(tL(e,t.nByteLength)),u=(e,t,r)=>tU(e.slice(t,r));class p{constructor(e,t,r){this.r=e,this.s=t,this.recovery=r,this.assertValidity()}static fromCompact(e){let r=t.nByteLength;return e=tB("compactSignature",e,2*r),new p(u(e,0,r),u(e,r,2*r))}static fromDER(e){let{r:t,s:r}=rA.toSig(tB("DER",e));return new p(t,r)}assertValidity(){tF("r",this.r,rS,i),tF("s",this.s,rS,i)}addRecoveryBit(e){return new p(this.r,this.s,e)}recoverPublicKey(e){let{r:s,s:n,recovery:c}=this,l=m(tB("msgHash",e));if(null==c||![0,1,2,3].includes(c))throw Error("recovery id invalid");let h=2===c||3===c?s+t.n:s;if(h>=r.ORDER)throw Error("recovery id 2 or 3 invalid");let u=o.fromHex(((1&c)==0?"02":"03")+d(h)),p=t7(h,i),g=a(-l*p),f=a(n*p),w=o.BASE.multiplyAndAddUnsafe(u,g,f);if(!w)throw Error("point at infinify");return w.assertValidity(),w}hasHighS(){return this.s>i>>rS}normalizeS(){return this.hasHighS()?new p(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return tx(this.toDERHex())}toDERHex(){return rA.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return tx(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}function g(e){let t=tN(e),r="string"==typeof e,i=(t||r)&&e.length;return t?i===s||i===n:r?i===2*s||i===2*n:e instanceof o}let f=t.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let r=tU(e),i=8*e.length-t.nBitLength;return i>0?r>>BigInt(i):r},m=t.bits2int_modN||function(e){return a(f(e))},w=tH(t.nBitLength);function y(e){return tF("num < 2^"+t.nBitLength,e,r_,w),tL(e,t.nByteLength)}let b={lowS:t.lowS,prehash:!1},v={lowS:t.lowS,prehash:!1};return o.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return o.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(g(e))throw Error("first arg must be private key");if(!g(t))throw Error("second arg must be public key");return o.fromHex(t).multiply(c(e)).toRawBytes(r)},sign:function(e,s,n=b){let{seed:l,k2sig:d}=function(e,s,n=b){if(["recovered","canonical"].some(e=>e in n))throw Error("sign() legacy options not supported");let{hash:l,randomBytes:d}=t,{lowS:u,prehash:g,extraEntropy:w}=n;null==u&&(u=!0),e=tB("msgHash",e),rC(n),g&&(e=tB("prehashed msgHash",l(e)));let v=m(e),E=c(s),C=[y(E),y(v)];if(null!=w&&!1!==w){let e=!0===w?d(r.BYTES):w;C.push(tB("extraEntropy",e))}let I=tj(...C);return{seed:I,k2sig:function(e){let t=f(e);if(!h(t))return;let r=t7(t,i),s=o.BASE.multiply(t).toAffine(),n=a(s.x);if(n===r_)return;let c=a(r*a(v+n*E));if(c===r_)return;let l=(s.x===n?0:2)|Number(s.y&rS),d=c;return u&&c>i>>rS&&(d=c>i>>rS?a(-c):c,l^=1),new p(n,d,l)}}}(e,s,n);return tK(t.hash.outputLen,t.nByteLength,t.hmac)(l,d)},verify:function(e,r,s,n=v){let c,l;r=tB("msgHash",r),s=tB("publicKey",s);let{lowS:h,prehash:d,format:u}=n;if(rC(n),"strict"in n)throw Error("options.strict was renamed to lowS");if(void 0!==u&&"compact"!==u&&"der"!==u)throw Error("format must be compact or der");let g="string"==typeof e||tN(e),f=!g&&!u&&"object"==typeof e&&null!==e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!g&&!f)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(f&&(c=new p(e.r,e.s)),g){try{"compact"!==u&&(c=p.fromDER(e))}catch(e){if(!(e instanceof rA.Err))throw e}c||"der"===u||(c=p.fromCompact(e))}l=o.fromHex(s)}catch{return!1}if(!c||h&&c.hasHighS())return!1;d&&(r=t.hash(r));let{r:w,s:y}=c,b=m(r),E=t7(y,i),C=a(b*E),I=a(w*E),N=o.BASE.multiplyAndAddUnsafe(l,C,I)?.toAffine();return!!N&&a(N.x)===w},ProjectivePoint:o,Signature:p,utils:{isValidPrivateKey(e){try{return c(e),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{let e=rs(t.n);return function(e,t,r=!1){let i=e.length,s=ri(t),n=rs(t);if(i<16||i<n||i>1024)throw Error("expected "+n+"-1024 bytes of input, got "+i);let a=r?tD(e):tU(e),o=t8(a,t-t0)+t0;return r?tM(o,s):tL(o,s)}(t.randomBytes(e),t.n)},precompute:(e=8,t=o.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}})({...e,hash:t,hmac:(e,...r)=>td(t,e,function(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];eh(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let s=e[t];r.set(s,i),i+=s.length}return r}(...r)),randomBytes:eP});return{...r(t),create:r}}({a:rT,b:rR,Fp:rO,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},tv),rx="base10",rU="base16",rD="base64pad",rL="base64url",rM="utf8";function rB(){let e=eP(32);return(0,F.BB)(e,rU)}function rj(e){let t=tv((0,F.mL)(e,rM));return(0,F.BB)(t,rU)}function rq(e){return(0,F.mL)(`${e}`,rx)}function r$(e){return Number((0,F.BB)(e,rx))}function rF(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function rz(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4;return t+"=".repeat(r)}function rH(e){if(2===r$(e.type))return(0,F.BB)((0,F.zo)([e.type,e.sealed]),rD);if(1===r$(e.type)){if(typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return(0,F.BB)((0,F.zo)([e.type,e.senderPublicKey,e.iv,e.sealed]),rD)}return(0,F.BB)((0,F.zo)([e.type,e.iv,e.sealed]),rD)}function rW(e){let t=(e.encoding||rD)===rL?rz(e.encoded):e.encoded,r=(0,F.mL)(t,rD),i=r.slice(0,1);if(1===r$(i)){let e=r.slice(1,33),t=r.slice(33,45),s=r.slice(45);return{type:i,sealed:s,iv:t,senderPublicKey:e}}if(2===r$(i)){let e=r.slice(1),t=eP(12);return{type:i,sealed:e,iv:t}}let s=r.slice(1,13),n=r.slice(13);return{type:i,sealed:n,iv:s}}function rV(e){let t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function rK(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function rG(e){return e?.relay||{protocol:"irn"}}function rJ(e){let t=z.iO[e];if(typeof t>"u")throw Error(`Relay Protocol not supported: ${e}`);return t}function rY(e){var t;if(!e.includes("wc:")){let t=ec(e);null!=t&&t.includes("wc:")&&(e=t)}e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e;let r=e.indexOf(":"),i=-1!==e.indexOf("?")?e.indexOf("?"):void 0,s=e.substring(0,r),n=e.substring(r+1,i).split("@"),a="u">typeof i?e.substring(i):"",o=new URLSearchParams(a),c={};o.forEach((e,t)=>{c[t]=e});let l="string"==typeof c.methods?c.methods.split(","):void 0;return{protocol:s,topic:(t=n[0]).startsWith("//")?t.substring(2):t,version:parseInt(n[1],10),symKey:c.symKey,relay:function(e,t="-"){let r={},i="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(i)){let s=t.replace(i,""),n=e[t];r[s]=n}}),r}(c),methods:l,expiryTimestamp:c.expiryTimestamp?parseInt(c.expiryTimestamp,10):void 0}}function rZ(e){let t=new URLSearchParams,r=function(e,t="-"){let r={};return Object.keys(e).forEach(i=>{e[i]&&(r["relay"+t+i]=e[i])}),r}(e.relay);Object.keys(r).sort().forEach(e=>{t.set(e,r[e])}),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));let i=t.toString();return`${e.protocol}:${e.topic}@${e.version}?${i}`}Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let rX={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},rQ={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function r0(e,t){let{message:r,code:i}=rQ[e];return{message:t?`${r} ${t}`:r,code:i}}function r1(e,t){let{message:r,code:i}=rX[e];return{message:t?`${r} ${t}`:r,code:i}}function r2(e){return typeof e>"u"}function r5(e,t){return!!(t&&r2(e))||"string"==typeof e&&!!e.trim().length}function r3(e){return"u">typeof e}function r4(){let e=Y();return new Promise(t=>{switch(e){case V.browser:t(J()&&navigator?.onLine);break;case V.reactNative:t(r8());break;case V.node:default:t(!0)}})}async function r8(){if(G()&&"u">typeof r.g&&null!=r.g&&r.g.NetInfo){let e=await (null==r.g?void 0:r.g.NetInfo.fetch());return e?.isConnected}return!0}var r6=r(81154),r9=r(55494),r7=r(94907),ie=r(48834).Buffer,it=r(34406);let ir="core",ii=`wc@2:${ir}:`,is={name:ir,logger:"error"},ia={database:":memory:"},io="client_ed25519_seed",ic=D.ONE_DAY,il=D.SIX_HOURS,ih="wss://relay.walletconnect.org",id={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},iu={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ip="2.21.0",ig={link_mode:"link_mode",relay:"relay"},im={inbound:"inbound",outbound:"outbound"},iw="WALLETCONNECT_LINK_MODE_APPS",iy={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ib=(D.FIVE_SECONDS,{wc_pairingDelete:{req:{ttl:D.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:D.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:D.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:D.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:D.ONE_DAY,prompt:!1,tag:0},res:{ttl:D.ONE_DAY,prompt:!1,tag:0}}}),iv={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},iE={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},iC={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},iI="https://verify.walletconnect.org",iN=`${iI}/v3`,iA=["https://verify.walletconnect.com",iI],i_={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},iS={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},iP={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},iO={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},iT={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},iR={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"};var ik=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),a=n.charCodeAt(0);if(255!==r[a])throw TypeError(n+" is ambiguous");r[a]=s}var o=e.length,c=e.charAt(0),l=Math.log(o)/Math.log(256),h=Math.log(256)/Math.log(o);function d(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,s=0;e[t]===c;)i++,t++;for(var n=(e.length-t)*l+1>>>0,a=new Uint8Array(n);e[t];){var h=r[e.charCodeAt(t)];if(255===h)return;for(var d=0,u=n-1;(0!==h||d<s)&&-1!==u;u--,d++)h+=o*a[u]>>>0,a[u]=h%256>>>0,h=h/256>>>0;if(0!==h)throw Error("Non-zero carry");s=d,t++}if(" "!==e[t]){for(var p=n-s;p!==n&&0===a[p];)p++;for(var g=new Uint8Array(i+(n-p)),f=i;p!==n;)g[f++]=a[p++];return g}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,s=0,n=t.length;s!==n&&0===t[s];)s++,r++;for(var a=(n-s)*h+1>>>0,l=new Uint8Array(a);s!==n;){for(var d=t[s],u=0,p=a-1;(0!==d||u<i)&&-1!==p;p--,u++)d+=256*l[p]>>>0,l[p]=d%o>>>0,d=d/o>>>0;if(0!==d)throw Error("Non-zero carry");i=u,s++}for(var g=a-i;g!==a&&0===l[g];)g++;for(var f=c.repeat(r);g<a;++g)f+=e.charAt(l[g]);return f},decodeUnsafe:d,decode:function(e){var r=d(e);if(r)return r;throw Error(`Non-${t} character`)}}};let ix=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")},iU=e=>new TextEncoder().encode(e),iD=e=>new TextDecoder().decode(e);class iL{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class iM{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return ij(this,e)}}class iB{constructor(e){this.decoders=e}or(e){return ij(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let ij=(e,t)=>new iB({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class iq{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new iL(e,t,r),this.decoder=new iM(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let i$=({name:e,prefix:t,encode:r,decode:i})=>new iq(e,t,r,i),iF=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:s}=ik(r,t);return i$({prefix:e,name:t,encode:i,decode:e=>ix(s(e))})},iz=(e,t,r,i)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let a=new Uint8Array(n*r/8|0),o=0,c=0,l=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${i} character`);c=c<<r|n,(o+=r)>=8&&(o-=8,a[l++]=255&c>>o)}if(o>=r||255&c<<8-o)throw SyntaxError("Unexpected end of data");return a},iH=(e,t,r)=>{let i="="===t[t.length-1],s=(1<<r)-1,n="",a=0,o=0;for(let i=0;i<e.length;++i)for(o=o<<8|e[i],a+=8;a>r;)a-=r,n+=t[s&o>>a];if(a&&(n+=t[s&o<<r-a]),i)for(;n.length*r&7;)n+="=";return n},iW=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>i$({prefix:t,name:e,encode:e=>iH(e,i,r),decode:t=>iz(t,i,r,e)}),iV=i$({prefix:"\x00",name:"identity",encode:e=>iD(e),decode:e=>iU(e)});var iK=Object.freeze({__proto__:null,identity:iV});let iG=iW({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var iJ=Object.freeze({__proto__:null,base2:iG});let iY=iW({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var iZ=Object.freeze({__proto__:null,base8:iY});let iX=iF({prefix:"9",name:"base10",alphabet:"0123456789"});var iQ=Object.freeze({__proto__:null,base10:iX});let i0=iW({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),i1=iW({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var i2=Object.freeze({__proto__:null,base16:i0,base16upper:i1});let i5=iW({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),i3=iW({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),i4=iW({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),i8=iW({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),i6=iW({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),i9=iW({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),i7=iW({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),se=iW({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),st=iW({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var sr=Object.freeze({__proto__:null,base32:i5,base32upper:i3,base32pad:i4,base32padupper:i8,base32hex:i6,base32hexupper:i9,base32hexpad:i7,base32hexpadupper:se,base32z:st});let si=iF({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ss=iF({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var sn=Object.freeze({__proto__:null,base36:si,base36upper:ss});let sa=iF({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),so=iF({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var sc=Object.freeze({__proto__:null,base58btc:sa,base58flickr:so});let sl=iW({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sh=iW({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sd=iW({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),su=iW({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var sp=Object.freeze({__proto__:null,base64:sl,base64pad:sh,base64url:sd,base64urlpad:su});let sg=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),sf=sg.reduce((e,t,r)=>(e[r]=t,e),[]),sm=sg.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]),sw=i$({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=sf[t],"")},decode:function(e){let t=[];for(let r of e){let e=sm[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var sy=Object.freeze({__proto__:null,base256emoji:sw});function sb(e,t,r){t=t||[],r=r||0;for(var i=r;e>=2147483648;)t[r++]=255&e|128,e/=128;for(;-128&e;)t[r++]=255&e|128,e>>>=7;return t[r]=0|e,sb.bytes=r-i+1,t}function sv(e,t){var r,i=0,t=t||0,s=0,n=t,a=e.length;do{if(n>=a)throw sv.bytes=0,RangeError("Could not decode varint");r=e[n++],i+=s<28?(127&r)<<s:(127&r)*Math.pow(2,s),s+=7}while(r>=128);return sv.bytes=n-t,i}var sE={encode:sb,decode:sv,encodingLength:function(e){return e<128?1:e<16384?2:e<2097152?3:e<268435456?4:e<34359738368?5:e<4398046511104?6:e<562949953421312?7:e<72057594037927940?8:e<0x7fffffffffffffff?9:10}};let sC=(e,t,r=0)=>(sE.encode(e,t,r),t),sI=e=>sE.encodingLength(e),sN=(e,t)=>{let r=t.byteLength,i=sI(e),s=i+sI(r),n=new Uint8Array(s+r);return sC(e,n,0),sC(r,n,i),n.set(t,s),new sA(e,r,t,n)};class sA{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}let s_=({name:e,code:t,encode:r})=>new sS(e,t,r);class sS{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?sN(this.code,t):t.then(e=>sN(this.code,e))}throw Error("Unknown type, must be binary type")}}let sP=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),sO=s_({name:"sha2-256",code:18,encode:sP("SHA-256")}),sT=s_({name:"sha2-512",code:19,encode:sP("SHA-512")});var sR=Object.freeze({__proto__:null,sha256:sO,sha512:sT});let sk=e=>sN(0,ix(e));var sx=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:ix,digest:sk}});new TextEncoder,new TextDecoder;let sU={...iK,...iJ,...iZ,...iQ,...i2,...sr,...sn,...sc,...sp,...sy};function sD(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...sR,...sx});let sL=sD("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),sM=sD("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),sB={utf8:sL,"utf-8":sL,hex:sU.base16,latin1:sM,ascii:sM,binary:sM,...sU};var sj=Object.defineProperty,sq=(e,t,r)=>t in e?sj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,s$=(e,t,r)=>sq(e,"symbol"!=typeof t?t+"":t,r);class sF{constructor(e,t){this.core=e,this.logger=t,s$(this,"keychain",new Map),s$(this,"name","keychain"),s$(this,"version","0.3"),s$(this,"initialized",!1),s$(this,"storagePrefix",ii),s$(this,"init",async()=>{if(!this.initialized){let e=await this.getKeyChain();"u">typeof e&&(this.keychain=e),this.initialized=!0}}),s$(this,"has",e=>(this.isInitialized(),this.keychain.has(e))),s$(this,"set",async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()}),s$(this,"get",e=>{this.isInitialized();let t=this.keychain.get(e);if(typeof t>"u"){let{message:t}=r0("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}),s$(this,"del",async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()}),this.core=e,this.logger=(0,m.Ep)(t,this.name)}get context(){return(0,m.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Q(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?ee(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=r0("NOT_INITIALIZED",this.name);throw Error(e)}}}var sz=Object.defineProperty,sH=(e,t,r)=>t in e?sz(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sW=(e,t,r)=>sH(e,"symbol"!=typeof t?t+"":t,r);class sV{constructor(e,t,r){this.core=e,this.logger=t,sW(this,"name","crypto"),sW(this,"keychain"),sW(this,"randomSessionIdentifier",rB()),sW(this,"initialized",!1),sW(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),sW(this,"hasKeys",e=>(this.isInitialized(),this.keychain.has(e))),sW(this,"getClientId",async()=>{this.isInitialized();let e=await this.getClientSeed(),t=M.Au(e);return M.bG(t.publicKey)}),sW(this,"generateKeyPair",()=>{this.isInitialized();let e=function(){let e=rE.utils.randomPrivateKey(),t=rE.getPublicKey(e);return{privateKey:(0,F.BB)(e,rU),publicKey:(0,F.BB)(t,rU)}}();return this.setPrivateKey(e.publicKey,e.privateKey)}),sW(this,"signJWT",async e=>{this.isInitialized();let t=await this.getClientSeed(),r=M.Au(t),i=this.randomSessionIdentifier;return await M.vf(i,e,ic,r)}),sW(this,"generateSharedKey",(e,t,r)=>{this.isInitialized();let i=this.getPrivateKey(e),s=function(e,t){let r=rE.getSharedSecret((0,F.mL)(e,rU),(0,F.mL)(t,rU)),i=tg(tv,r,void 0,void 0,32);return(0,F.BB)(i,rU)}(i,t);return this.setSymKey(s,r)}),sW(this,"setSymKey",async(e,t)=>{this.isInitialized();let r=t||function(e){let t=tv((0,F.mL)(e,rU));return(0,F.BB)(t,rU)}(e);return await this.keychain.set(r,e),r}),sW(this,"deleteKeyPair",async e=>{this.isInitialized(),await this.keychain.del(e)}),sW(this,"deleteSymKey",async e=>{this.isInitialized(),await this.keychain.del(e)}),sW(this,"encode",async(e,t,r)=>{this.isInitialized();let i=rV(r),s=(0,L.u)(t);if(2===i.type)return function(e,t){let r=rq(2),i=eP(12),s=(0,F.mL)(e,rM),n=rH({type:r,sealed:s,iv:i});return t===rL?rF(n):n}(s,r?.encoding);if(rK(i)){let t=i.senderPublicKey,r=i.receiverPublicKey;e=await this.generateSharedKey(t,r)}let n=this.getSymKey(e),{type:a,senderPublicKey:o}=i;return function(e){let t=rq("u">typeof e.type?e.type:0);if(1===r$(t)&&typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let r="u">typeof e.senderPublicKey?(0,F.mL)(e.senderPublicKey,rU):void 0,i="u">typeof e.iv?(0,F.mL)(e.iv,rU):eP(12),s=(0,F.mL)(e.symKey,rU),n=tl(s,i).encrypt((0,F.mL)(e.message,rM)),a=rH({type:t,sealed:n,iv:i,senderPublicKey:r});return e.encoding===rL?rF(a):a}({type:a,symKey:n,message:s,senderPublicKey:o,encoding:r?.encoding})}),sW(this,"decode",async(e,t,r)=>{this.isInitialized();let i=function(e,t){let r=rW({encoded:e,encoding:t?.encoding});return rV({type:r$(r.type),senderPublicKey:"u">typeof r.senderPublicKey?(0,F.BB)(r.senderPublicKey,rU):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,r);if(2===i.type){let e=function(e,t){let{sealed:r}=rW({encoded:e,encoding:t});return(0,F.BB)(r,rM)}(t,r?.encoding);return(0,L.D)(e)}if(rK(i)){let t=i.receiverPublicKey,r=i.senderPublicKey;e=await this.generateSharedKey(t,r)}try{let i=this.getSymKey(e),s=function(e){let t=(0,F.mL)(e.symKey,rU),{sealed:r,iv:i}=rW({encoded:e.encoded,encoding:e.encoding}),s=tl(t,i).decrypt(r);if(null===s)throw Error("Failed to decrypt");return(0,F.BB)(s,rM)}({symKey:i,encoded:t,encoding:r?.encoding});return(0,L.D)(s)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}}),sW(this,"getPayloadType",(e,t=rD)=>{let r=rW({encoded:e,encoding:t});return r$(r.type)}),sW(this,"getPayloadSenderPublicKey",(e,t=rD)=>{let r=rW({encoded:e,encoding:t});return r.senderPublicKey?(0,F.BB)(r.senderPublicKey,rU):void 0}),this.core=e,this.logger=(0,m.Ep)(t,this.name),this.keychain=r||new sF(this.core,this.logger)}get context(){return(0,m.Fd)(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(io)}catch{e=rB(),await this.keychain.set(io,e)}return function(e,t="utf8"){let r=sB[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=r0("NOT_INITIALIZED",this.name);throw Error(e)}}}var sK=Object.defineProperty,sG=Object.defineProperties,sJ=Object.getOwnPropertyDescriptors,sY=Object.getOwnPropertySymbols,sZ=Object.prototype.hasOwnProperty,sX=Object.prototype.propertyIsEnumerable,sQ=(e,t,r)=>t in e?sK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,s0=(e,t)=>{for(var r in t||(t={}))sZ.call(t,r)&&sQ(e,r,t[r]);if(sY)for(var r of sY(t))sX.call(t,r)&&sQ(e,r,t[r]);return e},s1=(e,t)=>sG(e,sJ(t)),s2=(e,t,r)=>sQ(e,"symbol"!=typeof t?t+"":t,r);class s5 extends _{constructor(e,t){super(e,t),this.logger=e,this.core=t,s2(this,"messages",new Map),s2(this,"messagesWithoutClientAck",new Map),s2(this,"name","messages"),s2(this,"version","0.3"),s2(this,"initialized",!1),s2(this,"storagePrefix",ii),s2(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let e=await this.getRelayerMessages();"u">typeof e&&(this.messages=e);let t=await this.getRelayerMessagesWithoutClientAck();"u">typeof t&&(this.messagesWithoutClientAck=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}}),s2(this,"set",async(e,t,r)=>{this.isInitialized();let i=rj(t),s=this.messages.get(e);if(typeof s>"u"&&(s={}),"u">typeof s[i])return i;if(s[i]=t,this.messages.set(e,s),r===im.inbound){let r=this.messagesWithoutClientAck.get(e)||{};this.messagesWithoutClientAck.set(e,s1(s0({},r),{[i]:t}))}return await this.persist(),i}),s2(this,"get",e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t}),s2(this,"getWithoutAck",e=>{this.isInitialized();let t={};for(let r of e){let e=this.messagesWithoutClientAck.get(r)||{};t[r]=Object.values(e)}return t}),s2(this,"has",(e,t)=>{this.isInitialized();let r=this.get(e),i=rj(t);return"u">typeof r[i]}),s2(this,"ack",async(e,t)=>{this.isInitialized();let r=this.messagesWithoutClientAck.get(e);if(typeof r>"u")return;let i=rj(t);delete r[i],0===Object.keys(r).length?this.messagesWithoutClientAck.delete(e):this.messagesWithoutClientAck.set(e,r),await this.persist()}),s2(this,"del",async e=>{this.isInitialized(),this.messages.delete(e),this.messagesWithoutClientAck.delete(e),await this.persist()}),this.logger=(0,m.Ep)(e,this.name),this.core=t}get context(){return(0,m.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Q(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Q(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?ee(e):void 0}async getRelayerMessagesWithoutClientAck(){let e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return"u">typeof e?ee(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:e}=r0("NOT_INITIALIZED",this.name);throw Error(e)}}}var s3=Object.defineProperty,s4=Object.defineProperties,s8=Object.getOwnPropertyDescriptors,s6=Object.getOwnPropertySymbols,s9=Object.prototype.hasOwnProperty,s7=Object.prototype.propertyIsEnumerable,ne=(e,t,r)=>t in e?s3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nt=(e,t)=>{for(var r in t||(t={}))s9.call(t,r)&&ne(e,r,t[r]);if(s6)for(var r of s6(t))s7.call(t,r)&&ne(e,r,t[r]);return e},nr=(e,t)=>s4(e,s8(t)),ni=(e,t,r)=>ne(e,"symbol"!=typeof t?t+"":t,r);class ns extends S{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,ni(this,"events",new u.EventEmitter),ni(this,"name","publisher"),ni(this,"queue",new Map),ni(this,"publishTimeout",(0,D.toMiliseconds)(D.ONE_MINUTE)),ni(this,"initialPublishTimeout",(0,D.toMiliseconds)(15*D.ONE_SECOND)),ni(this,"needsTransportRestart",!1),ni(this,"publish",async(e,t,r)=>{var i;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});let s=r?.ttl||il,n=rG(r),a=r?.prompt||!1,o=r?.tag||0,c=r?.id||(0,r9.getBigIntRpcId)().toString(),l={topic:e,message:t,opts:{ttl:s,relay:n,prompt:a,tag:o,id:c,attestation:r?.attestation,tvf:r?.tvf}},h=`Failed to publish payload, please try again. id:${c} tag:${o}`;try{let i=new Promise(async i=>{let n=({id:e})=>{l.opts.id===e&&(this.removeRequestFromQueue(e),this.relayer.events.removeListener(id.publish,n),i(l))};this.relayer.events.on(id.publish,n);let h=et(new Promise((i,n)=>{this.rpcPublish({topic:e,message:t,ttl:s,prompt:a,tag:o,id:c,attestation:r?.attestation,tvf:r?.tvf}).then(i).catch(e=>{this.logger.warn(e,e?.message),n(e)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${c} tag:${o}`);try{await h,this.events.removeListener(id.publish,n)}catch(e){this.queue.set(c,nr(nt({},l),{attempt:1})),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:c,topic:e,message:t,opts:r}}),await et(i,this.publishTimeout,h)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(i=r?.internal)&&i.throwOnFailedPublish)throw e}finally{this.queue.delete(c)}}),ni(this,"on",(e,t)=>{this.events.on(e,t)}),ni(this,"once",(e,t)=>{this.events.once(e,t)}),ni(this,"off",(e,t)=>{this.events.off(e,t)}),ni(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.relayer=e,this.logger=(0,m.Ep)(t,this.name),this.registerEventListeners()}get context(){return(0,m.Fd)(this.logger)}async rpcPublish(e){var t,r,i,s;let{topic:n,message:a,ttl:o=il,prompt:c,tag:l,id:h,attestation:d,tvf:u}=e,p={method:rJ(rG().protocol).publish,params:nt({topic:n,message:a,ttl:o,prompt:c,tag:l,attestation:d},u),id:h};r2(null==(t=p.params)?void 0:t.prompt)&&(null==(r=p.params)||delete r.prompt),r2(null==(i=p.params)?void 0:i.tag)&&(null==(s=p.params)||delete s.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});let g=await this.relayer.request(p);return this.relayer.events.emit(id.publish,e),this.logger.debug("Successfully Published Payload"),g}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{let r=e.attempt+1;this.queue.set(t,nr(nt({},e),{attempt:r}));let{topic:i,message:s,opts:n,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${r}`),await this.rpcPublish(nr(nt({},e),{topic:i,message:s,ttl:n.ttl,prompt:n.prompt,tag:n.tag,id:n.id,attestation:a,tvf:n.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(g.Lx.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(id.connection_stalled);return}this.checkQueue()}),this.relayer.on(id.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var nn=Object.defineProperty,na=(e,t,r)=>t in e?nn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,no=(e,t,r)=>na(e,"symbol"!=typeof t?t+"":t,r);class nc{constructor(){no(this,"map",new Map),no(this,"set",(e,t)=>{let r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),no(this,"get",e=>this.map.get(e)||[]),no(this,"exists",(e,t)=>this.get(e).includes(t)),no(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;let r=this.get(e);if(!this.exists(e,t))return;let i=r.filter(e=>e!==t);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),no(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var nl=Object.defineProperty,nh=Object.defineProperties,nd=Object.getOwnPropertyDescriptors,nu=Object.getOwnPropertySymbols,np=Object.prototype.hasOwnProperty,ng=Object.prototype.propertyIsEnumerable,nf=(e,t,r)=>t in e?nl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nm=(e,t)=>{for(var r in t||(t={}))np.call(t,r)&&nf(e,r,t[r]);if(nu)for(var r of nu(t))ng.call(t,r)&&nf(e,r,t[r]);return e},nw=(e,t)=>nh(e,nd(t)),ny=(e,t,r)=>nf(e,"symbol"!=typeof t?t+"":t,r);class nb extends T{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,ny(this,"subscriptions",new Map),ny(this,"topicMap",new nc),ny(this,"events",new u.EventEmitter),ny(this,"name","subscription"),ny(this,"version","0.3"),ny(this,"pending",new Map),ny(this,"cached",[]),ny(this,"initialized",!1),ny(this,"storagePrefix",ii),ny(this,"subscribeTimeout",(0,D.toMiliseconds)(D.ONE_MINUTE)),ny(this,"initialSubscribeTimeout",(0,D.toMiliseconds)(15*D.ONE_SECOND)),ny(this,"clientId"),ny(this,"batchSubscribeTopicsLimit",500),ny(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),ny(this,"subscribe",async(e,t)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{let r=rG(t),i={topic:e,relay:r,transportType:t?.transportType};this.pending.set(e,i);let s=await this.rpcSubscribe(e,r,t);return"string"==typeof s&&(this.onSubscribe(s,i),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),s}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}}),ny(this,"unsubscribe",async(e,t)=>{this.isInitialized(),"u">typeof t?.id?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)}),ny(this,"isSubscribed",e=>new Promise(t=>{t(this.topicMap.topics.includes(e))})),ny(this,"isKnownTopic",e=>new Promise(t=>{t(this.topicMap.topics.includes(e)||this.pending.has(e)||this.cached.some(t=>t.topic===e))})),ny(this,"on",(e,t)=>{this.events.on(e,t)}),ny(this,"once",(e,t)=>{this.events.once(e,t)}),ny(this,"off",(e,t)=>{this.events.off(e,t)}),ny(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),ny(this,"start",async()=>{await this.onConnect()}),ny(this,"stop",async()=>{await this.onDisconnect()}),ny(this,"restart",async()=>{await this.restore(),await this.onRestart()}),ny(this,"checkPending",async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;let e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}),ny(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(g.Lx.pulse,async()=>{await this.checkPending()}),this.events.on(iy.created,async e=>{let t=iy.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(iy.deleted,async e=>{let t=iy.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}),this.relayer=e,this.logger=(0,m.Ep)(t,this.name),this.clientId=""}get context(){return(0,m.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){let r=this.topicMap.get(e);await Promise.all(r.map(async r=>await this.unsubscribeById(e,r,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{let i=rG(r);await this.restartToComplete({topic:e,id:t,relay:i}),await this.rpcUnsubscribe(e,t,i);let s=r1("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,r){var i;r&&r?.transportType!==ig.relay||await this.restartToComplete({topic:e,id:e,relay:t});let s={method:rJ(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});let n=null==(i=r?.internal)?void 0:i.throwOnFailedPublish;try{let t=await this.getSubscriptionId(e);if(r?.transportType===ig.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(e=>this.logger.warn(e))},(0,D.toMiliseconds)(D.ONE_SECOND)),t;let i=new Promise(async t=>{let r=i=>{i.topic===e&&(this.events.removeListener(iy.created,r),t(i.id))};this.events.on(iy.created,r);try{let i=await et(new Promise((e,t)=>{this.relayer.request(s).catch(e=>{this.logger.warn(e,e?.message),t(e)}).then(e)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(iy.created,r),t(i)}catch{}}),a=await et(i,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!a&&n)throw Error(`Subscribing to ${e} failed, please try again`);return a?t:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(id.connection_stalled),n)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;let t=e[0].relay,r={method:rJ(t.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await et(new Promise(e=>{this.relayer.request(r).catch(e=>this.logger.warn(e)).then(e)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(id.connection_stalled)}}async rpcBatchFetchMessages(e){let t;if(!e.length)return;let r=e[0].relay,i={method:rJ(r.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{t=await await et(new Promise((e,t)=>{this.relayer.request(i).catch(e=>{this.logger.warn(e),t(e)}).then(e)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(id.connection_stalled)}return t}rpcUnsubscribe(e,t,r){let i={method:rJ(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,nw(nm({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,nm({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,nm({},t)),this.topicMap.set(t.topic,e),this.events.emit(iy.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:t}=r0("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(iy.deleted,nw(nm({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(iy.sync)}async onRestart(){if(this.cached.length){let e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){let t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit(iy.resubscribed)}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){let{message:e}=r0("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async e=>nw(nm({},e),{id:await this.getSubscriptionId(e.topic)})))))}async batchFetchMessages(e){var t;if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);let r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await (t=(0,D.toMiliseconds)(D.ONE_SECOND),new Promise(e=>setTimeout(e,t))),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:e}=r0("NOT_INITIALIZED",this.name);throw Error(e)}}async restartToComplete(e){this.relayer.connected||this.relayer.connecting||(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return rj(e+await this.getClientId())}}var nv=Object.defineProperty,nE=Object.getOwnPropertySymbols,nC=Object.prototype.hasOwnProperty,nI=Object.prototype.propertyIsEnumerable,nN=(e,t,r)=>t in e?nv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nA=(e,t)=>{for(var r in t||(t={}))nC.call(t,r)&&nN(e,r,t[r]);if(nE)for(var r of nE(t))nI.call(t,r)&&nN(e,r,t[r]);return e},n_=(e,t,r)=>nN(e,"symbol"!=typeof t?t+"":t,r);class nS extends P{constructor(e){super(e),n_(this,"protocol","wc"),n_(this,"version",2),n_(this,"core"),n_(this,"logger"),n_(this,"events",new u.EventEmitter),n_(this,"provider"),n_(this,"messages"),n_(this,"subscriber"),n_(this,"publisher"),n_(this,"name","relayer"),n_(this,"transportExplicitlyClosed",!1),n_(this,"initialized",!1),n_(this,"connectionAttemptInProgress",!1),n_(this,"relayUrl"),n_(this,"projectId"),n_(this,"packageName"),n_(this,"bundleId"),n_(this,"hasExperiencedNetworkDisruption",!1),n_(this,"pingTimeout"),n_(this,"heartBeatTimeout",(0,D.toMiliseconds)(D.THIRTY_SECONDS+D.FIVE_SECONDS)),n_(this,"reconnectTimeout"),n_(this,"connectPromise"),n_(this,"reconnectInProgress",!1),n_(this,"requestsInFlight",[]),n_(this,"connectTimeout",(0,D.toMiliseconds)(15*D.ONE_SECOND)),n_(this,"request",async e=>{var t,r;this.logger.debug("Publishing Request Payload");let i=e.id||(0,r9.getBigIntRpcId)().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");let s=`${i}:${(null==(r=e.params)?void 0:r.tag)||""}`;this.requestsInFlight.push(s);let n=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter(e=>e!==s),n}catch(e){throw this.logger.debug(`Failed to Publish Request: ${i}`),e}}),n_(this,"resetPingTimeout",()=>{K()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,t,r,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(i=null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.terminate)||i.call(r)}catch(e){this.logger.warn(e,e?.message)}},this.heartBeatTimeout))}),n_(this,"onPayloadHandler",e=>{this.onProviderPayload(e),this.resetPingTimeout()}),n_(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \uD83D\uDEDC"),this.startPingTimeout(),this.events.emit(id.connect)}),n_(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \uD83D\uDED1"),this.requestsInFlight=[],this.onProviderDisconnect()}),n_(this,"onProviderErrorHandler",e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit(id.error,e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),n_(this,"registerProviderListeners",()=>{this.provider.on(iu.payload,this.onPayloadHandler),this.provider.on(iu.connect,this.onConnectHandler),this.provider.on(iu.disconnect,this.onDisconnectHandler),this.provider.on(iu.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger="u">typeof e.logger&&"string"!=typeof e.logger?(0,m.Ep)(e.logger,this.name):(0,m.gw)((0,m.jI)({level:e.logger||"error"})),this.messages=new s5(this.logger,e.core),this.subscriber=new nb(this,this.logger),this.publisher=new ns(this,this.logger),this.relayUrl=e?.relayUrl||ih,this.projectId=e.projectId,G()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)&&(null==r.g?void 0:r.g.Platform.OS)==="android"?this.packageName=Z():G()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)&&(null==r.g?void 0:r.g.Platform.OS)==="ios"&&(this.bundleId=Z()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return(0,m.Fd)(this.logger)}get connected(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===1}get connecting(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===0||void 0!==this.connectPromise}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:ig.relay},im.outbound)}async subscribe(e,t){var r,i,s;this.isInitialized(),null!=t&&t.transportType&&t?.transportType!=="relay"||await this.toEstablishConnection();let n=typeof(null==(r=t?.internal)?void 0:r.throwOnFailedPublish)>"u"||(null==(i=t?.internal)?void 0:i.throwOnFailedPublish),a=(null==(s=this.subscriber.topicMap.get(e))?void 0:s[0])||"",o,c=t=>{t.topic===e&&(this.subscriber.off(iy.created,c),o())};return await Promise.all([new Promise(e=>{o=e,this.subscriber.on(iy.created,c)}),new Promise(async(r,i)=>{a=await this.subscriber.subscribe(e,nA({internal:{throwOnFailedPublish:n}},t)).catch(e=>{n&&i(e)})||a,r()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await et(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await r4())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}let t=e.sort((e,t)=>e.publishedAt-t.publishedAt);for(let e of(this.logger.debug(`Batch of ${t.length} message events sorted`),t))try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e,"Error while processing batch message event: "+e?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){let{topic:r}=e;if(!t.sessionExists){let e=ei(D.FIVE_MINUTES);await this.core.pairing.pairings.set(r,{topic:r,expiry:e,relay:{protocol:"irn"},active:!1})}this.events.emit(id.message,e),await this.recordMessageEvent(e,im.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(e,t)=>{let r=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(iu.disconnect,r),await et(new Promise((e,t)=>{this.provider.connect().then(e).catch(t)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(e=>{t(e)}).finally(()=>{this.provider.off(iu.disconnect,r),clearTimeout(this.reconnectTimeout)}),await new Promise(async(e,t)=>{let r=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(iu.disconnect,r),await this.subscriber.start().then(e).catch(t).finally(()=>{this.provider.off(iu.disconnect,r)})}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){await this.subscriber.stop(),this.logger.warn({},e.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(e=>setTimeout(e,(0,D.toMiliseconds)(1*t))),t++}}startPingTimeout(){var e,t,r,i,s;if(K())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(s=null==(i=null==(r=this.provider)?void 0:r.connection)?void 0:i.socket)||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(e){this.logger.warn(e,e?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new r6.r(new r7.Z(function({protocol:e,version:t,relayUrl:r,sdkVersion:i,auth:s,projectId:n,useOnCloseEvent:a,bundleId:o,packageName:c}){let l=r.split("?"),h=X(e,t,i),d=function(e,t){let r=new URLSearchParams(e);for(let e of Object.keys(t).sort())if(t.hasOwnProperty(e)){let i=t[e];void 0!==i&&r.set(e,i)}return r.toString()}(l[1]||"",{auth:s,ua:h,projectId:n,useOnCloseEvent:a||void 0,packageName:c||void 0,bundleId:o||void 0});return l[0]+"?"+d}({sdkVersion:ip,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){let{topic:r,message:i}=e;await this.messages.set(r,i,t)}async shouldIgnoreMessageEvent(e){let{topic:t,message:r}=e;if(!r||0===r.length)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;let i=this.messages.has(t,r);return i&&this.logger.warn(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,r9.isJsonRpcRequest)(e)){if(!e.method.endsWith("_subscription"))return;let t=e.params,{topic:r,message:i,publishedAt:s,attestation:n}=t.data,a={topic:r,message:i,publishedAt:s,transportType:ig.relay,attestation:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(nA({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else(0,r9.isJsonRpcResponse)(e)&&this.events.emit(id.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,im.inbound),this.events.emit(id.message,e))}async acknowledgePayload(e){let t=(0,r9.formatJsonRpcResult)(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(iu.payload,this.onPayloadHandler),this.provider.off(iu.connect,this.onConnectHandler),this.provider.off(iu.disconnect,this.onDisconnectHandler),this.provider.off(iu.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await r4();(function(e){switch(Y()){case V.browser:!G()&&J()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)));break;case V.reactNative:G()&&"u">typeof r.g&&null!=r.g&&r.g.NetInfo&&r.g?.NetInfo.addEventListener(t=>e(t?.isConnected));case V.node:}})(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(e=>this.logger.error(e,e?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(g.Lx.pulse,async()=>{var e;if(!this.transportExplicitlyClosed&&!this.connected&&(!(J()&&(0,j.getDocument)())||(null==(e=(0,j.getDocument)())?void 0:e.visibilityState)==="visible"))try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(id.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,D.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){let{message:e}=r0("NOT_INITIALIZED",this.name);throw Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function nP(){}function nO(e){if(!e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function nT(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function nR(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}let nk="[object Arguments]",nx="[object Object]";var nU=Object.defineProperty,nD=Object.getOwnPropertySymbols,nL=Object.prototype.hasOwnProperty,nM=Object.prototype.propertyIsEnumerable,nB=(e,t,r)=>t in e?nU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nj=(e,t)=>{for(var r in t||(t={}))nL.call(t,r)&&nB(e,r,t[r]);if(nD)for(var r of nD(t))nM.call(t,r)&&nB(e,r,t[r]);return e},nq=(e,t,r)=>nB(e,"symbol"!=typeof t?t+"":t,r);class n$ extends O{constructor(e,t,r,i=ii,s){super(e,t,r,i),this.core=e,this.logger=t,this.name=r,nq(this,"map",new Map),nq(this,"version","0.3"),nq(this,"cached",[]),nq(this,"initialized",!1),nq(this,"getKey"),nq(this,"storagePrefix",ii),nq(this,"recentlyDeleted",[]),nq(this,"recentlyDeletedLimit",200),nq(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>{var t;this.getKey&&null!==e&&!r2(e)?this.map.set(this.getKey(e),e):(null==(t=e?.proposer)?void 0:t.publicKey)?this.map.set(e.id,e):e?.topic&&this.map.set(e.topic,e)}),this.cached=[],this.initialized=!0)}),nq(this,"set",async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())}),nq(this,"get",e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e))),nq(this,"getAll",e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(r=>(function e(t,r,i,s,n,a,o){let c=o(t,r,i,s,n,a);if(void 0!==c)return c;if(typeof t==typeof r)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return t===r;case"number":return t===r||Object.is(t,r)}return function t(r,i,s,n){if(Object.is(r,i))return!0;let a=nR(r),o=nR(i);if(a===nk&&(a=nx),o===nk&&(o=nx),a!==o)return!1;switch(a){case"[object String]":return r.toString()===i.toString();case"[object Number]":{let e=r.valueOf(),t=i.valueOf();return e===t||Number.isNaN(e)&&Number.isNaN(t)}case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(r.valueOf(),i.valueOf());case"[object RegExp]":return r.source===i.source&&r.flags===i.flags;case"[object Function]":return r===i}s=s??new Map;let c=s.get(r),l=s.get(i);if(null!=c&&null!=l)return c===i;s.set(r,i),s.set(i,r);try{switch(a){case"[object Map]":if(r.size!==i.size)return!1;for(let[t,a]of r.entries())if(!i.has(t)||!e(a,i.get(t),t,r,i,s,n))return!1;return!0;case"[object Set]":{if(r.size!==i.size)return!1;let t=Array.from(r.values()),a=Array.from(i.values());for(let o=0;o<t.length;o++){let c=t[o],l=a.findIndex(t=>e(c,t,void 0,r,i,s,n));if(-1===l)return!1;a.splice(l,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if("u">typeof ie&&ie.isBuffer(r)!==ie.isBuffer(i)||r.length!==i.length)return!1;for(let t=0;t<r.length;t++)if(!e(r[t],i[t],t,r,i,s,n))return!1;return!0;case"[object ArrayBuffer]":return r.byteLength===i.byteLength&&t(new Uint8Array(r),new Uint8Array(i),s,n);case"[object DataView]":return r.byteLength===i.byteLength&&r.byteOffset===i.byteOffset&&t(new Uint8Array(r),new Uint8Array(i),s,n);case"[object Error]":return r.name===i.name&&r.message===i.message;case nx:{if(!(t(r.constructor,i.constructor,s,n)||nO(r)&&nO(i)))return!1;let a=[...Object.keys(r),...nT(r)],o=[...Object.keys(i),...nT(i)];if(a.length!==o.length)return!1;for(let t=0;t<a.length;t++){let o=a[t],c=r[o];if(!Object.hasOwn(i,o))return!1;let l=i[o];if(!e(c,l,o,r,i,s,n))return!1}return!0}default:return!1}}finally{s.delete(r),s.delete(i)}}(t,r,a,o)})(t[r],e[r],void 0,void 0,void 0,void 0,nP))):this.values)),nq(this,"update",async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});let r=nj(nj({},this.getData(e)),t);this.map.set(e,r),await this.persist()}),nq(this,"delete",async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())}),this.logger=(0,m.Ep)(t,this.name),this.storagePrefix=i,this.getKey=s}get context(){return(0,m.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){let{message:t}=r0("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),Error(t)}let{message:t}=r0("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:e}=r0("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=r0("NOT_INITIALIZED",this.name);throw Error(e)}}}var nF=Object.defineProperty,nz=(e,t,r)=>t in e?nF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nH=(e,t,r)=>nz(e,"symbol"!=typeof t?t+"":t,r);class nW{constructor(e,t){this.core=e,this.logger=t,nH(this,"name","pairing"),nH(this,"version","0.3"),nH(this,"events",new(p())),nH(this,"pairings"),nH(this,"initialized",!1),nH(this,"storagePrefix",ii),nH(this,"ignoredPayloadTypes",[1]),nH(this,"registeredMethods",[]),nH(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),nH(this,"register",({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]}),nH(this,"create",async e=>{this.isInitialized();let t=rB(),r=await this.core.crypto.setSymKey(t),i=ei(D.FIVE_MINUTES),s={protocol:"irn"},n={topic:r,expiry:i,relay:s,active:!1,methods:e?.methods},a=rZ({protocol:this.core.protocol,version:this.core.version,topic:r,symKey:t,relay:s,expiryTimestamp:i,methods:e?.methods});return this.events.emit(iv.create,n),this.core.expirer.set(r,i),await this.pairings.set(r,n),await this.core.relayer.subscribe(r,{transportType:e?.transportType}),{topic:r,uri:a}}),nH(this,"pair",async e=>{let t;this.isInitialized();let r=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:[i_.pairing_started]}});this.isValidPair(e,r);let{topic:i,symKey:s,relay:n,expiryTimestamp:a,methods:o}=rY(e.uri);if(r.props.properties.topic=i,r.addTrace(i_.pairing_uri_validation_success),r.addTrace(i_.pairing_uri_not_expired),this.pairings.keys.includes(i)){if(t=this.pairings.get(i),r.addTrace(i_.existing_pairing),t.active)throw r.setError(iS.active_pairing_already_exists),Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);r.addTrace(i_.pairing_not_expired)}let c=a||ei(D.FIVE_MINUTES),l={topic:i,relay:n,expiry:c,active:!1,methods:o};this.core.expirer.set(i,c),await this.pairings.set(i,l),r.addTrace(i_.store_new_pairing),e.activatePairing&&await this.activate({topic:i}),this.events.emit(iv.create,l),r.addTrace(i_.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(s,i),r.addTrace(i_.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{r.setError(iS.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:n})}catch(e){throw r.setError(iS.subscribe_pairing_topic_failure),e}return r.addTrace(i_.subscribe_pairing_topic_success),l}),nH(this,"activate",async({topic:e})=>{this.isInitialized();let t=ei(D.FIVE_MINUTES);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})}),nH(this,"ping",async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:t}=e;if(this.pairings.keys.includes(t)){let e=await this.sendRequest(t,"wc_pairingPing",{}),{done:r,resolve:i,reject:s}=function(e=D.FIVE_MINUTES,t){let r,i,s,n;let a=(0,D.toMiliseconds)(e||D.FIVE_MINUTES);return{resolve:e=>{s&&r&&(clearTimeout(s),r(e),n=Promise.resolve(e))},reject:e=>{s&&i&&(clearTimeout(s),i(e))},done:()=>new Promise((e,t)=>{if(n)return e(n);s=setTimeout(()=>{let e=Error(void 0);n=Promise.reject(e),t(e)},a),r=e,i=t})}}();this.events.once(en("pairing_ping",e),({error:e})=>{e?s(e):i()}),await r()}}),nH(this,"updateExpiry",async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})}),nH(this,"updateMetadata",async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})}),nH(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),nH(this,"disconnect",async e=>{this.isInitialized(),await this.isValidDisconnect(e);let{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",r1("USER_DISCONNECTED")),await this.deletePairing(t))}),nH(this,"formatUriFromPairing",e=>{this.isInitialized();let{topic:t,relay:r,expiry:i,methods:s}=e,n=this.core.crypto.keychain.get(t);return rZ({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:n,relay:r,expiryTimestamp:i,methods:s})}),nH(this,"sendRequest",async(e,t,r)=>{let i=(0,r9.formatJsonRpcRequest)(t,r),s=await this.core.crypto.encode(e,i),n=ib[t].req;return this.core.history.set(e,i),this.core.relayer.publish(e,s,n),i.id}),nH(this,"sendResult",async(e,t,r)=>{let i=(0,r9.formatJsonRpcResult)(e,r),s=await this.core.crypto.encode(t,i),n=(await this.core.history.get(t,e)).request.method,a=ib[n].res;await this.core.relayer.publish(t,s,a),await this.core.history.resolve(i)}),nH(this,"sendError",async(e,t,r)=>{let i=(0,r9.formatJsonRpcError)(e,r),s=await this.core.crypto.encode(t,i),n=(await this.core.history.get(t,e)).request.method,a=ib[n]?ib[n].res:ib.unregistered_method.res;await this.core.relayer.publish(t,s,a),await this.core.history.resolve(i)}),nH(this,"deletePairing",async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,r1("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])}),nH(this,"cleanup",async()=>{let e=this.pairings.getAll().filter(e=>es(e.expiry));await Promise.all(e.map(e=>this.deletePairing(e.topic)))}),nH(this,"onRelayEventRequest",async e=>{let{topic:t,payload:r}=e;switch(r.method){case"wc_pairingPing":return await this.onPairingPingRequest(t,r);case"wc_pairingDelete":return await this.onPairingDeleteRequest(t,r);default:return await this.onUnknownRpcMethodRequest(t,r)}}),nH(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r}=e,i=(await this.core.history.get(t,r.id)).request.method;return"wc_pairingPing"===i?this.onPairingPingResponse(t,r):this.onUnknownRpcMethodResponse(i)}),nH(this,"onPairingPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.events.emit(iv.ping,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),nH(this,"onPairingPingResponse",(e,t)=>{let{id:r}=t;setTimeout(()=>{(0,r9.isJsonRpcResult)(t)?this.events.emit(en("pairing_ping",r),{}):(0,r9.isJsonRpcError)(t)&&this.events.emit(en("pairing_ping",r),{error:t.error})},500)}),nH(this,"onPairingDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(iv.delete,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),nH(this,"onUnknownRpcMethodRequest",async(e,t)=>{let{id:r,method:i}=t;try{if(this.registeredMethods.includes(i))return;let t=r1("WC_METHOD_UNSUPPORTED",i);await this.sendError(r,e,t),this.logger.error(t)}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),nH(this,"onUnknownRpcMethodResponse",e=>{this.registeredMethods.includes(e)||this.logger.error(r1("WC_METHOD_UNSUPPORTED",e))}),nH(this,"isValidPair",(e,t)=>{var r;if(!r3(e)){let{message:r}=r0("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(iS.malformed_pairing_uri),Error(r)}if(!function(e){function t(e){try{return"u">typeof new URL(e)}catch{return!1}}try{if(r5(e,!1)){if(t(e))return!0;let r=ec(e);return t(r)}}catch{}return!1}(e.uri)){let{message:r}=r0("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(iS.malformed_pairing_uri),Error(r)}let i=rY(e?.uri);if(!(null!=(r=i?.relay)&&r.protocol)){let{message:e}=r0("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(iS.malformed_pairing_uri),Error(e)}if(!(null!=i&&i.symKey)){let{message:e}=r0("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(iS.malformed_pairing_uri),Error(e)}if(null!=i&&i.expiryTimestamp&&(0,D.toMiliseconds)(i?.expiryTimestamp)<Date.now()){t.setError(iS.pairing_expired);let{message:e}=r0("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(e)}}),nH(this,"isValidPing",async e=>{if(!r3(e)){let{message:t}=r0("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),nH(this,"isValidDisconnect",async e=>{if(!r3(e)){let{message:t}=r0("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),nH(this,"isValidPairingTopic",async e=>{if(!r5(e,!1)){let{message:t}=r0("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.pairings.keys.includes(e)){let{message:t}=r0("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(es(this.pairings.get(e).expiry)){await this.deletePairing(e);let{message:t}=r0("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}),this.core=e,this.logger=(0,m.Ep)(t,this.name),this.pairings=new n$(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,m.Fd)(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=r0("NOT_INITIALIZED",this.name);throw Error(e)}}registerRelayerEvents(){this.core.relayer.on(id.message,async e=>{let{topic:t,message:r,transportType:i}=e;if(this.pairings.keys.includes(t)&&i!==ig.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{let e=await this.core.crypto.decode(t,r);(0,r9.isJsonRpcRequest)(e)?(this.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e})):(0,r9.isJsonRpcResponse)(e)&&(await this.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e}),this.core.history.delete(t,e.id)),await this.core.relayer.messages.ack(t,r)}catch(e){this.logger.error(e)}})}registerExpirerEvents(){this.core.expirer.on(iC.expired,async e=>{let{topic:t}=function(e){let[t,r]=e.split(":"),i={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)i.topic=r;else if("id"===t&&Number.isInteger(Number(r)))i.id=Number(r);else throw Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return i}(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(iv.expire,{topic:t}))})}}var nV=Object.defineProperty,nK=(e,t,r)=>t in e?nV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nG=(e,t,r)=>nK(e,"symbol"!=typeof t?t+"":t,r);class nJ extends A{constructor(e,t){super(e,t),this.core=e,this.logger=t,nG(this,"records",new Map),nG(this,"events",new u.EventEmitter),nG(this,"name","history"),nG(this,"version","0.3"),nG(this,"cached",[]),nG(this,"initialized",!1),nG(this,"storagePrefix",ii),nG(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.records.set(e.id,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),nG(this,"set",(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;let i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:ei(D.THIRTY_DAYS)};this.records.set(i.id,i),this.persist(),this.events.emit(iE.created,i)}),nG(this,"resolve",async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;let t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=(0,r9.isJsonRpcError)(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(iE.updated,t))}),nG(this,"get",async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t))),nG(this,"delete",(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(r=>{r.topic!==e||"u">typeof t&&r.id!==t||(this.records.delete(r.id),this.events.emit(iE.deleted,r))}),this.persist()}),nG(this,"exists",async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e)),nG(this,"on",(e,t)=>{this.events.on(e,t)}),nG(this,"once",(e,t)=>{this.events.once(e,t)}),nG(this,"off",(e,t)=>{this.events.off(e,t)}),nG(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,m.Ep)(t,this.name)}get context(){return(0,m.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if("u">typeof t.response)return;let r={topic:t.topic,request:(0,r9.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:t}=r0("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(iE.sync)}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:e}=r0("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(iE.created,e=>{let t=iE.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(iE.updated,e=>{let t=iE.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(iE.deleted,e=>{let t=iE.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(g.Lx.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,D.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(iE.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=r0("NOT_INITIALIZED",this.name);throw Error(e)}}}var nY=Object.defineProperty,nZ=(e,t,r)=>t in e?nY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nX=(e,t,r)=>nZ(e,"symbol"!=typeof t?t+"":t,r);class nQ extends R{constructor(e,t){super(e,t),this.core=e,this.logger=t,nX(this,"expirations",new Map),nX(this,"events",new u.EventEmitter),nX(this,"name","expirer"),nX(this,"version","0.3"),nX(this,"cached",[]),nX(this,"initialized",!1),nX(this,"storagePrefix",ii),nX(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.expirations.set(e.target,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),nX(this,"has",e=>{try{let t=this.formatTarget(e);return"u">typeof this.getExpiration(t)}catch{return!1}}),nX(this,"set",(e,t)=>{this.isInitialized();let r=this.formatTarget(e),i={target:r,expiry:t};this.expirations.set(r,i),this.checkExpiry(r,i),this.events.emit(iC.created,{target:r,expiration:i})}),nX(this,"get",e=>{this.isInitialized();let t=this.formatTarget(e);return this.getExpiration(t)}),nX(this,"del",e=>{if(this.isInitialized(),this.has(e)){let t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit(iC.deleted,{target:t,expiration:r})}}),nX(this,"on",(e,t)=>{this.events.on(e,t)}),nX(this,"once",(e,t)=>{this.events.once(e,t)}),nX(this,"off",(e,t)=>{this.events.off(e,t)}),nX(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,m.Ep)(t,this.name)}get context(){return(0,m.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return er("topic",e);if("number"==typeof e)return er("id",e);let{message:t}=r0("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(iC.sync)}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:e}=r0("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:t}=r0("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),Error(t)}return t}checkExpiry(e,t){let{expiry:r}=t;(0,D.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(iC.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(g.Lx.pulse,()=>this.checkExpirations()),this.events.on(iC.created,e=>{let t=iC.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(iC.expired,e=>{let t=iC.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(iC.deleted,e=>{let t=iC.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=r0("NOT_INITIALIZED",this.name);throw Error(e)}}}var n0=Object.defineProperty,n1=(e,t,r)=>t in e?n0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,n2=(e,t,r)=>n1(e,"symbol"!=typeof t?t+"":t,r);class n5 extends k{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,n2(this,"name","verify-api"),n2(this,"abortController"),n2(this,"isDevEnv"),n2(this,"verifyUrlV3",iN),n2(this,"storagePrefix",ii),n2(this,"version",2),n2(this,"publicKey"),n2(this,"fetchPromise"),n2(this,"init",async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,D.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),n2(this,"register",async e=>{if(!J()||this.isDevEnv)return;let t=window.location.origin,{id:r,decryptedId:i}=e,s=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${r}&decryptedId=${i}`;try{let e=(0,j.getDocument)(),t=this.startAbortTimer(5*D.ONE_SECOND),i=await new Promise((i,n)=>{let a=()=>{window.removeEventListener("message",c),e.body.removeChild(o),n("attestation aborted")};this.abortController.signal.addEventListener("abort",a);let o=e.createElement("iframe");o.src=s,o.style.display="none",o.addEventListener("error",a,{signal:this.abortController.signal});let c=s=>{if(s.data&&"string"==typeof s.data)try{let n=JSON.parse(s.data);if("verify_attestation"===n.type){if((0,M.xp)(n.attestation).payload.id!==r)return;clearInterval(t),e.body.removeChild(o),this.abortController.signal.removeEventListener("abort",a),window.removeEventListener("message",c),i(null===n.attestation?"":n.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(o),window.addEventListener("message",c,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",i),i}catch(e){this.logger.warn(e)}return""}),n2(this,"resolve",async e=>{if(this.isDevEnv)return"";let{attestationId:t,hash:r,encryptedId:i}=e;if(""===t){this.logger.debug("resolve: attestationId is empty, skipping");return}if(t){if((0,M.xp)(t).payload.id!==i)return;let e=await this.isValidJwtAttestation(t);if(e){if(!e.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return e}}if(!r)return;let s=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(r,s)}),n2(this,"fetchAttestation",async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);let r=this.startAbortTimer(5*D.ONE_SECOND),i=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(r),200===i.status?await i.json():void 0}),n2(this,"getVerifyUrl",e=>{let t=e||iI;return iA.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${iI}`),t=iI),t}),n2(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let e=this.startAbortTimer(D.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}}),n2(this,"persistPublicKey",async e=>{this.logger.debug("persisting public key to local storage",e),await this.store.setItem(this.storeKey,e),this.publicKey=e}),n2(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),n2(this,"isValidJwtAttestation",async e=>{let t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}let r=await this.fetchAndPersistPublicKey();try{if(r)return this.validateAttestation(e,r)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}}),n2(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),n2(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async e=>{let t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))});let e=await this.fetchPromise;return this.fetchPromise=void 0,e}),n2(this,"validateAttestation",(e,t)=>{let r=function(e,t){let[r,i,s]=e.split("."),n=W.from(rz(s),"base64");if(64!==n.length)throw Error("Invalid signature length");let a=n.slice(0,32),o=n.slice(32,64),c=`${r}.${i}`,l=tv(c),h=function(e){let t=W.from(e.x,"base64"),r=W.from(e.y,"base64");return(0,F.zo)([new Uint8Array([4]),t,r])}(t);if(!rk.verify((0,F.zo)([a,o]),l,h))throw Error("Invalid signature");return(0,M.xp)(e).payload}(e,t.publicKey),i={hasExpired:(0,D.toMiliseconds)(r.exp)<Date.now(),payload:r};if(i.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:i.payload.origin,isScam:i.payload.isScam,isVerified:i.payload.isVerified}}),this.logger=(0,m.Ep)(t,this.name),this.abortController=new AbortController,this.isDevEnv=eo(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return(0,m.Fd)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,D.toMiliseconds)(e))}}var n3=Object.defineProperty,n4=(e,t,r)=>t in e?n3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,n8=(e,t,r)=>n4(e,"symbol"!=typeof t?t+"":t,r);class n6 extends x{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,n8(this,"context","echo"),n8(this,"registerDeviceToken",async e=>{let{clientId:t,token:r,notificationType:i,enableEncrypted:s=!1}=e,n=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:i,token:r,always_raw:s})})}),this.logger=(0,m.Ep)(t,this.context)}}var n9=Object.defineProperty,n7=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable,ar=(e,t,r)=>t in e?n9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ai=(e,t)=>{for(var r in t||(t={}))ae.call(t,r)&&ar(e,r,t[r]);if(n7)for(var r of n7(t))at.call(t,r)&&ar(e,r,t[r]);return e},as=(e,t,r)=>ar(e,"symbol"!=typeof t?t+"":t,r);class an extends U{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,as(this,"context","event-client"),as(this,"storagePrefix",ii),as(this,"storageVersion",.1),as(this,"events",new Map),as(this,"shouldPersist",!1),as(this,"init",async()=>{if(!eo())try{let e={eventId:ea(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:X(this.core.relayer.protocol,this.core.relayer.version,ip)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}}),as(this,"createEvent",e=>{let{event:t="ERROR",type:r="",properties:{topic:i,trace:s}}=e,n=ea(),a=this.core.projectId||"",o=Date.now(),c=ai({eventId:n,timestamp:o,props:{event:t,type:r,properties:{topic:i,trace:s}},bundleId:a,domain:this.getAppDomain()},this.setMethods(n));return this.telemetryEnabled&&(this.events.set(n,c),this.shouldPersist=!0),c}),as(this,"getEvent",e=>{let{eventId:t,topic:r}=e;if(t)return this.events.get(t);let i=Array.from(this.events.values()).find(e=>e.props.properties.topic===r);if(i)return ai(ai({},i),this.setMethods(i.eventId))}),as(this,"deleteEvent",e=>{let{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0}),as(this,"setEventListeners",()=>{this.core.heartbeat.on(g.Lx.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(e=>{(0,D.fromMiliseconds)(Date.now())-(0,D.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)})})}),as(this,"setMethods",e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)})),as(this,"addTrace",(e,t)=>{let r=this.events.get(e);r&&(r.props.properties.trace.push(t),this.events.set(e,r),this.shouldPersist=!0)}),as(this,"setError",(e,t)=>{let r=this.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),this.events.set(e,r),this.shouldPersist=!0)}),as(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),as(this,"restore",async()=>{try{let e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach(e=>{this.events.set(e.eventId,ai(ai({},e),this.setMethods(e.eventId)))})}catch(e){this.logger.warn(e)}}),as(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let e=[];for(let[t,r]of this.events)r.props.type&&e.push(r);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(let t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}}),as(this,"sendEvent",async e=>{let t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${ip}${t}`,{method:"POST",body:JSON.stringify(e)})}),as(this,"getAppDomain",()=>((0,q.D)()||{name:"",description:"",url:"",icons:[""]}).url),this.logger=(0,m.Ep)(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var aa=Object.defineProperty,ao=Object.getOwnPropertySymbols,ac=Object.prototype.hasOwnProperty,al=Object.prototype.propertyIsEnumerable,ah=(e,t,r)=>t in e?aa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ad=(e,t)=>{for(var r in t||(t={}))ac.call(t,r)&&ah(e,r,t[r]);if(ao)for(var r of ao(t))al.call(t,r)&&ah(e,r,t[r]);return e},au=(e,t,r)=>ah(e,"symbol"!=typeof t?t+"":t,r);class ap extends E{constructor(e){var t;super(e),au(this,"protocol","wc"),au(this,"version",2),au(this,"name",ir),au(this,"relayUrl"),au(this,"projectId"),au(this,"customStoragePrefix"),au(this,"events",new u.EventEmitter),au(this,"logger"),au(this,"heartbeat"),au(this,"relayer"),au(this,"crypto"),au(this,"storage"),au(this,"history"),au(this,"expirer"),au(this,"pairing"),au(this,"verify"),au(this,"echoClient"),au(this,"linkModeSupportedApps"),au(this,"eventClient"),au(this,"initialized",!1),au(this,"logChunkController"),au(this,"on",(e,t)=>this.events.on(e,t)),au(this,"once",(e,t)=>this.events.once(e,t)),au(this,"off",(e,t)=>this.events.off(e,t)),au(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),au(this,"dispatchEnvelope",({topic:e,message:t,sessionExists:r})=>{if(!e||!t)return;let i={topic:e,message:t,publishedAt:Date.now(),transportType:ig.link_mode};this.relayer.onLinkMessageEvent(i,{sessionExists:r})});let r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(e){console.warn("Failed to copy global core",e)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||ih,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";let i=(0,m.jI)({level:"string"==typeof e?.logger&&e.logger?e.logger:is.logger,name:ir}),{logger:s,chunkLoggerController:n}=(0,m.Rt)({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=n,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=(0,m.Ep)(s,this.name),this.heartbeat=new g.C$,this.crypto=new sV(this,this.logger,e?.keychain),this.history=new nJ(this,this.logger),this.expirer=new nQ(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new f.Z(ad(ad({},ia),e?.storageOptions)),this.relayer=new nS({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new nW(this,this.logger),this.verify=new n5(this,this.logger,this.storage),this.echoClient=new n6(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new an(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){let t=new ap(e);await t.initialize();let r=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",r),t}get context(){return(0,m.Fd)(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(iw,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(iw)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;let t=`_walletConnectCore_${e}`,r=`${t}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[t]}catch(e){console.warn("Failed to get global WalletConnect core",e);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;let r=`_walletConnectCore_${(null==(t=e.opts)?void 0:t.customStoragePrefix)||""}`;globalThis[r]=e}catch(e){console.warn("Failed to set global WalletConnect core",e)}}isGlobalCoreDisabled(){try{return"u">typeof it&&"true"===it.env.DISABLE_GLOBAL_CORE}catch{return!0}}}var ag=Object.defineProperty,af=(e,t,r)=>t in e?ag(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,am=(e,t,r)=>af(e,"symbol"!=typeof t?t+"":t,r);class aw{constructor(e){this.opts=e,am(this,"protocol","wc"),am(this,"version",2)}}class ay{constructor(e){this.client=e}}let ab="2.23.2",av={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:r})=>t?`${e??"https://viem.sh"}${t}${r?`#${r}`:""}`:void 0,version:`viem@${ab}`};class aE extends Error{constructor(e,t={}){let r=t.cause instanceof aE?t.cause.details:t.cause?.message?t.cause.message:t.details,i=t.cause instanceof aE&&t.cause.docsPath||t.docsPath,s=av.getDocsUrl?.({...t,docsPath:i}),n=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...s?[`Docs: ${s}`]:[],...r?[`Details: ${r}`]:[],...av.version?[`Version: ${av.version}`]:[]].join("\n");super(n,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=i,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=ab}walk(e){return function e(t,r){return r?.(t)?t:t&&"object"==typeof t&&"cause"in t&&void 0!==t.cause?e(t.cause,r):r?null:t}(this,e)}}function aC(e,{strict:t=!0}={}){return!!e&&"string"==typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x"))}class aI extends aE{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function aN(e,{dir:t,size:r=32}={}){return"string"==typeof e?function(e,{dir:t,size:r=32}={}){if(null===r)return e;let i=e.replace("0x","");if(i.length>2*r)throw new aI({size:Math.ceil(i.length/2),targetSize:r,type:"hex"});return`0x${i["right"===t?"padEnd":"padStart"](2*r,"0")}`}(e,{dir:t,size:r}):function(e,{dir:t,size:r=32}={}){if(null===r)return e;if(e.length>r)throw new aI({size:e.length,targetSize:r,type:"bytes"});let i=new Uint8Array(r);for(let s=0;s<r;s++){let n="right"===t;i[n?s:r-s-1]=e[n?s:e.length-s-1]}return i}(e,{dir:t,size:r})}class aA extends aE{constructor({max:e,min:t,signed:r,size:i,value:s}){super(`Number "${s}" is not in safe ${i?`${8*i}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class a_ extends aE{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function aS(e){return aC(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}function aP(e,{size:t}){if(aS(e)>t)throw new a_({givenSize:aS(e),maxSize:t})}function aO(e,t={}){let{signed:r}=t;t.size&&aP(e,{size:t.size});let i=BigInt(e);if(!r)return i;let s=(e.length-2)/2,n=(1n<<8n*BigInt(s)-1n)-1n;return i<=n?i:i-BigInt(`0x${"f".padStart(2*s,"f")}`)-1n}let aT=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function aR(e,t={}){return"number"==typeof e||"bigint"==typeof e?ax(e,t):"string"==typeof e?function(e,t={}){let r=aU.encode(e);return ak(r,t)}(e,t):"boolean"==typeof e?function(e,t={}){let r=`0x${Number(e)}`;return"number"==typeof t.size?(aP(r,{size:t.size}),aN(r,{size:t.size})):r}(e,t):ak(e,t)}function ak(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=aT[e[t]];let i=`0x${r}`;return"number"==typeof t.size?(aP(i,{size:t.size}),aN(i,{dir:"right",size:t.size})):i}function ax(e,t={}){let r;let{signed:i,size:s}=t,n=BigInt(e);s?r=i?(1n<<8n*BigInt(s)-1n)-1n:2n**(8n*BigInt(s))-1n:"number"==typeof e&&(r=BigInt(Number.MAX_SAFE_INTEGER));let a="bigint"==typeof r&&i?-r-1n:0;if(r&&n>r||n<a){let t="bigint"==typeof e?"n":"";throw new aA({max:r?`${r}${t}`:void 0,min:`${a}${t}`,signed:i,size:s,value:`${e}${t}`})}let o=`0x${(i&&n<0?(1n<<BigInt(8*s))+BigInt(n):n).toString(16)}`;return s?aN(o,{size:s}):o}let aU=new TextEncoder,aD=new TextEncoder,aL={zero:48,nine:57,A:65,F:70,a:97,f:102};function aM(e){return e>=aL.zero&&e<=aL.nine?e-aL.zero:e>=aL.A&&e<=aL.F?e-(aL.A-10):e>=aL.a&&e<=aL.f?e-(aL.a-10):void 0}function aB(e,t={}){let r=e;t.size&&(aP(r,{size:t.size}),r=aN(r,{dir:"right",size:t.size}));let i=r.slice(2);i.length%2&&(i=`0${i}`);let s=i.length/2,n=new Uint8Array(s);for(let e=0,t=0;e<s;e++){let r=aM(i.charCodeAt(t++)),s=aM(i.charCodeAt(t++));if(void 0===r||void 0===s)throw new aE(`Invalid byte sequence ("${i[t-2]}${i[t-1]}" in "${i}").`);n[e]=16*r+s}return n}function aj(e,t={}){let r=aD.encode(e);return"number"==typeof t.size?(aP(r,{size:t.size}),aN(r,{dir:"right",size:t.size})):r}var aq=r(48796);function a$(e,t){let r=(0,aq.fr)(aC(e,{strict:!1})?function(e,t={}){return"number"==typeof e||"bigint"==typeof e?function(e,t){let r=ax(e,t);return aB(r)}(e,t):"boolean"==typeof e?function(e,t={}){let r=new Uint8Array(1);return(r[0]=Number(e),"number"==typeof t.size)?(aP(r,{size:t.size}),aN(r,{size:t.size})):r}(e,t):aC(e)?aB(e,t):aj(e,t)}(e):e);return"bytes"===(t||"hex")?r:aR(r)}class aF extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){let t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){let e=this.keys().next().value;e&&this.delete(e)}return this}}let az=new aF(8192);async function aH({hash:e,signature:t}){let i=aC(e)?e:aR(e),{secp256k1:s}=await r.e(1321).then(r.bind(r,91321)),n=(()=>{if("object"==typeof t&&"r"in t&&"s"in t){let{r:e,s:r,v:i,yParity:n}=t,a=Number(n??i),o=aW(a);return new s.Signature(aO(e),aO(r)).addRecoveryBit(o)}let e=aC(t)?t:aR(t),r=function(e,t={}){return Number(aO(e,t))}(`0x${e.slice(130)}`),i=aW(r);return s.Signature.fromCompact(e.substring(2,130)).addRecoveryBit(i)})(),a=n.recoverPublicKey(i.substring(2)).toHex(!1);return`0x${a}`}function aW(e){if(0===e||1===e)return e;if(27===e)return 0;if(28===e)return 1;throw Error("Invalid yParityOrV value")}async function aV({hash:e,signature:t}){return function(e){let t=a$(`0x${e.substring(4)}`).substring(26);return function(e,t){if(az.has(`${e}.${t}`))return az.get(`${e}.${t}`);let r=t?`${t}${e.toLowerCase()}`:e.substring(2).toLowerCase(),i=a$(aj(r),"bytes"),s=(t?r.substring(`${t}0x`.length):r).split("");for(let e=0;e<40;e+=2)i[e>>1]>>4>=8&&s[e]&&(s[e]=s[e].toUpperCase()),(15&i[e>>1])>=8&&s[e+1]&&(s[e+1]=s[e+1].toUpperCase());let n=`0x${s.join("")}`;return az.set(`${e}.${t}`,n),n}(`0x${t}`)}(await aH({hash:e,signature:t}))}var aK=r(34406),aG=r(48834).Buffer;function aJ(e){let[t,r]=e.split(":");return{namespace:t,reference:r}}function aY(e,t){return e.includes(":")?[e]:t.chains||[]}var aZ=Object.defineProperty,aX=Object.defineProperties,aQ=Object.getOwnPropertyDescriptors,a0=Object.getOwnPropertySymbols,a1=Object.prototype.hasOwnProperty,a2=Object.prototype.propertyIsEnumerable,a5=(e,t,r)=>t in e?aZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,a3=(e,t)=>{for(var r in t||(t={}))a1.call(t,r)&&a5(e,r,t[r]);if(a0)for(var r of a0(t))a2.call(t,r)&&a5(e,r,t[r]);return e},a4=(e,t)=>aX(e,aQ(t));let a8={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};function a6(){return"u">typeof aK&&"u">typeof aK.versions&&"u">typeof aK.versions.node}function a9(){return!(0,j.getDocument)()&&!!(0,j.getNavigator)()&&"ReactNative"===navigator.product}function a7(){return!a6()&&!!(0,j.getNavigator)()&&!!(0,j.getDocument)()}function oe(e,t){return e.filter(e=>t.includes(e)).length===e.length}function ot(e=D.FIVE_MINUTES,t){let r,i,s,n;let a=(0,D.toMiliseconds)(e||D.FIVE_MINUTES);return{resolve:e=>{s&&r&&(clearTimeout(s),r(e),n=Promise.resolve(e))},reject:e=>{s&&i&&(clearTimeout(s),i(e))},done:()=>new Promise((e,o)=>{if(n)return e(n);s=setTimeout(()=>{let e=Error(t);n=Promise.reject(e),o(e)},a),r=e,i=o})}}function or(e,t){return(0,D.fromMiliseconds)((t||Date.now())+(0,D.toMiliseconds)(e))}function oi(e){return Date.now()>=(0,D.toMiliseconds)(e)}function os(e,t){return`${e}${t?`:${t}`:""}`}function on(e=[],t=[]){return[...new Set([...e,...t])]}async function oa({id:e,topic:t,wcDeepLink:i}){var s;try{if(!i)return;let n="string"==typeof i?JSON.parse(i):i,a=n?.href;if("string"!=typeof a)return;let o=function(e,t,r){let i=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let s=`${e}`;if(e.startsWith("https://t.me")){let t=e.includes("?")?"&startapp=":"?startapp=";s=`${s}${t}${function(e,t=!1){let r=aG.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(i,!0)}`}else s=`${s}/wc?${i}`;return s}(a,e,t),c=a9()?a8.reactNative:a6()?a8.node:a7()?a8.browser:a8.unknown;if(c===a8.browser){let e;if(!(null!=(s=(0,j.getDocument)())&&s.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}e="_self",function(){try{return window.self!==window.top}catch{return!1}}()?e="_top":("u">typeof window&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)||o.startsWith("https://")||o.startsWith("http://"))&&(e="_blank"),window.open(o,e,"noreferrer noopener")}else c===a8.reactNative&&"u">typeof(null==r.g?void 0:r.g.Linking)&&await r.g.Linking.openURL(o)}catch(e){console.error(e)}}async function oo(e,t){let r="";try{if(a7()&&(r=localStorage.getItem(t)))return r;r=await e.getItem(t)}catch(e){console.error(e)}return r}function oc(e,t){if(!e.includes(t))return null;let r=e.split(/([&,?,=])/),i=r.indexOf(t);return r[i+2]}function ol(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function oh(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function od(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function ou(e,t){oh(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}let op=BigInt(4294967296-1),og=BigInt(32),of=(e,t,r)=>e<<r|t>>>32-r,om=(e,t,r)=>t<<r|e>>>32-r,ow=(e,t,r)=>t<<r-32|e>>>64-r,oy=(e,t,r)=>e<<r-32|t>>>64-r,ob="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function ov(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function oE(e,t){return e<<32-t|e>>>t}let oC=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function oI(e){for(let r=0;r<e.length;r++){var t;e[r]=(t=e[r])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}}function oN(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(e)),oh(e),e}class oA{clone(){return this._cloneInto()}}function o_(e){let t=t=>e().update(oN(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function oS(e=32){if(ob&&"function"==typeof ob.getRandomValues)return ob.getRandomValues(new Uint8Array(e));if(ob&&"function"==typeof ob.randomBytes)return ob.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}let oP=[],oO=[],oT=[],oR=BigInt(0),ok=BigInt(1),ox=BigInt(2),oU=BigInt(7),oD=BigInt(256),oL=BigInt(113);for(let e=0,t=ok,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],oP.push(2*(5*i+r)),oO.push((e+1)*(e+2)/2%64);let s=oR;for(let e=0;e<7;e++)(t=(t<<ok^(t>>oU)*oL)%oD)&ox&&(s^=ok<<(ok<<BigInt(e))-ok);oT.push(s)}let[oM,oB]=function(e,t=!1){let r=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:n,l:a}=function(e,t=!1){return t?{h:Number(e&op),l:Number(e>>og&op)}:{h:0|Number(e>>og&op),l:0|Number(e&op)}}(e[s],t);[r[s],i[s]]=[n,a]}return[r,i]}(oT,!0),oj=(e,t,r)=>r>32?ow(e,t,r):of(e,t,r),oq=(e,t,r)=>r>32?oy(e,t,r):om(e,t,r);class o$ extends oA{constructor(e,t,r,i=!1,s=24){var n;if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ol(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(n=this.state,new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)))}keccak(){oC||oI(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,s=(t+2)%10,n=r[s],a=r[s+1],o=oj(n,a,1)^r[i],c=oq(n,a,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=o,e[t+r+1]^=c}let t=e[2],s=e[3];for(let r=0;r<24;r++){let i=oO[r],n=oj(t,s,i),a=oq(t,s,i),o=oP[r];t=e[o],s=e[o+1],e[o]=n,e[o+1]=a}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=oM[i],e[1]^=oB[i]}r.fill(0)}(this.state32,this.rounds),oC||oI(this.state32),this.posOut=0,this.pos=0}update(e){od(this);let{blockLen:t,state:r}=this;e=oN(e);let i=e.length;for(let s=0;s<i;){let n=Math.min(t-this.pos,i-s);for(let t=0;t<n;t++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){od(this,!1),oh(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();let n=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+n),i),this.posOut+=n,i+=n}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ol(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ou(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:n}=this;return e||(e=new o$(t,r,i,n,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=n,e.destroyed=this.destroyed,e}}let oF=o_(()=>new o$(136,1,32));function oz(e){let t=`Ethereum Signed Message:
${e.length}`,r=new TextEncoder().encode(t+e);return"0x"+aG.from(oF(r)).toString("hex")}async function oH(e,t,r,i,s,n){switch(r.t){case"eip191":return await oW(e,t,r.s);case"eip1271":return await oV(e,t,r.s,i,s,n);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function oW(e,t,r){return(await aV({hash:oz(t),signature:r})).toLowerCase()===e.toLowerCase()}async function oV(e,t,r,i,s,n){let a=aJ(i);if(!a.namespace||!a.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{let a="0x1626ba7e",o=r.substring(2),c=oz(t).substring(2),l=await fetch(`${n||"https://rpc.walletconnect.org/v1"}/?chainId=${i}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:a+c+"00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041"+o},"latest"]})}),{result:h}=await l.json();return!!h&&h.slice(0,a.length).toLowerCase()===a.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}var oK=Object.defineProperty,oG=Object.defineProperties,oJ=Object.getOwnPropertyDescriptors,oY=Object.getOwnPropertySymbols,oZ=Object.prototype.hasOwnProperty,oX=Object.prototype.propertyIsEnumerable,oQ=(e,t,r)=>t in e?oK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,o0=(e,t)=>{for(var r in t||(t={}))oZ.call(t,r)&&oQ(e,r,t[r]);if(oY)for(var r of oY(t))oX.call(t,r)&&oQ(e,r,t[r]);return e},o1=(e,t)=>oG(e,oJ(t));let o2=e=>e?.split(":"),o5=e=>{let t=e&&o2(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]},o3=e=>{let t=e&&o2(e);if(t)return t[2]+":"+t[3]},o4=e=>{let t=e&&o2(e);if(t)return t.pop()};async function o8(e){let{cacao:t,projectId:r}=e,{s:i,p:s}=t,n=o6(s,s.iss),a=o4(s.iss);return await oH(a,n,i,o3(s.iss),r)}let o6=(e,t)=>{let r=`${e.domain} wants you to sign in with your Ethereum account:`,i=o4(t);if(!e.aud&&!e.uri)throw Error("Either `aud` or `uri` is required to construct the message");let s=e.statement||void 0,n=`URI: ${e.aud||e.uri}`,a=`Version: ${e.version}`,o=`Chain ID: ${o5(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,h=e.exp?`Expiration Time: ${e.exp}`:void 0,d=e.nbf?`Not Before: ${e.nbf}`:void 0,u=e.requestId?`Request ID: ${e.requestId}`:void 0,p=e.resources?`Resources:${e.resources.map(e=>`
- ${e}`).join("")}`:void 0,g=ci(e.resources);if(g){let e=ce(g);s=function(e="",t){o9(t);let r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;let i=[],s=0;Object.keys(t.att).forEach(e=>{let r=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));r.sort((e,t)=>e.action.localeCompare(t.action));let n={};r.forEach(e=>{n[e.ability]||(n[e.ability]=[]),n[e.ability].push(e.action)});let a=Object.keys(n).map(t=>`(${++s}) '${t}': '${n[t].join("', '")}' for '${e}'.`);i.push(a.join(", ").replace(".,","."))});let n=i.join(" "),a=`${r}${n}`;return`${e?e+" ":""}${a}`}(s,e)}return[r,i,"",s,"",n,a,o,c,l,h,d,u,p].filter(e=>null!=e).join(`
`)};function o9(e){if(!e)throw Error("No recap provided, value is undefined");if(!e.att)throw Error("No `att` property found");let t=Object.keys(e.att);if(!(null!=t&&t.length))throw Error("No resources found in `att` property");t.forEach(t=>{let r=e.att[t];if(Array.isArray(r)||"object"!=typeof r)throw Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(e=>{let t=r[e];if(!Array.isArray(t))throw Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function o7(e){return o9(e),`urn:recap:${aG.from(JSON.stringify(e)).toString("base64").replace(/=/g,"")}`}function ce(e){var t;let r=(t=e.replace("urn:recap:",""),JSON.parse(aG.from(t,"base64").toString("utf-8")));return o9(r),r}function ct(e){var t;let r=ce(e);o9(r);let i=null==(t=r.att)?void 0:t.eip155;return i?Object.keys(i).map(e=>e.split("/")[1]):[]}function cr(e){let t=ce(e);o9(t);let r=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&r.push(e[0].chains)})}),[...new Set(r.flat())]}function ci(e){if(!e)return;let t=e?.[e.length-1];return t&&t.includes("urn:recap:")?t:void 0}function cs(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function cn(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function ca(e,...t){if(!cn(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function co(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function cc(e){if("boolean"!=typeof e)throw Error(`boolean expected, not ${e}`)}let cl=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),ch=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),cd=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];if(!cd)throw Error("Non little-endian hardware is not supported");function cu(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(cn(e))e=cf(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function cp(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&t.byteOffset%4!=0)throw Error("invalid output, must be aligned");return t}function cg(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(4294967295),a=Number(r>>s&n),o=Number(r&n);e.setUint32(t+(i?4:0),a,i),e.setUint32(t+(i?0:4),o,i)}function cf(e){return Uint8Array.from(e)}function cm(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}let cw=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),cy=cw("expand 16-byte k"),cb=cw("expand 32-byte k"),cv=cl(cy),cE=cl(cb);function cC(e,t){return e<<t|e>>>32-t}function cI(e){return e.byteOffset%4==0}let cN=4294967296-1,cA=new Uint32Array,c_=(e,t)=>255&e[t++]|(255&e[t++])<<8;class cS{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,ca(e=cu(e),32);let t=c_(e,0),r=c_(e,2),i=c_(e,4),s=c_(e,6),n=c_(e,8),a=c_(e,10),o=c_(e,12),c=c_(e,14);this.r[0]=8191&t,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|n<<12)&255,this.r[5]=n>>>1&8190,this.r[6]=(n>>>14|a<<2)&8191,this.r[7]=(a>>>11|o<<5)&8065,this.r[8]=(o>>>8|c<<8)&8191,this.r[9]=c>>>5&127;for(let t=0;t<8;t++)this.pad[t]=c_(e,16+2*t)}process(e,t,r=!1){let{h:i,r:s}=this,n=s[0],a=s[1],o=s[2],c=s[3],l=s[4],h=s[5],d=s[6],u=s[7],p=s[8],g=s[9],f=c_(e,t+0),m=c_(e,t+2),w=c_(e,t+4),y=c_(e,t+6),b=c_(e,t+8),v=c_(e,t+10),E=c_(e,t+12),C=c_(e,t+14),I=i[0]+(8191&f),N=i[1]+((f>>>13|m<<3)&8191),A=i[2]+((m>>>10|w<<6)&8191),_=i[3]+((w>>>7|y<<9)&8191),S=i[4]+((y>>>4|b<<12)&8191),P=i[5]+(b>>>1&8191),O=i[6]+((b>>>14|v<<2)&8191),T=i[7]+((v>>>11|E<<5)&8191),R=i[8]+((E>>>8|C<<8)&8191),k=i[9]+(C>>>5|(r?0:2048)),x=0,U=0+I*n+N*(5*g)+A*(5*p)+_*(5*u)+S*(5*d);x=U>>>13,U&=8191,U+=P*(5*h)+O*(5*l)+T*(5*c)+R*(5*o)+k*(5*a),x+=U>>>13,U&=8191;let D=x+I*a+N*n+A*(5*g)+_*(5*p)+S*(5*u);x=D>>>13,D&=8191,D+=P*(5*d)+O*(5*h)+T*(5*l)+R*(5*c)+k*(5*o),x+=D>>>13,D&=8191;let L=x+I*o+N*a+A*n+_*(5*g)+S*(5*p);x=L>>>13,L&=8191,L+=P*(5*u)+O*(5*d)+T*(5*h)+R*(5*l)+k*(5*c),x+=L>>>13,L&=8191;let M=x+I*c+N*o+A*a+_*n+S*(5*g);x=M>>>13,M&=8191,M+=P*(5*p)+O*(5*u)+T*(5*d)+R*(5*h)+k*(5*l),x+=M>>>13,M&=8191;let B=x+I*l+N*c+A*o+_*a+S*n;x=B>>>13,B&=8191,B+=P*(5*g)+O*(5*p)+T*(5*u)+R*(5*d)+k*(5*h),x+=B>>>13,B&=8191;let j=x+I*h+N*l+A*c+_*o+S*a;x=j>>>13,j&=8191,j+=P*n+O*(5*g)+T*(5*p)+R*(5*u)+k*(5*d),x+=j>>>13,j&=8191;let q=x+I*d+N*h+A*l+_*c+S*o;x=q>>>13,q&=8191,q+=P*a+O*n+T*(5*g)+R*(5*p)+k*(5*u),x+=q>>>13,q&=8191;let $=x+I*u+N*d+A*h+_*l+S*c;x=$>>>13,$&=8191,$+=P*o+O*a+T*n+R*(5*g)+k*(5*p),x+=$>>>13,$&=8191;let F=x+I*p+N*u+A*d+_*h+S*l;x=F>>>13,F&=8191,F+=P*c+O*o+T*a+R*n+k*(5*g),x+=F>>>13,F&=8191;let z=x+I*g+N*p+A*u+_*d+S*h;x=z>>>13,z&=8191,z+=P*l+O*c+T*o+R*a+k*n,x+=z>>>13,z&=8191,U=8191&(x=(x=(x<<2)+x|0)+U|0),x>>>=13,D+=x,i[0]=U,i[1]=D,i[2]=L,i[3]=M,i[4]=B,i[5]=j,i[6]=q,i[7]=$,i[8]=F,i[9]=z}finalize(){let{h:e,pad:t}=this,r=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=i,i=e[t]>>>13,e[t]&=8191;e[0]+=5*i,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+i,i=r[t]>>>13,r[t]&=8191;r[9]-=8192;let s=(1^i)-1;for(let e=0;e<10;e++)r[e]&=s;s=~s;for(let t=0;t<10;t++)e[t]=e[t]&s|r[t];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let n=e[0]+t[0];e[0]=65535&n;for(let r=1;r<8;r++)n=(e[r]+t[r]|0)+(n>>>16)|0,e[r]=65535&n;cm(r)}update(e){co(this);let{buffer:t,blockLen:r}=this;e=cu(e);let i=e.length;for(let s=0;s<i;){let n=Math.min(r-this.pos,i-s);if(n===r){for(;r<=i-s;s+=r)this.process(e,s);continue}t.set(e.subarray(s,s+n),this.pos),this.pos+=n,s+=n,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){cm(this.h,this.r,this.buffer,this.pad)}digestInto(e){co(this),function(e,t){ca(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;let{buffer:t,h:r}=this,{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let s=0;for(let t=0;t<8;t++)e[s++]=r[t]>>>0,e[s++]=r[t]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}}let cP=function(e){let t=(t,r)=>e(r).update(cu(t)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new cS(e)),cO=function(e,t){let{allowShortKeys:r,extendNonceFn:i,counterLength:s,counterRight:n,rounds:a}=function(e,t){if(null==t||"object"!=typeof t)throw Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw Error("core must be a function");return cs(s),cs(a),cc(n),cc(r),(t,o,c,l,h=0)=>{ca(t),ca(o),ca(c);let d=c.length;if(void 0===l&&(l=new Uint8Array(d)),ca(l),cs(h),h<0||h>=cN)throw Error("arx: counter overflow");if(l.length<d)throw Error(`arx: output (${l.length}) is shorter than data (${d})`);let u=[],p=t.length,g,f;if(32===p)u.push(g=cf(t)),f=cE;else if(16===p&&r)(g=new Uint8Array(32)).set(t),g.set(t,16),f=cv,u.push(g);else throw Error(`arx: invalid 32-byte key, got length=${p}`);cI(o)||u.push(o=cf(o));let m=cl(g);if(i){if(24!==o.length)throw Error("arx: extended nonce must be 24 bytes");i(f,m,cl(o.subarray(0,16)),m),o=o.subarray(16)}let w=16-s;if(w!==o.length)throw Error(`arx: nonce must be ${w} or 16 bytes`);if(12!==w){let e=new Uint8Array(12);e.set(o,n?0:12-o.length),o=e,u.push(o)}let y=cl(o);return function(e,t,r,i,s,n,a,o){let c=s.length,l=new Uint8Array(64),h=cl(l),d=cI(s)&&cI(n),u=d?cl(s):cA,p=d?cl(n):cA;for(let g=0;g<c;a++){if(e(t,r,i,h,a,o),a>=cN)throw Error("arx: counter overflow");let f=Math.min(64,c-g);if(d&&64===f){let e=g/4;if(g%4!=0)throw Error("arx: invalid block position");for(let t=0,r;t<16;t++)p[r=e+t]=u[r]^h[t];g+=64;continue}for(let e=0,t;e<f;e++)n[t=g+e]=s[t]^l[e];g+=f}}(e,f,m,y,c,l,h,a),cm(...u),l}}(function(e,t,r,i,s,n=20){let a=e[0],o=e[1],c=e[2],l=e[3],h=t[0],d=t[1],u=t[2],p=t[3],g=t[4],f=t[5],m=t[6],w=t[7],y=r[0],b=r[1],v=r[2],E=a,C=o,I=c,N=l,A=h,_=d,S=u,P=p,O=g,T=f,R=m,k=w,x=s,U=y,D=b,L=v;for(let e=0;e<n;e+=2)O=O+(x=cC(x^(E=E+A|0),16))|0,E=E+(A=cC(A^O,12))|0,O=O+(x=cC(x^E,8))|0,A=cC(A^O,7),T=T+(U=cC(U^(C=C+_|0),16))|0,C=C+(_=cC(_^T,12))|0,T=T+(U=cC(U^C,8))|0,_=cC(_^T,7),R=R+(D=cC(D^(I=I+S|0),16))|0,I=I+(S=cC(S^R,12))|0,R=R+(D=cC(D^I,8))|0,S=cC(S^R,7),k=k+(L=cC(L^(N=N+P|0),16))|0,N=N+(P=cC(P^k,12))|0,k=k+(L=cC(L^N,8))|0,P=cC(P^k,7),R=R+(L=cC(L^(E=E+_|0),16))|0,E=E+(_=cC(_^R,12))|0,R=R+(L=cC(L^E,8))|0,_=cC(_^R,7),k=k+(x=cC(x^(C=C+S|0),16))|0,C=C+(S=cC(S^k,12))|0,k=k+(x=cC(x^C,8))|0,S=cC(S^k,7),O=O+(U=cC(U^(I=I+P|0),16))|0,I=I+(P=cC(P^O,12))|0,O=O+(U=cC(U^I,8))|0,P=cC(P^O,7),T=T+(D=cC(D^(N=N+A|0),16))|0,N=N+(A=cC(A^T,12))|0,T=T+(D=cC(D^N,8))|0,A=cC(A^T,7);let M=0;i[M++]=a+E|0,i[M++]=o+C|0,i[M++]=c+I|0,i[M++]=l+N|0,i[M++]=h+A|0,i[M++]=d+_|0,i[M++]=u+S|0,i[M++]=p+P|0,i[M++]=g+O|0,i[M++]=f+T|0,i[M++]=m+R|0,i[M++]=w+k|0,i[M++]=s+x|0,i[M++]=y+U|0,i[M++]=b+D|0,i[M++]=v+L|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),cT=new Uint8Array(16),cR=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(cT.subarray(r))},ck=new Uint8Array(32);function cx(e,t,r,i,s){let n=e(t,r,ck),a=cP.create(n);s&&cR(a,s),cR(a,i);let o=new Uint8Array(16),c=ch(o);cg(c,0,BigInt(s?s.length:0),!0),cg(c,8,BigInt(i.length),!0),a.update(o);let l=a.digest();return cm(n,o),l}a={blockSize:64,nonceLength:12,tagLength:16},o=(e,t,r)=>({encrypt(i,s){let n=i.length;(s=cp(n+16,s,!1)).set(i);let a=s.subarray(0,-16);cO(e,t,a,a,1);let o=cx(cO,e,t,a,r);return s.set(o,n),cm(o),s},decrypt(i,s){s=cp(i.length-16,s,!1);let n=i.subarray(0,-16),a=i.subarray(-16),o=cx(cO,e,t,n,r);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}(a,o))throw Error("invalid tag");return s.set(i.subarray(0,-16)),cO(e,t,s,s,1),cm(o),s}}),Object.assign(function(e,...t){if(ca(e),void 0!==a.nonceLength){let e=t[0];if(!e)throw Error("nonce / iv required");a.varSizeNonce?ca(e):ca(e,a.nonceLength)}let r=a.tagLength;r&&void 0!==t[1]&&ca(t[1]);let i=o(e,...t),s=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");ca(t)}},n=!1;return{encrypt(e,t){if(n)throw Error("cannot encrypt() twice with same key + nonce");return n=!0,ca(e),s(i.encrypt.length,t),i.encrypt(e,t)},decrypt(e,t){if(ca(e),r&&e.length<r)throw Error("invalid ciphertext length: smaller than tagLength="+r);return s(i.decrypt.length,t),i.decrypt(e,t)}}},a);class cU extends oA{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");ol(e.outputLen),ol(e.blockLen)}(e);let r=oN(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),s.fill(0)}update(e){return od(this),this.iHash.update(e),this}digestInto(e){od(this),oh(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:n,outputLen:a}=this;return e.finished=i,e.destroyed=s,e.blockLen=n,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let cD=(e,t,r)=>new cU(e,t).update(r).digest();cD.create=(e,t)=>new cU(e,t),new Uint8Array([0]),new Uint8Array;class cL extends oA{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ov(this.buffer)}update(e){od(this);let{view:t,buffer:r,blockLen:i}=this;e=oN(e);let s=e.length;for(let n=0;n<s;){let a=Math.min(i-this.pos,s-n);if(a===i){let t=ov(e);for(;i<=s-n;n+=i)this.process(t,n);continue}r.set(e.subarray(n,n+a),this.pos),this.pos+=a,n+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){od(this),ou(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:s}=this,{pos:n}=this;t[n++]=128,this.buffer.subarray(n).fill(0),this.padOffset>i-n&&(this.process(r,0),n=0);for(let e=n;e<i;e++)t[e]=0;(function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(4294967295),a=Number(r>>s&n),o=Number(r&n);e.setUint32(t+(i?4:0),a,i),e.setUint32(t+(i?0:4),o,i)})(r,i-8,BigInt(8*this.length),s),this.process(r,0);let a=ov(e),o=this.outputLen;if(o%4)throw Error("_sha2: outputLen should be aligned to 32bit");let c=o/4,l=this.get();if(c>l.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)a.setUint32(4*e,l[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:s,destroyed:n,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=n,i%t&&e.buffer.set(r),e}}let cM=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),cB=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),cj=new Uint32Array(64);class cq extends cL{constructor(){super(64,32,8,!1),this.A=0|cB[0],this.B=0|cB[1],this.C=0|cB[2],this.D=0|cB[3],this.E=0|cB[4],this.F=0|cB[5],this.G=0|cB[6],this.H=0|cB[7]}get(){let{A:e,B:t,C:r,D:i,E:s,F:n,G:a,H:o}=this;return[e,t,r,i,s,n,a,o]}set(e,t,r,i,s,n,a,o){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|s,this.F=0|n,this.G=0|a,this.H=0|o}process(e,t){for(let r=0;r<16;r++,t+=4)cj[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=cj[e-15],r=cj[e-2],i=oE(t,7)^oE(t,18)^t>>>3,s=oE(r,17)^oE(r,19)^r>>>10;cj[e]=s+cj[e-7]+i+cj[e-16]|0}let{A:r,B:i,C:s,D:n,E:a,F:o,G:c,H:l}=this;for(let e=0;e<64;e++){var h,d,u,p;let t=oE(a,6)^oE(a,11)^oE(a,25),g=l+t+((h=a)&o^~h&c)+cM[e]+cj[e]|0,f=(oE(r,2)^oE(r,13)^oE(r,22))+((d=r)&(u=i)^d&(p=s)^u&p)|0;l=c,c=o,o=a,a=n+g|0,n=s,s=i,i=r,r=g+f|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,n=n+this.D|0,a=a+this.E|0,o=o+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,i,s,n,a,o,c,l)}roundClean(){cj.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}let c$=o_(()=>new cq),cF=BigInt(0),cz=BigInt(1),cH=BigInt(2);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function cW(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function cV(e){if(!cW(e))throw Error("Uint8Array expected")}function cK(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)}let cG=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function cJ(e){cV(e);let t="";for(let r=0;r<e.length;r++)t+=cG[e[r]];return t}function cY(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function cZ(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?cF:BigInt("0x"+e)}let cX={_0:48,_9:57,A:65,F:70,a:97,f:102};function cQ(e){return e>=cX._0&&e<=cX._9?e-cX._0:e>=cX.A&&e<=cX.F?e-(cX.A-10):e>=cX.a&&e<=cX.f?e-(cX.a-10):void 0}function c0(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,s=0;t<r;t++,s+=2){let r=cQ(e.charCodeAt(s)),n=cQ(e.charCodeAt(s+1));if(void 0===r||void 0===n){let t=e[s]+e[s+1];throw Error('hex string expected, got non-hex character "'+t+'" at index '+s)}i[t]=16*r+n}return i}function c1(e){return cZ(cJ(e))}function c2(e){return cV(e),cZ(cJ(Uint8Array.from(e).reverse()))}function c5(e,t){return c0(e.toString(16).padStart(2*t,"0"))}function c3(e,t){return c5(e,t).reverse()}function c4(e,t,r){let i;if("string"==typeof t)try{i=c0(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(cW(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let s=i.length;if("number"==typeof r&&s!==r)throw Error(e+" of length "+r+" expected, got "+s);return i}function c8(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];cV(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let s=e[t];r.set(s,i),i+=s.length}return r}let c6=e=>"bigint"==typeof e&&cF<=e;function c9(e,t,r){return c6(e)&&c6(t)&&c6(r)&&t<=e&&e<r}function c7(e,t,r,i){if(!c9(t,r,i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}function le(e){let t;for(t=0;e>cF;e>>=cz,t+=1);return t}let lt=e=>(cH<<BigInt(e-1))-cz,lr=e=>new Uint8Array(e),li=e=>Uint8Array.from(e);function ls(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=lr(e),s=lr(e),n=0,a=()=>{i.fill(1),s.fill(0),n=0},o=(...e)=>r(s,i,...e),c=(e=lr())=>{s=o(li([0]),e),i=o(),0!==e.length&&(s=o(li([1]),e),i=o())},l=()=>{if(n++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){i=o();let t=i.slice();r.push(t),e+=i.length}return c8(...r)};return(e,t)=>{let r;for(a(),c(e);!(r=t(l()));)c();return a(),r}}let ln={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||cW(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function la(e,t,r={}){let i=(t,r,i)=>{let s=ln[r];if("function"!=typeof s)throw Error("invalid validator function");let n=e[t];if(!(i&&void 0===n)&&!s(n,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+n)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0);return e}let lo=()=>{throw Error("not implemented")};function lc(e){let t=new WeakMap;return(r,...i)=>{let s=t.get(r);if(void 0!==s)return s;let n=e(r,...i);return t.set(r,n),n}}var ll=Object.freeze({__proto__:null,isBytes:cW,abytes:cV,abool:cK,bytesToHex:cJ,numberToHexUnpadded:cY,hexToNumber:cZ,hexToBytes:c0,bytesToNumberBE:c1,bytesToNumberLE:c2,numberToBytesBE:c5,numberToBytesLE:c3,numberToVarBytesBE:function(e){return c0(cY(e))},ensureBytes:c4,concatBytes:c8,equalBytes:function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r},utf8ToBytes:function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))},inRange:c9,aInRange:c7,bitLen:le,bitGet:function(e,t){return e>>BigInt(t)&cz},bitSet:function(e,t,r){return e|(r?cz:cF)<<BigInt(t)},bitMask:lt,createHmacDrbg:ls,validateObject:la,notImplemented:lo,memoized:lc});let lh=BigInt(0),ld=BigInt(1),lu=BigInt(2),lp=BigInt(3),lg=BigInt(4),lf=BigInt(5),lm=BigInt(8);function lw(e,t){let r=e%t;return r>=lh?r:t+r}function ly(e,t,r){if(t<lh)throw Error("invalid exponent, negatives unsupported");if(r<=lh)throw Error("invalid modulus");if(r===ld)return lh;let i=ld;for(;t>lh;)t&ld&&(i=i*e%r),e=e*e%r,t>>=ld;return i}function lb(e,t,r){let i=e;for(;t-- >lh;)i*=i,i%=r;return i}function lv(e,t){if(e===lh)throw Error("invert: expected non-zero number");if(t<=lh)throw Error("invert: expected positive modulus, got "+t);let r=lw(e,t),i=t,s=lh,n=ld;for(;r!==lh;){let e=i/r,t=i%r,a=s-n*e;i=r,r=t,s=n,n=a}if(i!==ld)throw Error("invert: does not exist");return lw(s,t)}let lE=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function lC(e,t){let r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function lI(e,t,r=!1,i={}){let s;if(e<=lh)throw Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:n,nByteLength:a}=lC(e,t);if(a>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let o=Object.freeze({ORDER:e,isLE:r,BITS:n,BYTES:a,MASK:lt(n),ZERO:lh,ONE:ld,create:t=>lw(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return lh<=t&&t<e},is0:e=>e===lh,isOdd:e=>(e&ld)===ld,neg:t=>lw(-t,e),eql:(e,t)=>e===t,sqr:t=>lw(t*t,e),add:(t,r)=>lw(t+r,e),sub:(t,r)=>lw(t-r,e),mul:(t,r)=>lw(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<lh)throw Error("invalid exponent, negatives unsupported");if(r===lh)return e.ONE;if(r===ld)return t;let i=e.ONE,s=t;for(;r>lh;)r&ld&&(i=e.mul(i,s)),s=e.sqr(s),r>>=ld;return i})(o,e,t),div:(t,r)=>lw(t*lv(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>lv(t,e),sqrt:i.sqrt||(t=>(s||(s=function(e){if(e%lg===lp){let t=(e+ld)/lg;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}if(e%lm===lf){let t=(e-lf)/lm;return function(e,r){let i=e.mul(r,lu),s=e.pow(i,t),n=e.mul(r,s),a=e.mul(e.mul(n,lu),s),o=e.mul(n,e.sub(a,e.ONE));if(!e.eql(e.sqr(o),r))throw Error("Cannot find square root");return o}}return function(e){let t,r,i;let s=(e-ld)/lu;for(t=e-ld,r=0;t%lu===lh;t/=lu,r++);for(i=lu;i<e&&ly(i,s,e)!==e-ld;i++)if(i>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===r){let t=(e+ld)/lg;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}let n=(t+ld)/lu;return function(e,a){if(e.pow(a,s)===e.neg(e.ONE))throw Error("Cannot find square root");let o=r,c=e.pow(e.mul(e.ONE,i),t),l=e.pow(a,n),h=e.pow(a,t);for(;!e.eql(h,e.ONE);){if(e.eql(h,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(h);t<o&&!e.eql(r,e.ONE);t++)r=e.sqr(r);let r=e.pow(c,ld<<BigInt(o-t-1));c=e.sqr(r),l=e.mul(l,r),h=e.mul(h,c),o=t}return l}}(e)}(e)),s(o,t))),invertBatch:e=>(function(e,t){let r=Array(t.length),i=t.reduce((t,i,s)=>e.is0(i)?t:(r[s]=t,e.mul(t,i)),e.ONE),s=e.inv(i);return t.reduceRight((t,i,s)=>e.is0(i)?t:(r[s]=e.mul(t,r[s]),e.mul(t,i)),s),r})(o,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?c3(e,a):c5(e,a),fromBytes:e=>{if(e.length!==a)throw Error("Field.fromBytes: expected "+a+" bytes, got "+e.length);return r?c2(e):c1(e)}});return Object.freeze(o)}function lN(e){if("bigint"!=typeof e)throw Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function lA(e){let t=lN(e);return t+Math.ceil(t/2)}let l_=BigInt(0),lS=BigInt(1);function lP(e,t){let r=t.negate();return e?r:t}function lO(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function lT(e,t){return lO(e,t),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}let lR=new WeakMap,lk=new WeakMap;function lx(e){return lk.get(e)||1}function lU(e){return function(e){let t=lE.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});la(e,t)}(e.Fp),la(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...lC(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8),BigInt(0),BigInt(1);let lD=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);let lL=BigInt(1),lM=BigInt(2),lB=BigInt(3),lj=BigInt(5);function lq(e){void 0!==e.lowS&&cK("lowS",e.lowS),void 0!==e.prehash&&cK("prehash",e.prehash)}BigInt(8),function(e){let t=(la(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})),{P:r}=t,i=e=>lw(e,r),s=t.montgomeryBits;t.nByteLength,t.adjustScalarBytes||(e=>e),t.powPminus2||(e=>ly(e,r-BigInt(2),r));t.a,BigInt(2),BigInt(4),c3(i(t.Gu),Math.ceil(s/8))}({P:lD,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let{pow_p_5_8:t,b2:r}=function(e){let t=BigInt(10),r=BigInt(20),i=BigInt(40),s=BigInt(80),n=e*e%lD*e%lD,a=lb(n,lM,lD)*n%lD,o=lb(a,lL,lD)*e%lD,c=lb(o,lj,lD)*o%lD,l=lb(c,t,lD)*c%lD,h=lb(l,r,lD)*l%lD,d=lb(h,i,lD)*h%lD,u=lb(d,s,lD)*d%lD,p=lb(u,s,lD)*d%lD,g=lb(p,t,lD)*c%lD;return{pow_p_5_8:lb(g,lM,lD)*e%lD,b2:n}}(e);return lw(lb(t,lB,lD)*r,lD)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:oS});let{bytesToNumberBE:l$,hexToBytes:lF}=ll,lz={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{let{Err:r}=lz;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,s=cY(i);if(s.length/2&128)throw new r("tlv.encode: long form length too big");let n=i>127?cY(s.length/2|128):"";return cY(e)+n+s+t},decode(e,t){let{Err:r}=lz,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let s=t[i++],n=0;if(128&s){let e=127&s;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let a=t.subarray(i,i+e);if(a.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===a[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of a)n=n<<8|e;if(i+=e,n<128)throw new r("tlv.decode(long): not minimal encoding")}else n=s;let a=t.subarray(i,i+n);if(a.length!==n)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(i+n)}}},_int:{encode(e){let{Err:t}=lz;if(e<lH)throw new t("integer: negative integers are not allowed");let r=cY(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=lz;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return l$(e)}},toSig(e){let{Err:t,_int:r,_tlv:i}=lz,s="string"==typeof e?lF(e):e;cV(s);let{v:n,l:a}=i.decode(48,s);if(a.length)throw new t("invalid signature: left bytes after parsing");let{v:o,l:c}=i.decode(2,n),{v:l,l:h}=i.decode(2,c);if(h.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(o),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=lz,i=t.encode(2,r.encode(e.r)),s=t.encode(2,r.encode(e.s));return t.encode(48,i+s)}},lH=BigInt(0),lW=BigInt(1);BigInt(2);let lV=BigInt(3);BigInt(4);let lK=lI(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),lG=lK.create(BigInt("-3")),lJ=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),lY=(s={a:lG,b:lJ,Fp:lK,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},n=c$,function(e){let t=function(e){let t=lU(e);return la(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:r,n:i}=t,s=r.BYTES+1,n=2*r.BYTES+1;function a(e){return lw(e,i)}let{ProjectivePoint:o,normPrivateKeyToScalar:c,weierstrassEquation:l,isWithinCurveOrder:h}=function(e){var t;let r=function(e){let t=lU(e);la(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:i,a:s}=t;if(r){if(!i.eql(s,i.ZERO))throw Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:i}=r,s=lI(r.n,r.nBitLength),n=r.toBytes||((e,t,r)=>{let s=t.toAffine();return c8(Uint8Array.from([4]),i.toBytes(s.x),i.toBytes(s.y))}),a=r.fromBytes||(e=>{let t=e.subarray(1),r=i.fromBytes(t.subarray(0,i.BYTES)),s=i.fromBytes(t.subarray(i.BYTES,2*i.BYTES));return{x:r,y:s}});function o(e){let{a:t,b:s}=r,n=i.sqr(e),a=i.mul(n,e);return i.add(i.add(a,i.mul(e,t)),s)}if(!i.eql(i.sqr(r.Gy),o(r.Gx)))throw Error("bad generator point: equation left != right");function c(e){let t;let{allowedPrivateKeyLengths:i,nByteLength:s,wrapPrivateKey:n,n:a}=r;if(i&&"bigint"!=typeof e){if(cW(e)&&(e=cJ(e)),"string"!=typeof e||!i.includes(e.length))throw Error("invalid private key");e=e.padStart(2*s,"0")}try{t="bigint"==typeof e?e:c1(c4("private key",e,s))}catch{throw Error("invalid private key, expected hex or "+s+" bytes, got "+typeof e)}return n&&(t=lw(t,a)),c7("private key",t,lW,a),t}function l(e){if(!(e instanceof u))throw Error("ProjectivePoint expected")}let h=lc((e,t)=>{let{px:r,py:s,pz:n}=e;if(i.eql(n,i.ONE))return{x:r,y:s};let a=e.is0();null==t&&(t=a?i.ONE:i.inv(n));let o=i.mul(r,t),c=i.mul(s,t),l=i.mul(n,t);if(a)return{x:i.ZERO,y:i.ZERO};if(!i.eql(l,i.ONE))throw Error("invZ was invalid");return{x:o,y:c}}),d=lc(e=>{if(e.is0()){if(r.allowInfinityPoint&&!i.is0(e.py))return;throw Error("bad point: ZERO")}let{x:t,y:s}=e.toAffine();if(!i.isValid(t)||!i.isValid(s))throw Error("bad point: x or y not FE");let n=i.sqr(s),a=o(t);if(!i.eql(n,a))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class u{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!i.isValid(e))throw Error("x required");if(null==t||!i.isValid(t))throw Error("y required");if(null==r||!i.isValid(r))throw Error("z required");Object.freeze(this)}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!i.isValid(t)||!i.isValid(r))throw Error("invalid affine point");if(e instanceof u)throw Error("projective point not allowed");let s=e=>i.eql(e,i.ZERO);return s(t)&&s(r)?u.ZERO:new u(t,r,i.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){let t=i.invertBatch(e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(u.fromAffine)}static fromHex(e){let t=u.fromAffine(a(c4("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return u.BASE.multiply(c(e))}static msm(e,t){return function(e,t,r,i){if(function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}(i,t),r.length!==i.length)throw Error("arrays of points and scalars must have equal length");let s=e.ZERO,n=le(BigInt(r.length)),a=n>12?n-3:n>4?n-2:n?2:1,o=(1<<a)-1,c=Array(o+1).fill(s),l=Math.floor((t.BITS-1)/a)*a,h=s;for(let e=l;e>=0;e-=a){c.fill(s);for(let t=0;t<i.length;t++){let s=i[t],n=Number(s>>BigInt(e)&BigInt(o));c[n]=c[n].add(r[t])}let t=s;for(let e=c.length-1,r=s;e>0;e--)r=r.add(c[e]),t=t.add(r);if(h=h.add(t),0!==e)for(let e=0;e<a;e++)h=h.double()}return h}(u,s,e,t)}_setWindowSize(e){g.setWindowSize(this,e)}assertValidity(){d(this)}hasEvenY(){let{y:e}=this.toAffine();if(i.isOdd)return!i.isOdd(e);throw Error("Field doesn't support isOdd")}equals(e){l(e);let{px:t,py:r,pz:s}=this,{px:n,py:a,pz:o}=e,c=i.eql(i.mul(t,o),i.mul(n,s)),h=i.eql(i.mul(r,o),i.mul(a,s));return c&&h}negate(){return new u(this.px,i.neg(this.py),this.pz)}double(){let{a:e,b:t}=r,s=i.mul(t,lV),{px:n,py:a,pz:o}=this,c=i.ZERO,l=i.ZERO,h=i.ZERO,d=i.mul(n,n),p=i.mul(a,a),g=i.mul(o,o),f=i.mul(n,a);return f=i.add(f,f),h=i.mul(n,o),h=i.add(h,h),c=i.mul(e,h),l=i.mul(s,g),l=i.add(c,l),c=i.sub(p,l),l=i.add(p,l),l=i.mul(c,l),c=i.mul(f,c),h=i.mul(s,h),g=i.mul(e,g),f=i.sub(d,g),f=i.mul(e,f),f=i.add(f,h),h=i.add(d,d),d=i.add(h,d),d=i.add(d,g),d=i.mul(d,f),l=i.add(l,d),g=i.mul(a,o),g=i.add(g,g),d=i.mul(g,f),c=i.sub(c,d),h=i.mul(g,p),h=i.add(h,h),h=i.add(h,h),new u(c,l,h)}add(e){l(e);let{px:t,py:s,pz:n}=this,{px:a,py:o,pz:c}=e,h=i.ZERO,d=i.ZERO,p=i.ZERO,g=r.a,f=i.mul(r.b,lV),m=i.mul(t,a),w=i.mul(s,o),y=i.mul(n,c),b=i.add(t,s),v=i.add(a,o);b=i.mul(b,v),v=i.add(m,w),b=i.sub(b,v),v=i.add(t,n);let E=i.add(a,c);return v=i.mul(v,E),E=i.add(m,y),v=i.sub(v,E),E=i.add(s,n),h=i.add(o,c),E=i.mul(E,h),h=i.add(w,y),E=i.sub(E,h),p=i.mul(g,v),h=i.mul(f,y),p=i.add(h,p),h=i.sub(w,p),p=i.add(w,p),d=i.mul(h,p),w=i.add(m,m),w=i.add(w,m),y=i.mul(g,y),v=i.mul(f,v),w=i.add(w,y),y=i.sub(m,y),y=i.mul(g,y),v=i.add(v,y),m=i.mul(w,v),d=i.add(d,m),m=i.mul(E,v),h=i.mul(b,h),h=i.sub(h,m),m=i.mul(b,w),p=i.mul(E,p),p=i.add(p,m),new u(h,d,p)}subtract(e){return this.add(e.negate())}is0(){return this.equals(u.ZERO)}wNAF(e){return g.wNAFCached(this,e,u.normalizeZ)}multiplyUnsafe(e){let{endo:t,n:s}=r;c7("scalar",e,lH,s);let n=u.ZERO;if(e===lH)return n;if(this.is0()||e===lW)return this;if(!t||g.hasPrecomputes(this))return g.wNAFCachedUnsafe(this,e,u.normalizeZ);let{k1neg:a,k1:o,k2neg:c,k2:l}=t.splitScalar(e),h=n,d=n,p=this;for(;o>lH||l>lH;)o&lW&&(h=h.add(p)),l&lW&&(d=d.add(p)),p=p.double(),o>>=lW,l>>=lW;return a&&(h=h.negate()),c&&(d=d.negate()),d=new u(i.mul(d.px,t.beta),d.py,d.pz),h.add(d)}multiply(e){let t,s;let{endo:n,n:a}=r;if(c7("scalar",e,lW,a),n){let{k1neg:r,k1:a,k2neg:o,k2:c}=n.splitScalar(e),{p:l,f:h}=this.wNAF(a),{p:d,f:p}=this.wNAF(c);l=g.constTimeNegate(r,l),d=g.constTimeNegate(o,d),d=new u(i.mul(d.px,n.beta),d.py,d.pz),t=l.add(d),s=h.add(p)}else{let{p:r,f:i}=this.wNAF(e);t=r,s=i}return u.normalizeZ([t,s])[0]}multiplyAndAddUnsafe(e,t,r){let i=u.BASE,s=(e,t)=>t!==lH&&t!==lW&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t),n=s(this,t).add(s(e,r));return n.is0()?void 0:n}toAffine(e){return h(this,e)}isTorsionFree(){let{h:e,isTorsionFree:t}=r;if(e===lW)return!0;if(t)return t(u,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:e,clearCofactor:t}=r;return e===lW?this:t?t(u,this):this.multiplyUnsafe(r.h)}toRawBytes(e=!0){return cK("isCompressed",e),this.assertValidity(),n(u,this,e)}toHex(e=!0){return cK("isCompressed",e),cJ(this.toRawBytes(e))}}u.BASE=new u(r.Gx,r.Gy,i.ONE),u.ZERO=new u(i.ZERO,i.ONE,i.ZERO);let p=r.nBitLength,g=(t=r.endo?Math.ceil(p/2):p,{constTimeNegate:lP,hasPrecomputes:e=>1!==lx(e),unsafeLadder(e,t,r=u.ZERO){let i=e;for(;t>l_;)t&lS&&(r=r.add(i)),i=i.double(),t>>=lS;return r},precomputeWindow(e,r){let{windows:i,windowSize:s}=lT(r,t),n=[],a=e,o=a;for(let e=0;e<i;e++){o=a,n.push(o);for(let e=1;e<s;e++)o=o.add(a),n.push(o);a=o.double()}return n},wNAF(e,r,i){let{windows:s,windowSize:n}=lT(e,t),a=u.ZERO,o=u.BASE,c=BigInt(2**e-1),l=2**e,h=BigInt(e);for(let e=0;e<s;e++){let t=e*n,s=Number(i&c);i>>=h,s>n&&(s-=l,i+=lS);let d=t+Math.abs(s)-1,u=e%2!=0,p=s<0;0===s?o=o.add(lP(u,r[t])):a=a.add(lP(p,r[d]))}return{p:a,f:o}},wNAFUnsafe(e,r,i,s=u.ZERO){let{windows:n,windowSize:a}=lT(e,t),o=BigInt(2**e-1),c=2**e,l=BigInt(e);for(let e=0;e<n;e++){let t=e*a;if(i===l_)break;let n=Number(i&o);if(i>>=l,n>a&&(n-=c,i+=lS),0===n)continue;let h=r[t+Math.abs(n)-1];n<0&&(h=h.negate()),s=s.add(h)}return s},getPrecomputes(e,t,r){let i=lR.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&lR.set(t,r(i))),i},wNAFCached(e,t,r){let i=lx(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)},wNAFCachedUnsafe(e,t,r,i){let s=lx(e);return 1===s?this.unsafeLadder(e,t,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,r),t,i)},setWindowSize(e,r){lO(r,t),lk.set(e,r),lR.delete(e)}});return{CURVE:r,ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:function(e){return c9(e,lW,r.n)}}}({...t,toBytes(e,t,i){let s=t.toAffine(),n=r.toBytes(s.x);return cK("isCompressed",i),i?c8(Uint8Array.from([t.hasEvenY()?2:3]),n):c8(Uint8Array.from([4]),n,r.toBytes(s.y))},fromBytes(e){let t=e.length,i=e[0],a=e.subarray(1);if(t===s&&(2===i||3===i)){let e;let t=c1(a);if(!c9(t,lW,r.ORDER))throw Error("Point is not on curve");let s=l(t);try{e=r.sqrt(s)}catch(t){let e=t instanceof Error?": "+t.message:"";throw Error("Point is not on curve"+e)}let n=(e&lW)===lW;return(1&i)==1!==n&&(e=r.neg(e)),{x:t,y:e}}if(t===n&&4===i){let e=r.fromBytes(a.subarray(0,r.BYTES)),t=r.fromBytes(a.subarray(r.BYTES,2*r.BYTES));return{x:e,y:t}}throw Error("invalid Point, expected length of "+s+", or uncompressed "+n+", got "+t)}}),d=e=>cJ(c5(e,t.nByteLength)),u=(e,t,r)=>c1(e.slice(t,r));class p{constructor(e,t,r){this.r=e,this.s=t,this.recovery=r,this.assertValidity()}static fromCompact(e){let r=t.nByteLength;return e=c4("compactSignature",e,2*r),new p(u(e,0,r),u(e,r,2*r))}static fromDER(e){let{r:t,s:r}=lz.toSig(c4("DER",e));return new p(t,r)}assertValidity(){c7("r",this.r,lW,i),c7("s",this.s,lW,i)}addRecoveryBit(e){return new p(this.r,this.s,e)}recoverPublicKey(e){let{r:s,s:n,recovery:c}=this,l=m(c4("msgHash",e));if(null==c||![0,1,2,3].includes(c))throw Error("recovery id invalid");let h=2===c||3===c?s+t.n:s;if(h>=r.ORDER)throw Error("recovery id 2 or 3 invalid");let u=o.fromHex(((1&c)==0?"02":"03")+d(h)),p=lv(h,i),g=a(-l*p),f=a(n*p),w=o.BASE.multiplyAndAddUnsafe(u,g,f);if(!w)throw Error("point at infinify");return w.assertValidity(),w}hasHighS(){return this.s>i>>lW}normalizeS(){return this.hasHighS()?new p(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return c0(this.toDERHex())}toDERHex(){return lz.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return c0(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}function g(e){let t=cW(e),r="string"==typeof e,i=(t||r)&&e.length;return t?i===s||i===n:r?i===2*s||i===2*n:e instanceof o}let f=t.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let r=c1(e),i=8*e.length-t.nBitLength;return i>0?r>>BigInt(i):r},m=t.bits2int_modN||function(e){return a(f(e))},w=lt(t.nBitLength);function y(e){return c7("num < 2^"+t.nBitLength,e,lH,w),c5(e,t.nByteLength)}let b={lowS:t.lowS,prehash:!1},v={lowS:t.lowS,prehash:!1};o.BASE._setWindowSize(8)}({...s,hash:n,hmac:(e,...t)=>cD(n,e,function(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];oh(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let s=e[t];r.set(s,i),i+=s.length}return r}(...t)),randomBytes:oS}),"base16"),lZ="base64pad",lX="base64url";function lQ(e){let t=c$((0,F.mL)(e,lY));return(0,F.BB)(t,lY)}function l0(e){let t=c$((0,F.mL)(e,"utf8"));return(0,F.BB)(t,lY)}function l1(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}var l2=Object.defineProperty,l5=Object.defineProperties,l3=Object.getOwnPropertyDescriptors,l4=Object.getOwnPropertySymbols,l8=Object.prototype.hasOwnProperty,l6=Object.prototype.propertyIsEnumerable,l9=(e,t,r)=>t in e?l2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,l7=(e,t)=>{for(var r in t||(t={}))l8.call(t,r)&&l9(e,r,t[r]);if(l4)for(var r of l4(t))l6.call(t,r)&&l9(e,r,t[r]);return e},he=(e,t)=>l5(e,l3(t));function ht(e){let t=[];return e.forEach(e=>{let[r,i]=e.split(":");t.push(`${r}:${i}`)}),t}function hr(e){return e.includes(":")}function hi(e){return hr(e)?e.split(":")[0]:e}function hs(e){var t,r,i;let s={};if(!hd(e))return s;for(let[n,a]of Object.entries(e)){let e=hr(n)?[n]:a.chains,o=a.methods||[],c=a.events||[],l=hi(n);s[l]=he(l7({},s[l]),{chains:on(e,null==(t=s[l])?void 0:t.chains),methods:on(o,null==(r=s[l])?void 0:r.methods),events:on(c,null==(i=s[l])?void 0:i.events)})}return s}function hn(e,t){t=t.map(e=>e.replace("did:pkh:",""));let r=function(e){let t={};return e?.forEach(e=>{var r;let[i,s]=e.split(":");t[i]||(t[i]={accounts:[],chains:[],events:[],methods:[]}),t[i].accounts.push(e),null==(r=t[i].chains)||r.push(`${i}:${s}`)}),t}(t);for(let[t,i]of Object.entries(r))i.methods?i.methods=on(i.methods,e):i.methods=e,i.events=["chainChanged","accountsChanged"];return r}let ha={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},ho={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function hc(e,t){let{message:r,code:i}=ho[e];return{message:t?`${r} ${t}`:r,code:i}}function hl(e,t){let{message:r,code:i}=ha[e];return{message:t?`${r} ${t}`:r,code:i}}function hh(e,t){return!!Array.isArray(e)&&(!("u">typeof t)||!e.length||e.every(t))}function hd(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function hu(e){return typeof e>"u"}function hp(e,t){return!!(t&&hu(e))||"string"==typeof e&&!!e.trim().length}function hg(e,t){return!!(t&&hu(e))||"number"==typeof e&&!isNaN(e)}function hf(e){return!!(hp(e,!1)&&e.includes(":"))&&2===e.split(":").length}function hm(e){let t=!0;return hh(e)?e.length&&(t=e.every(e=>hp(e,!1))):t=!1,t}function hw(e,t){let r=null;return Object.values(e).forEach(e=>{var i;let s;if(r)return;let n=(i=`${t}, namespace`,s=null,hm(e?.methods)?hm(e?.events)||(s=hl("UNSUPPORTED_EVENTS",`${i}, events should be an array of strings or empty array for no events`)):s=hl("UNSUPPORTED_METHODS",`${i}, methods should be an array of strings or empty array for no methods`),s);n&&(r=n)}),r}function hy(e,t){let r=null;if(e&&hd(e)){let i;let s=hw(e,t);s&&(r=s);let n=(i=null,Object.values(e).forEach(e=>{var r,s;let n;if(i)return;let a=(r=e?.accounts,s=`${t} namespace`,n=null,hh(r)?r.forEach(e=>{n||function(e){if(hp(e,!1)&&e.includes(":")){let t=e.split(":");if(3===t.length){let e=t[0]+":"+t[1];return!!t[2]&&hf(e)}}return!1}(e)||(n=hl("UNSUPPORTED_ACCOUNTS",`${s}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):n=hl("UNSUPPORTED_ACCOUNTS",`${s}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n);a&&(i=a)}),i);n&&(r=n)}else r=hc("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function hb(e){return hp(e.protocol,!0)}function hv(e){return"u">typeof e}function hE(e,t){return!(!hf(t)||!(function(e){let t=[];return Object.values(e).forEach(e=>{t.push(...ht(e.accounts))}),t})(e).includes(t))}function hC(e,t,r){let i=null,s=function(e){let t={};return Object.keys(e).forEach(r=>{var i;r.includes(":")?t[r]=e[r]:null==(i=e[r].chains)||i.forEach(i=>{t[i]={methods:e[r].methods,events:e[r].events}})}),t}(e),n=function(e){let t={};return Object.keys(e).forEach(r=>{if(r.includes(":"))t[r]=e[r];else{let i=ht(e[r].accounts);i?.forEach(i=>{t[i]={accounts:e[r].accounts.filter(e=>e.includes(`${i}:`)),methods:e[r].methods,events:e[r].events}})}}),t}(t),a=Object.keys(s),o=Object.keys(n),c=hI(Object.keys(e)),l=hI(Object.keys(t)),h=c.filter(e=>!l.includes(e));return h.length&&(i=hc("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${h.toString()}
      Received: ${Object.keys(t).toString()}`)),oe(a,o)||(i=hc("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${a.toString()}
      Approved: ${o.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||i)return;let s=ht(t[e].accounts);s.includes(e)||(i=hc("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}
        Required: ${e}
        Approved: ${s.toString()}`))}),a.forEach(e=>{i||(oe(s[e].methods,n[e].methods)?oe(s[e].events,n[e].events)||(i=hc("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):i=hc("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))}),i}function hI(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}let hN={};class hA{static get(e){return hN[e]}static set(e,t){hN[e]=t}static delete(e){delete hN[e]}}let h_="client",hS=`wc@2:${h_}:`,hP={name:h_,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},hO="WALLETCONNECT_DEEPLINK_CHOICE",hT="Proposal expired",hR=D.SEVEN_DAYS,hk={wc_sessionPropose:{req:{ttl:D.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:D.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:D.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:D.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:D.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:D.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:D.ONE_DAY,prompt:!1,tag:1104},res:{ttl:D.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:D.ONE_DAY,prompt:!1,tag:1106},res:{ttl:D.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:D.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:D.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:D.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:D.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:D.ONE_DAY,prompt:!1,tag:1112},res:{ttl:D.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:D.ONE_DAY,prompt:!1,tag:1114},res:{ttl:D.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:D.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:D.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:D.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:D.FIVE_MINUTES,prompt:!1,tag:1119}}},hx={min:D.FIVE_MINUTES,max:D.SEVEN_DAYS},hU={idle:"IDLE",active:"ACTIVE"},hD={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},hL=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],hM="wc@1.5:auth:",hB=`${hM}:PUB_KEY`;var hj=Object.defineProperty,hq=Object.defineProperties,h$=Object.getOwnPropertyDescriptors,hF=Object.getOwnPropertySymbols,hz=Object.prototype.hasOwnProperty,hH=Object.prototype.propertyIsEnumerable,hW=(e,t,r)=>t in e?hj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hV=(e,t)=>{for(var r in t||(t={}))hz.call(t,r)&&hW(e,r,t[r]);if(hF)for(var r of hF(t))hH.call(t,r)&&hW(e,r,t[r]);return e},hK=(e,t)=>hq(e,h$(t)),hG=(e,t,r)=>hW(e,"symbol"!=typeof t?t+"":t,r);class hJ extends ay{constructor(e){super(e),hG(this,"name","engine"),hG(this,"events",new(p())),hG(this,"initialized",!1),hG(this,"requestQueue",{state:hU.idle,queue:[]}),hG(this,"sessionRequestQueue",{state:hU.idle,queue:[]}),hG(this,"requestQueueDelay",D.ONE_SECOND),hG(this,"expectedPairingMethodMap",new Map),hG(this,"recentlyDeletedMap",new Map),hG(this,"recentlyDeletedLimit",200),hG(this,"relayMessageCache",[]),hG(this,"pendingSessions",new Map),hG(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(hk)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,D.toMiliseconds)(this.requestQueueDelay)))}),hG(this,"connect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let t=hK(hV({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t),t.optionalNamespaces=function(e,t){var r,i,s,n,a,o;let c=hs(e),l=hs(t),h={},d=Object.keys(c).concat(Object.keys(l));for(let e of d)h[e]={chains:on(null==(r=c[e])?void 0:r.chains,null==(i=l[e])?void 0:i.chains),methods:on(null==(s=c[e])?void 0:s.methods,null==(n=l[e])?void 0:n.methods),events:on(null==(a=c[e])?void 0:a.events,null==(o=l[e])?void 0:o.events)};return h}(t.requiredNamespaces,t.optionalNamespaces),t.requiredNamespaces={};let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:n,scopedProperties:a,relays:o}=t,c=r,l,h=!1;try{if(c){let e=this.client.core.pairing.pairings.get(c);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=e.active}}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${c}) failed`),e}if(!c||!h){let{topic:e,uri:t}=await this.client.core.pairing.create();c=e,l=t}if(!c){let{message:e}=hc("NO_MATCHING_KEY",`connect() pairing topic: ${c}`);throw Error(e)}let d=await this.client.core.crypto.generateKeyPair(),u=hk.wc_sessionPropose.req.ttl||D.FIVE_MINUTES,p=or(u),g=hK(hV(hV({requiredNamespaces:i,optionalNamespaces:s,relays:o??[{protocol:"irn"}],proposer:{publicKey:d,metadata:this.client.metadata},expiryTimestamp:p,pairingTopic:c},n&&{sessionProperties:n}),a&&{scopedProperties:a}),{id:(0,r9.payloadId)()}),f=os("session_connect",g.id),{reject:m,resolve:w,done:y}=ot(u,hT),b=({id:e})=>{e===g.id&&(this.client.events.off("proposal_expire",b),this.pendingSessions.delete(g.id),this.events.emit(f,{error:{message:hT,code:0}}))};return this.client.events.on("proposal_expire",b),this.events.once(f,({error:e,session:t})=>{this.client.events.off("proposal_expire",b),e?m(e):t&&w(t)}),await this.sendRequest({topic:c,method:"wc_sessionPropose",params:g,throwOnFailedPublish:!0,clientRpcId:g.id}),await this.setProposal(g.id,g),{uri:l,approval:y}}),hG(this,"pair",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}}),hG(this,"approve",async e=>{var t,r,i;let s=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[iP.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw s.setError(iO.no_internet_connection),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),s.setError(iO.proposal_not_found),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),s.setError(iO.session_approve_namespace_validation_failure),e}let{id:n,relayProtocol:a,namespaces:o,sessionProperties:c,scopedProperties:l,sessionConfig:h}=e,d=this.client.proposal.get(n);this.client.core.eventClient.deleteEvent({eventId:s.eventId});let{pairingTopic:u,proposer:p,requiredNamespaces:g,optionalNamespaces:f}=d,m=null==(r=this.client.core.eventClient)?void 0:r.getEvent({topic:u});m||(m=null==(i=this.client.core.eventClient)?void 0:i.createEvent({type:iP.session_approve_started,properties:{topic:u,trace:[iP.session_approve_started,iP.session_namespaces_validation_success]}}));let w=await this.client.core.crypto.generateKeyPair(),y=p.publicKey,b=await this.client.core.crypto.generateSharedKey(w,y),v=hV(hV(hV({relay:{protocol:a??"irn"},namespaces:o,controller:{publicKey:w,metadata:this.client.metadata},expiry:or(hR)},c&&{sessionProperties:c}),l&&{scopedProperties:l}),h&&{sessionConfig:h}),E=ig.relay;m.addTrace(iP.subscribing_session_topic);try{await this.client.core.relayer.subscribe(b,{transportType:E})}catch(e){throw m.setError(iO.subscribe_session_topic_failure),e}m.addTrace(iP.subscribe_session_topic_success);let C=hK(hV({},v),{topic:b,requiredNamespaces:g,optionalNamespaces:f,pairingTopic:u,acknowledged:!1,self:v.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:w,transportType:ig.relay});await this.client.session.set(b,C),m.addTrace(iP.store_session);try{m.addTrace(iP.publishing_session_settle),await this.sendRequest({topic:b,method:"wc_sessionSettle",params:v,throwOnFailedPublish:!0}).catch(e=>{throw m?.setError(iO.session_settle_publish_failure),e}),m.addTrace(iP.session_settle_publish_success),m.addTrace(iP.publishing_session_approve),await this.sendResult({id:n,topic:u,result:{relay:{protocol:a??"irn"},responderPublicKey:w},throwOnFailedPublish:!0}).catch(e=>{throw m?.setError(iO.session_approve_publish_failure),e}),m.addTrace(iP.session_approve_publish_success)}catch(e){throw this.client.logger.error(e),this.client.session.delete(b,hl("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(b),e}return this.client.core.eventClient.deleteEvent({eventId:m.eventId}),await this.client.core.pairing.updateMetadata({topic:u,metadata:p.metadata}),await this.client.proposal.delete(n,hl("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:u}),await this.setExpiry(b,or(hR)),{topic:b,acknowledged:()=>Promise.resolve(this.client.session.get(b))}}),hG(this,"reject",async e=>{let t;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}let{id:r,reason:i}=e;try{t=this.client.proposal.get(r).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),e}t&&(await this.sendError({id:r,topic:t,error:i,rpcOpts:hk.wc_sessionPropose.reject}),await this.client.proposal.delete(r,hl("USER_DISCONNECTED")))}),hG(this,"update",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}let{topic:t,namespaces:r}=e,{done:i,resolve:s,reject:n}=ot(),a=(0,r9.payloadId)(),o=(0,r9.getBigIntRpcId)().toString(),c=this.client.session.get(t).namespaces;return this.events.once(os("session_update",a),({error:e})=>{e?n(e):s()}),await this.client.session.update(t,{namespaces:r}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:r},throwOnFailedPublish:!0,clientRpcId:a,relayRpcId:o}).catch(e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:c}),n(e)}),{acknowledged:i}}),hG(this,"extend",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}let{topic:t}=e,r=(0,r9.payloadId)(),{done:i,resolve:s,reject:n}=ot();return this.events.once(os("session_extend",r),({error:e})=>{e?n(e):s()}),await this.setExpiry(t,or(hR)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:r,throwOnFailedPublish:!0}).catch(e=>{n(e)}),{acknowledged:i}}),hG(this,"request",async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}let{chainId:t,request:r,topic:i,expiry:s=hk.wc_sessionRequest.req.ttl}=e,n=this.client.session.get(i);n?.transportType===ig.relay&&await this.confirmOnlineStateOrThrow();let a=(0,r9.payloadId)(),o=(0,r9.getBigIntRpcId)().toString(),{done:c,resolve:l,reject:h}=ot(s,"Request expired. Please try again.");this.events.once(os("session_request",a),({error:e,result:t})=>{e?h(e):l(t)});let d="wc_sessionRequest",u=this.getAppLinkIfEnabled(n.peer.metadata,n.transportType);if(u)return await this.sendRequest({clientRpcId:a,relayRpcId:o,topic:i,method:d,params:{request:hK(hV({},r),{expiryTimestamp:or(s)}),chainId:t},expiry:s,throwOnFailedPublish:!0,appLink:u}).catch(e=>h(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:a}),await c();let p={request:hK(hV({},r),{expiryTimestamp:or(s)}),chainId:t},g=this.shouldSetTVF(d,p);return await Promise.all([new Promise(async e=>{await this.sendRequest(hV({clientRpcId:a,relayRpcId:o,topic:i,method:d,params:p,expiry:s,throwOnFailedPublish:!0},g&&{tvf:this.getTVFParams(a,p)})).catch(e=>h(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:a}),e()}),new Promise(async e=>{var t;if(!(null!=(t=n.sessionConfig)&&t.disableDeepLink)){let e=await oo(this.client.core.storage,hO);await oa({id:a,topic:i,wcDeepLink:e})}e()}),c()]).then(e=>e[2])}),hG(this,"respond",async e=>{this.isInitialized(),await this.isValidRespond(e);let{topic:t,response:r}=e,{id:i}=r,s=this.client.session.get(t);s.transportType===ig.relay&&await this.confirmOnlineStateOrThrow();let n=this.getAppLinkIfEnabled(s.peer.metadata,s.transportType);(0,r9.isJsonRpcResult)(r)?await this.sendResult({id:i,topic:t,result:r.result,throwOnFailedPublish:!0,appLink:n}):(0,r9.isJsonRpcError)(r)&&await this.sendError({id:i,topic:t,error:r.error,appLink:n}),this.cleanupAfterResponse(e)}),hG(this,"ping",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}let{topic:t}=e;if(this.client.session.keys.includes(t)){let e=(0,r9.payloadId)(),r=(0,r9.getBigIntRpcId)().toString(),{done:i,resolve:s,reject:n}=ot();this.events.once(os("session_ping",e),({error:e})=>{e?n(e):s()}),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:r}),i()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))}),hG(this,"emit",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);let{topic:t,event:r,chainId:i}=e,s=(0,r9.getBigIntRpcId)().toString(),n=(0,r9.payloadId)();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:r,chainId:i},throwOnFailedPublish:!0,relayRpcId:s,clientRpcId:n})}),hG(this,"disconnect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);let{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:hl("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(t))await this.client.core.pairing.disconnect({topic:t});else{let{message:e}=hc("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw Error(e)}}),hG(this,"find",e=>(this.isInitialized(),this.client.session.getAll().filter(t=>(function(e,t){let{requiredNamespaces:r}=t,i=Object.keys(e.namespaces),s=Object.keys(r),n=!0;return!!oe(s,i)&&(i.forEach(t=>{let{accounts:i,methods:s,events:a}=e.namespaces[t],o=ht(i),c=r[t];oe(aY(t,c),o)&&oe(c.methods,s)&&oe(c.events,a)||(n=!1)}),n)})(t,e)))),hG(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),hG(this,"authenticate",async(e,t)=>{var r;let i;this.isInitialized(),this.isValidAuthenticate(e);let s=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(r=this.client.metadata.redirect)?void 0:r.linkMode),n=s?ig.link_mode:ig.relay;n===ig.relay&&await this.confirmOnlineStateOrThrow();let{chains:a,statement:o="",uri:c,domain:l,nonce:h,type:d,exp:u,nbf:p,methods:g=[],expiry:f}=e,m=[...e.resources||[]],{topic:w,uri:y}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:n});this.client.logger.info({message:"Generated new pairing",pairing:{topic:w,uri:y}});let b=await this.client.core.crypto.generateKeyPair(),v=lQ(b);if(await Promise.all([this.client.auth.authKeys.set(hB,{responseTopic:v,publicKey:b}),this.client.auth.pairingTopics.set(v,{topic:v,pairingTopic:w})]),await this.client.core.relayer.subscribe(v,{transportType:n}),this.client.logger.info(`sending request to new pairing topic: ${w}`),g.length>0){let{namespace:e}=aJ(a[0]),t=function(e,t,r){let i=function(e,t,r,i={}){return r?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:function(e,t,r={}){t=t?.sort((e,t)=>e.localeCompare(t));let i=t.map(t=>({[`${e}/${t}`]:[r]}));return Object.assign({},...i)}(t,r,i)}}}(e,t,r);return o7(i)}(e,"request",g);ci(m)&&(t=function(e,t){let r=ce(e),i=ce(t),s=function(e,t){o9(e),o9(t);let r=Object.keys(e.att).concat(Object.keys(t.att)).sort((e,t)=>e.localeCompare(t)),i={att:{}};return r.forEach(r=>{var s,n;Object.keys((null==(s=e.att)?void 0:s[r])||{}).concat(Object.keys((null==(n=t.att)?void 0:n[r])||{})).sort((e,t)=>e.localeCompare(t)).forEach(s=>{var n,a;i.att[r]=o1(o0({},i.att[r]),{[s]:(null==(n=e.att[r])?void 0:n[s])||(null==(a=t.att[r])?void 0:a[s])})})}),i}(r,i);return o7(s)}(t,m.pop())),m.push(t)}let E=f&&f>hk.wc_sessionAuthenticate.req.ttl?f:hk.wc_sessionAuthenticate.req.ttl,C={authPayload:{type:d??"caip122",chains:a,statement:o,aud:c,domain:l,version:"1",nonce:h,iat:new Date().toISOString(),exp:u,nbf:p,resources:m},requester:{publicKey:b,metadata:this.client.metadata},expiryTimestamp:or(E)},I={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},N={requiredNamespaces:{},optionalNamespaces:I,relays:[{protocol:"irn"}],pairingTopic:w,proposer:{publicKey:b,metadata:this.client.metadata},expiryTimestamp:or(hk.wc_sessionPropose.req.ttl),id:(0,r9.payloadId)()},{done:A,resolve:_,reject:S}=ot(E,"Request expired"),P=(0,r9.payloadId)(),O=os("session_connect",N.id),T=os("session_request",P),R=async({error:e,session:t})=>{this.events.off(T,k),e?S(e):t&&_({session:t})},k=async e=>{var r,i,s;let a;if(await this.deletePendingAuthRequest(P,{message:"fulfilled",code:0}),e.error){let t=hl("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(O,R),S(e.error.message))}await this.deleteProposal(N.id),this.events.off(O,R);let{cacaos:o,responder:c}=e.result,l=[],h=[];for(let e of o){await o8({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),S(hl("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:t}=e,r=ci(t.resources),i=[o3(t.iss)],s=o4(t.iss);if(r){let e=ct(r),t=cr(r);l.push(...e),i.push(...t)}for(let e of i)h.push(`${e}:${s}`)}let d=await this.client.core.crypto.generateSharedKey(b,c.publicKey);l.length>0&&(a={topic:d,acknowledged:!0,self:{publicKey:b,metadata:this.client.metadata},peer:c,controller:c.publicKey,expiry:or(hR),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:w,namespaces:hn([...new Set(l)],[...new Set(h)]),transportType:n},await this.client.core.relayer.subscribe(d,{transportType:n}),await this.client.session.set(d,a),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:c.metadata}),a=this.client.session.get(d)),null!=(r=this.client.metadata.redirect)&&r.linkMode&&null!=(i=c.metadata.redirect)&&i.linkMode&&null!=(s=c.metadata.redirect)&&s.universal&&t&&(this.client.core.addLinkModeSupportedApp(c.metadata.redirect.universal),this.client.session.update(d,{transportType:ig.link_mode})),_({auths:o,session:a})};this.events.once(O,R),this.events.once(T,k);try{if(s){let e=(0,r9.formatJsonRpcRequest)("wc_sessionAuthenticate",C,P);this.client.core.history.set(w,e);let r=await this.client.core.crypto.encode("",e,{type:2,encoding:lX});i=l1(t,w,r)}else await Promise.all([this.sendRequest({topic:w,method:"wc_sessionAuthenticate",params:C,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:P}),this.sendRequest({topic:w,method:"wc_sessionPropose",params:N,expiry:hk.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:N.id})])}catch(e){throw this.events.off(O,R),this.events.off(T,k),e}return await this.setProposal(N.id,N),await this.setAuthRequest(P,{request:hK(hV({},C),{verifyContext:{}}),pairingTopic:w,transportType:n}),{uri:i??y,response:A}}),hG(this,"approveSessionAuthenticate",async e=>{let t;let{id:r,auths:i}=e,s=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[iT.authenticated_session_approve_started]}});try{this.isInitialized()}catch(e){throw s.setError(iR.no_internet_connection),e}let n=this.getPendingAuthRequest(r);if(!n)throw s.setError(iR.authenticated_session_pending_request_not_found),Error(`Could not find pending auth request with id ${r}`);let a=n.transportType||ig.relay;a===ig.relay&&await this.confirmOnlineStateOrThrow();let o=n.requester.publicKey,c=await this.client.core.crypto.generateKeyPair(),l=lQ(o),h={type:1,receiverPublicKey:o,senderPublicKey:c},d=[],u=[];for(let e of i){if(!await o8({cacao:e,projectId:this.client.core.projectId})){s.setError(iR.invalid_cacao);let e=hl("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:l,error:e,encodeOpts:h}),Error(e.message)}s.addTrace(iT.cacaos_verified);let{p:t}=e,i=ci(t.resources),n=[o3(t.iss)],a=o4(t.iss);if(i){let e=ct(i),t=cr(i);d.push(...e),n.push(...t)}for(let e of n)u.push(`${e}:${a}`)}let p=await this.client.core.crypto.generateSharedKey(c,o);if(s.addTrace(iT.create_authenticated_session_topic),d?.length>0){t={topic:p,acknowledged:!0,self:{publicKey:c,metadata:this.client.metadata},peer:{publicKey:o,metadata:n.requester.metadata},controller:o,expiry:or(hR),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:n.pairingTopic,namespaces:hn([...new Set(d)],[...new Set(u)]),transportType:a},s.addTrace(iT.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(e){throw s.setError(iR.subscribe_authenticated_session_topic_failure),e}s.addTrace(iT.subscribe_authenticated_session_topic_success),await this.client.session.set(p,t),s.addTrace(iT.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:n.pairingTopic,metadata:n.requester.metadata})}s.addTrace(iT.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:r,result:{cacaos:i,responder:{publicKey:c,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(n.requester.metadata,a)})}catch(e){throw s.setError(iR.authenticated_session_approve_publish_failure),e}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:n.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:t}}),hG(this,"rejectSessionAuthenticate",async e=>{this.isInitialized();let{id:t,reason:r}=e,i=this.getPendingAuthRequest(t);if(!i)throw Error(`Could not find pending auth request with id ${t}`);i.transportType===ig.relay&&await this.confirmOnlineStateOrThrow();let s=i.requester.publicKey,n=await this.client.core.crypto.generateKeyPair(),a=lQ(s);await this.sendError({id:t,topic:a,error:r,encodeOpts:{type:1,receiverPublicKey:s,senderPublicKey:n},rpcOpts:hk.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.client.proposal.delete(t,hl("USER_DISCONNECTED"))}),hG(this,"formatAuthMessage",e=>{this.isInitialized();let{request:t,iss:r}=e;return o6(t,r)}),hG(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)}),hG(this,"cleanupDuplicatePairings",async e=>{if(e.pairingTopic)try{let t=this.client.core.pairing.pairings.get(e.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter(r=>{var i,s;return(null==(i=r.peerMetadata)?void 0:i.url)&&(null==(s=r.peerMetadata)?void 0:s.url)===e.peer.metadata.url&&r.topic&&r.topic!==t.topic});if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map(e=>this.client.core.pairing.disconnect({topic:e.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}}),hG(this,"deleteSession",async e=>{var t;let{topic:r,expirerHasDeleted:i=!1,emitEvent:s=!0,id:n=0}=e,{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await this.client.session.delete(r,hl("USER_DISCONNECTED")),this.addToRecentlyDeleted(r,"session"),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r),this.client.core.storage.removeItem(hO).catch(e=>this.client.logger.warn(e)),this.getPendingSessionRequests().forEach(e=>{e.topic===r&&this.deletePendingSessionRequest(e.id,hl("USER_DISCONNECTED"))}),r===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=hU.idle),s&&this.client.events.emit("session_delete",{id:n,topic:r})}),hG(this,"deleteProposal",async(e,t)=>{if(t)try{let t=this.client.proposal.get(e),r=this.client.core.eventClient.getEvent({topic:t.pairingTopic});r?.setError(iO.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(e,hl("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")}),hG(this,"deletePendingSessionRequest",async(e,t,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(t=>t.id!==e),r&&(this.sessionRequestQueue.state=hU.idle,this.client.events.emit("session_request_expire",{id:e}))}),hG(this,"deletePendingAuthRequest",async(e,t,r=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)])}),hG(this,"setExpiry",async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))}),hG(this,"setProposal",async(e,t)=>{this.client.core.expirer.set(e,or(hk.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)}),hG(this,"setAuthRequest",async(e,t)=>{let{request:r,pairingTopic:i,transportType:s=ig.relay}=t;this.client.core.expirer.set(e,r.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:r.authPayload,requester:r.requester,expiryTimestamp:r.expiryTimestamp,id:e,pairingTopic:i,verifyContext:r.verifyContext,transportType:s})}),hG(this,"setPendingSessionRequest",async e=>{let{id:t,topic:r,params:i,verifyContext:s}=e,n=i.request.expiryTimestamp||or(hk.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,n),await this.client.pendingRequest.set(t,{id:t,topic:r,params:i,verifyContext:s})}),hG(this,"sendRequest",async e=>{let t,i;let{topic:s,method:n,params:a,expiry:o,relayRpcId:c,clientRpcId:l,throwOnFailedPublish:h,appLink:d,tvf:u}=e,p=(0,r9.formatJsonRpcRequest)(n,a,l),g=!!d;try{t=await this.client.core.crypto.encode(s,p,{encoding:g?lX:lZ})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${s} failed`),e}if(hL.includes(n)){let e=l0(JSON.stringify(p)),r=l0(t);i=await this.client.core.verify.register({id:r,decryptedId:e})}let f=hk[n].req;if(f.attestation=i,o&&(f.ttl=o),c&&(f.id=c),this.client.core.history.set(s,p),g){let e=l1(d,s,t);await r.g.Linking.openURL(e,this.client.name)}else{let e=hk[n].req;o&&(e.ttl=o),c&&(e.id=c),e.tvf=hK(hV({},u),{correlationId:p.id}),h?(e.internal=hK(hV({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,t,e)):this.client.core.relayer.publish(s,t,e).catch(e=>this.client.logger.error(e))}return p.id}),hG(this,"sendResult",async e=>{let t,i,s;let{id:n,topic:a,result:o,throwOnFailedPublish:c,encodeOpts:l,appLink:h}=e,d=(0,r9.formatJsonRpcResult)(n,o),u=h&&"u">typeof(null==r.g?void 0:r.g.Linking);try{t=await this.client.core.crypto.encode(a,d,hK(hV({},l||{}),{encoding:u?lX:lZ}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${a} failed`),e}try{i=await this.client.core.history.get(a,n);let e=i.request;try{this.shouldSetTVF(e.method,e.params)&&(s=this.getTVFParams(n,e.params,o))}catch(e){this.client.logger.warn("sendResult() -> getTVFParams() failed",e)}}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${a}, ${n}) failed`),e}if(u){let e=l1(h,a,t);await r.g.Linking.openURL(e,this.client.name)}else{let e=i.request.method,r=hk[e].res;r.tvf=hK(hV({},s),{correlationId:n}),c?(r.internal=hK(hV({},r.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,t,r)):this.client.core.relayer.publish(a,t,r).catch(e=>this.client.logger.error(e))}await this.client.core.history.resolve(d)}),hG(this,"sendError",async e=>{let t,i;let{id:s,topic:n,error:a,encodeOpts:o,rpcOpts:c,appLink:l}=e,h=(0,r9.formatJsonRpcError)(s,a),d=l&&"u">typeof(null==r.g?void 0:r.g.Linking);try{t=await this.client.core.crypto.encode(n,h,hK(hV({},o||{}),{encoding:d?lX:lZ}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),e}try{i=await this.client.core.history.get(n,s)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${n}, ${s}) failed`),e}if(d){let e=l1(l,n,t);await r.g.Linking.openURL(e,this.client.name)}else{let e=i.request.method,r=c||hk[e].res;this.client.core.relayer.publish(n,t,r)}await this.client.core.history.resolve(h)}),hG(this,"cleanup",async()=>{let e=[],t=[];this.client.session.getAll().forEach(t=>{let r=!1;oi(t.expiry)&&(r=!0),this.client.core.crypto.keychain.has(t.topic)||(r=!0),r&&e.push(t.topic)}),this.client.proposal.getAll().forEach(e=>{oi(e.expiryTimestamp)&&t.push(e.id)}),await Promise.all([...e.map(e=>this.deleteSession({topic:e})),...t.map(e=>this.deleteProposal(e))])}),hG(this,"onProviderMessageEvent",async e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):await this.onRelayMessage(e)}),hG(this,"onRelayEventRequest",async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()}),hG(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===hU.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=hU.active;let e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=hU.idle}),hG(this,"processRequest",async e=>{let{topic:t,payload:r,attestation:i,transportType:s,encryptedId:n}=e,a=r.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:a}))switch(a){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:r,attestation:i,encryptedId:n});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,r);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,r);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,r);case"wc_sessionPing":return await this.onSessionPingRequest(t,r);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,r);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:r,attestation:i,encryptedId:n,transportType:s});case"wc_sessionEvent":return await this.onSessionEventRequest(t,r);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:r,attestation:i,encryptedId:n,transportType:s});default:return this.client.logger.info(`Unsupported request method ${a}`)}}),hG(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r,transportType:i}=e,s=(await this.client.core.history.get(t,r.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(t,r,i);case"wc_sessionSettle":return this.onSessionSettleResponse(t,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,r);case"wc_sessionExtend":return this.onSessionExtendResponse(t,r);case"wc_sessionPing":return this.onSessionPingResponse(t,r);case"wc_sessionRequest":return this.onSessionRequestResponse(t,r);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,r);default:return this.client.logger.info(`Unsupported response method ${s}`)}}),hG(this,"onRelayEventUnknownPayload",e=>{let{topic:t}=e,{message:r}=hc("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw Error(r)}),hG(this,"shouldIgnorePairingRequest",e=>{let{topic:t,requestMethod:r}=e,i=this.expectedPairingMethodMap.get(t);return!(!i||i.includes(r))&&!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),hG(this,"onSessionProposeRequest",async e=>{let{topic:t,payload:r,attestation:i,encryptedId:s}=e,{params:n,id:a}=r;try{let e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError(iS.proposal_listener_not_found)),this.isValidConnect(hV({},r.params));let o=n.expiryTimestamp||or(hk.wc_sessionPropose.req.ttl),c=hV({id:a,pairingTopic:t,expiryTimestamp:o},n);await this.setProposal(a,c);let l=await this.getVerifyContext({attestationId:i,hash:l0(JSON.stringify(r)),encryptedId:s,metadata:c.proposer.metadata});e?.addTrace(i_.emit_session_proposal),this.client.events.emit("session_proposal",{id:a,params:c,verifyContext:l})}catch(e){await this.sendError({id:a,topic:t,error:e,rpcOpts:hk.wc_sessionPropose.autoReject}),this.client.logger.error(e)}}),hG(this,"onSessionProposeResponse",async(e,t,r)=>{let{id:i}=t;if((0,r9.isJsonRpcResult)(t)){let{result:s}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});let n=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:n});let a=n.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:a});let o=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:o});let c=await this.client.core.crypto.generateSharedKey(a,o);this.pendingSessions.set(i,{sessionTopic:c,pairingTopic:e,proposalId:i,publicKey:a});let l=await this.client.core.relayer.subscribe(c,{transportType:r});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:e})}else if((0,r9.isJsonRpcError)(t)){await this.client.proposal.delete(i,hl("USER_DISCONNECTED"));let e=os("session_connect",i);if(0===this.events.listenerCount(e))throw Error(`emitting ${e} without any listeners, 954`);this.events.emit(e,{error:t.error})}}),hG(this,"onSessionSettleRequest",async(e,t)=>{let{id:r,params:i}=t;try{this.isValidSessionSettleRequest(i);let{relay:r,controller:s,expiry:n,namespaces:a,sessionProperties:o,scopedProperties:c,sessionConfig:l}=t.params,h=[...this.pendingSessions.values()].find(t=>t.sessionTopic===e);if(!h)return this.client.logger.error(`Pending session not found for topic ${e}`);let d=this.client.proposal.get(h.proposalId),u=hK(hV(hV(hV({topic:e,relay:r,expiry:n,namespaces:a,acknowledged:!0,pairingTopic:h.pairingTopic,requiredNamespaces:d.requiredNamespaces,optionalNamespaces:d.optionalNamespaces,controller:s.publicKey,self:{publicKey:h.publicKey,metadata:this.client.metadata},peer:{publicKey:s.publicKey,metadata:s.metadata}},o&&{sessionProperties:o}),c&&{scopedProperties:c}),l&&{sessionConfig:l}),{transportType:ig.relay});await this.client.session.set(u.topic,u),await this.setExpiry(u.topic,u.expiry),await this.client.core.pairing.updateMetadata({topic:h.pairingTopic,metadata:u.peer.metadata}),this.client.events.emit("session_connect",{session:u}),this.events.emit(os("session_connect",h.proposalId),{session:u}),this.pendingSessions.delete(h.proposalId),this.deleteProposal(h.proposalId,!1),this.cleanupDuplicatePairings(u),await this.sendResult({id:t.id,topic:e,result:!0,throwOnFailedPublish:!0})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),hG(this,"onSessionSettleResponse",async(e,t)=>{let{id:r}=t;(0,r9.isJsonRpcResult)(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(os("session_approve",r),{})):(0,r9.isJsonRpcError)(t)&&(await this.client.session.delete(e,hl("USER_DISCONNECTED")),this.events.emit(os("session_approve",r),{error:t.error}))}),hG(this,"onSessionUpdateRequest",async(e,t)=>{let{params:r,id:i}=t;try{let t=`${e}_session_update`,s=hA.get(t);if(s&&this.isRequestOutOfSync(s,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:e,error:hl("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(hV({topic:e},r));try{hA.set(t,i),await this.client.session.update(e,{namespaces:r.namespaces}),await this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0})}catch(e){throw hA.delete(t),e}this.client.events.emit("session_update",{id:i,topic:e,params:r})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),hG(this,"isRequestOutOfSync",(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3)),hG(this,"onSessionUpdateResponse",(e,t)=>{let{id:r}=t,i=os("session_update",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,r9.isJsonRpcResult)(t)?this.events.emit(os("session_update",r),{}):(0,r9.isJsonRpcError)(t)&&this.events.emit(os("session_update",r),{error:t.error})}),hG(this,"onSessionExtendRequest",async(e,t)=>{let{id:r}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,or(hR)),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),hG(this,"onSessionExtendResponse",(e,t)=>{let{id:r}=t,i=os("session_extend",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,r9.isJsonRpcResult)(t)?this.events.emit(os("session_extend",r),{}):(0,r9.isJsonRpcError)(t)&&this.events.emit(os("session_extend",r),{error:t.error})}),hG(this,"onSessionPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),hG(this,"onSessionPingResponse",(e,t)=>{let{id:r}=t,i=os("session_ping",r);setTimeout(()=>{if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners 2176`);(0,r9.isJsonRpcResult)(t)?this.events.emit(os("session_ping",r),{}):(0,r9.isJsonRpcError)(t)&&this.events.emit(os("session_ping",r),{error:t.error})},500)}),hG(this,"onSessionDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),Promise.all([new Promise(t=>{this.client.core.relayer.once(id.publish,async()=>{t(await this.deleteSession({topic:e,id:r}))})}),this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:hl("USER_DISCONNECTED")})]).catch(e=>this.client.logger.error(e))}catch(e){this.client.logger.error(e)}}),hG(this,"onSessionRequest",async e=>{var t,r,i;let{topic:s,payload:n,attestation:a,encryptedId:o,transportType:c}=e,{id:l,params:h}=n;try{await this.isValidRequest(hV({topic:s},h));let e=this.client.session.get(s),n=await this.getVerifyContext({attestationId:a,hash:l0(JSON.stringify((0,r9.formatJsonRpcRequest)("wc_sessionRequest",h,l))),encryptedId:o,metadata:e.peer.metadata,transportType:c}),d={id:l,topic:s,params:h,verifyContext:n};await this.setPendingSessionRequest(d),c===ig.link_mode&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(r=e.peer.metadata.redirect)?void 0:r.universal),null!=(i=this.client.signConfig)&&i.disableRequestQueue?this.emitSessionRequest(d):(this.addSessionRequestToSessionRequestQueue(d),this.processSessionRequestQueue())}catch(e){await this.sendError({id:l,topic:s,error:e}),this.client.logger.error(e)}}),hG(this,"onSessionRequestResponse",(e,t)=>{let{id:r}=t,i=os("session_request",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,r9.isJsonRpcResult)(t)?this.events.emit(os("session_request",r),{result:t.result}):(0,r9.isJsonRpcError)(t)&&this.events.emit(os("session_request",r),{error:t.error})}),hG(this,"onSessionEventRequest",async(e,t)=>{let{id:r,params:i}=t;try{let t=`${e}_session_event_${i.event.name}`,s=hA.get(t);if(s&&this.isRequestOutOfSync(s,r)){this.client.logger.info(`Discarding out of sync request - ${r}`);return}this.isValidEmit(hV({topic:e},i)),this.client.events.emit("session_event",{id:r,topic:e,params:i}),hA.set(t,r)}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),hG(this,"onSessionAuthenticateResponse",(e,t)=>{let{id:r}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),(0,r9.isJsonRpcResult)(t)?this.events.emit(os("session_request",r),{result:t.result}):(0,r9.isJsonRpcError)(t)&&this.events.emit(os("session_request",r),{error:t.error})}),hG(this,"onSessionAuthenticateRequest",async e=>{var t;let{topic:r,payload:i,attestation:s,encryptedId:n,transportType:a}=e;try{let{requester:e,authPayload:o,expiryTimestamp:c}=i.params,l=await this.getVerifyContext({attestationId:s,hash:l0(JSON.stringify(i)),encryptedId:n,metadata:e.metadata,transportType:a}),h={requester:e,pairingTopic:r,id:i.id,authPayload:o,verifyContext:l,expiryTimestamp:c};await this.setAuthRequest(i.id,{request:h,pairingTopic:r,transportType:a}),a===ig.link_mode&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:r,params:i.params,id:i.id,verifyContext:l})}catch(n){this.client.logger.error(n);let e=i.params.requester.publicKey,t=await this.client.core.crypto.generateKeyPair(),s=this.getAppLinkIfEnabled(i.params.requester.metadata,a);await this.sendError({id:i.id,topic:r,error:n,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:t},rpcOpts:hk.wc_sessionAuthenticate.autoReject,appLink:s})}}),hG(this,"addSessionRequestToSessionRequestQueue",e=>{this.sessionRequestQueue.queue.push(e)}),hG(this,"cleanupAfterResponse",e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=hU.idle,this.processSessionRequestQueue()},(0,D.toMiliseconds)(this.requestQueueDelay))}),hG(this,"cleanupPendingSentRequestsForTopic",({topic:e,error:t})=>{let r=this.client.core.history.pending;r.length>0&&r.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{let r=e.request.id,i=os("session_request",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);this.events.emit(os("session_request",e.request.id),{error:t})})}),hG(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===hU.active){this.client.logger.info("session request queue is already active.");return}let e=this.sessionRequestQueue.queue[0];if(!e){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=hU.active,this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}}),hG(this,"emitSessionRequest",e=>{this.client.events.emit("session_request",e)}),hG(this,"onPairingCreated",e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;let t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:(0,r9.formatJsonRpcRequest)("wc_sessionPropose",hK(hV({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties}),t.id)})}),hG(this,"isValidConnect",async e=>{let t;if(!hv(e)){let{message:t}=hc("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw Error(t)}let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:n,scopedProperties:a,relays:o}=e;if(hu(r)||await this.isValidPairingTopic(r),t=!1,o?o&&hh(o)&&o.length&&o.forEach(e=>{t=hb(e)}):t=!0,!t){let{message:e}=hc("MISSING_OR_INVALID",`connect() relays: ${o}`);throw Error(e)}if(!hu(i)&&0!==hd(i)){let e="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(e):this.client.logger.warn(e),this.validateNamespaces(i,"requiredNamespaces")}if(hu(s)||0===hd(s)||this.validateNamespaces(s,"optionalNamespaces"),hu(n)||this.validateSessionProps(n,"sessionProperties"),!hu(a)){this.validateSessionProps(a,"scopedProperties");let e=Object.keys(i||{}).concat(Object.keys(s||{}));if(!Object.keys(a).every(t=>e.includes(t)))throw Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(e)}`)}}),hG(this,"validateNamespaces",(e,t)=>{let r=function(e,t,r){let i=null;if(e&&hd(e)){let s;let n=hw(e,t);n&&(i=n);let a=(s=null,Object.entries(e).forEach(([e,i])=>{var n,a;let o;if(s)return;let c=(n=aY(e,i),a=`${t} ${r}`,o=null,hh(n)&&n.length?n.forEach(e=>{o||hf(e)||(o=hl("UNSUPPORTED_CHAINS",`${a}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):hf(e)||(o=hl("UNSUPPORTED_CHAINS",`${a}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),o);c&&(s=c)}),s);a&&(i=a)}else i=hc("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return i}(e,"connect()",t);if(r)throw Error(r.message)}),hG(this,"isValidApprove",async e=>{if(!hv(e))throw Error(hc("MISSING_OR_INVALID",`approve() params: ${e}`).message);let{id:t,namespaces:r,relayProtocol:i,sessionProperties:s,scopedProperties:n}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);let a=this.client.proposal.get(t),o=hy(r,"approve()");if(o)throw Error(o.message);let c=hC(a.requiredNamespaces,r,"approve()");if(c)throw Error(c.message);if(!hp(i,!0)){let{message:e}=hc("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw Error(e)}if(hu(s)||this.validateSessionProps(s,"sessionProperties"),!hu(n)){this.validateSessionProps(n,"scopedProperties");let e=new Set(Object.keys(r));if(!Object.keys(n).every(t=>e.has(t)))throw Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(n)}, approved namespaces: ${Array.from(e).join(", ")}`)}}),hG(this,"isValidReject",async e=>{if(!hv(e)){let{message:t}=hc("MISSING_OR_INVALID",`reject() params: ${e}`);throw Error(t)}let{id:t,reason:r}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!r||"object"!=typeof r||!r.code||!hg(r.code,!1)||!r.message||!hp(r.message,!1)){let{message:e}=hc("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw Error(e)}}),hG(this,"isValidSessionSettleRequest",e=>{let t;if(!hv(e)){let{message:t}=hc("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw Error(t)}let{relay:r,controller:i,namespaces:s,expiry:n}=e;if(!hb(r)){let{message:e}=hc("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(e)}let a=(t=null,hp(i?.publicKey,!1)||(t=hc("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),t);if(a)throw Error(a.message);let o=hy(s,"onSessionSettleRequest()");if(o)throw Error(o.message);if(oi(n)){let{message:e}=hc("EXPIRED","onSessionSettleRequest()");throw Error(e)}}),hG(this,"isValidUpdate",async e=>{if(!hv(e)){let{message:t}=hc("MISSING_OR_INVALID",`update() params: ${e}`);throw Error(t)}let{topic:t,namespaces:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);let i=this.client.session.get(t),s=hy(r,"update()");if(s)throw Error(s.message);let n=hC(i.requiredNamespaces,r,"update()");if(n)throw Error(n.message)}),hG(this,"isValidExtend",async e=>{if(!hv(e)){let{message:t}=hc("MISSING_OR_INVALID",`extend() params: ${e}`);throw Error(t)}let{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)}),hG(this,"isValidRequest",async e=>{var t;if(!hv(e)){let{message:t}=hc("MISSING_OR_INVALID",`request() params: ${e}`);throw Error(t)}let{topic:r,request:i,chainId:s,expiry:n}=e;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let{namespaces:a}=this.client.session.get(r);if(!hE(a,s)){let{message:e}=hc("MISSING_OR_INVALID",`request() chainId: ${s}`);throw Error(e)}if(hu(i)||!hp(i.method,!1)){let{message:e}=hc("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw Error(e)}if(!(hp(t=i.method,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{ht(e.accounts).includes(t)&&r.push(...e.methods)}),r})(a,s).includes(t))){let{message:e}=hc("MISSING_OR_INVALID",`request() method: ${i.method}`);throw Error(e)}if(n&&(!hg(n,!1)||!(n<=hx.max)||!(n>=hx.min))){let{message:e}=hc("MISSING_OR_INVALID",`request() expiry: ${n}. Expiry must be a number (in seconds) between ${hx.min} and ${hx.max}`);throw Error(e)}}),hG(this,"isValidRespond",async e=>{var t;if(!hv(e)){let{message:t}=hc("MISSING_OR_INVALID",`respond() params: ${e}`);throw Error(t)}let{topic:r,response:i}=e;try{await this.isValidSessionTopic(r)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(hu(i)||hu(i.result)&&hu(i.error)||!hg(i.id,!1)||!hp(i.jsonrpc,!1)){let{message:e}=hc("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw Error(e)}}),hG(this,"isValidPing",async e=>{if(!hv(e)){let{message:t}=hc("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),hG(this,"isValidEmit",async e=>{var t;if(!hv(e)){let{message:t}=hc("MISSING_OR_INVALID",`emit() params: ${e}`);throw Error(t)}let{topic:r,event:i,chainId:s}=e;await this.isValidSessionTopic(r);let{namespaces:n}=this.client.session.get(r);if(!hE(n,s)){let{message:e}=hc("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw Error(e)}if(hu(i)||!hp(i.name,!1)){let{message:e}=hc("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}if(!(hp(t=i.name,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{ht(e.accounts).includes(t)&&r.push(...e.events)}),r})(n,s).includes(t))){let{message:e}=hc("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}}),hG(this,"isValidDisconnect",async e=>{if(!hv(e)){let{message:t}=hc("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),hG(this,"isValidAuthenticate",e=>{let{chains:t,uri:r,domain:i,nonce:s}=e;if(!Array.isArray(t)||0===t.length)throw Error("chains is required and must be a non-empty array");if(!hp(r,!1))throw Error("uri is required parameter");if(!hp(i,!1))throw Error("domain is required parameter");if(!hp(s,!1))throw Error("nonce is required parameter");if([...new Set(t.map(e=>aJ(e).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:n}=aJ(t[0]);if("eip155"!==n)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),hG(this,"getVerifyContext",async e=>{let{attestationId:t,hash:r,encryptedId:i,metadata:s,transportType:n}=e,a={verified:{verifyUrl:s.verifyUrl||iI,validation:"UNKNOWN",origin:s.url||""}};try{if(n===ig.link_mode){let e=this.getAppLinkIfEnabled(s,n);return a.verified.validation=e&&new URL(e).origin===new URL(s.url).origin?"VALID":"INVALID",a}let e=await this.client.core.verify.resolve({attestationId:t,hash:r,encryptedId:i,verifyUrl:s.verifyUrl});e&&(a.verified.origin=e.origin,a.verified.isScam=e.isScam,a.verified.validation=e.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(a)}`),a}),hG(this,"validateSessionProps",(e,t)=>{Object.values(e).forEach((r,i)=>{if(null==r){let{message:s}=hc("MISSING_OR_INVALID",`${t} must contain an existing value for each key. Received: ${r} for key ${Object.keys(e)[i]}`);throw Error(s)}})}),hG(this,"getPendingAuthRequest",e=>{let t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),hG(this,"addToRecentlyDeleted",(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0,t=this.recentlyDeletedLimit/2;for(let r of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(r)}}}),hG(this,"checkRecentlyDeleted",e=>{let t=this.recentlyDeletedMap.get(e);if(t){let{message:r}=hc("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw Error(r)}}),hG(this,"isLinkModeEnabled",(e,t)=>{var i,s,n,a,o,c,l,h,d;return!!e&&t===ig.link_mode&&(null==(s=null==(i=this.client.metadata)?void 0:i.redirect)?void 0:s.linkMode)===!0&&(null==(a=null==(n=this.client.metadata)?void 0:n.redirect)?void 0:a.universal)!==void 0&&(null==(c=null==(o=this.client.metadata)?void 0:o.redirect)?void 0:c.universal)!==""&&(null==(l=e?.redirect)?void 0:l.universal)!==void 0&&(null==(h=e?.redirect)?void 0:h.universal)!==""&&(null==(d=e?.redirect)?void 0:d.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&"u">typeof(null==r.g?void 0:r.g.Linking)}),hG(this,"getAppLinkIfEnabled",(e,t)=>{var r;return this.isLinkModeEnabled(e,t)?null==(r=e?.redirect)?void 0:r.universal:void 0}),hG(this,"handleLinkModeMessage",({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;let t=oc(e,"topic")||"",r=decodeURIComponent(oc(e,"wc_ev")||""),i=this.client.session.keys.includes(t);i&&this.client.session.update(t,{transportType:ig.link_mode}),this.client.core.dispatchEnvelope({topic:t,message:r,sessionExists:i})}),hG(this,"registerLinkModeListeners",async()=>{var e;if("u">typeof aK&&"true"===aK.env.IS_VITEST||a9()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){let e=null==r.g?void 0:r.g.Linking;if("u">typeof e){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);let t=await e.getInitialURL();t&&setTimeout(()=>{this.handleLinkModeMessage({url:t})},50)}}}),hG(this,"shouldSetTVF",(e,t)=>{if(!t||"wc_sessionRequest"!==e)return!1;let{request:r}=t;return Object.keys(hD).includes(r.method)}),hG(this,"getTVFParams",(e,t,r)=>{var i,s;try{let n=t.request.method,a=this.extractTxHashesFromResult(n,r);return hK(hV({correlationId:e,rpcMethods:[n],chainId:t.chainId},this.isValidContractData(t.request.params)&&{contractAddresses:[null==(s=null==(i=t.request.params)?void 0:i[0])?void 0:s.to]}),{txHashes:a})}catch(e){this.client.logger.warn("Error getting TVF params",e)}return{}}),hG(this,"isValidContractData",e=>{var t;if(!e)return!1;try{let r=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!r.startsWith("0x"))return!1;let i=r.slice(2);return!!/^[0-9a-fA-F]*$/.test(i)&&i.length%2==0}catch{}return!1}),hG(this,"extractTxHashesFromResult",(e,t)=>{try{let r=hD[e];if("string"==typeof t)return[t];let i=t[r.key];if(hh(i))return"solana_signAllTransactions"===e?i.map(e=>(function(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);let i=r[0];if(0===i)throw Error("No signatures found");if(r.length<1+64*i)throw Error("Transaction data too short for claimed signature count");if(r.length<100)throw Error("Transaction too short");let s=aG.from(e,"base64").slice(1,65);return $.Z.encode(s)})(e)):i;if("string"==typeof i)return[i]}catch(e){this.client.logger.warn("Error extracting tx hashes from result",e)}return[]})}async processPendingMessageEvents(){try{let e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(let[e,r]of Object.entries(t))for(let t of r)try{await this.onProviderMessageEvent({topic:e,message:t,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${e}, message: ${t}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){let{message:e}=hc("NOT_INITIALIZED",this.name);throw Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(id.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){let{topic:t,message:r,attestation:i,transportType:s}=e,{publicKey:n}=this.client.auth.authKeys.keys.includes(hB)?this.client.auth.authKeys.get(hB):{responseTopic:void 0,publicKey:void 0};try{let e=await this.client.core.crypto.decode(t,r,{receiverPublicKey:n,encoding:s===ig.link_mode?lX:lZ});(0,r9.isJsonRpcRequest)(e)?(this.client.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e,attestation:i,transportType:s,encryptedId:l0(r)})):(0,r9.isJsonRpcResponse)(e)?(await this.client.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e,transportType:s}),this.client.core.history.delete(t,e.id)):await this.onRelayEventUnknownPayload({topic:t,payload:e,transportType:s}),await this.client.core.relayer.messages.ack(t,r)}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(iC.expired,async e=>{let{topic:t,id:r}=function(e){let[t,r]=e.split(":"),i={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)i.topic=r;else if("id"===t&&Number.isInteger(Number(r)))i.id=Number(r);else throw Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return i}(e.target);return r&&this.client.pendingRequest.keys.includes(r)?await this.deletePendingSessionRequest(r,hc("EXPIRED"),!0):r&&this.client.auth.requests.keys.includes(r)?await this.deletePendingAuthRequest(r,hc("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r})))})}registerPairingEvents(){this.client.core.pairing.events.on(iv.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(iv.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!hp(e,!1)){let{message:t}=hc("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=hc("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(oi(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=hc("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}async isValidSessionTopic(e){if(!hp(e,!1)){let{message:t}=hc("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){let{message:t}=hc("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw Error(t)}if(oi(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});let{message:t}=hc("EXPIRED",`session topic: ${e}`);throw Error(t)}if(!this.client.core.crypto.keychain.has(e)){let{message:t}=hc("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(hp(e,!1)){let{message:t}=hc("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw Error(t)}else{let{message:t}=hc("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw Error(t)}}async isValidProposalId(e){if("number"!=typeof e){let{message:t}=hc("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=hc("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw Error(t)}if(oi(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);let{message:t}=hc("EXPIRED",`proposal id: ${e}`);throw Error(t)}}}class hY extends n${constructor(e,t){super(e,t,"proposal",hS),this.core=e,this.logger=t}}class hZ extends n${constructor(e,t){super(e,t,"session",hS),this.core=e,this.logger=t}}class hX extends n${constructor(e,t){super(e,t,"request",hS,e=>e.id),this.core=e,this.logger=t}}class hQ extends n${constructor(e,t){super(e,t,"authKeys",hM,()=>hB),this.core=e,this.logger=t}}class h0 extends n${constructor(e,t){super(e,t,"pairingTopics",hM),this.core=e,this.logger=t}}class h1 extends n${constructor(e,t){super(e,t,"requests",hM,e=>e.id),this.core=e,this.logger=t}}var h2=Object.defineProperty,h5=(e,t,r)=>t in e?h2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h3=(e,t,r)=>h5(e,"symbol"!=typeof t?t+"":t,r);class h4{constructor(e,t){this.core=e,this.logger=t,h3(this,"authKeys"),h3(this,"pairingTopics"),h3(this,"requests"),this.authKeys=new hQ(this.core,this.logger),this.pairingTopics=new h0(this.core,this.logger),this.requests=new h1(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var h8=Object.defineProperty,h6=(e,t,r)=>t in e?h8(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h9=(e,t,r)=>h6(e,"symbol"!=typeof t?t+"":t,r);class h7 extends aw{constructor(e){super(e),h9(this,"protocol","wc"),h9(this,"version",2),h9(this,"name",hP.name),h9(this,"metadata"),h9(this,"core"),h9(this,"logger"),h9(this,"events",new u.EventEmitter),h9(this,"engine"),h9(this,"session"),h9(this,"proposal"),h9(this,"pendingRequest"),h9(this,"auth"),h9(this,"signConfig"),h9(this,"on",(e,t)=>this.events.on(e,t)),h9(this,"once",(e,t)=>this.events.once(e,t)),h9(this,"off",(e,t)=>this.events.off(e,t)),h9(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),h9(this,"removeAllListeners",e=>this.events.removeAllListeners(e)),h9(this,"connect",async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"pair",async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"approve",async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"reject",async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"update",async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"extend",async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"request",async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"respond",async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"ping",async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"emit",async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"disconnect",async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"find",e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}}),h9(this,"authenticate",async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"formatAuthMessage",e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"approveSessionAuthenticate",async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),h9(this,"rejectSessionAuthenticate",async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),this.name=e?.name||hP.name,this.metadata=function(e){var t,r;let i=(0,q.D)()||{name:"",description:"",url:"",icons:[""]};try{return null!=e&&e.url&&i.url&&new URL(e.url).host!==new URL(i.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${i.url}. This is probably unintended and can lead to issues.`),e.url=i.url),null!=(t=e?.icons)&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(e=>""!==e)),a4(a3(a3({},i),e),{url:e?.url||i.url,name:e?.name||i.name,description:e?.description||i.description,icons:null!=(r=e?.icons)&&r.length&&e.icons.length>0?e.icons:i.icons})}catch(t){return console.warn("Error populating app metadata",t),e||i}}(e?.metadata),this.signConfig=e?.signConfig;let t="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,m.gw)((0,m.jI)({level:e?.logger||hP.logger}));this.core=e?.core||new ap(e),this.logger=(0,m.Ep)(t,this.name),this.session=new hZ(this.core,this.logger),this.proposal=new hY(this.core,this.logger),this.pendingRequest=new hX(this.core,this.logger),this.engine=new hJ(this),this.auth=new h4(this.core,this.logger)}static async init(e){let t=new h7(e);return await t.initialize(),t}get context(){return(0,m.Fd)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},(0,D.toMiliseconds)(D.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var de=r(66282),dt=r(48834).Buffer;let dr="error",di="wc@2:universal_provider:",ds="https://rpc.walletconnect.org/v1/",dn="generic",da=`${ds}bundler`,dc={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function dl(){}function dh(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function dd(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function du(e){return"object"==typeof e&&null!==e}function dp(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function dg(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}let df="[object String]",dm="[object Number]",dw="[object Boolean]",dy="[object Arguments]";function db(e,t,r,i=new Map,s){let n=s?.(e,t,r,i);if(null!=n)return n;if(dh(e))return e;if(i.has(e))return i.get(e);if(Array.isArray(e)){let t=Array(e.length);i.set(e,t);for(let n=0;n<e.length;n++)t[n]=db(e[n],n,r,i,s);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){let t=new Map;for(let[n,a]of(i.set(e,t),e))t.set(n,db(a,n,r,i,s));return t}if(e instanceof Set){let t=new Set;for(let n of(i.set(e,t),e))t.add(db(n,void 0,r,i,s));return t}if("u">typeof dt&&dt.isBuffer(e))return e.subarray();if(dd(e)){let t=new(Object.getPrototypeOf(e)).constructor(e.length);i.set(e,t);for(let n=0;n<e.length;n++)t[n]=db(e[n],n,r,i,s);return t}if(e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return i.set(e,t),dv(t,e,r,i,s),t}if("u">typeof File&&e instanceof File){let t=new File([e],e.name,{type:e.type});return i.set(e,t),dv(t,e,r,i,s),t}if(e instanceof Blob){let t=new Blob([e],{type:e.type});return i.set(e,t),dv(t,e,r,i,s),t}if(e instanceof Error){let t=new e.constructor;return i.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,dv(t,e,r,i,s),t}if("object"==typeof e&&function(e){switch(dg(e)){case dy:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case dw:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case dm:case"[object Object]":case"[object RegExp]":case"[object Set]":case df:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(e)){let t=Object.create(Object.getPrototypeOf(e));return i.set(e,t),dv(t,e,r,i,s),t}return e}function dv(e,t,r=e,i,s){let n=[...Object.keys(t),...dp(t)];for(let a=0;a<n.length;a++){let o=n[a],c=Object.getOwnPropertyDescriptor(e,o);(null==c||c.writable)&&(e[o]=db(t[o],o,r,i,s))}}function dE(e){var t;return t=(t,r,i,s)=>{let n=void 0;if(null!=n)return n;if("object"==typeof e)switch(Object.prototype.toString.call(e)){case dm:case df:case dw:{let t=new e.constructor(e?.valueOf());return dv(t,e),t}case dy:{let t={};return dv(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}},db(e,void 0,e,new Map,t)}function dC(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===dg(e)}var dI=Object.defineProperty,dN=Object.defineProperties,dA=Object.getOwnPropertyDescriptors,d_=Object.getOwnPropertySymbols,dS=Object.prototype.hasOwnProperty,dP=Object.prototype.propertyIsEnumerable,dO=(e,t,r)=>t in e?dI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,dT=(e,t)=>{for(var r in t||(t={}))dS.call(t,r)&&dO(e,r,t[r]);if(d_)for(var r of d_(t))dP.call(t,r)&&dO(e,r,t[r]);return e},dR=(e,t)=>dN(e,dA(t));function dk(e,t,r){var i;let s=aJ(e);return(null==(i=t.rpcMap)?void 0:i[s.reference])||`${ds}?chainId=${s.namespace}:${s.reference}&projectId=${r}`}function dx(e){return e.includes(":")?e.split(":")[1]:e}function dU(e){return e.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function dD(e={},t={}){let r=dL(e),i=dL(t);return function(e,...t){return function(e,...t){let r=t.slice(0,-1),i=t[t.length-1],s=e;for(let e=0;e<r.length;e++){let t=r[e];s=function e(t,r,i,s){if(dh(t)&&(t=Object(t)),null==r||"object"!=typeof r)return t;if(s.has(r))return function(e){if(dh(e))return e;if(Array.isArray(e)||dd(e)||e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);let t=Object.getPrototypeOf(e),r=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new r(e);if(e instanceof RegExp){let t=new r(e);return t.lastIndex=e.lastIndex,t}if(e instanceof DataView)return new r(e.buffer.slice(0));if(e instanceof Error){let t=new r(e.message);return t.stack=e.stack,t.name=e.name,t.cause=e.cause,t}if("u">typeof File&&e instanceof File)return new r([e],e.name,{type:e.type,lastModified:e.lastModified});if("object"==typeof e){let r=Object.create(t);return Object.assign(r,e)}return e}(s.get(r));if(s.set(r,t),Array.isArray(r)){r=r.slice();for(let e=0;e<r.length;e++)r[e]=r[e]??void 0}let n=[...Object.keys(r),...dp(r)];for(let a=0;a<n.length;a++){let o=n[a],c=r[o],l=t[o];if(dC(c)&&(c={...c}),dC(l)&&(l={...l}),"u">typeof dt&&dt.isBuffer(c)&&(c=dE(c)),Array.isArray(c)){if("object"==typeof l&&null!=l){let e=[],t=Reflect.ownKeys(l);for(let r=0;r<t.length;r++){let i=t[r];e[i]=l[i]}l=e}else l=[]}let h=i(l,c,o,t,r,s);null!=h?t[o]=h:Array.isArray(c)||du(l)&&du(c)?t[o]=e(l,c,i,s):null==l&&function(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){let t=e[Symbol.toStringTag];return!!(null!=t&&Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable)&&e.toString()===`[object ${t}]`}let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(c)?t[o]=e({},c,i,s):null==l&&dd(c)?t[o]=dE(c):(void 0===l||void 0!==c)&&(t[o]=c)}return t}(s,t,i,new Map)}return s}(e,...t,dl)}(r,i)}function dL(e){var t,r,i,s,n;let a={};if(!hd(e))return a;for(let[o,c]of Object.entries(e)){let e=hr(o)?[o]:c.chains,l=c.methods||[],h=c.events||[],d=c.rpcMap||{},u=hi(o);a[u]=dR(dT(dT({},a[u]),c),{chains:on(e,null==(t=a[u])?void 0:t.chains),methods:on(l,null==(r=a[u])?void 0:r.methods),events:on(h,null==(i=a[u])?void 0:i.events)}),(hd(d)||hd((null==(s=a[u])?void 0:s.rpcMap)||{}))&&(a[u].rpcMap=dT(dT({},d),null==(n=a[u])?void 0:n.rpcMap))}return a}function dM(e){return e.includes(":")?e.split(":")[2]:e}function dB(e){let t={};for(let[r,i]of Object.entries(e)){let e=i.methods||[],s=i.events||[],n=i.accounts||[],a=hr(r)?[r]:i.chains?i.chains:dU(i.accounts);t[r]={chains:a,methods:e,events:s,accounts:n}}return t}function dj(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):isNaN(Number(e=e.includes(":")?e.split(":")[1]:e))?e:Number(e)}let dq={},d$=e=>dq[e],dF=(e,t)=>{dq[e]=t};var dz=Object.defineProperty,dH=(e,t,r)=>t in e?dz(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,dW=(e,t,r)=>dH(e,"symbol"!=typeof t?t+"":t,r);class dV{constructor(e){dW(this,"name","polkadot"),dW(this,"client"),dW(this,"httpProviders"),dW(this,"events"),dW(this,"namespace"),dW(this,"chainId"),this.namespace=e.namespace,this.events=d$("events"),this.client=d$("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dc.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=dx(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||dk(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new r6.r(new de.Z(r,d$("disableProviderPing")))}}var dK=Object.defineProperty,dG=Object.defineProperties,dJ=Object.getOwnPropertyDescriptors,dY=Object.getOwnPropertySymbols,dZ=Object.prototype.hasOwnProperty,dX=Object.prototype.propertyIsEnumerable,dQ=(e,t,r)=>t in e?dK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d0=(e,t)=>{for(var r in t||(t={}))dZ.call(t,r)&&dQ(e,r,t[r]);if(dY)for(var r of dY(t))dX.call(t,r)&&dQ(e,r,t[r]);return e},d1=(e,t)=>dG(e,dJ(t)),d2=(e,t,r)=>dQ(e,"symbol"!=typeof t?t+"":t,r);class d5{constructor(e){d2(this,"name","eip155"),d2(this,"client"),d2(this,"chainId"),d2(this,"namespace"),d2(this,"httpProviders"),d2(this,"events"),this.namespace=e.namespace,this.events=d$("events"),this.client=d$("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(dc.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){let r=t||dk(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new r6.r(new de.k(r,d$("disableProviderPing")))}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=parseInt(dx(t));e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){let e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,r;let i=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0";i=i.startsWith("0x")?i:`0x${i}`;let s=parseInt(i,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:null==(r=this.namespace.chains)?void 0:r[0]}),this.setDefaultChain(`${s}`);else throw Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,r,i,s,n;let a=null==(r=null==(t=e.request)?void 0:t.params)?void 0:r[0],o=(null==(s=null==(i=e.request)?void 0:i.params)?void 0:s[1])||[],c=`${a}${o.join(",")}`;if(!a)throw Error("Missing address parameter in `wallet_getCapabilities` request");let l=this.client.session.get(e.topic),h=(null==(n=l?.sessionProperties)?void 0:n.capabilities)||{};if(null!=h&&h[c])return h?.[c];let d=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:d1(d0({},l.sessionProperties||{}),{capabilities:d1(d0({},h||{}),{[c]:d})})})}catch(e){console.warn("Failed to update session with capabilities",e)}return d}async getCallStatus(e){var t,r;let i=this.client.session.get(e.topic),s=null==(t=i.sessionProperties)?void 0:t.bundler_name;if(s){let t=this.getBundlerUrl(e.chainId,s);try{return await this.getUserOperationReceipt(t,e)}catch(e){console.warn("Failed to fetch call status from bundler",e,t)}}let n=null==(r=i.sessionProperties)?void 0:r.bundler_url;if(n)try{return await this.getUserOperationReceipt(n,e)}catch(e){console.warn("Failed to fetch call status from custom bundler",e,n)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var r;let i=new URL(e),s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,r9.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(r=t.request.params)?void 0:r[0]]))});if(!s.ok)throw Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,t){return`${da}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var d3=Object.defineProperty,d4=(e,t,r)=>t in e?d3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d8=(e,t,r)=>d4(e,"symbol"!=typeof t?t+"":t,r);class d6{constructor(e){d8(this,"name","solana"),d8(this,"client"),d8(this,"httpProviders"),d8(this,"events"),d8(this,"namespace"),d8(this,"chainId"),this.namespace=e.namespace,this.events=d$("events"),this.client=d$("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dc.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=dx(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||dk(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new r6.r(new de.Z(r,d$("disableProviderPing")))}}var d9=Object.defineProperty,d7=(e,t,r)=>t in e?d9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ue=(e,t,r)=>d7(e,"symbol"!=typeof t?t+"":t,r);class ut{constructor(e){ue(this,"name","cosmos"),ue(this,"client"),ue(this,"httpProviders"),ue(this,"events"),ue(this,"namespace"),ue(this,"chainId"),this.namespace=e.namespace,this.events=d$("events"),this.client=d$("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dc.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=dx(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||dk(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new r6.r(new de.Z(r,d$("disableProviderPing")))}}var ur=Object.defineProperty,ui=(e,t,r)=>t in e?ur(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,us=(e,t,r)=>ui(e,"symbol"!=typeof t?t+"":t,r);class un{constructor(e){us(this,"name","algorand"),us(this,"client"),us(this,"httpProviders"),us(this,"events"),us(this,"namespace"),us(this,"chainId"),this.namespace=e.namespace,this.events=d$("events"),this.client=d$("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){let r=t||dk(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(dc.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||dk(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new r6.r(new de.Z(r,d$("disableProviderPing")))}}var ua=Object.defineProperty,uo=(e,t,r)=>t in e?ua(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uc=(e,t,r)=>uo(e,"symbol"!=typeof t?t+"":t,r);class ul{constructor(e){uc(this,"name","cip34"),uc(this,"client"),uc(this,"httpProviders"),uc(this,"events"),uc(this,"namespace"),uc(this,"chainId"),this.namespace=e.namespace,this.events=d$("events"),this.client=d$("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dc.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{let r=this.getCardanoRPCUrl(t),i=dx(t);e[i]=this.createHttpProvider(i,r)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){let t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||this.getCardanoRPCUrl(e);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new r6.r(new de.Z(r,d$("disableProviderPing")))}}var uh=Object.defineProperty,ud=(e,t,r)=>t in e?uh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uu=(e,t,r)=>ud(e,"symbol"!=typeof t?t+"":t,r);class up{constructor(e){uu(this,"name","elrond"),uu(this,"client"),uu(this,"httpProviders"),uu(this,"events"),uu(this,"namespace"),uu(this,"chainId"),this.namespace=e.namespace,this.events=d$("events"),this.client=d$("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dc.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=dx(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||dk(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new r6.r(new de.Z(r,d$("disableProviderPing")))}}var ug=Object.defineProperty,uf=(e,t,r)=>t in e?ug(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,um=(e,t,r)=>uf(e,"symbol"!=typeof t?t+"":t,r);class uw{constructor(e){um(this,"name","multiversx"),um(this,"client"),um(this,"httpProviders"),um(this,"events"),um(this,"namespace"),um(this,"chainId"),this.namespace=e.namespace,this.events=d$("events"),this.client=d$("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dc.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=dx(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||dk(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new r6.r(new de.Z(r,d$("disableProviderPing")))}}var uy=Object.defineProperty,ub=(e,t,r)=>t in e?uy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uv=(e,t,r)=>ub(e,"symbol"!=typeof t?t+"":t,r);class uE{constructor(e){uv(this,"name","near"),uv(this,"client"),uv(this,"httpProviders"),uv(this,"events"),uv(this,"namespace"),uv(this,"chainId"),this.namespace=e.namespace,this.events=d$("events"),this.client=d$("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let r=t||dk(`${this.name}:${e}`,this.namespace);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(dc.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||dk(e,this.namespace);return typeof r>"u"?void 0:new r6.r(new de.Z(r,d$("disableProviderPing")))}}var uC=Object.defineProperty,uI=(e,t,r)=>t in e?uC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uN=(e,t,r)=>uI(e,"symbol"!=typeof t?t+"":t,r);class uA{constructor(e){uN(this,"name","tezos"),uN(this,"client"),uN(this,"httpProviders"),uN(this,"events"),uN(this,"namespace"),uN(this,"chainId"),this.namespace=e.namespace,this.events=d$("events"),this.client=d$("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let r=t||dk(`${this.name}:${e}`,this.namespace);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(dc.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||dk(e,this.namespace);return typeof r>"u"?void 0:new r6.r(new de.Z(r))}}var u_=Object.defineProperty,uS=(e,t,r)=>t in e?u_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uP=(e,t,r)=>uS(e,"symbol"!=typeof t?t+"":t,r);class uO{constructor(e){uP(this,"name",dn),uP(this,"client"),uP(this,"httpProviders"),uP(this,"events"),uP(this,"namespace"),uP(this,"chainId"),this.namespace=e.namespace,this.events=d$("events"),this.client=d$("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dc.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var e,t;let r={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(e=>{let t=aJ(e);r[`${t.namespace}:${t.reference}`]=this.createHttpProvider(e)}),r}getHttpProvider(e){let t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||dk(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new r6.r(new de.Z(r,d$("disableProviderPing")))}}var uT=Object.defineProperty,uR=Object.defineProperties,uk=Object.getOwnPropertyDescriptors,ux=Object.getOwnPropertySymbols,uU=Object.prototype.hasOwnProperty,uD=Object.prototype.propertyIsEnumerable,uL=(e,t,r)=>t in e?uT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uM=(e,t)=>{for(var r in t||(t={}))uU.call(t,r)&&uL(e,r,t[r]);if(ux)for(var r of ux(t))uD.call(t,r)&&uL(e,r,t[r]);return e},uB=(e,t)=>uR(e,uk(t)),uj=(e,t,r)=>uL(e,"symbol"!=typeof t?t+"":t,r);class uq{constructor(e){uj(this,"client"),uj(this,"namespaces"),uj(this,"optionalNamespaces"),uj(this,"sessionProperties"),uj(this,"scopedProperties"),uj(this,"events",new(p())),uj(this,"rpcProviders",{}),uj(this,"session"),uj(this,"providerOpts"),uj(this,"logger"),uj(this,"uri"),uj(this,"disableProviderPing",!1),this.providerOpts=e,this.logger="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,m.gw)((0,m.jI)({level:e?.logger||dr})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){let t=new uq(e);return await t.initialize(),t}async request(e,t,r){let[i,s]=this.validateChain(t);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(i).request({request:uM({},e),chainId:`${i}:${s}`,topic:this.session.topic,expiry:r})}sendAsync(e,t,r,i){let s=new Date().getTime();this.request(e,r,i).then(e=>t(null,(0,r9.formatJsonRpcResult)(s,e))).catch(e=>t(e,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:hl("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();let{uri:r,response:i}=await this.client.authenticate(e,t);r&&(this.uri=r,this.events.emit("display_uri",r));let s=await i();if(this.session=s.session,this.session){let e=dB(this.session.namespaces);this.namespaces=dD(this.namespaces,e),await this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){let{uri:t,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));let i=await r();this.session=i;let s=dB(i.namespaces);return this.namespaces=dD(this.namespaces,s),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;let[r,i]=this.validateChain(e),s=this.getProvider(r);s.name===dn?s.setDefaultChain(`${r}:${i}`,t):s.setDefaultChain(i,t)}catch(e){if(!/Please call connect/.test(e.message))throw e}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");let t=this.client.pairing.getAll();if(hh(t)){for(let r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await h7.init({core:this.providerOpts.core,logger:this.providerOpts.logger||dr,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),Error(`The provided session: ${null==(t=null==(e=this.providerOpts)?void 0:e.session)?void 0:t.topic} doesn't exist in the Sign client`)}else{let e=this.client.session.getAll();this.session=e[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let e=[...new Set(Object.keys(this.session.namespaces).map(e=>hi(e)))];dF("client",this.client),dF("events",this.events),dF("disableProviderPing",this.disableProviderPing),e.forEach(e=>{if(!this.session)return;let t=function(e,t){let r=Object.keys(t.namespaces).filter(t=>t.includes(e));if(!r.length)return[];let i=[];return r.forEach(e=>{let r=t.namespaces[e].accounts;i.push(...r)}),i}(e,this.session),r=dU(t),i=dD(this.namespaces,this.optionalNamespaces),s=uB(uM({},i[e]),{accounts:t,chains:r});switch(e){case"eip155":this.rpcProviders[e]=new d5({namespace:s});break;case"algorand":this.rpcProviders[e]=new un({namespace:s});break;case"solana":this.rpcProviders[e]=new d6({namespace:s});break;case"cosmos":this.rpcProviders[e]=new ut({namespace:s});break;case"polkadot":this.rpcProviders[e]=new dV({namespace:s});break;case"cip34":this.rpcProviders[e]=new ul({namespace:s});break;case"elrond":this.rpcProviders[e]=new up({namespace:s});break;case"multiversx":this.rpcProviders[e]=new uw({namespace:s});break;case"near":this.rpcProviders[e]=new uE({namespace:s});break;case"tezos":this.rpcProviders[e]=new uA({namespace:s});break;default:this.rpcProviders[dn]?this.rpcProviders[dn].updateNamespace(s):this.rpcProviders[dn]=new uO({namespace:s})}})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;let{topic:r}=e;r===(null==(t=this.session)?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;let{params:r,topic:i}=e;if(i!==(null==(t=this.session)?void 0:t.topic))return;let{event:s}=r;if("accountsChanged"===s.name){let e=s.data;e&&hh(e)&&this.events.emit("accountsChanged",e.map(dM))}else if("chainChanged"===s.name){let e=r.chainId,t=r.event.data,i=hi(e),s=dj(e)!==dj(t)?`${i}:${dj(t)}`:e;this.onChainChanged(s)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var r,i;if(e!==(null==(r=this.session)?void 0:r.topic))return;let{namespaces:s}=t,n=null==(i=this.client)?void 0:i.session.get(e);this.session=uB(uM({},n),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===(null==(t=this.session)?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",uB(uM({},hl("USER_DISCONNECTED")),{data:e.topic})))}),this.on(dc.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[dn]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])})}setNamespaces(e){let{namespaces:t={},optionalNamespaces:r={},sessionProperties:i,scopedProperties:s}=e;this.optionalNamespaces=dD(t,r),this.sessionProperties=i,this.scopedProperties=s}validateChain(e){let[t,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(e=>hi(e)).includes(t))throw Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];let i=hi(Object.keys(this.namespaces)[0]),s=this.rpcProviders[i].getDefaultChain();return[i,s]}async requestAccounts(){let[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;let[r,i]=this.validateChain(e);if(!i)return;this.updateNamespaceChain(r,i),this.events.emit("chainChanged",i);let s=this.getProvider(r).getDefaultChain();t||this.getProvider(r).setDefaultChain(i),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:s,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:r}){var i,s;try{if(t===r)return;let n=null==(s=null==(i=this.session)?void 0:i.namespaces[e])?void 0:s.accounts;if(!n)return;let a=n.filter(e=>e.includes(`${r}:`)).map(dM);if(!hh(a))return;this.events.emit("accountsChanged",a)}catch(e){this.logger.warn("Failed to emit accountsChanged on chain change",e)}}updateNamespaceChain(e,t){if(!this.namespaces)return;let r=this.namespaces[e]?e:`${e}:${t}`;this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=t):this.namespaces[r]={chains:[],methods:[],events:[],defaultChain:t}}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var r;let i=(null==(r=this.session)?void 0:r.topic)||"";await this.client.core.storage.setItem(`${di}/${e}${i}`,t)}async getFromStore(e){var t;let r=(null==(t=this.session)?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${di}/${e}${r}`)}async deleteFromStore(e){var t;let r=(null==(t=this.session)?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${di}/${e}${r}`)}async cleanupStorage(){var e;try{if((null==(e=this.client)?void 0:e.session.length)>0)return;let t=await this.client.core.storage.getKeys();for(let e of t)e.startsWith(di)&&await this.client.core.storage.removeItem(e)}catch(e){this.logger.warn("Failed to cleanup storage",e)}}}var u$=r(53807);let uF={validateCaipAddress(e){if(e.split(":")?.length!==3)throw Error("Invalid CAIP Address");return e},parseCaipAddress(e){let t=e.split(":");if(3!==t.length)throw Error(`Invalid CAIP-10 address: ${e}`);let[r,i,s]=t;if(!r||!i||!s)throw Error(`Invalid CAIP-10 address: ${e}`);return{chainNamespace:r,chainId:i,address:s}},parseCaipNetworkId(e){let t=e.split(":");if(2!==t.length)throw Error(`Invalid CAIP-2 network id: ${e}`);let[r,i]=t;if(!r||!i)throw Error(`Invalid CAIP-2 network id: ${e}`);return{chainNamespace:r,chainId:i}}};var uz=r(23470),uH=r(12309),uW=r(38750),uV=r(70066),uK=r(70580),uG=r(1495),uJ=r(63243);let uY={convertEVMChainIdToCoinType(e){if(e>=2147483648)throw Error("Invalid chainId");return(2147483648|e)>>>0}};var uZ=r(72054),uX=r(64695);let uQ=(0,uG.sj)({suggestions:[],loading:!1}),u0=(0,uZ.P)({state:uQ,subscribe:e=>(0,uG.Ld)(uQ,()=>e(uQ)),subscribeKey:(e,t)=>(0,uJ.VW)(uQ,e,t),async resolveName(e){try{return await uW.L.lookupEnsName(e)}catch(e){throw Error(e?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(e){try{return await uW.L.lookupEnsName(e),!0}catch{return!1}},async getSuggestions(e){try{uQ.loading=!0,uQ.suggestions=[];let t=await uW.L.getEnsNameSuggestions(e);return uQ.suggestions=t.suggestions.map(e=>({...e,name:e.name}))||[],uQ.suggestions}catch(t){let e=u0.parseEnsApiError(t,"Error fetching name suggestions");throw Error(e)}finally{uQ.loading=!1}},async getNamesForAddress(e){try{let t=uH.R.state.activeCaipNetwork;if(!t)return[];let r=uK.M.getEnsFromCacheForAddress(e);if(r)return r;let i=await uW.L.reverseLookupEnsName({address:e});return uK.M.updateEnsCache({address:e,ens:i,timestamp:Date.now()}),i}catch(t){let e=u0.parseEnsApiError(t,"Error fetching names for address");throw Error(e)}},async registerName(e){let t=uH.R.state.activeCaipNetwork;if(!t)throw Error("Network not found");let r=uV.N.state.address,i=c.A.getAuthConnector();if(!r||!i)throw Error("Address or auth connector not found");uQ.loading=!0;try{let i=JSON.stringify({name:e,attributes:{},timestamp:Math.floor(Date.now()/1e3)});uX.P.pushTransactionStack({onCancel(){uX.P.replace("RegisterAccountName")}});let s=await l.l.signMessage(i);uQ.loading=!1;let n=t.id;if(!n)throw Error("Network not found");let a=uY.convertEVMChainIdToCoinType(Number(n));await uW.L.registerEnsName({coinType:a,address:r,signature:s,message:i}),uV.N.setProfileName(e,t.chainNamespace),uX.P.replace("RegisterAccountNameSuccess")}catch(r){let t=u0.parseEnsApiError(r,`Error registering name ${e}`);throw uX.P.replace("RegisterAccountName"),Error(t)}finally{uQ.loading=!1}},validateName:e=>/^[a-zA-Z0-9-]{4,}$/u.test(e),parseEnsApiError:(e,t)=>e?.reasons?.[0]?.description||t});var u1=r(62661),u2=r(24997),u5=r(88049);let u3={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},u4={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},u8={providers:u2.gy,selectedProvider:null,error:null,purchaseCurrency:u3,paymentCurrency:u4,purchaseCurrencies:[u3],paymentCurrencies:[],quotesLoading:!1},u6=(0,uG.sj)(u8),u9=(0,uZ.P)({state:u6,subscribe:e=>(0,uG.Ld)(u6,()=>e(u6)),subscribeKey:(e,t)=>(0,uJ.VW)(u6,e,t),setSelectedProvider(e){if(e&&"meld"===e.name){let t=uH.R.state.activeChain===u$.b.CHAIN.SOLANA?"SOL":"USDC",r=uV.N.state.address??"",i=new URL(e.url);i.searchParams.append("publicKey",u2.a$),i.searchParams.append("destinationCurrencyCode",t),i.searchParams.append("walletAddress",r),i.searchParams.append("externalCustomerId",d.h.state.projectId),u6.selectedProvider={...e,url:i.toString()}}else u6.selectedProvider=e},setOnrampProviders(e){if(Array.isArray(e)&&e.every(e=>"string"==typeof e)){let t=u2.gy.filter(t=>e.includes(t.name));u6.providers=t}else u6.providers=[]},setPurchaseCurrency(e){u6.purchaseCurrency=e},setPaymentCurrency(e){u6.paymentCurrency=e},setPurchaseAmount(e){u9.state.purchaseAmount=e},setPaymentAmount(e){u9.state.paymentAmount=e},async getAvailableCurrencies(){let e=await uW.L.getOnrampOptions();u6.purchaseCurrencies=e.purchaseCurrencies,u6.paymentCurrencies=e.paymentCurrencies,u6.paymentCurrency=e.paymentCurrencies[0]||u4,u6.purchaseCurrency=e.purchaseCurrencies[0]||u3,await u5.Q.fetchCurrencyImages(e.paymentCurrencies.map(e=>e.id)),await u5.Q.fetchTokenImages(e.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){u6.quotesLoading=!0;try{let e=await uW.L.getOnrampQuote({purchaseCurrency:u6.purchaseCurrency,paymentCurrency:u6.paymentCurrency,amount:u6.paymentAmount?.toString()||"0",network:u6.purchaseCurrency?.symbol});return u6.quotesLoading=!1,u6.purchaseAmount=Number(e?.purchaseAmount.amount),e}catch(e){return u6.error=e.message,u6.quotesLoading=!1,null}finally{u6.quotesLoading=!1}},resetState(){u6.selectedProvider=null,u6.error=null,u6.purchaseCurrency=u3,u6.paymentCurrency=u4,u6.purchaseCurrencies=[u3],u6.paymentCurrencies=[],u6.paymentAmount=void 0,u6.purchaseAmount=void 0,u6.quotesLoading=!1}});var u7=r(6912),pe=r(37517),pt=r(10375),pr=r(64616),pi=r(7113),ps=r(46560),pn=r(26067),pa=r(14406);function po(e,t){return c.A.getConnectorId(e)===t}r(10171),r(30141);var pc=r(45435),pl=r(6089);let ph=new AbortController,pd={EmbeddedWalletAbortController:ph,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${"undefined"!=typeof window?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},IFRAME_LOAD_FAILED:{shortMessage:"Network Error - Could not load embedded wallet",longMessage:()=>"There was an issue loading the embedded wallet. Please try again later."},IFRAME_REQUEST_TIMEOUT:{shortMessage:"Embedded Wallet Request Timed Out",longMessage:()=>"There was an issue doing the request to the embedded wallet. Please try again later."},UNVERIFIED_DOMAIN:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"}}},pu=(e,t,r)=>JSON.stringify(e,(e,r)=>{let i="bigint"==typeof r?r.toString():r;return"function"==typeof t?t(e,i):i},r),pp="2.31.0",pg={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:r})=>t?`${e??"https://viem.sh"}${t}${r?`#${r}`:""}`:void 0,version:`viem@${pp}`};class pf extends Error{constructor(e,t={}){let r=t.cause instanceof pf?t.cause.details:t.cause?.message?t.cause.message:t.details,i=t.cause instanceof pf&&t.cause.docsPath||t.docsPath,s=pg.getDocsUrl?.({...t,docsPath:i}),n=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...s?[`Docs: ${s}`]:[],...r?[`Details: ${r}`]:[],...pg.version?[`Version: ${pg.version}`]:[]].join("\n");super(n,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=i,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=pp}walk(e){return function e(t,r){return r?.(t)?t:t&&"object"==typeof t&&"cause"in t&&void 0!==t.cause?e(t.cause,r):r?null:t}(this,e)}}let pm=e=>e;class pw extends pf{constructor({body:e,cause:t,details:r,headers:i,status:s,url:n}){super("HTTP request failed.",{cause:t,details:r,metaMessages:[s&&`Status: ${s}`,`URL: ${pm(n)}`,e&&`Request body: ${pu(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=i,this.status=s,this.url=n}}class py extends pf{constructor({body:e,error:t,url:r}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${pm(r)}`,`Request body: ${pu(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t.code,this.data=t.data}}class pb extends pf{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${pm(t)}`,`Request body: ${pu(e)}`],name:"TimeoutError"})}}class pv extends pf{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}let pE=new Map,pC={current:0,take(){return this.current++},reset(){this.current=0}};class pI extends pf{constructor(e,{code:t,docsPath:r,metaMessages:i,name:s,shortMessage:n}){super(n,{cause:e,docsPath:r,metaMessages:i||e?.metaMessages,name:s||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=s||e.name,this.code=e instanceof py?e.code:t??-1}}class pN extends pI{constructor(e,t){super(e,t),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class pA extends pI{constructor(e){super(e,{code:pA.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(pA,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class p_ extends pI{constructor(e){super(e,{code:p_.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(p_,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class pS extends pI{constructor(e,{method:t}={}){super(e,{code:pS.code,name:"MethodNotFoundRpcError",shortMessage:`The method${t?` "${t}"`:""} does not exist / is not available.`})}}Object.defineProperty(pS,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class pP extends pI{constructor(e){super(e,{code:pP.code,name:"InvalidParamsRpcError",shortMessage:"Invalid parameters were provided to the RPC method.\nDouble check you have provided the correct parameters."})}}Object.defineProperty(pP,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class pO extends pI{constructor(e){super(e,{code:pO.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(pO,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class pT extends pI{constructor(e){super(e,{code:pT.code,name:"InvalidInputRpcError",shortMessage:"Missing or invalid parameters.\nDouble check you have provided the correct parameters."})}}Object.defineProperty(pT,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class pR extends pI{constructor(e){super(e,{code:pR.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(pR,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class pk extends pI{constructor(e){super(e,{code:pk.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(pk,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class px extends pI{constructor(e){super(e,{code:px.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(px,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class pU extends pI{constructor(e,{method:t}={}){super(e,{code:pU.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${t?` "${t}"`:""} is not supported.`})}}Object.defineProperty(pU,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class pD extends pI{constructor(e){super(e,{code:pD.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(pD,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class pL extends pI{constructor(e){super(e,{code:pL.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(pL,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class pM extends pN{constructor(e){super(e,{code:pM.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(pM,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class pB extends pN{constructor(e){super(e,{code:pB.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(pB,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class pj extends pN{constructor(e,{method:t}={}){super(e,{code:pj.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${t?` " ${t}"`:""}.`})}}Object.defineProperty(pj,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class pq extends pN{constructor(e){super(e,{code:pq.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(pq,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class p$ extends pN{constructor(e){super(e,{code:p$.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(p$,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class pF extends pN{constructor(e){super(e,{code:pF.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(pF,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class pz extends pN{constructor(e){super(e,{code:pz.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(pz,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class pH extends pN{constructor(e){super(e,{code:pH.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(pH,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class pW extends pN{constructor(e){super(e,{code:pW.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(pW,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class pV extends pN{constructor(e){super(e,{code:pV.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(pV,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class pK extends pN{constructor(e){super(e,{code:pK.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(pK,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class pG extends pN{constructor(e){super(e,{code:pG.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(pG,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class pJ extends pN{constructor(e){super(e,{code:pJ.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(pJ,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class pY extends pI{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}class pZ extends pf{constructor({max:e,min:t,signed:r,size:i,value:s}){super(`Number "${s}" is not in safe ${i?`${8*i}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class pX extends pf{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}class pQ extends pf{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function p0(e,{dir:t,size:r=32}={}){return"string"==typeof e?function(e,{dir:t,size:r=32}={}){if(null===r)return e;let i=e.replace("0x","");if(i.length>2*r)throw new pQ({size:Math.ceil(i.length/2),targetSize:r,type:"hex"});return`0x${i["right"===t?"padEnd":"padStart"](2*r,"0")}`}(e,{dir:t,size:r}):function(e,{dir:t,size:r=32}={}){if(null===r)return e;if(e.length>r)throw new pQ({size:e.length,targetSize:r,type:"bytes"});let i=new Uint8Array(r);for(let s=0;s<r;s++){let n="right"===t;i[n?s:r-s-1]=e[n?s:e.length-s-1]}return i}(e,{dir:t,size:r})}function p1(e){return!function(e,{strict:t=!0}={}){return!!e&&"string"==typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x"))}(e,{strict:!1})?e.length:Math.ceil((e.length-2)/2)}function p2(e,{size:t}){if(p1(e)>t)throw new pX({givenSize:p1(e),maxSize:t})}let p5=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function p3(e,t={}){return"number"==typeof e||"bigint"==typeof e?function(e,t={}){let r;let{signed:i,size:s}=t,n=BigInt(e);s?r=i?(1n<<8n*BigInt(s)-1n)-1n:2n**(8n*BigInt(s))-1n:"number"==typeof e&&(r=BigInt(Number.MAX_SAFE_INTEGER));let a="bigint"==typeof r&&i?-r-1n:0;if(r&&n>r||n<a){let t="bigint"==typeof e?"n":"";throw new pZ({max:r?`${r}${t}`:void 0,min:`${a}${t}`,signed:i,size:s,value:`${e}${t}`})}let o=`0x${(i&&n<0?(1n<<BigInt(8*s))+BigInt(n):n).toString(16)}`;return s?p0(o,{size:s}):o}(e,t):"string"==typeof e?p6(e,t):"boolean"==typeof e?function(e,t={}){let r=`0x${Number(e)}`;return"number"==typeof t.size?(p2(r,{size:t.size}),p0(r,{size:t.size})):r}(e,t):p4(e,t)}function p4(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=p5[e[t]];let i=`0x${r}`;return"number"==typeof t.size?(p2(i,{size:t.size}),p0(i,{dir:"right",size:t.size})):i}let p8=new TextEncoder;function p6(e,t={}){let r=p8.encode(e);return p4(r,t)}class p9 extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){let t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){let e=this.keys().next().value;e&&this.delete(e)}return this}}let p7=new p9(8192);async function ge(e){return new Promise(t=>setTimeout(t,e))}let gt=256;function gr({key:e,methods:t,name:r,request:s,retryCount:n=3,retryDelay:a=150,timeout:o,type:c},l){let h=function(e=11){if(!i||gt+e>512){i="",gt=0;for(let e=0;e<256;e++)i+=(256+256*Math.random()|0).toString(16).substring(1)}return i.substring(gt,gt+++e)}();return{config:{key:e,methods:t,name:r,request:s,retryCount:n,retryDelay:a,timeout:o,type:c},request:function(e,t={}){return async(r,i={})=>{let{dedupe:s=!1,methods:n,retryDelay:a=150,retryCount:o=3,uid:c}={...t,...i},{method:l}=r;if(n?.exclude?.includes(l)||n?.include&&!n.include.includes(l))throw new pU(Error("method not supported"),{method:l});let h=s?p6(`${c}.${pu(r)}`):void 0;return function(e,{enabled:t=!0,id:r}){if(!t||!r)return e();if(p7.get(r))return p7.get(r);let i=e().finally(()=>p7.delete(r));return p7.set(r,i),i}(()=>(function(e,{delay:t=100,retryCount:r=2,shouldRetry:i=()=>!0}={}){return new Promise((s,n)=>{let a=async({count:o=0}={})=>{let c=async({error:e})=>{let r="function"==typeof t?t({count:o,error:e}):t;r&&await ge(r),a({count:o+1})};try{let t=await e();s(t)}catch(e){if(o<r&&await i({count:o,error:e}))return c({error:e});n(e)}};a()})})(async()=>{try{return await e(r)}catch(e){switch(e.code){case pA.code:throw new pA(e);case p_.code:throw new p_(e);case pS.code:throw new pS(e,{method:r.method});case pP.code:throw new pP(e);case pO.code:throw new pO(e);case pT.code:throw new pT(e);case pR.code:throw new pR(e);case pk.code:throw new pk(e);case px.code:throw new px(e);case pU.code:throw new pU(e,{method:r.method});case pD.code:throw new pD(e);case pL.code:throw new pL(e);case pM.code:throw new pM(e);case pB.code:throw new pB(e);case pj.code:throw new pj(e);case pq.code:throw new pq(e);case p$.code:throw new p$(e);case pF.code:throw new pF(e);case pz.code:throw new pz(e);case pH.code:throw new pH(e);case pW.code:throw new pW(e);case pV.code:throw new pV(e);case pK.code:throw new pK(e);case pG.code:throw new pG(e);case pJ.code:throw new pJ(e);case 5e3:throw new pM(e);default:if(e instanceof pf)throw e;throw new pY(e)}}},{delay:({count:e,error:t})=>{if(t&&t instanceof pw){let e=t?.headers?.get("Retry-After");if(e?.match(/\d/))return 1e3*Number.parseInt(e)}return~~(1<<e)*a},retryCount:o,shouldRetry:({error:e})=>"code"in e&&"number"==typeof e.code?-1===e.code||e.code===pD.code||e.code===pO.code:!(e instanceof pw)||!e.status||403===e.status||408===e.status||413===e.status||429===e.status||500===e.status||502===e.status||503===e.status||504===e.status}),{enabled:s,id:h})}}(s,{methods:t,retryCount:n,retryDelay:a,uid:h}),value:l}}function gi(e,t={}){let{batch:r,fetchOptions:i,key:s="http",methods:n,name:a="HTTP JSON-RPC",onFetchRequest:o,onFetchResponse:c,retryDelay:l,raw:h}=t;return({chain:d,retryCount:u,timeout:p})=>{let{batchSize:g=1e3,wait:f=0}="object"==typeof r?r:{},m=t.retryCount??u,w=p??t.timeout??1e4,y=e||d?.rpcUrls.default.http[0];if(!y)throw new pv;let b=function(e,t={}){return{async request(r){let{body:i,onRequest:s=t.onRequest,onResponse:n=t.onResponse,timeout:a=t.timeout??1e4}=r,o={...t.fetchOptions??{},...r.fetchOptions??{}},{headers:c,method:l,signal:h}=o;try{let t;let r=await function(e,{errorInstance:t=Error("timed out"),timeout:r,signal:i}){return new Promise((s,n)=>{(async()=>{let a;try{let o=new AbortController;r>0&&(a=setTimeout(()=>{i?o.abort():n(t)},r)),s(await e({signal:o?.signal||null}))}catch(e){e?.name==="AbortError"&&n(t),n(e)}finally{clearTimeout(a)}})()})}(async({signal:t})=>{let r={...o,body:Array.isArray(i)?pu(i.map(e=>({jsonrpc:"2.0",id:e.id??pC.take(),...e}))):pu({jsonrpc:"2.0",id:i.id??pC.take(),...i}),headers:{"Content-Type":"application/json",...c},method:l||"POST",signal:h||(a>0?t:null)},n=new Request(e,r),d=await s?.(n,r)??{...r,url:e},u=await fetch(d.url??e,d);return u},{errorInstance:new pb({body:i,url:e}),timeout:a,signal:!0});if(n&&await n(r),r.headers.get("Content-Type")?.startsWith("application/json"))t=await r.json();else{t=await r.text();try{t=JSON.parse(t||"{}")}catch(e){if(r.ok)throw e;t={error:t}}}if(!r.ok)throw new pw({body:i,details:pu(t.error)||r.statusText,headers:r.headers,status:r.status,url:e});return t}catch(t){if(t instanceof pw||t instanceof pb)throw t;throw new pw({body:i,cause:t,url:e})}}}}(y,{fetchOptions:i,onRequest:o,onResponse:c,timeout:w});return gr({key:s,methods:n,name:a,async request({method:e,params:t}){let i={method:e,params:t},{schedule:s}=function({fn:e,id:t,shouldSplitBatch:r,wait:i=0,sort:s}){let n=async()=>{let t=c();a();let r=t.map(({args:e})=>e);0!==r.length&&e(r).then(e=>{s&&Array.isArray(e)&&e.sort(s);for(let r=0;r<t.length;r++){let{resolve:i}=t[r];i?.([e[r],e])}}).catch(e=>{for(let r=0;r<t.length;r++){let{reject:i}=t[r];i?.(e)}})},a=()=>pE.delete(t),o=()=>c().map(({args:e})=>e),c=()=>pE.get(t)||[],l=e=>pE.set(t,[...c(),e]);return{flush:a,async schedule(e){let{promise:t,resolve:s,reject:a}=function(){let e=()=>void 0,t=()=>void 0,r=new Promise((r,i)=>{e=r,t=i});return{promise:r,resolve:e,reject:t}}(),h=r?.([...o(),e]);h&&n();let d=c().length>0;return d?(l({args:e,resolve:s,reject:a}),t):(l({args:e,resolve:s,reject:a}),setTimeout(n,i),t)}}}({id:y,wait:f,shouldSplitBatch:e=>e.length>g,fn:e=>b.request({body:e}),sort:(e,t)=>e.id-t.id}),n=async e=>r?s(e):[await b.request({body:e})],[{error:a,result:o}]=await n(i);if(h)return{error:a,result:o};if(a)throw new py({body:i,error:a,url:y});return o},retryCount:m,retryDelay:l,timeout:w,type:"http"},{fetchOptions:i,url:y})}}let gs={ether:-9,wei:9};var gn=r(34551);function ga(e,t="wei"){return(0,gn.b)(e,gs[t])}class go extends pf{constructor({cause:e,message:t}={}){let r=t?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}function gc(e,t={}){let{key:r="fallback",name:i="Fallback",rank:s=!1,shouldThrow:n=gl,retryCount:a,retryDelay:o}=t;return({chain:t,pollingInterval:c=4e3,timeout:l,...h})=>{let d=e,u=()=>{},p=gr({key:r,name:i,async request({method:e,params:r}){let i;let s=async(a=0)=>{let o=d[a]({...h,chain:t,retryCount:0,timeout:l});try{let t=await o.request({method:e,params:r});return u({method:e,params:r,response:t,transport:o,status:"success"}),t}catch(c){if(u({error:c,method:e,params:r,transport:o,status:"error"}),n(c)||a===d.length-1||!(i??=d.slice(a+1).some(r=>{let{include:i,exclude:s}=r({chain:t}).config.methods||{};return i?i.includes(e):!s||!s.includes(e)})))throw c;return s(a+1)}};return s()},retryCount:a,retryDelay:o,type:"fallback"},{onResponse:e=>u=e,transports:d.map(e=>e({chain:t,retryCount:0}))});if(s){let e="object"==typeof s?s:{};!function({chain:e,interval:t=4e3,onTransports:r,ping:i,sampleCount:s=10,timeout:n=1e3,transports:a,weights:o={}}){let{stability:c=.7,latency:l=.3}=o,h=[],d=async()=>{let o=await Promise.all(a.map(async t=>{let r,s;let a=t({chain:e,retryCount:0,timeout:n}),o=Date.now();try{await (i?i({transport:a}):a.request({method:"net_listening"})),s=1}catch{s=0}finally{r=Date.now()}let c=r-o;return{latency:c,success:s}}));h.push(o),h.length>s&&h.shift();let u=Math.max(...h.map(e=>Math.max(...e.map(({latency:e})=>e)))),p=a.map((e,t)=>{let r=h.map(e=>e[t].latency),i=r.reduce((e,t)=>e+t,0)/r.length,s=h.map(e=>e[t].success),n=s.reduce((e,t)=>e+t,0)/s.length;return 0===n?[0,t]:[l*(1-i/u)+c*n,t]}).sort((e,t)=>t[0]-e[0]);r(p.map(([,e])=>a[e])),await ge(t),d()};d()}({chain:t,interval:e.interval??c,onTransports:e=>d=e,ping:e.ping,sampleCount:e.sampleCount,timeout:e.timeout,transports:d,weights:e.weights})}return p}}function gl(e){return!!("code"in e&&"number"==typeof e.code&&(e.code===px.code||e.code===pM.code||go.nodeMessage.test(e.message)||5e3===e.code))}Object.defineProperty(go,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(go,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/}),Object.defineProperty(class extends pf{constructor({cause:e,maxFeePerGas:t}={}){super(`The fee cap (\`maxFeePerGas\`${t?` = ${ga(t)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}},"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/}),Object.defineProperty(class extends pf{constructor({cause:e,maxFeePerGas:t}={}){super(`The fee cap (\`maxFeePerGas\`${t?` = ${ga(t)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}},"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/}),Object.defineProperty(class extends pf{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}},"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/}),Object.defineProperty(class extends pf{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}is lower than the current nonce of the account.
Try increasing the nonce or find the latest nonce with \`getTransactionCount\`.`,{cause:e,name:"NonceTooLowError"})}},"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/}),Object.defineProperty(class extends pf{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}},"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/}),Object.defineProperty(class extends pf{constructor({cause:e}={}){super("The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account.",{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}},"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/}),Object.defineProperty(class extends pf{constructor({cause:e,gas:t}={}){super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}},"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/}),Object.defineProperty(class extends pf{constructor({cause:e,gas:t}={}){super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}},"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/}),Object.defineProperty(class extends pf{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}},"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/}),Object.defineProperty(class extends pf{constructor({cause:e,maxPriorityFeePerGas:t,maxFeePerGas:r}={}){super(`The provided tip (\`maxPriorityFeePerGas\`${t?` = ${ga(t)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${ga(r)} gwei`:""}).`,{cause:e,name:"TipAboveFeeCapError"})}},"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});var gh=r(42375);let gd={ConnectorExplorerIds:{[u$.b.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[u$.b.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[u$.b.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[u$.b.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[u$.b.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[gh.b.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[gh.b.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[gh.b.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[gh.b.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[gh.b.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[gh.b.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[gh.b.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[gh.b.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[gh.b.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[gh.b.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[gh.b.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[u$.b.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[u$.b.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[u$.b.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[u$.b.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[u$.b.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[u$.b.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[u$.b.CONNECTOR_ID.INJECTED]:"Browser Wallet",[u$.b.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[u$.b.CONNECTOR_ID.COINBASE]:"Coinbase",[u$.b.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[u$.b.CONNECTOR_ID.LEDGER]:"Ledger",[u$.b.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[u$.b.CONNECTOR_ID.INJECTED]:"INJECTED",[u$.b.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[u$.b.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[u$.b.CONNECTOR_ID.AUTH]:"AUTH"},WalletConnectRpcChainIds:[1,5,11155111,10,420,42161,421613,137,80001,42220,1313161554,1313161555,56,97,43114,43113,100,8453,84531,7777777,999,324,280]};function gu(e,t){let r=new URL("https://rpc.walletconnect.org/v1/");return r.searchParams.set("chainId",e),r.searchParams.set("projectId",t),r.toString()}let gp=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],gg={extendRpcUrlWithProjectId(e,t){let r=!1;try{let t=new URL(e);r="rpc.walletconnect.org"===t.host}catch(e){r=!1}if(r){let r=new URL(e);return r.searchParams.has("projectId")||r.searchParams.set("projectId",t),r.toString()}return e},isCaipNetwork:e=>"chainNamespace"in e&&"caipNetworkId"in e,getChainNamespace(e){return this.isCaipNetwork(e)?e.chainNamespace:u$.b.CHAIN.EVM},getCaipNetworkId(e){return this.isCaipNetwork(e)?e.caipNetworkId:`${u$.b.CHAIN.EVM}:${e.id}`},getDefaultRpcUrl(e,t,r){let i=e.rpcUrls?.default?.http?.[0];return gp.includes(t)?gu(t,r):i||""},extendCaipNetwork(e,{customNetworkImageUrls:t,projectId:r,customRpcUrls:i}){let s=this.getChainNamespace(e),n=this.getCaipNetworkId(e),a=e.rpcUrls.default.http?.[0],o=this.getDefaultRpcUrl(e,n,r),c=e?.rpcUrls?.chainDefault?.http?.[0]||a,l=i?.[n]?.map(e=>e.url)||[],h=[...l,o],d=[...l];return c&&!d.includes(c)&&d.push(c),{...e,chainNamespace:s,caipNetworkId:n,assets:{imageId:gd.NetworkImageIds[e.id],imageUrl:t?.[e.id]},rpcUrls:{...e.rpcUrls,default:{http:h},chainDefault:{http:d}}}},extendCaipNetworks:(e,{customNetworkImageUrls:t,projectId:r,customRpcUrls:i})=>e.map(e=>gg.extendCaipNetwork(e,{customNetworkImageUrls:t,customRpcUrls:i,projectId:r})),getViemTransport(e,t,r){let i=[];return r?.forEach(e=>{i.push(gi(e.url,e.config))}),gp.includes(e.caipNetworkId)&&i.push(gi(gu(e.caipNetworkId,t),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),e?.rpcUrls?.default?.http?.forEach(e=>{i.push(gi(e))}),gc(i)},extendWagmiTransports(e,t,r){if(gp.includes(e.caipNetworkId)){let i=this.getDefaultRpcUrl(e,e.caipNetworkId,t);return gc([r,gi(i)])}return r},getUnsupportedNetwork:e=>({id:e.split(":")[1],caipNetworkId:e,name:u$.b.UNSUPPORTED_NETWORK_NAME,chainNamespace:e.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}),getCaipNetworkFromStorage(e){let t=uK.M.getActiveCaipNetworkId(),r=uH.R.getAllRequestedCaipNetworks(),i=Array.from(uH.R.state.chains?.keys()||[]),s=t?.split(":")[0],n=!!s&&i.includes(s),a=r?.find(e=>e.caipNetworkId===t);return n&&!a&&t?this.getUnsupportedNetwork(t):a||e||r?.[0]}};var gf=r(35247);let gm={createLogger(e,t="error"){let r=(0,m.jI)({level:t}),{logger:i}=(0,m.Rt)({opts:r});return i.error=(...t)=>{for(let r of t)if(r instanceof Error){e(r,...t);return}e(void 0,...t)},i}},gw={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},gy=(0,uG.sj)({providers:{...gw},providerIds:{...gw}}),gb={state:gy,subscribeKey:(e,t)=>(0,uJ.VW)(gy,e,t),subscribe:e=>(0,uG.Ld)(gy,()=>{e(gy)}),subscribeProviders:e=>(0,uG.Ld)(gy.providers,()=>e(gy.providers)),setProvider(e,t){t&&(gy.providers[e]=(0,uG.iH)(t))},getProvider:e=>gy.providers[e],setProviderId(e,t){t&&(gy.providerIds[e]=t)},getProviderId(e){if(e)return gy.providerIds[e]},reset(){gy.providers={...gw},gy.providerIds={...gw}},resetChain(e){gy.providers[e]=void 0,gy.providerIds[e]=void 0}},gv={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};function gE(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}let gC=gE({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),gI=gE({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});gE({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"}),gE({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}}),gE({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});let gN={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},gA={getMethodsByChainNamespace:e=>gN[e]||[],createDefaultNamespace(e){return{methods:this.getMethodsByChainNamespace(e),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(e,t){if(!t)return{...e};let r={...e},i=new Set;if(t.methods&&Object.keys(t.methods).forEach(e=>i.add(e)),t.chains&&Object.keys(t.chains).forEach(e=>i.add(e)),t.events&&Object.keys(t.events).forEach(e=>i.add(e)),t.rpcMap&&Object.keys(t.rpcMap).forEach(e=>{let[t]=e.split(":");t&&i.add(t)}),i.forEach(e=>{r[e]||(r[e]=this.createDefaultNamespace(e))}),t.methods&&Object.entries(t.methods).forEach(([e,t])=>{r[e]&&(r[e].methods=t)}),t.chains&&Object.entries(t.chains).forEach(([e,t])=>{r[e]&&(r[e].chains=t)}),t.events&&Object.entries(t.events).forEach(([e,t])=>{r[e]&&(r[e].events=t)}),t.rpcMap){let e=new Set;Object.entries(t.rpcMap).forEach(([t,i])=>{let[s,n]=t.split(":");s&&n&&r[s]&&(r[s].rpcMap||(r[s].rpcMap={}),e.has(s)||(r[s].rpcMap={},e.add(s)),r[s].rpcMap[n]=i)})}return r},createNamespaces(e,t){let r=e.reduce((e,t)=>{let{id:r,chainNamespace:i,rpcUrls:s}=t,n=s.default.http[0];e[i]||(e[i]=this.createDefaultNamespace(i));let a=`${i}:${r}`,o=e[i];switch(o.chains.push(a),a){case gC.caipNetworkId:o.chains.push(gC.deprecatedCaipNetworkId);break;case gI.caipNetworkId:o.chains.push(gI.deprecatedCaipNetworkId)}return o?.rpcMap&&n&&(o.rpcMap[r]=n),e},{});return this.applyNamespaceOverrides(r,t)},resolveReownName:async e=>{let t=await u0.resolveName(e),r=Object.values(t?.addresses)||[];return r[0]?.address||!1},getChainsFromNamespaces:(e={})=>Object.values(e).flatMap(e=>{let t=e.chains||[],r=e.accounts.map(e=>{let[t,r]=e.split(":");return`${t}:${r}`});return Array.from(new Set([...t,...r]))}),isSessionEventData:e=>"object"==typeof e&&null!==e&&"id"in e&&"topic"in e&&"params"in e&&"object"==typeof e.params&&null!==e.params&&"chainId"in e.params&&"event"in e.params&&"object"==typeof e.params.event&&null!==e.params.event,isOriginAllowed(e,t,r){for(let i of[...t,...r])if(i.includes("*")){let t=i.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&"),r=`^${t.replace(/\\\*/gu,".*")}$`,s=RegExp(r,"u");if(s.test(e))return!0}else try{if(new URL(i).origin===e)return!0}catch(t){if(i===e)return!0}return!1}};class g_{constructor({provider:e,namespace:t}){this.id=u$.b.CONNECTOR_ID.WALLET_CONNECT,this.name=gd.ConnectorNamesMap[u$.b.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=gd.ConnectorImageIds[u$.b.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=uH.R.getCaipNetworks.bind(uH.R),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=t}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){let e=await this.authenticate();if(!e){let e=this.getCaipNetworks(),t=d.h.state.universalProviderConfigOverride,r=gA.createNamespaces(e,t);await this.provider.connect({optionalNamespaces:r})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){let e=this.chains.map(e=>e.caipNetworkId);return pi.w.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:gS})}}let gS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];class gP{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,this.getCaipNetworks=e=>uH.R.getCaipNetworks(e),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.getCaipNetworks(this.namespace)}setAuthProvider(e){this.addConnector({id:u$.b.CONNECTOR_ID.AUTH,type:"AUTH",name:u$.b.CONNECTOR_NAMES.AUTH,provider:e,imageId:gd.ConnectorImageIds[u$.b.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){let t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(e=>!t.has(e.id)&&(t.add(e.id),!0)),this.emit("connectors",this.availableConnectors)}setStatus(e,t){uV.N.setStatus(e,t)}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(t)}off(e,t){let r=this.eventListeners.get(e);r&&r.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){let r=this.eventListeners.get(e);r&&r.forEach(e=>e(t))}async connectWalletConnect(e){let t=this.getWalletConnectConnector(),r=await t.connectWalletConnect();return{clientId:r.clientId}}async switchNetwork(e){let{caipNetwork:t,providerType:r}=e;if(!e.provider)return;let i="provider"in e.provider?e.provider.provider:e.provider;if("WALLET_CONNECT"===r){i.setDefaultChain(t.caipNetworkId);return}if(i&&"AUTH"===r){let e=uV.N.state.preferredAccountTypes?.[t.chainNamespace];await i.switchNetwork(t.caipNetworkId);let r=await i.getUser({chainId:t.caipNetworkId,preferredAccountType:e});this.emit("switchNetwork",r)}}getWalletConnectConnector(){let e=this.connectors.find(e=>e instanceof g_);if(!e)throw Error("WalletConnectConnector not found");return e}}class gO extends gP{setUniversalProvider(e){this.addConnector(new g_({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{let e=this.getWalletConnectConnector();await e.disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts({namespace:e}){let t=this.provider,r=t?.session?.namespaces?.[e]?.accounts?.map(e=>{let[,,t]=e.split(":");return t}).filter((e,t,r)=>r.indexOf(e)===t)||[];return Promise.resolve({accounts:r.map(t=>h.j.createAccount(e,t,"bip122"===e?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){let t=e.caipNetwork&&u2.bq.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace);if(!t||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};if(uV.N.state.balanceLoading&&e.chainId===uH.R.state.activeCaipNetwork?.id)return{balance:uV.N.state.balance||"0.00",symbol:uV.N.state.balanceSymbol||""};let r=await uV.N.fetchTokenBalance(),i=r.find(t=>t.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&t.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:i?.quantity.numeric||"0.00",symbol:i?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){let{provider:t,message:r,address:i}=e;if(!t)throw Error("UniversalAdapter:signMessage - provider is undefined");let s="";if(uH.R.state.activeCaipNetwork?.chainNamespace===u$.b.CHAIN.SOLANA){let e=await t.request({method:"solana_signMessage",params:{message:$.Z.encode(new TextEncoder().encode(r)),pubkey:i}},uH.R.state.activeCaipNetwork?.caipNetworkId);s=e.signature}else s=await t.request({method:"personal_sign",params:[r,i]},uH.R.state.activeCaipNetwork?.caipNetworkId);return{signature:s}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){let{caipNetwork:t}=e,r=this.getWalletConnectConnector();if(t.chainNamespace===u$.b.CHAIN.EVM)try{await r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:p3(t.id)}]})}catch(e){if(e.code===gv.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||e.code===gv.ERROR_INVALID_CHAIN_ID||e.code===gv.ERROR_CODE_DEFAULT||e?.data?.originalError?.code===gv.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:p3(t.id),rpcUrls:[t?.rpcUrls.chainDefault?.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[t.blockExplorers?.default.url]}]})}catch(e){throw Error("Chain is not supported")}}r.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){let e=this.connectors.find(e=>"WALLET_CONNECT"===e.type),t=e?.provider;return t}}let gT=["email","socials","swaps","onramp","activity","reownBranding"],gR={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.includes("email")},processFallback:e=>void 0===e?u2.bq.DEFAULT_REMOTE_FEATURES.email:!!e},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.length>0&&t.filter(e=>"email"!==e)},processFallback:e=>void 0===e?u2.bq.DEFAULT_REMOTE_FEATURES.socials:"boolean"==typeof e?!!e&&u2.bq.DEFAULT_REMOTE_FEATURES.socials:e},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.length>0&&t},processFallback:e=>void 0===e?u2.bq.DEFAULT_REMOTE_FEATURES.swaps:"boolean"==typeof e?!!e&&u2.bq.DEFAULT_REMOTE_FEATURES.swaps:e},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.length>0&&t},processFallback:e=>void 0===e?u2.bq.DEFAULT_REMOTE_FEATURES.onramp:"boolean"==typeof e?!!e&&u2.bq.DEFAULT_REMOTE_FEATURES.onramp:e},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>void 0===e?u2.bq.DEFAULT_REMOTE_FEATURES.activity:!!e},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>void 0===e?u2.bq.DEFAULT_REMOTE_FEATURES.reownBranding:!!e}},gk={localSettingsOverridden:new Set,getApiConfig:(e,t)=>t?.find(t=>t.id===e),addWarning(e,t){if(void 0!==e){let e=gR[t],r=e.isLegacy?`"features.${e.localFeatureName}" (now "${t}")`:`"features.${t}"`;this.localSettingsOverridden.add(r)}},processFeature(e,t,r,i,s){let n=gR[e],a=t[n.localFeatureName];if(s&&!n.isAvailableOnBasic)return!1;if(i){let t=this.getApiConfig(n.apiFeatureName,r);return t?.config===null?this.processFallbackFeature(e,a):!!t?.config&&(void 0!==a&&this.addWarning(a,e),this.processApiFeature(e,t))}return this.processFallbackFeature(e,a)},processApiFeature:(e,t)=>gR[e].processApi(t),processFallbackFeature:(e,t)=>gR[e].processFallback(t),async fetchRemoteFeatures(e){let t=e.basic??!1,r=e.features||{};this.localSettingsOverridden.clear();let i=null,s=!1;try{s=null!=(i=await u5.Q.fetchProjectConfig())}catch(e){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",e)}let n=s&&!t?u2.bq.DEFAULT_REMOTE_FEATURES:u2.bq.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(let e of gT){let a=this.processFeature(e,r,i,s,t);Object.assign(n,{[e]:a})}}catch(e){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",e),u2.bq.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){let e=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;u7.B.open({shortMessage:"Local configuration ignored",longMessage:`[Reown Config Notice] ${e}`},"warning")}return n}};class gx{constructor(e){this.chainNamespaces=[],this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(e,t)=>{if(e){let r=uH.R.getNetworkData(e)?.requestedCaipNetworks?.find(e=>e.id===t);if(r)return r;let i=uH.R.getNetworkData(e)?.caipNetwork;if(i)return i;let s=uH.R.getRequestedCaipNetworks(e);return s.filter(t=>t.chainNamespace===e)?.[0]}return uH.R.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{let e=this.getCaipNetwork();if(e)return e.id},this.getCaipNetworks=e=>uH.R.getCaipNetworks(e),this.getActiveChainNamespace=()=>uH.R.state.activeChain,this.setRequestedCaipNetworks=(e,t)=>{uH.R.setRequestedCaipNetworks(e,t)},this.getApprovedCaipNetworkIds=()=>uH.R.getAllApprovedCaipNetworkIds(),this.getCaipAddress=e=>uH.R.state.activeChain!==e&&e?uH.R.getAccountProp("caipAddress",e):uH.R.state.activeCaipAddress,this.setClientId=e=>{uW.L.setClientId(e)},this.getProvider=e=>gb.getProvider(e),this.getProviderType=e=>gb.getProviderId(e),this.getPreferredAccountType=e=>uV.N.state.preferredAccountTypes?.[e],this.setCaipAddress=(e,t)=>{uV.N.setCaipAddress(e,t),e&&d.h.state.enableEmbedded&&this.close()},this.setBalance=(e,t,r)=>{uV.N.setBalance(e,t,r)},this.setProfileName=(e,t)=>{uV.N.setProfileName(e,t)},this.setProfileImage=(e,t)=>{uV.N.setProfileImage(e,t)},this.setUser=(e,t)=>{uV.N.setUser(e,t)},this.resetAccount=e=>{uV.N.resetAccount(e)},this.setCaipNetwork=e=>{uH.R.setActiveCaipNetwork(e)},this.setCaipNetworkOfNamespace=(e,t)=>{uH.R.setChainNetworkData(t,{caipNetwork:e})},this.setAllAccounts=(e,t)=>{uV.N.setAllAccounts(e,t),d.h.setHasMultipleAddresses(e?.length>1)},this.setStatus=(e,t)=>{uV.N.setStatus(e,t),c.A.isConnected()?uK.M.setConnectionStatus("connected"):uK.M.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=e=>uH.R.getAccountProp("address",e),this.setConnectors=e=>{let t=[...c.A.state.allConnectors,...e];c.A.setConnectors(t)},this.setConnections=(e,t)=>{l.l.setConnections(e,t)},this.fetchIdentity=e=>uW.L.fetchIdentity(e),this.getReownName=e=>u0.getNamesForAddress(e),this.getConnectors=()=>c.A.getConnectors(),this.getConnectorImage=e=>u1.f.getConnectorImage(e),this.setConnectedWalletInfo=(e,t)=>{let r=gb.getProviderId(t),i=e?{...e,type:r}:void 0;uV.N.setConnectedWalletInfo(i,t)},this.getIsConnectedState=()=>!!uH.R.state.activeCaipAddress,this.addAddressLabel=(e,t,r)=>{uV.N.addAddressLabel(e,t,r)},this.removeAddressLabel=(e,t)=>{uV.N.removeAddressLabel(e,t)},this.getAddress=e=>uH.R.state.activeChain!==e&&e?uH.R.getAccountProp("address",e):uV.N.state.address,this.setApprovedCaipNetworksData=e=>uH.R.setApprovedCaipNetworksData(e),this.resetNetwork=e=>{uH.R.resetNetwork(e)},this.addConnector=e=>{c.A.addConnector(e)},this.resetWcConnection=()=>{l.l.resetWcConnection()},this.setAddressExplorerUrl=(e,t)=>{uV.N.setAddressExplorerUrl(e,t)},this.setSmartAccountDeployed=(e,t)=>{uV.N.setSmartAccountDeployed(e,t)},this.setSmartAccountEnabledNetworks=(e,t)=>{uH.R.setSmartAccountEnabledNetworks(e,t)},this.setPreferredAccountType=(e,t)=>{uV.N.setPreferredAccountType(e,t)},this.setEIP6963Enabled=e=>{d.h.setEIP6963Enabled(e)},this.handleUnsafeRPCRequest=()=>{this.isOpen()?this.isTransactionStackEmpty()||this.redirect("ApproveTransaction"):this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,t){let r=e?.map(e=>e.namespace).filter(e=>!!e);if(r?.length)return[...new Set(r)];let i=t?.map(e=>e.chainNamespace);return[...new Set(i)]}async initialize(e){this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),await this.syncExistingConnection(),this.remoteFeatures=await gk.fetchRemoteFeatures(e),d.h.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&u9.setOnrampProviders(this.remoteFeatures.onramp),(d.h.state.remoteFeatures?.email||Array.isArray(d.h.state.remoteFeatures?.socials)&&d.h.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){let e=await u5.Q.fetchAllowedOrigins();if(e&&h.j.isClient()){let t=window.location.origin,r=gA.isOriginAllowed(t,e,gv.DEFAULT_ALLOWED_ANCESTORS);r||u7.B.open(pd.ALERT_ERRORS.INVALID_APP_CONFIGURATION,"error")}else u7.B.open(pd.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}sendInitializeEvent(e){let{...t}=e;delete t.adapters,delete t.universalProvider,pe.X.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(e=>e.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&pt.u.setThemeMode(e.themeMode),e.themeVariables&&pt.u.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw Error("ConnectionControllerClient and NetworkControllerClient must be set");uH.R.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});let t=this.getDefaultNetwork();t&&uH.R.setActiveCaipNetwork(t)}initializeConnectionController(e){l.l.setWcBasic(e.basic??!1)}initializeConnectorController(){c.A.initialize(this.chainNamespaces)}initializeProjectSettings(e){d.h.setProjectId(e.projectId),d.h.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){d.h.setDebug(!1!==e.debug),d.h.setEnableWalletConnect(!1!==e.enableWalletConnect),d.h.setEnableWalletGuide(!1!==e.enableWalletGuide),d.h.setEnableWallets(!1!==e.enableWallets),d.h.setEIP6963Enabled(!1!==e.enableEIP6963),d.h.setEnableNetworkSwitch(!1!==e.enableNetworkSwitch),d.h.setEnableAuthLogger(!1!==e.enableAuthLogger),d.h.setCustomRpcUrls(e.customRpcUrls),d.h.setEnableEmbedded(e.enableEmbedded),d.h.setAllWallets(e.allWallets),d.h.setIncludeWalletIds(e.includeWalletIds),d.h.setExcludeWalletIds(e.excludeWalletIds),d.h.setFeaturedWalletIds(e.featuredWalletIds),d.h.setTokens(e.tokens),d.h.setTermsConditionsUrl(e.termsConditionsUrl),d.h.setPrivacyPolicyUrl(e.privacyPolicyUrl),d.h.setCustomWallets(e.customWallets),d.h.setFeatures(e.features),d.h.setAllowUnsupportedChain(e.allowUnsupportedChain),d.h.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),d.h.setPreferUniversalLinks(e.experimental_preferUniversalLinks),d.h.setDefaultAccountTypes(e.defaultAccountTypes);let t=uK.M.getPreferredAccountTypes()||{},r={...d.h.state.defaultAccountTypes,...t};uV.N.setPreferredAccountTypes(r);let i=this.getDefaultMetaData();if(!e.metadata&&i&&(e.metadata=i),d.h.setMetadata(e.metadata),d.h.setDisableAppend(e.disableAppend),d.h.setEnableEmbedded(e.enableEmbedded),d.h.setSIWX(e.siwx),!e.projectId){u7.B.open(pd.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}let s=e.adapters?.find(e=>e.namespace===u$.b.CHAIN.EVM);if(s&&e.siweConfig){if(e.siwx)throw Error("Cannot set both `siweConfig` and `siwx` options");d.h.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return h.j.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){let t=this.getActiveChainNamespace();if(t){let r=gg.getUnsupportedNetwork(`${t}:${e}`);uH.R.setActiveCaipNetwork(r)}}getDefaultNetwork(){return gg.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){let r=gg.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId});return r}extendCaipNetworks(e){let t=gg.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId});return t}extendDefaultCaipNetwork(e){let t=e.networks.find(t=>t.id===e.defaultNetwork?.id),r=t?gg.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0;return r}async disconnectNamespace(e){try{let t=this.getAdapter(e),r=gb.getProvider(e),i=gb.getProviderId(e),{caipAddress:s}=uH.R.getAccountData(e)||{};this.setLoading(!0,e),s&&t?.disconnect&&await t.disconnect({provider:r,providerType:i}),uK.M.removeConnectedNamespace(e),gb.resetChain(e),this.setUser(void 0,e),this.setStatus("disconnected",e),this.setConnectedWalletInfo(void 0,e),c.A.removeConnectorId(e),uH.R.resetAccount(e),uH.R.resetNetwork(e),this.setLoading(!1,e)}catch(t){throw this.setLoading(!1,e),Error(`Failed to disconnect chain ${e}: ${t.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{let e=uH.R.state.activeChain,t=this.getAdapter(e),r=this.getCaipNetwork(e)?.id;if(!t)throw Error("Adapter not found");let i=await t.connectWalletConnect(r);this.close(),this.setClientId(i?.clientId||null),uK.M.setConnectedNamespaces([...uH.R.state.chains.keys()]),this.chainNamespaces.forEach(e=>{c.A.setConnectorId(gh.b.CONNECTOR_TYPE_WALLET_CONNECT,e)}),await this.syncWalletConnectAccount()},connectExternal:async({id:e,info:t,type:r,provider:i,chain:s,caipNetwork:n,socialUri:a})=>{let o=uH.R.state.activeChain,c=s||o,l=this.getAdapter(c);if(s&&s!==o&&!n){let e=this.getCaipNetworks().find(e=>e.chainNamespace===s);e&&this.setCaipNetwork(e)}if(!l)throw Error("Adapter not found");let h=this.getCaipNetwork(c),d=await l.connect({id:e,info:t,type:r,provider:i,socialUri:a,chainId:n?.id||h?.id,rpcUrl:n?.rpcUrls?.default?.http?.[0]||h?.rpcUrls?.default?.http?.[0]});if(!d)return;uK.M.addConnectedNamespace(c),this.syncProvider({...d,chainNamespace:c});let u=uV.N.state.allAccounts,{accounts:p}=u?.length>0?{accounts:[...u]}:await l.getAccounts({namespace:c,id:e});this.setAllAccounts(p,c),this.setStatus("connected",c),this.syncConnectedWalletInfo(c)},reconnectExternal:async({id:e,info:t,type:r,provider:i})=>{let s=uH.R.state.activeChain,n=this.getAdapter(s);n?.reconnect&&(await n?.reconnect({id:e,info:t,type:r,provider:i,chainId:this.getCaipNetwork()?.id}),uK.M.addConnectedNamespace(s),this.syncConnectedWalletInfo(s))},disconnect:async e=>{let t=function(e){let t=Array.from(uH.R.state.chains.keys()),r=[];return e?(r.push([e,uH.R.state.chains.get(e)]),po(e,u$.b.CONNECTOR_ID.WALLET_CONNECT)?t.forEach(t=>{t!==e&&po(t,u$.b.CONNECTOR_ID.WALLET_CONNECT)&&r.push([t,uH.R.state.chains.get(t)])}):po(e,u$.b.CONNECTOR_ID.AUTH)&&t.forEach(t=>{t!==e&&po(t,u$.b.CONNECTOR_ID.AUTH)&&r.push([t,uH.R.state.chains.get(t)])})):r=Array.from(uH.R.state.chains.entries()),r}(e);try{let r=await Promise.allSettled(t.map(async([e])=>this.disconnectNamespace(e)));pr.S.resetSend(),l.l.resetWcConnection(),await pi.w.clearSessions(),c.A.setFilterByNamespace(void 0);let i=r.filter(e=>"rejected"===e.status);if(i.length>0)throw Error(i.map(e=>e.reason.message).join(", "));uK.M.deleteConnectedSocialProvider(),pe.X.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:e||"all"}})}catch(e){throw Error(`Failed to disconnect chains: ${e.message}`)}},checkInstalled:e=>e?e.some(e=>!!window.ethereum?.[String(e)]):!!window.ethereum,signMessage:async e=>{let t=this.getAdapter(uH.R.state.activeChain),r=await t?.signMessage({message:e,address:uV.N.state.address,provider:gb.getProvider(uH.R.state.activeChain)});return r?.signature||""},sendTransaction:async e=>{let t=e.chainNamespace;if(u2.bq.SEND_SUPPORTED_NAMESPACES.includes(t)){let r=this.getAdapter(uH.R.state.activeChain),i=gb.getProvider(t),s=await r?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:i});return s?.hash||""}return""},estimateGas:async e=>{if(e.chainNamespace===u$.b.CHAIN.EVM){let t=this.getAdapter(uH.R.state.activeChain),r=gb.getProvider(uH.R.state.activeChain),i=this.getCaipNetwork();if(!i)throw Error("CaipNetwork is undefined");let s=await t?.estimateGas({...e,provider:r,caipNetwork:i});return s?.gas||0n}return 0n},getEnsAvatar:async()=>(await this.syncIdentity({address:uV.N.state.address,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:uH.R.state.activeChain}),uV.N.state.profileImage||!1),getEnsAddress:async e=>await gA.resolveReownName(e),writeContract:async e=>{let t=this.getAdapter(uH.R.state.activeChain),r=this.getCaipNetwork(),i=this.getCaipAddress(),s=gb.getProvider(uH.R.state.activeChain);if(!r||!i)throw Error("CaipNetwork or CaipAddress is undefined");let n=await t?.writeContract({...e,caipNetwork:r,provider:s,caipAddress:i});return n?.hash},parseUnits:(e,t)=>{let r=this.getAdapter(uH.R.state.activeChain);return r?.parseUnits({value:e,decimals:t})??0n},formatUnits:(e,t)=>{let r=this.getAdapter(uH.R.state.activeChain);return r?.formatUnits({value:e,decimals:t})??"0"},getCapabilities:async e=>{let t=this.getAdapter(uH.R.state.activeChain);return await t?.getCapabilities(e)},grantPermissions:async e=>{let t=this.getAdapter(uH.R.state.activeChain);return await t?.grantPermissions(e)},revokePermissions:async e=>{let t=this.getAdapter(uH.R.state.activeChain);return t?.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{let t=this.getAdapter(uH.R.state.activeChain);return await t?.walletGetAssets(e)??{}},updateBalance:e=>{let t=this.getCaipNetwork(e);t&&uV.N.state.address&&this.updateNativeBalance(uV.N.state.address,t?.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},l.l.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){let e=gb.getProviderId(uH.R.state.activeChain);if(e===gh.b.CONNECTOR_TYPE_WALLET_CONNECT){let e=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:"MetaMask Wallet"===this.universalProvider?.session?.peer?.metadata.name,approvedCaipNetworkIds:this.getChainsFromNamespaces(e)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;let t=e.chainNamespace,r=this.getAddressByChainNamespace(e.chainNamespace);if(r){let r=gb.getProvider(t),i=gb.getProviderId(t);if(e.chainNamespace===uH.R.state.activeChain){let s=this.getAdapter(t);await s?.switchNetwork({caipNetwork:e,provider:r,providerType:i})}else if(this.setCaipNetwork(e),i===gh.b.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{let r=this.getAddressByChainNamespace(t);r&&this.syncAccount({address:r,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(e=>{let t=e.chains||[],r=e.accounts.map(e=>{let{chainId:t,chainNamespace:r}=uF.parseCaipAddress(e);return`${r}:${t}`});return Array.from(new Set([...t,...r]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,r)=>{let i=e?.find(e=>e.namespace===r);return i?(i.construct({namespace:r,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),t[r]=i):t[r]=new gO({namespace:r,networks:this.getCaipNetworks()}),t},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e),await this.chainAdapters?.[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){let t=this.getAdapter(e);t?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){let t=this.getAdapter(e);if(!t)return;let r=uK.M.getConnectionStatus();"connected"===r?this.setStatus("connecting",e):("disconnected"===r&&uK.M.clearAddressCache(),this.setStatus(r,e)),t.on("switchNetwork",({address:t,chainId:r})=>{let i=this.getCaipNetworks().find(e=>e.id===r||e.caipNetworkId===r),s=uH.R.state.activeChain===e,n=uH.R.getAccountProp("address",e);if(i){let r=s&&t?t:n;r&&this.syncAccount({address:r,chainId:i.id,chainNamespace:e})}else this.setUnsupportedNetwork(r)}),t.on("disconnect",this.disconnect.bind(this,e)),t.on("connections",t=>{this.setConnections(t,e)}),t.on("pendingTransactions",()=>{let e=uV.N.state.address,t=uH.R.state.activeCaipNetwork;e&&t?.id&&this.updateNativeBalance(e,t.id,t.chainNamespace)}),t.on("accountChanged",({address:t,chainId:r})=>{let i=uH.R.state.activeChain===e;i&&r?this.syncAccount({address:t,chainId:r,chainNamespace:e}):i&&uH.R.state.activeCaipNetwork?.id?this.syncAccount({address:t,chainId:uH.R.state.activeCaipNetwork?.id,chainNamespace:e}):this.syncAccountInfo(t,r,e),this.syncAllAccounts(e)})}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async syncNamespaceConnection(e){try{e===u$.b.CHAIN.EVM&&h.j.isSafeApp()&&c.A.setConnectorId(u$.b.CONNECTOR_ID.SAFE,e);let t=c.A.getConnectorId(e);switch(this.setStatus("connecting",e),t){case u$.b.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case u$.b.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){let t=this.getAdapter(e),r=c.A.getConnectorId(e),i=this.getCaipNetwork(e),s=c.A.getConnectors(e),n=s.find(e=>e.id===r);try{if(!t||!n)throw Error(`Adapter or connector not found for namespace ${e}`);if(!i?.id)throw Error("CaipNetwork not found");let r=await t?.syncConnection({namespace:e,id:n.id,chainId:i.id,rpcUrl:i?.rpcUrls?.default?.http?.[0]});if(r){let i=await t?.getAccounts({namespace:e,id:n.id});i&&i.accounts.length>0?this.setAllAccounts(i.accounts,e):this.setAllAccounts([h.j.createAccount(e,r.address,"eoa")],e),this.syncProvider({...r,chainNamespace:e}),await this.syncAccount({...r,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch(t){this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){let e=this.chainNamespaces.map(async e=>{let t=this.getAdapter(e),r=this.universalProvider?.session?.namespaces?.[e]?.accounts||[],i=uH.R.state.activeCaipNetwork?.id,s=r.find(e=>{let{chainId:t}=uF.parseCaipAddress(e);return t===i?.toString()})||r[0];if(s){let r=uF.validateCaipAddress(s),{chainId:i,address:n}=uF.parseCaipAddress(r);if(gb.setProviderId(e,gh.b.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&uH.R.state.activeCaipNetwork&&t?.namespace!==u$.b.CHAIN.EVM){let r=t?.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:uH.R.state.activeCaipNetwork});gb.setProvider(e,r)}else gb.setProvider(e,this.universalProvider);c.A.setConnectorId(u$.b.CONNECTOR_ID.WALLET_CONNECT,e),uK.M.addConnectedNamespace(e),this.syncWalletConnectAccounts(e),await this.syncAccount({address:n,chainId:i,chainNamespace:e})}else this.setStatus("disconnected",e);this.syncConnectedWalletInfo(e),await uH.R.setApprovedCaipNetworksData(e)});await Promise.all(e)}syncWalletConnectAccounts(e){let t=this.universalProvider?.session?.namespaces?.[e]?.accounts?.map(e=>{let{address:t}=uF.parseCaipAddress(e);return t}).filter((e,t,r)=>r.indexOf(e)===t);t&&this.setAllAccounts(t.map(t=>h.j.createAccount(e,t,"bip122"===e?"payment":"eoa")),e)}syncProvider({type:e,provider:t,id:r,chainNamespace:i}){gb.setProviderId(i,e),gb.setProvider(i,t),c.A.setConnectorId(r,i)}async syncAllAccounts(e){let t=c.A.getConnectorId(e);if(!t)return;let r=this.getAdapter(e),i=await r?.getAccounts({namespace:e,id:t});i&&i.accounts.length>0&&this.setAllAccounts(i.accounts,e)}async syncAccount(e){let t=e.chainNamespace===uH.R.state.activeChain,r=uH.R.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:i,chainId:s,chainNamespace:n}=e,{chainId:a}=uK.M.getActiveNetworkProps(),o=s||a,c=uH.R.state.activeCaipNetwork?.name===u$.b.UNSUPPORTED_NETWORK_NAME,l=uH.R.getNetworkProp("supportsAllNetworks",n);if(this.setStatus("connected",n),(!c||l)&&o){let e=this.getCaipNetworks().find(e=>e.id.toString()===o.toString()),s=this.getCaipNetworks().find(e=>e.chainNamespace===n);if(!l&&!e&&!s){let t=this.getApprovedCaipNetworkIds()||[],r=t.find(e=>uF.parseCaipNetworkId(e)?.chainId===o.toString()),i=t.find(e=>uF.parseCaipNetworkId(e)?.chainNamespace===n);e=this.getCaipNetworks().find(e=>e.caipNetworkId===r),s=this.getCaipNetworks().find(e=>e.caipNetworkId===i||"deprecatedCaipNetworkId"in e&&e.deprecatedCaipNetworkId===i)}let a=e||s;a?.chainNamespace===uH.R.state.activeChain?d.h.state.enableNetworkSwitch&&!d.h.state.allowUnsupportedChain&&uH.R.state.activeCaipNetwork?.name===u$.b.UNSUPPORTED_NETWORK_NAME?uH.R.showUnsupportedChainUI():this.setCaipNetwork(a):!t&&r&&this.setCaipNetworkOfNamespace(r,n),this.syncConnectedWalletInfo(n),gf.g.isLowerCaseMatch(i,uV.N.state.address)||this.syncAccountInfo(i,a?.id,n),t?await this.syncBalance({address:i,chainId:a?.id,chainNamespace:n}):await this.syncBalance({address:i,chainId:r?.id,chainNamespace:n})}}async syncAccountInfo(e,t,r){let i=this.getCaipAddress(r),s=t||i?.split(":")[1];if(!s)return;let n=`${r}:${s}:${e}`;this.setCaipAddress(n,r),await this.syncIdentity({address:e,chainId:s,chainNamespace:r})}async syncReownName(e,t){try{let r=await this.getReownName(e);if(r[0]){let e=r[0];this.setProfileName(e.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){let t=c.A.getConnectorId(e),r=gb.getProviderId(e);if(r===gh.b.CONNECTOR_TYPE_ANNOUNCED||r===gh.b.CONNECTOR_TYPE_INJECTED){if(t){let r=this.getConnectors().find(e=>e.id===t);if(r){let{info:t,name:i,imageUrl:s}=r,n=s||this.getConnectorImage(r);this.setConnectedWalletInfo({name:i,icon:n,...t},e)}}}else if(r===gh.b.CONNECTOR_TYPE_WALLET_CONNECT){let t=gb.getProvider(e);t?.session&&this.setConnectedWalletInfo({...t.session.peer.metadata,name:t.session.peer.metadata.name,icon:t.session.peer.metadata.icons?.[0]},e)}else if(t&&t===u$.b.CONNECTOR_ID.COINBASE){let t=this.getConnectors().find(e=>e.id===u$.b.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(t)},e)}}async syncBalance(e){let t=uz.p.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(t=>t.id.toString()===e.chainId?.toString());t&&e.chainId&&await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,t,r){let i=this.getAdapter(r),s=uH.R.getCaipNetworkByNamespace(r,t);if(i){let n=await i.getBalance({address:e,chainId:t,caipNetwork:s,tokens:this.options.tokens});return this.setBalance(n.balance,n.symbol,r),n}}async initializeUniversalAdapter(){let e=gm.createLogger((e,...t)=>{e&&this.handleAlertError(e),console.error(...t)}),t={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};d.h.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await uq.init(t),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",e=>{l.l.setUri(e)}),this.universalProvider.on("connect",l.l.finalizeWcConnection),this.universalProvider.on("disconnect",()=>{this.chainNamespaces.forEach(e=>{this.resetAccount(e)}),l.l.resetWcConnection()}),this.universalProvider.on("chainChanged",e=>{let t=this.getCaipNetworks().find(t=>t.id==e),r=this.getCaipNetwork();if(!t){this.setUnsupportedNetwork(e);return}r?.id!==t?.id&&this.setCaipNetwork(t)}),this.universalProvider.on("session_event",e=>{if(gA.isSessionEventData(e)){let{name:t,data:r}=e.params.event;"accountsChanged"===t&&Array.isArray(r)&&h.j.isCaipAddress(r[0])&&this.syncAccount(uF.parseCaipAddress(r[0]))}}))}createUniversalProvider(){return!this.universalProviderInitPromise&&h.j.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){pe.X.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){let t=Object.entries(pd.UniversalProviderErrors).find(([,{message:t}])=>e.message.includes(t)),[r,i]=t??[],{message:s,alertErrorKey:n}=i??{};if(r&&s&&!this.reportedAlertErrors[r]){let e=pd.ALERT_ERRORS[n];e&&(u7.B.open(e,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;let t=e.namespace;if(!t)return;this.createClients();let r=e;r.namespace=t,r.construct({namespace:t,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=r)}async open(e){return(await this.injectModalUi(),e?.uri&&l.l.setUri(e.uri),e?.arguments&&e?.view==="Swap")?ps.I.open({...e,data:{swap:e.arguments}}):ps.I.open(e)}async close(){await this.injectModalUi(),ps.I.close()}setLoading(e,t){ps.I.setLoading(e,t)}async disconnect(e){await l.l.disconnect(e)}getSIWX(){return d.h.state.siwx}getError(){return""}getChainId(){return uH.R.state.activeCaipNetwork?.id}async switchNetwork(e){let t=this.getCaipNetworks().find(t=>t.id===e.id);if(!t){u7.B.open(pd.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await uH.R.switchActiveNetwork(t)}getWalletProvider(){return uH.R.state.activeChain?gb.state.providers[uH.R.state.activeChain]:null}getWalletProviderType(){return gb.getProviderId(uH.R.state.activeChain)}subscribeProviders(e){return gb.subscribeProviders(e)}getThemeMode(){return pt.u.state.themeMode}getThemeVariables(){return pt.u.state.themeVariables}setThemeMode(e){pt.u.setThemeMode(e),(0,pl.Hs)(pt.u.state.themeMode)}setTermsConditionsUrl(e){d.h.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){d.h.setPrivacyPolicyUrl(e)}setThemeVariables(e){pt.u.setThemeVariables(e),(0,pl.R)(pt.u.state.themeVariables)}subscribeTheme(e){return pt.u.subscribe(e)}getWalletInfo(){return uV.N.state.connectedWalletInfo}getAccount(e){let t=c.A.getAuthConnector(e),r=uH.R.getAccountData(e),i=uH.R.state.activeChain,s=uK.M.getConnectedConnectorId(e||i);if(r)return{allAccounts:r.allAccounts,caipAddress:r.caipAddress,address:h.j.getPlainAddress(r.caipAddress),isConnected:!!r.caipAddress,status:r.status,embeddedWalletInfo:t&&s===u$.b.CONNECTOR_ID.AUTH?{user:r.user?{...r.user,username:uK.M.getConnectedSocialUsername()}:void 0,authProvider:r.socialProvider||"email",accountType:r.preferredAccountTypes?.[e||i],isSmartAccountDeployed:!!r.smartAccountDeployed}:void 0}}subscribeAccount(e,t){let r=()=>{let r=this.getAccount(t);r&&e(r)};t?uH.R.subscribeChainProp("accountState",r,t):uH.R.subscribe(r),c.A.subscribe(r)}subscribeNetwork(e){return uH.R.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t?.id,caipNetworkId:t?.caipNetworkId})})}subscribeWalletInfo(e){return uV.N.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){uV.N.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){uH.R.subscribeKey("activeCaipNetwork",e)}getState(){return pn.I.state}subscribeState(e){return pn.I.subscribe(e)}showErrorMessage(e){pa.K.showError(e)}showSuccessMessage(e){pa.K.showSuccess(e)}getEvent(){return{...pe.X.state}}subscribeEvents(e){return pe.X.subscribe(e)}replace(e){uX.P.replace(e)}redirect(e){uX.P.push(e)}popTransactionStack(e){uX.P.popTransactionStack(e)}isOpen(){return ps.I.state.open}isTransactionStackEmpty(){return 0===uX.P.state.transactionStack.length}static getInstance(){return this.instance}updateFeatures(e){d.h.setFeatures(e)}updateRemoteFeatures(e){d.h.setRemoteFeatures(e)}updateOptions(e){let t=d.h.state||{},r={...t,...e};d.h.setOptions(r)}setConnectMethodsOrder(e){d.h.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){d.h.setWalletFeaturesOrder(e)}setCollapseWallets(e){d.h.setCollapseWallets(e)}setSocialsOrder(e){d.h.setSocialsOrder(e)}getConnectMethodsOrder(){return pc.J.getConnectOrderMethod(d.h.state.features,c.A.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw Error(`Adapter for namespace ${e} doesn't exist`);let r=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(e=>e.id===r.id)||uH.R.addNetwork(r)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw Error(`Adapter for namespace ${e} doesn't exist`);let r=this.getCaipNetworks().find(e=>e.id===t);r&&uH.R.removeNetwork(e,t)}}let gU=!1;class gD extends gx{async open(e){let t=c.A.isConnected();t||await super.open(e)}async close(){await super.close(),this.options.manualWCControl&&l.l.finalizeWcConnection()}async syncIdentity(e){return Promise.resolve()}async syncBalance(e){return Promise.resolve()}async injectModalUi(){if(!gU&&h.j.isClient()){await Promise.all([r.e(5308),r.e(9324)]).then(r.bind(r,39324)),await Promise.all([r.e(5308),r.e(3404)]).then(r.bind(r,53404));let e=document.querySelector("w3m-modal");if(!e){let e=document.createElement("w3m-modal");d.h.state.disableAppend||d.h.state.enableEmbedded||document.body.insertAdjacentElement("beforeend",e)}gU=!0}}}function gL(e){return new gD({...e,basic:!0,sdkVersion:"html-core-1.7.8"})}},1495:function(e,t,r){r.d(t,{sj:function(){return E},iH:function(){return N},CO:function(){return I},Ld:function(){return C}});let i=Symbol(),s=Symbol(),n=(e,t)=>new Proxy(e,t),a=Object.getPrototypeOf,o=new WeakMap,c=e=>e&&(o.has(e)?o.get(e):a(e)===Object.prototype||a(e)===Array.prototype),l=e=>"object"==typeof e&&null!==e,h=e=>{if(Array.isArray(e))return Array.from(e);let t=Object.getOwnPropertyDescriptors(e);return Object.values(t).forEach(e=>{e.configurable=!0}),Object.create(a(e),t)},d=e=>e[s]||e,u=(e,t,r,a)=>{if(!c(e))return e;let o=a&&a.get(e);if(!o){let t=d(e);o=Object.values(Object.getOwnPropertyDescriptors(t)).some(e=>!e.configurable&&!e.writable)?[t,h(t)]:[t],null==a||a.set(e,o)}let[l,p]=o,g=r&&r.get(l);return g&&!!p===g[1].f||((g=((e,t)=>{let r={f:t},n=!1,a=(t,i)=>{if(!n){let s=r.a.get(e);if(s||(s={},r.a.set(e,s)),"w"===t)s.w=!0;else{let e=s[t];e||(e=new Set,s[t]=e),e.add(i)}}},o={get:(t,i)=>i===s?e:(a("k",i),u(Reflect.get(t,i),r.a,r.c,r.t)),has:(t,s)=>s===i?(n=!0,r.a.delete(e),!0):(a("h",s),Reflect.has(t,s)),getOwnPropertyDescriptor:(e,t)=>(a("o",t),Reflect.getOwnPropertyDescriptor(e,t)),ownKeys:e=>(a("w"),Reflect.ownKeys(e))};return t&&(o.set=o.deleteProperty=()=>!1),[o,r]})(l,!!p))[1].p=n(p||l,g[0]),r&&r.set(l,g)),g[1].a=t,g[1].c=r,g[1].t=a,g[1].p},p=(e,t,r,i,s=Object.is)=>{if(s(e,t))return!1;if(!l(e)||!l(t))return!0;let n=r.get(d(e));if(!n)return!0;if(i){let r=i.get(e);if(r&&r.n===t)return r.g;i.set(e,{n:t,g:!1})}let a=null;try{for(let r of n.h||[])if(a=Reflect.has(e,r)!==Reflect.has(t,r))return a;if(!0===n.w){if(a=((e,t)=>{let r=Reflect.ownKeys(e),i=Reflect.ownKeys(t);return r.length!==i.length||r.some((e,t)=>e!==i[t])})(e,t))return a}else for(let r of n.o||[])if(a=!!Reflect.getOwnPropertyDescriptor(e,r)!=!!Reflect.getOwnPropertyDescriptor(t,r))return a;for(let o of n.k||[])if(a=p(e[o],t[o],r,i,s))return a;return null===a&&(a=!0),a}finally{i&&i.set(e,{n:t,g:a})}},g=e=>c(e)&&e[s]||null,f=(e,t=!0)=>{o.set(e,t)},m=e=>"object"==typeof e&&null!==e,w=new WeakMap,y=new WeakSet,b=(e=Object.is,t=(e,t)=>new Proxy(e,t),r=e=>m(e)&&!y.has(e)&&(Array.isArray(e)||!(Symbol.iterator in e))&&!(e instanceof WeakMap)&&!(e instanceof WeakSet)&&!(e instanceof Error)&&!(e instanceof Number)&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof RegExp)&&!(e instanceof ArrayBuffer),i=e=>{switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e}},s=new WeakMap,n=(e,t,r=i)=>{let a=s.get(e);if((null==a?void 0:a[0])===t)return a[1];let o=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return f(o,!0),s.set(e,[t,o]),Reflect.ownKeys(e).forEach(t=>{if(Object.getOwnPropertyDescriptor(o,t))return;let i=Reflect.get(e,t),{enumerable:s}=Reflect.getOwnPropertyDescriptor(e,t),a={value:i,enumerable:s,configurable:!0};if(y.has(i))f(i,!1);else if(i instanceof Promise)delete a.value,a.get=()=>r(i);else if(w.has(i)){let[e,t]=w.get(i);a.value=n(e,t(),r)}Object.defineProperty(o,t,a)}),Object.preventExtensions(o)},a=new WeakMap,o=[1,1],c=i=>{if(!m(i))throw Error("object required");let s=a.get(i);if(s)return s;let l=o[0],h=new Set,d=(e,t=++o[0])=>{l!==t&&(l=t,h.forEach(r=>r(e,t)))},u=o[1],p=(e=++o[1])=>(u===e||h.size||(u=e,b.forEach(([t])=>{let r=t[1](e);r>l&&(l=r)})),l),f=e=>(t,r)=>{let i=[...t];i[1]=[e,...i[1]],d(i,r)},b=new Map,v=(e,t)=>{if(b.has(e))throw Error("prop listener already exists");if(h.size){let r=t[3](f(e));b.set(e,[t,r])}else b.set(e,[t])},E=e=>{var t;let r=b.get(e);r&&(b.delete(e),null==(t=r[1])||t.call(r))},C=e=>{h.add(e),1===h.size&&b.forEach(([e,t],r)=>{if(t)throw Error("remove already exists");let i=e[3](f(r));b.set(r,[e,i])});let t=()=>{h.delete(e),0===h.size&&b.forEach(([e,t],r)=>{t&&(t(),b.set(r,[e]))})};return t},I=Array.isArray(i)?[]:Object.create(Object.getPrototypeOf(i)),N={deleteProperty(e,t){let r=Reflect.get(e,t);E(t);let i=Reflect.deleteProperty(e,t);return i&&d(["delete",[t],r]),i},set(t,i,s,n){let o=Reflect.has(t,i),l=Reflect.get(t,i,n);if(o&&(e(l,s)||a.has(s)&&e(l,a.get(s))))return!0;E(i),m(s)&&(s=g(s)||s);let h=s;if(s instanceof Promise)s.then(e=>{s.status="fulfilled",s.value=e,d(["resolve",[i],e])}).catch(e=>{s.status="rejected",s.reason=e,d(["reject",[i],e])});else{!w.has(s)&&r(s)&&(h=c(s));let e=!y.has(h)&&w.get(h);e&&v(i,e)}return Reflect.set(t,i,h,n),d(["set",[i],s,l]),!0}},A=t(I,N);a.set(i,A);let _=[I,p,n,C];return w.set(A,_),Reflect.ownKeys(i).forEach(e=>{let t=Object.getOwnPropertyDescriptor(i,e);"value"in t&&(A[e]=i[e],delete t.value,delete t.writable),Object.defineProperty(I,e,t)}),A})=>[c,w,y,e,t,r,i,s,n,a,o],[v]=b();function E(e={}){return v(e)}function C(e,t,r){let i;let s=w.get(e);s||console.warn("Please use proxy object");let n=[],a=s[3],o=!1,c=e=>{if(n.push(e),r){t(n.splice(0));return}i||(i=Promise.resolve().then(()=>{i=void 0,o&&t(n.splice(0))}))},l=a(c);return o=!0,()=>{o=!1,l()}}function I(e,t){let r=w.get(e);r||console.warn("Please use proxy object");let[i,s,n]=r;return n(i,s(),t)}function N(e){return y.add(e),e}},63243:function(e,t,r){let i;r.d(t,{VW:function(){return n},Yr:function(){return c}});var s=r(1495);function n(e,t,r,i){let n=e[t];return(0,s.Ld)(e,()=>{let i=e[t];Object.is(n,i)||r(n=i)},i)}Symbol();let a=e=>"object"==typeof e&&null!==e,o=e=>{if(i||(i=unstable_buildProxyFunction()[2]),!a(e)||i.has(e))return e;let t=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return Reflect.ownKeys(e).forEach(r=>{t[r]=o(e[r])}),t};function c(e){let t=(0,s.sj)({data:Array.from(e||[]),has(e){return this.data.some(t=>t[0]===e)},set(e,t){let r=this.data.find(t=>t[0]===e);return r?r[1]=t:this.data.push([e,t]),this},get(e){var t;return null==(t=this.data.find(t=>t[0]===e))?void 0:t[1]},delete(e){let t=this.data.findIndex(t=>t[0]===e);return -1!==t&&(this.data.splice(t,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return new Map(this.data)},forEach(e){this.data.forEach(t=>{e(t[1],t[0],this)})},keys(){return this.data.map(e=>e[0]).values()},values(){return this.data.map(e=>e[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(t,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(t),t}},34551:function(e,t,r){r.d(t,{b:function(){return i}});function i(e,t){let r=e.toString(),i=r.startsWith("-");i&&(r=r.slice(1));let[s,n]=[(r=r.padStart(t,"0")).slice(0,r.length-t),r.slice(r.length-t)];return n=n.replace(/(0+)$/,""),`${i?"-":""}${s||"0"}${n?`.${n}`:""}`}}}]);